<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tapnow Studio</title>
  <script type="module" crossorigin>var Iv=Object.defineProperty;var wm=e=>{throw TypeError(e)};var Ev=(e,t,r)=>t in e?Iv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var On=(e,t,r)=>Ev(e,typeof t!="symbol"?t+"":t,r),$v=(e,t,r)=>t.has(e)||wm("Cannot "+r);var km=(e,t,r)=>t.has(e)?wm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var pu=(e,t,r)=>($v(e,t,"access private method"),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var vi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yx={exports:{}},Id={},vx={exports:{}},dn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zc=Symbol.for("react.element"),Mv=Symbol.for("react.portal"),Tv=Symbol.for("react.fragment"),Pv=Symbol.for("react.strict_mode"),Av=Symbol.for("react.profiler"),Rv=Symbol.for("react.provider"),Dv=Symbol.for("react.context"),Ov=Symbol.for("react.forward_ref"),Lv=Symbol.for("react.suspense"),Uv=Symbol.for("react.memo"),Fv=Symbol.for("react.lazy"),zm=Symbol.iterator;function Bv(e){return e===null||typeof e!="object"?null:(e=zm&&e[zm]||e["@@iterator"],typeof e=="function"?e:null)}var wx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kx=Object.assign,zx={};function Ya(e,t,r){this.props=e,this.context=t,this.refs=zx,this.updater=r||wx}Ya.prototype.isReactComponent={};Ya.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ya.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jx(){}jx.prototype=Ya.prototype;function f0(e,t,r){this.props=e,this.context=t,this.refs=zx,this.updater=r||wx}var h0=f0.prototype=new jx;h0.constructor=f0;kx(h0,Ya.prototype);h0.isPureReactComponent=!0;var jm=Array.isArray,Nx=Object.prototype.hasOwnProperty,m0={current:null},_x={key:!0,ref:!0,__self:!0,__source:!0};function Sx(e,t,r){var i,o={},a=null,c=null;if(t!=null)for(i in t.ref!==void 0&&(c=t.ref),t.key!==void 0&&(a=""+t.key),t)Nx.call(t,i)&&!_x.hasOwnProperty(i)&&(o[i]=t[i]);var p=arguments.length-2;if(p===1)o.children=r;else if(1<p){for(var m=Array(p),w=0;w<p;w++)m[w]=arguments[w+2];o.children=m}if(e&&e.defaultProps)for(i in p=e.defaultProps,p)o[i]===void 0&&(o[i]=p[i]);return{$$typeof:zc,type:e,key:a,ref:c,props:o,_owner:m0.current}}function Wv(e,t){return{$$typeof:zc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function g0(e){return typeof e=="object"&&e!==null&&e.$$typeof===zc}function Hv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Nm=/\/+/g;function Sp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Hv(""+e.key):t.toString(36)}function Bu(e,t,r,i,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var c=!1;if(e===null)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case zc:case Mv:c=!0}}if(c)return c=e,o=o(c),e=i===""?"."+Sp(c,0):i,jm(o)?(r="",e!=null&&(r=e.replace(Nm,"$&/")+"/"),Bu(o,t,r,"",function(w){return w})):o!=null&&(g0(o)&&(o=Wv(o,r+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(Nm,"$&/")+"/")+e)),t.push(o)),1;if(c=0,i=i===""?".":i+":",jm(e))for(var p=0;p<e.length;p++){a=e[p];var m=i+Sp(a,p);c+=Bu(a,t,r,m,o)}else if(m=Bv(e),typeof m=="function")for(e=m.call(e),p=0;!(a=e.next()).done;)a=a.value,m=i+Sp(a,p++),c+=Bu(a,t,r,m,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function fu(e,t,r){if(e==null)return e;var i=[],o=0;return Bu(e,i,"","",function(a){return t.call(r,a,o++)}),i}function Vv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Yr={current:null},Wu={transition:null},Kv={ReactCurrentDispatcher:Yr,ReactCurrentBatchConfig:Wu,ReactCurrentOwner:m0};function Cx(){throw Error("act(...) is not supported in production builds of React.")}dn.Children={map:fu,forEach:function(e,t,r){fu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return fu(e,function(){t++}),t},toArray:function(e){return fu(e,function(t){return t})||[]},only:function(e){if(!g0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};dn.Component=Ya;dn.Fragment=Tv;dn.Profiler=Av;dn.PureComponent=f0;dn.StrictMode=Pv;dn.Suspense=Lv;dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kv;dn.act=Cx;dn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=kx({},e.props),o=e.key,a=e.ref,c=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,c=m0.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var p=e.type.defaultProps;for(m in t)Nx.call(t,m)&&!_x.hasOwnProperty(m)&&(i[m]=t[m]===void 0&&p!==void 0?p[m]:t[m])}var m=arguments.length-2;if(m===1)i.children=r;else if(1<m){p=Array(m);for(var w=0;w<m;w++)p[w]=arguments[w+2];i.children=p}return{$$typeof:zc,type:e.type,key:o,ref:a,props:i,_owner:c}};dn.createContext=function(e){return e={$$typeof:Dv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Rv,_context:e},e.Consumer=e};dn.createElement=Sx;dn.createFactory=function(e){var t=Sx.bind(null,e);return t.type=e,t};dn.createRef=function(){return{current:null}};dn.forwardRef=function(e){return{$$typeof:Ov,render:e}};dn.isValidElement=g0;dn.lazy=function(e){return{$$typeof:Fv,_payload:{_status:-1,_result:e},_init:Vv}};dn.memo=function(e,t){return{$$typeof:Uv,type:e,compare:t===void 0?null:t}};dn.startTransition=function(e){var t=Wu.transition;Wu.transition={};try{e()}finally{Wu.transition=t}};dn.unstable_act=Cx;dn.useCallback=function(e,t){return Yr.current.useCallback(e,t)};dn.useContext=function(e){return Yr.current.useContext(e)};dn.useDebugValue=function(){};dn.useDeferredValue=function(e){return Yr.current.useDeferredValue(e)};dn.useEffect=function(e,t){return Yr.current.useEffect(e,t)};dn.useId=function(){return Yr.current.useId()};dn.useImperativeHandle=function(e,t,r){return Yr.current.useImperativeHandle(e,t,r)};dn.useInsertionEffect=function(e,t){return Yr.current.useInsertionEffect(e,t)};dn.useLayoutEffect=function(e,t){return Yr.current.useLayoutEffect(e,t)};dn.useMemo=function(e,t){return Yr.current.useMemo(e,t)};dn.useReducer=function(e,t,r){return Yr.current.useReducer(e,t,r)};dn.useRef=function(e){return Yr.current.useRef(e)};dn.useState=function(e){return Yr.current.useState(e)};dn.useSyncExternalStore=function(e,t,r){return Yr.current.useSyncExternalStore(e,t,r)};dn.useTransition=function(){return Yr.current.useTransition()};dn.version="18.3.1";vx.exports=dn;var R=vx.exports;const Ed=bx(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv=R,Gv=Symbol.for("react.element"),Xv=Symbol.for("react.fragment"),Jv=Object.prototype.hasOwnProperty,Zv=Yv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qv={key:!0,ref:!0,__self:!0,__source:!0};function Ix(e,t,r){var i,o={},a=null,c=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(c=t.ref);for(i in t)Jv.call(t,i)&&!qv.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)o[i]===void 0&&(o[i]=t[i]);return{$$typeof:Gv,type:e,key:a,ref:c,props:o,_owner:Zv.current}}Id.Fragment=Xv;Id.jsx=Ix;Id.jsxs=Ix;yx.exports=Id;var s=yx.exports,ff={},Ex={exports:{}},ms={},$x={exports:{}},Mx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ve,me){var Re=ve.length;ve.push(me);e:for(;0<Re;){var ce=Re-1>>>1,fe=ve[ce];if(0<o(fe,me))ve[ce]=me,ve[Re]=fe,Re=ce;else break e}}function r(ve){return ve.length===0?null:ve[0]}function i(ve){if(ve.length===0)return null;var me=ve[0],Re=ve.pop();if(Re!==me){ve[0]=Re;e:for(var ce=0,fe=ve.length,ct=fe>>>1;ce<ct;){var it=2*(ce+1)-1,Fe=ve[it],on=it+1,Cn=ve[on];if(0>o(Fe,Re))on<fe&&0>o(Cn,Fe)?(ve[ce]=Cn,ve[on]=Re,ce=on):(ve[ce]=Fe,ve[it]=Re,ce=it);else if(on<fe&&0>o(Cn,Re))ve[ce]=Cn,ve[on]=Re,ce=on;else break e}}return me}function o(ve,me){var Re=ve.sortIndex-me.sortIndex;return Re!==0?Re:ve.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,p=c.now();e.unstable_now=function(){return c.now()-p}}var m=[],w=[],$=1,T=null,E=3,y=!1,A=!1,N=!1,D=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(ve){for(var me=r(w);me!==null;){if(me.callback===null)i(w);else if(me.startTime<=ve)i(w),me.sortIndex=me.expirationTime,t(m,me);else break;me=r(w)}}function W(ve){if(N=!1,P(ve),!A)if(r(m)!==null)A=!0,ht(G);else{var me=r(w);me!==null&&ke(W,me.startTime-ve)}}function G(ve,me){A=!1,N&&(N=!1,b(ye),ye=-1),y=!0;var Re=E;try{for(P(me),T=r(m);T!==null&&(!(T.expirationTime>me)||ve&&!Ke());){var ce=T.callback;if(typeof ce=="function"){T.callback=null,E=T.priorityLevel;var fe=ce(T.expirationTime<=me);me=e.unstable_now(),typeof fe=="function"?T.callback=fe:T===r(m)&&i(m),P(me)}else i(m);T=r(m)}if(T!==null)var ct=!0;else{var it=r(w);it!==null&&ke(W,it.startTime-me),ct=!1}return ct}finally{T=null,E=Re,y=!1}}var oe=!1,se=null,ye=-1,we=5,Se=-1;function Ke(){return!(e.unstable_now()-Se<we)}function X(){if(se!==null){var ve=e.unstable_now();Se=ve;var me=!0;try{me=se(!0,ve)}finally{me?_e():(oe=!1,se=null)}}else oe=!1}var _e;if(typeof z=="function")_e=function(){z(X)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,je=I.port2;I.port1.onmessage=X,_e=function(){je.postMessage(null)}}else _e=function(){D(X,0)};function ht(ve){se=ve,oe||(oe=!0,_e())}function ke(ve,me){ye=D(function(){ve(e.unstable_now())},me)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ve){ve.callback=null},e.unstable_continueExecution=function(){A||y||(A=!0,ht(G))},e.unstable_forceFrameRate=function(ve){0>ve||125<ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):we=0<ve?Math.floor(1e3/ve):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return r(m)},e.unstable_next=function(ve){switch(E){case 1:case 2:case 3:var me=3;break;default:me=E}var Re=E;E=me;try{return ve()}finally{E=Re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ve,me){switch(ve){case 1:case 2:case 3:case 4:case 5:break;default:ve=3}var Re=E;E=ve;try{return me()}finally{E=Re}},e.unstable_scheduleCallback=function(ve,me,Re){var ce=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?ce+Re:ce):Re=ce,ve){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=Re+fe,ve={id:$++,callback:me,priorityLevel:ve,startTime:Re,expirationTime:fe,sortIndex:-1},Re>ce?(ve.sortIndex=Re,t(w,ve),r(m)===null&&ve===r(w)&&(N?(b(ye),ye=-1):N=!0,ke(W,Re-ce))):(ve.sortIndex=fe,t(m,ve),A||y||(A=!0,ht(G))),ve},e.unstable_shouldYield=Ke,e.unstable_wrapCallback=function(ve){var me=E;return function(){var Re=E;E=me;try{return ve.apply(this,arguments)}finally{E=Re}}}})(Mx);$x.exports=Mx;var Qv=$x.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ew=R,hs=Qv;function Xe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tx=new Set,oc={};function Vo(e,t){Ua(e,t),Ua(e+"Capture",t)}function Ua(e,t){for(oc[e]=t,e=0;e<t.length;e++)Tx.add(t[e])}var Ni=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hf=Object.prototype.hasOwnProperty,tw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_m={},Sm={};function nw(e){return hf.call(Sm,e)?!0:hf.call(_m,e)?!1:tw.test(e)?Sm[e]=!0:(_m[e]=!0,!1)}function rw(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sw(e,t,r,i){if(t===null||typeof t>"u"||rw(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gr(e,t,r,i,o,a,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=c}var _r={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){_r[e]=new Gr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];_r[t]=new Gr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){_r[e]=new Gr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){_r[e]=new Gr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){_r[e]=new Gr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){_r[e]=new Gr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){_r[e]=new Gr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){_r[e]=new Gr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){_r[e]=new Gr(e,5,!1,e.toLowerCase(),null,!1,!1)});var x0=/[\-:]([a-z])/g;function b0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x0,b0);_r[t]=new Gr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x0,b0);_r[t]=new Gr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x0,b0);_r[t]=new Gr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){_r[e]=new Gr(e,1,!1,e.toLowerCase(),null,!1,!1)});_r.xlinkHref=new Gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){_r[e]=new Gr(e,1,!1,e.toLowerCase(),null,!0,!0)});function y0(e,t,r,i){var o=_r.hasOwnProperty(t)?_r[t]:null;(o!==null?o.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(sw(t,r,o,i)&&(r=null),i||o===null?nw(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,i=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var Ii=ew.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hu=Symbol.for("react.element"),ka=Symbol.for("react.portal"),za=Symbol.for("react.fragment"),v0=Symbol.for("react.strict_mode"),mf=Symbol.for("react.profiler"),Px=Symbol.for("react.provider"),Ax=Symbol.for("react.context"),w0=Symbol.for("react.forward_ref"),gf=Symbol.for("react.suspense"),xf=Symbol.for("react.suspense_list"),k0=Symbol.for("react.memo"),Zi=Symbol.for("react.lazy"),Rx=Symbol.for("react.offscreen"),Cm=Symbol.iterator;function zl(e){return e===null||typeof e!="object"?null:(e=Cm&&e[Cm]||e["@@iterator"],typeof e=="function"?e:null)}var Jn=Object.assign,Cp;function Fl(e){if(Cp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Cp=t&&t[1]||""}return`
`+Cp+e}var Ip=!1;function Ep(e,t){if(!e||Ip)return"";Ip=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(w){var i=w}Reflect.construct(e,[],t)}else{try{t.call()}catch(w){i=w}e.call(t.prototype)}else{try{throw Error()}catch(w){i=w}e()}}catch(w){if(w&&i&&typeof w.stack=="string"){for(var o=w.stack.split(`
`),a=i.stack.split(`
`),c=o.length-1,p=a.length-1;1<=c&&0<=p&&o[c]!==a[p];)p--;for(;1<=c&&0<=p;c--,p--)if(o[c]!==a[p]){if(c!==1||p!==1)do if(c--,p--,0>p||o[c]!==a[p]){var m=`
`+o[c].replace(" at new "," at ");return e.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",e.displayName)),m}while(1<=c&&0<=p);break}}}finally{Ip=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Fl(e):""}function iw(e){switch(e.tag){case 5:return Fl(e.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return e=Ep(e.type,!1),e;case 11:return e=Ep(e.type.render,!1),e;case 1:return e=Ep(e.type,!0),e;default:return""}}function bf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case za:return"Fragment";case ka:return"Portal";case mf:return"Profiler";case v0:return"StrictMode";case gf:return"Suspense";case xf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ax:return(e.displayName||"Context")+".Consumer";case Px:return(e._context.displayName||"Context")+".Provider";case w0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case k0:return t=e.displayName||null,t!==null?t:bf(e.type)||"Memo";case Zi:t=e._payload,e=e._init;try{return bf(e(t))}catch{}}return null}function ow(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bf(t);case 8:return t===v0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function po(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Dx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function aw(e){var t=Dx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(c){i=""+c,a.call(this,c)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(c){i=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function mu(e){e._valueTracker||(e._valueTracker=aw(e))}function Ox(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=Dx(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function td(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yf(e,t){var r=t.checked;return Jn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Im(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=po(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Lx(e,t){t=t.checked,t!=null&&y0(e,"checked",t,!1)}function vf(e,t){Lx(e,t);var r=po(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wf(e,t.type,r):t.hasOwnProperty("defaultValue")&&wf(e,t.type,po(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Em(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function wf(e,t,r){(t!=="number"||td(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bl=Array.isArray;function Pa(e,t,r,i){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&i&&(e[r].defaultSelected=!0)}else{for(r=""+po(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function kf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Xe(91));return Jn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $m(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Xe(92));if(Bl(r)){if(1<r.length)throw Error(Xe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:po(r)}}function Ux(e,t){var r=po(t.value),i=po(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function Mm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Fx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Fx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gu,Bx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,i,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gu=gu||document.createElement("div"),gu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ac(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lw=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(e){lw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gl[t]=Gl[e]})});function Wx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gl.hasOwnProperty(e)&&Gl[e]?(""+t).trim():t+"px"}function Hx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,o=Wx(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,o):e[r]=o}}var cw=Jn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jf(e,t){if(t){if(cw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Xe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Xe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Xe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Xe(62))}}function Nf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _f=null;function z0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Sf=null,Aa=null,Ra=null;function Tm(e){if(e=_c(e)){if(typeof Sf!="function")throw Error(Xe(280));var t=e.stateNode;t&&(t=Ad(t),Sf(e.stateNode,e.type,t))}}function Vx(e){Aa?Ra?Ra.push(e):Ra=[e]:Aa=e}function Kx(){if(Aa){var e=Aa,t=Ra;if(Ra=Aa=null,Tm(e),t)for(e=0;e<t.length;e++)Tm(t[e])}}function Yx(e,t){return e(t)}function Gx(){}var $p=!1;function Xx(e,t,r){if($p)return e(t,r);$p=!0;try{return Yx(e,t,r)}finally{$p=!1,(Aa!==null||Ra!==null)&&(Gx(),Kx())}}function lc(e,t){var r=e.stateNode;if(r===null)return null;var i=Ad(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Xe(231,t,typeof r));return r}var Cf=!1;if(Ni)try{var jl={};Object.defineProperty(jl,"passive",{get:function(){Cf=!0}}),window.addEventListener("test",jl,jl),window.removeEventListener("test",jl,jl)}catch{Cf=!1}function uw(e,t,r,i,o,a,c,p,m){var w=Array.prototype.slice.call(arguments,3);try{t.apply(r,w)}catch($){this.onError($)}}var Xl=!1,nd=null,rd=!1,If=null,dw={onError:function(e){Xl=!0,nd=e}};function pw(e,t,r,i,o,a,c,p,m){Xl=!1,nd=null,uw.apply(dw,arguments)}function fw(e,t,r,i,o,a,c,p,m){if(pw.apply(this,arguments),Xl){if(Xl){var w=nd;Xl=!1,nd=null}else throw Error(Xe(198));rd||(rd=!0,If=w)}}function Ko(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Jx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Pm(e){if(Ko(e)!==e)throw Error(Xe(188))}function hw(e){var t=e.alternate;if(!t){if(t=Ko(e),t===null)throw Error(Xe(188));return t!==e?null:e}for(var r=e,i=t;;){var o=r.return;if(o===null)break;var a=o.alternate;if(a===null){if(i=o.return,i!==null){r=i;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===r)return Pm(o),e;if(a===i)return Pm(o),t;a=a.sibling}throw Error(Xe(188))}if(r.return!==i.return)r=o,i=a;else{for(var c=!1,p=o.child;p;){if(p===r){c=!0,r=o,i=a;break}if(p===i){c=!0,i=o,r=a;break}p=p.sibling}if(!c){for(p=a.child;p;){if(p===r){c=!0,r=a,i=o;break}if(p===i){c=!0,i=a,r=o;break}p=p.sibling}if(!c)throw Error(Xe(189))}}if(r.alternate!==i)throw Error(Xe(190))}if(r.tag!==3)throw Error(Xe(188));return r.stateNode.current===r?e:t}function Zx(e){return e=hw(e),e!==null?qx(e):null}function qx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=qx(e);if(t!==null)return t;e=e.sibling}return null}var Qx=hs.unstable_scheduleCallback,Am=hs.unstable_cancelCallback,mw=hs.unstable_shouldYield,gw=hs.unstable_requestPaint,nr=hs.unstable_now,xw=hs.unstable_getCurrentPriorityLevel,j0=hs.unstable_ImmediatePriority,eb=hs.unstable_UserBlockingPriority,sd=hs.unstable_NormalPriority,bw=hs.unstable_LowPriority,tb=hs.unstable_IdlePriority,$d=null,ai=null;function yw(e){if(ai&&typeof ai.onCommitFiberRoot=="function")try{ai.onCommitFiberRoot($d,e,void 0,(e.current.flags&128)===128)}catch{}}var Vs=Math.clz32?Math.clz32:kw,vw=Math.log,ww=Math.LN2;function kw(e){return e>>>=0,e===0?32:31-(vw(e)/ww|0)|0}var xu=64,bu=4194304;function Wl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function id(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,o=e.suspendedLanes,a=e.pingedLanes,c=r&268435455;if(c!==0){var p=c&~o;p!==0?i=Wl(p):(a&=c,a!==0&&(i=Wl(a)))}else c=r&~o,c!==0?i=Wl(c):a!==0&&(i=Wl(a));if(i===0)return 0;if(t!==0&&t!==i&&!(t&o)&&(o=i&-i,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(i&4&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-Vs(t),o=1<<r,i|=e[r],t&=~o;return i}function zw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jw(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var c=31-Vs(a),p=1<<c,m=o[c];m===-1?(!(p&r)||p&i)&&(o[c]=zw(p,t)):m<=t&&(e.expiredLanes|=p),a&=~p}}function Ef(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function nb(){var e=xu;return xu<<=1,!(xu&4194240)&&(xu=64),e}function Mp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function jc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Vs(t),e[t]=r}function Nw(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-Vs(r),a=1<<o;t[o]=0,i[o]=-1,e[o]=-1,r&=~a}}function N0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-Vs(r),o=1<<i;o&t|e[i]&t&&(e[i]|=t),r&=~o}}var zn=0;function rb(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sb,_0,ib,ob,ab,$f=!1,yu=[],ro=null,so=null,io=null,cc=new Map,uc=new Map,Qi=[],_w="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rm(e,t){switch(e){case"focusin":case"focusout":ro=null;break;case"dragenter":case"dragleave":so=null;break;case"mouseover":case"mouseout":io=null;break;case"pointerover":case"pointerout":cc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":uc.delete(t.pointerId)}}function Nl(e,t,r,i,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:a,targetContainers:[o]},t!==null&&(t=_c(t),t!==null&&_0(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Sw(e,t,r,i,o){switch(t){case"focusin":return ro=Nl(ro,e,t,r,i,o),!0;case"dragenter":return so=Nl(so,e,t,r,i,o),!0;case"mouseover":return io=Nl(io,e,t,r,i,o),!0;case"pointerover":var a=o.pointerId;return cc.set(a,Nl(cc.get(a)||null,e,t,r,i,o)),!0;case"gotpointercapture":return a=o.pointerId,uc.set(a,Nl(uc.get(a)||null,e,t,r,i,o)),!0}return!1}function lb(e){var t=To(e.target);if(t!==null){var r=Ko(t);if(r!==null){if(t=r.tag,t===13){if(t=Jx(r),t!==null){e.blockedOn=t,ab(e.priority,function(){ib(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Mf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);_f=i,r.target.dispatchEvent(i),_f=null}else return t=_c(r),t!==null&&_0(t),e.blockedOn=r,!1;t.shift()}return!0}function Dm(e,t,r){Hu(e)&&r.delete(t)}function Cw(){$f=!1,ro!==null&&Hu(ro)&&(ro=null),so!==null&&Hu(so)&&(so=null),io!==null&&Hu(io)&&(io=null),cc.forEach(Dm),uc.forEach(Dm)}function _l(e,t){e.blockedOn===t&&(e.blockedOn=null,$f||($f=!0,hs.unstable_scheduleCallback(hs.unstable_NormalPriority,Cw)))}function dc(e){function t(o){return _l(o,e)}if(0<yu.length){_l(yu[0],e);for(var r=1;r<yu.length;r++){var i=yu[r];i.blockedOn===e&&(i.blockedOn=null)}}for(ro!==null&&_l(ro,e),so!==null&&_l(so,e),io!==null&&_l(io,e),cc.forEach(t),uc.forEach(t),r=0;r<Qi.length;r++)i=Qi[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<Qi.length&&(r=Qi[0],r.blockedOn===null);)lb(r),r.blockedOn===null&&Qi.shift()}var Da=Ii.ReactCurrentBatchConfig,od=!0;function Iw(e,t,r,i){var o=zn,a=Da.transition;Da.transition=null;try{zn=1,S0(e,t,r,i)}finally{zn=o,Da.transition=a}}function Ew(e,t,r,i){var o=zn,a=Da.transition;Da.transition=null;try{zn=4,S0(e,t,r,i)}finally{zn=o,Da.transition=a}}function S0(e,t,r,i){if(od){var o=Mf(e,t,r,i);if(o===null)Bp(e,t,i,ad,r),Rm(e,i);else if(Sw(o,e,t,r,i))i.stopPropagation();else if(Rm(e,i),t&4&&-1<_w.indexOf(e)){for(;o!==null;){var a=_c(o);if(a!==null&&sb(a),a=Mf(e,t,r,i),a===null&&Bp(e,t,i,ad,r),a===o)break;o=a}o!==null&&i.stopPropagation()}else Bp(e,t,i,null,r)}}var ad=null;function Mf(e,t,r,i){if(ad=null,e=z0(i),e=To(e),e!==null)if(t=Ko(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Jx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ad=e,null}function cb(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xw()){case j0:return 1;case eb:return 4;case sd:case bw:return 16;case tb:return 536870912;default:return 16}default:return 16}}var to=null,C0=null,Vu=null;function ub(){if(Vu)return Vu;var e,t=C0,r=t.length,i,o="value"in to?to.value:to.textContent,a=o.length;for(e=0;e<r&&t[e]===o[e];e++);var c=r-e;for(i=1;i<=c&&t[r-i]===o[a-i];i++);return Vu=o.slice(e,1<i?1-i:void 0)}function Ku(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vu(){return!0}function Om(){return!1}function gs(e){function t(r,i,o,a,c){this._reactName=r,this._targetInst=o,this.type=i,this.nativeEvent=a,this.target=c,this.currentTarget=null;for(var p in e)e.hasOwnProperty(p)&&(r=e[p],this[p]=r?r(a):a[p]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?vu:Om,this.isPropagationStopped=Om,this}return Jn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vu)},persist:function(){},isPersistent:vu}),t}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},I0=gs(Ga),Nc=Jn({},Ga,{view:0,detail:0}),$w=gs(Nc),Tp,Pp,Sl,Md=Jn({},Nc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:E0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sl&&(Sl&&e.type==="mousemove"?(Tp=e.screenX-Sl.screenX,Pp=e.screenY-Sl.screenY):Pp=Tp=0,Sl=e),Tp)},movementY:function(e){return"movementY"in e?e.movementY:Pp}}),Lm=gs(Md),Mw=Jn({},Md,{dataTransfer:0}),Tw=gs(Mw),Pw=Jn({},Nc,{relatedTarget:0}),Ap=gs(Pw),Aw=Jn({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),Rw=gs(Aw),Dw=Jn({},Ga,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ow=gs(Dw),Lw=Jn({},Ga,{data:0}),Um=gs(Lw),Uw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ww(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Bw[e])?!!t[e]:!1}function E0(){return Ww}var Hw=Jn({},Nc,{key:function(e){if(e.key){var t=Uw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ku(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:E0,charCode:function(e){return e.type==="keypress"?Ku(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ku(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vw=gs(Hw),Kw=Jn({},Md,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fm=gs(Kw),Yw=Jn({},Nc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:E0}),Gw=gs(Yw),Xw=Jn({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jw=gs(Xw),Zw=Jn({},Md,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qw=gs(Zw),Qw=[9,13,27,32],$0=Ni&&"CompositionEvent"in window,Jl=null;Ni&&"documentMode"in document&&(Jl=document.documentMode);var e2=Ni&&"TextEvent"in window&&!Jl,db=Ni&&(!$0||Jl&&8<Jl&&11>=Jl),Bm=" ",Wm=!1;function pb(e,t){switch(e){case"keyup":return Qw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ja=!1;function t2(e,t){switch(e){case"compositionend":return fb(t);case"keypress":return t.which!==32?null:(Wm=!0,Bm);case"textInput":return e=t.data,e===Bm&&Wm?null:e;default:return null}}function n2(e,t){if(ja)return e==="compositionend"||!$0&&pb(e,t)?(e=ub(),Vu=C0=to=null,ja=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return db&&t.locale!=="ko"?null:t.data;default:return null}}var r2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!r2[e.type]:t==="textarea"}function hb(e,t,r,i){Vx(i),t=ld(t,"onChange"),0<t.length&&(r=new I0("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Zl=null,pc=null;function s2(e){Nb(e,0)}function Td(e){var t=Sa(e);if(Ox(t))return e}function i2(e,t){if(e==="change")return t}var mb=!1;if(Ni){var Rp;if(Ni){var Dp="oninput"in document;if(!Dp){var Vm=document.createElement("div");Vm.setAttribute("oninput","return;"),Dp=typeof Vm.oninput=="function"}Rp=Dp}else Rp=!1;mb=Rp&&(!document.documentMode||9<document.documentMode)}function Km(){Zl&&(Zl.detachEvent("onpropertychange",gb),pc=Zl=null)}function gb(e){if(e.propertyName==="value"&&Td(pc)){var t=[];hb(t,pc,e,z0(e)),Xx(s2,t)}}function o2(e,t,r){e==="focusin"?(Km(),Zl=t,pc=r,Zl.attachEvent("onpropertychange",gb)):e==="focusout"&&Km()}function a2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Td(pc)}function l2(e,t){if(e==="click")return Td(t)}function c2(e,t){if(e==="input"||e==="change")return Td(t)}function u2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ys=typeof Object.is=="function"?Object.is:u2;function fc(e,t){if(Ys(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var o=r[i];if(!hf.call(t,o)||!Ys(e[o],t[o]))return!1}return!0}function Ym(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Gm(e,t){var r=Ym(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ym(r)}}function xb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function bb(){for(var e=window,t=td();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=td(e.document)}return t}function M0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function d2(e){var t=bb(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&xb(r.ownerDocument.documentElement,r)){if(i!==null&&M0(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,a=Math.min(i.start,o);i=i.end===void 0?a:Math.min(i.end,o),!e.extend&&a>i&&(o=i,i=a,a=o),o=Gm(r,a);var c=Gm(r,i);o&&c&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var p2=Ni&&"documentMode"in document&&11>=document.documentMode,Na=null,Tf=null,ql=null,Pf=!1;function Xm(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Pf||Na==null||Na!==td(i)||(i=Na,"selectionStart"in i&&M0(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),ql&&fc(ql,i)||(ql=i,i=ld(Tf,"onSelect"),0<i.length&&(t=new I0("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Na)))}function wu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _a={animationend:wu("Animation","AnimationEnd"),animationiteration:wu("Animation","AnimationIteration"),animationstart:wu("Animation","AnimationStart"),transitionend:wu("Transition","TransitionEnd")},Op={},yb={};Ni&&(yb=document.createElement("div").style,"AnimationEvent"in window||(delete _a.animationend.animation,delete _a.animationiteration.animation,delete _a.animationstart.animation),"TransitionEvent"in window||delete _a.transitionend.transition);function Pd(e){if(Op[e])return Op[e];if(!_a[e])return e;var t=_a[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in yb)return Op[e]=t[r];return e}var vb=Pd("animationend"),wb=Pd("animationiteration"),kb=Pd("animationstart"),zb=Pd("transitionend"),jb=new Map,Jm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ho(e,t){jb.set(e,t),Vo(t,[e])}for(var Lp=0;Lp<Jm.length;Lp++){var Up=Jm[Lp],f2=Up.toLowerCase(),h2=Up[0].toUpperCase()+Up.slice(1);ho(f2,"on"+h2)}ho(vb,"onAnimationEnd");ho(wb,"onAnimationIteration");ho(kb,"onAnimationStart");ho("dblclick","onDoubleClick");ho("focusin","onFocus");ho("focusout","onBlur");ho(zb,"onTransitionEnd");Ua("onMouseEnter",["mouseout","mouseover"]);Ua("onMouseLeave",["mouseout","mouseover"]);Ua("onPointerEnter",["pointerout","pointerover"]);Ua("onPointerLeave",["pointerout","pointerover"]);Vo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hl));function Zm(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,fw(i,t,void 0,e),e.currentTarget=null}function Nb(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],o=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var c=i.length-1;0<=c;c--){var p=i[c],m=p.instance,w=p.currentTarget;if(p=p.listener,m!==a&&o.isPropagationStopped())break e;Zm(o,p,w),a=m}else for(c=0;c<i.length;c++){if(p=i[c],m=p.instance,w=p.currentTarget,p=p.listener,m!==a&&o.isPropagationStopped())break e;Zm(o,p,w),a=m}}}if(rd)throw e=If,rd=!1,If=null,e}function Ln(e,t){var r=t[Lf];r===void 0&&(r=t[Lf]=new Set);var i=e+"__bubble";r.has(i)||(_b(t,e,2,!1),r.add(i))}function Fp(e,t,r){var i=0;t&&(i|=4),_b(r,e,i,t)}var ku="_reactListening"+Math.random().toString(36).slice(2);function hc(e){if(!e[ku]){e[ku]=!0,Tx.forEach(function(r){r!=="selectionchange"&&(m2.has(r)||Fp(r,!1,e),Fp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ku]||(t[ku]=!0,Fp("selectionchange",!1,t))}}function _b(e,t,r,i){switch(cb(t)){case 1:var o=Iw;break;case 4:o=Ew;break;default:o=S0}r=o.bind(null,t,r,e),o=void 0,!Cf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Bp(e,t,r,i,o){var a=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var c=i.tag;if(c===3||c===4){var p=i.stateNode.containerInfo;if(p===o||p.nodeType===8&&p.parentNode===o)break;if(c===4)for(c=i.return;c!==null;){var m=c.tag;if((m===3||m===4)&&(m=c.stateNode.containerInfo,m===o||m.nodeType===8&&m.parentNode===o))return;c=c.return}for(;p!==null;){if(c=To(p),c===null)return;if(m=c.tag,m===5||m===6){i=a=c;continue e}p=p.parentNode}}i=i.return}Xx(function(){var w=a,$=z0(r),T=[];e:{var E=jb.get(e);if(E!==void 0){var y=I0,A=e;switch(e){case"keypress":if(Ku(r)===0)break e;case"keydown":case"keyup":y=Vw;break;case"focusin":A="focus",y=Ap;break;case"focusout":A="blur",y=Ap;break;case"beforeblur":case"afterblur":y=Ap;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Lm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Tw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=Gw;break;case vb:case wb:case kb:y=Rw;break;case zb:y=Jw;break;case"scroll":y=$w;break;case"wheel":y=qw;break;case"copy":case"cut":case"paste":y=Ow;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Fm}var N=(t&4)!==0,D=!N&&e==="scroll",b=N?E!==null?E+"Capture":null:E;N=[];for(var z=w,P;z!==null;){P=z;var W=P.stateNode;if(P.tag===5&&W!==null&&(P=W,b!==null&&(W=lc(z,b),W!=null&&N.push(mc(z,W,P)))),D)break;z=z.return}0<N.length&&(E=new y(E,A,null,r,$),T.push({event:E,listeners:N}))}}if(!(t&7)){e:{if(E=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",E&&r!==_f&&(A=r.relatedTarget||r.fromElement)&&(To(A)||A[_i]))break e;if((y||E)&&(E=$.window===$?$:(E=$.ownerDocument)?E.defaultView||E.parentWindow:window,y?(A=r.relatedTarget||r.toElement,y=w,A=A?To(A):null,A!==null&&(D=Ko(A),A!==D||A.tag!==5&&A.tag!==6)&&(A=null)):(y=null,A=w),y!==A)){if(N=Lm,W="onMouseLeave",b="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(N=Fm,W="onPointerLeave",b="onPointerEnter",z="pointer"),D=y==null?E:Sa(y),P=A==null?E:Sa(A),E=new N(W,z+"leave",y,r,$),E.target=D,E.relatedTarget=P,W=null,To($)===w&&(N=new N(b,z+"enter",A,r,$),N.target=P,N.relatedTarget=D,W=N),D=W,y&&A)t:{for(N=y,b=A,z=0,P=N;P;P=xa(P))z++;for(P=0,W=b;W;W=xa(W))P++;for(;0<z-P;)N=xa(N),z--;for(;0<P-z;)b=xa(b),P--;for(;z--;){if(N===b||b!==null&&N===b.alternate)break t;N=xa(N),b=xa(b)}N=null}else N=null;y!==null&&qm(T,E,y,N,!1),A!==null&&D!==null&&qm(T,D,A,N,!0)}}e:{if(E=w?Sa(w):window,y=E.nodeName&&E.nodeName.toLowerCase(),y==="select"||y==="input"&&E.type==="file")var G=i2;else if(Hm(E))if(mb)G=c2;else{G=a2;var oe=o2}else(y=E.nodeName)&&y.toLowerCase()==="input"&&(E.type==="checkbox"||E.type==="radio")&&(G=l2);if(G&&(G=G(e,w))){hb(T,G,r,$);break e}oe&&oe(e,E,w),e==="focusout"&&(oe=E._wrapperState)&&oe.controlled&&E.type==="number"&&wf(E,"number",E.value)}switch(oe=w?Sa(w):window,e){case"focusin":(Hm(oe)||oe.contentEditable==="true")&&(Na=oe,Tf=w,ql=null);break;case"focusout":ql=Tf=Na=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,Xm(T,r,$);break;case"selectionchange":if(p2)break;case"keydown":case"keyup":Xm(T,r,$)}var se;if($0)e:{switch(e){case"compositionstart":var ye="onCompositionStart";break e;case"compositionend":ye="onCompositionEnd";break e;case"compositionupdate":ye="onCompositionUpdate";break e}ye=void 0}else ja?pb(e,r)&&(ye="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(ye="onCompositionStart");ye&&(db&&r.locale!=="ko"&&(ja||ye!=="onCompositionStart"?ye==="onCompositionEnd"&&ja&&(se=ub()):(to=$,C0="value"in to?to.value:to.textContent,ja=!0)),oe=ld(w,ye),0<oe.length&&(ye=new Um(ye,e,null,r,$),T.push({event:ye,listeners:oe}),se?ye.data=se:(se=fb(r),se!==null&&(ye.data=se)))),(se=e2?t2(e,r):n2(e,r))&&(w=ld(w,"onBeforeInput"),0<w.length&&($=new Um("onBeforeInput","beforeinput",null,r,$),T.push({event:$,listeners:w}),$.data=se))}Nb(T,t)})}function mc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ld(e,t){for(var r=t+"Capture",i=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=lc(e,r),a!=null&&i.unshift(mc(e,a,o)),a=lc(e,t),a!=null&&i.push(mc(e,a,o))),e=e.return}return i}function xa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function qm(e,t,r,i,o){for(var a=t._reactName,c=[];r!==null&&r!==i;){var p=r,m=p.alternate,w=p.stateNode;if(m!==null&&m===i)break;p.tag===5&&w!==null&&(p=w,o?(m=lc(r,a),m!=null&&c.unshift(mc(r,m,p))):o||(m=lc(r,a),m!=null&&c.push(mc(r,m,p)))),r=r.return}c.length!==0&&e.push({event:t,listeners:c})}var g2=/\r\n?/g,x2=/\u0000|\uFFFD/g;function Qm(e){return(typeof e=="string"?e:""+e).replace(g2,`
`).replace(x2,"")}function zu(e,t,r){if(t=Qm(t),Qm(e)!==t&&r)throw Error(Xe(425))}function cd(){}var Af=null,Rf=null;function Df(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Of=typeof setTimeout=="function"?setTimeout:void 0,b2=typeof clearTimeout=="function"?clearTimeout:void 0,eg=typeof Promise=="function"?Promise:void 0,y2=typeof queueMicrotask=="function"?queueMicrotask:typeof eg<"u"?function(e){return eg.resolve(null).then(e).catch(v2)}:Of;function v2(e){setTimeout(function(){throw e})}function Wp(e,t){var r=t,i=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(i===0){e.removeChild(o),dc(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=o}while(r);dc(t)}function oo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function tg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Xa=Math.random().toString(36).slice(2),si="__reactFiber$"+Xa,gc="__reactProps$"+Xa,_i="__reactContainer$"+Xa,Lf="__reactEvents$"+Xa,w2="__reactListeners$"+Xa,k2="__reactHandles$"+Xa;function To(e){var t=e[si];if(t)return t;for(var r=e.parentNode;r;){if(t=r[_i]||r[si]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=tg(e);e!==null;){if(r=e[si])return r;e=tg(e)}return t}e=r,r=e.parentNode}return null}function _c(e){return e=e[si]||e[_i],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Sa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Xe(33))}function Ad(e){return e[gc]||null}var Uf=[],Ca=-1;function mo(e){return{current:e}}function Un(e){0>Ca||(e.current=Uf[Ca],Uf[Ca]=null,Ca--)}function Pn(e,t){Ca++,Uf[Ca]=e.current,e.current=t}var fo={},Tr=mo(fo),Qr=mo(!1),Oo=fo;function Fa(e,t){var r=e.type.contextTypes;if(!r)return fo;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in r)o[a]=t[a];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function es(e){return e=e.childContextTypes,e!=null}function ud(){Un(Qr),Un(Tr)}function ng(e,t,r){if(Tr.current!==fo)throw Error(Xe(168));Pn(Tr,t),Pn(Qr,r)}function Sb(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var o in i)if(!(o in t))throw Error(Xe(108,ow(e)||"Unknown",o));return Jn({},r,i)}function dd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fo,Oo=Tr.current,Pn(Tr,e),Pn(Qr,Qr.current),!0}function rg(e,t,r){var i=e.stateNode;if(!i)throw Error(Xe(169));r?(e=Sb(e,t,Oo),i.__reactInternalMemoizedMergedChildContext=e,Un(Qr),Un(Tr),Pn(Tr,e)):Un(Qr),Pn(Qr,r)}var yi=null,Rd=!1,Hp=!1;function Cb(e){yi===null?yi=[e]:yi.push(e)}function z2(e){Rd=!0,Cb(e)}function go(){if(!Hp&&yi!==null){Hp=!0;var e=0,t=zn;try{var r=yi;for(zn=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}yi=null,Rd=!1}catch(o){throw yi!==null&&(yi=yi.slice(e+1)),Qx(j0,go),o}finally{zn=t,Hp=!1}}return null}var Ia=[],Ea=0,pd=null,fd=0,js=[],Ns=0,Lo=null,ki=1,zi="";function $o(e,t){Ia[Ea++]=fd,Ia[Ea++]=pd,pd=e,fd=t}function Ib(e,t,r){js[Ns++]=ki,js[Ns++]=zi,js[Ns++]=Lo,Lo=e;var i=ki;e=zi;var o=32-Vs(i)-1;i&=~(1<<o),r+=1;var a=32-Vs(t)+o;if(30<a){var c=o-o%5;a=(i&(1<<c)-1).toString(32),i>>=c,o-=c,ki=1<<32-Vs(t)+o|r<<o|i,zi=a+e}else ki=1<<a|r<<o|i,zi=e}function T0(e){e.return!==null&&($o(e,1),Ib(e,1,0))}function P0(e){for(;e===pd;)pd=Ia[--Ea],Ia[Ea]=null,fd=Ia[--Ea],Ia[Ea]=null;for(;e===Lo;)Lo=js[--Ns],js[Ns]=null,zi=js[--Ns],js[Ns]=null,ki=js[--Ns],js[Ns]=null}var fs=null,ps=null,Vn=!1,Hs=null;function Eb(e,t){var r=_s(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function sg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,fs=e,ps=oo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,fs=e,ps=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Lo!==null?{id:ki,overflow:zi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=_s(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,fs=e,ps=null,!0):!1;default:return!1}}function Ff(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bf(e){if(Vn){var t=ps;if(t){var r=t;if(!sg(e,t)){if(Ff(e))throw Error(Xe(418));t=oo(r.nextSibling);var i=fs;t&&sg(e,t)?Eb(i,r):(e.flags=e.flags&-4097|2,Vn=!1,fs=e)}}else{if(Ff(e))throw Error(Xe(418));e.flags=e.flags&-4097|2,Vn=!1,fs=e}}}function ig(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;fs=e}function ju(e){if(e!==fs)return!1;if(!Vn)return ig(e),Vn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Df(e.type,e.memoizedProps)),t&&(t=ps)){if(Ff(e))throw $b(),Error(Xe(418));for(;t;)Eb(e,t),t=oo(t.nextSibling)}if(ig(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Xe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ps=oo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ps=null}}else ps=fs?oo(e.stateNode.nextSibling):null;return!0}function $b(){for(var e=ps;e;)e=oo(e.nextSibling)}function Ba(){ps=fs=null,Vn=!1}function A0(e){Hs===null?Hs=[e]:Hs.push(e)}var j2=Ii.ReactCurrentBatchConfig;function Cl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Xe(309));var i=r.stateNode}if(!i)throw Error(Xe(147,e));var o=i,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(c){var p=o.refs;c===null?delete p[a]:p[a]=c},t._stringRef=a,t)}if(typeof e!="string")throw Error(Xe(284));if(!r._owner)throw Error(Xe(290,e))}return e}function Nu(e,t){throw e=Object.prototype.toString.call(t),Error(Xe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function og(e){var t=e._init;return t(e._payload)}function Mb(e){function t(b,z){if(e){var P=b.deletions;P===null?(b.deletions=[z],b.flags|=16):P.push(z)}}function r(b,z){if(!e)return null;for(;z!==null;)t(b,z),z=z.sibling;return null}function i(b,z){for(b=new Map;z!==null;)z.key!==null?b.set(z.key,z):b.set(z.index,z),z=z.sibling;return b}function o(b,z){return b=uo(b,z),b.index=0,b.sibling=null,b}function a(b,z,P){return b.index=P,e?(P=b.alternate,P!==null?(P=P.index,P<z?(b.flags|=2,z):P):(b.flags|=2,z)):(b.flags|=1048576,z)}function c(b){return e&&b.alternate===null&&(b.flags|=2),b}function p(b,z,P,W){return z===null||z.tag!==6?(z=Zp(P,b.mode,W),z.return=b,z):(z=o(z,P),z.return=b,z)}function m(b,z,P,W){var G=P.type;return G===za?$(b,z,P.props.children,W,P.key):z!==null&&(z.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Zi&&og(G)===z.type)?(W=o(z,P.props),W.ref=Cl(b,z,P),W.return=b,W):(W=Qu(P.type,P.key,P.props,null,b.mode,W),W.ref=Cl(b,z,P),W.return=b,W)}function w(b,z,P,W){return z===null||z.tag!==4||z.stateNode.containerInfo!==P.containerInfo||z.stateNode.implementation!==P.implementation?(z=qp(P,b.mode,W),z.return=b,z):(z=o(z,P.children||[]),z.return=b,z)}function $(b,z,P,W,G){return z===null||z.tag!==7?(z=Do(P,b.mode,W,G),z.return=b,z):(z=o(z,P),z.return=b,z)}function T(b,z,P){if(typeof z=="string"&&z!==""||typeof z=="number")return z=Zp(""+z,b.mode,P),z.return=b,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case hu:return P=Qu(z.type,z.key,z.props,null,b.mode,P),P.ref=Cl(b,null,z),P.return=b,P;case ka:return z=qp(z,b.mode,P),z.return=b,z;case Zi:var W=z._init;return T(b,W(z._payload),P)}if(Bl(z)||zl(z))return z=Do(z,b.mode,P,null),z.return=b,z;Nu(b,z)}return null}function E(b,z,P,W){var G=z!==null?z.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return G!==null?null:p(b,z,""+P,W);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case hu:return P.key===G?m(b,z,P,W):null;case ka:return P.key===G?w(b,z,P,W):null;case Zi:return G=P._init,E(b,z,G(P._payload),W)}if(Bl(P)||zl(P))return G!==null?null:$(b,z,P,W,null);Nu(b,P)}return null}function y(b,z,P,W,G){if(typeof W=="string"&&W!==""||typeof W=="number")return b=b.get(P)||null,p(z,b,""+W,G);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case hu:return b=b.get(W.key===null?P:W.key)||null,m(z,b,W,G);case ka:return b=b.get(W.key===null?P:W.key)||null,w(z,b,W,G);case Zi:var oe=W._init;return y(b,z,P,oe(W._payload),G)}if(Bl(W)||zl(W))return b=b.get(P)||null,$(z,b,W,G,null);Nu(z,W)}return null}function A(b,z,P,W){for(var G=null,oe=null,se=z,ye=z=0,we=null;se!==null&&ye<P.length;ye++){se.index>ye?(we=se,se=null):we=se.sibling;var Se=E(b,se,P[ye],W);if(Se===null){se===null&&(se=we);break}e&&se&&Se.alternate===null&&t(b,se),z=a(Se,z,ye),oe===null?G=Se:oe.sibling=Se,oe=Se,se=we}if(ye===P.length)return r(b,se),Vn&&$o(b,ye),G;if(se===null){for(;ye<P.length;ye++)se=T(b,P[ye],W),se!==null&&(z=a(se,z,ye),oe===null?G=se:oe.sibling=se,oe=se);return Vn&&$o(b,ye),G}for(se=i(b,se);ye<P.length;ye++)we=y(se,b,ye,P[ye],W),we!==null&&(e&&we.alternate!==null&&se.delete(we.key===null?ye:we.key),z=a(we,z,ye),oe===null?G=we:oe.sibling=we,oe=we);return e&&se.forEach(function(Ke){return t(b,Ke)}),Vn&&$o(b,ye),G}function N(b,z,P,W){var G=zl(P);if(typeof G!="function")throw Error(Xe(150));if(P=G.call(P),P==null)throw Error(Xe(151));for(var oe=G=null,se=z,ye=z=0,we=null,Se=P.next();se!==null&&!Se.done;ye++,Se=P.next()){se.index>ye?(we=se,se=null):we=se.sibling;var Ke=E(b,se,Se.value,W);if(Ke===null){se===null&&(se=we);break}e&&se&&Ke.alternate===null&&t(b,se),z=a(Ke,z,ye),oe===null?G=Ke:oe.sibling=Ke,oe=Ke,se=we}if(Se.done)return r(b,se),Vn&&$o(b,ye),G;if(se===null){for(;!Se.done;ye++,Se=P.next())Se=T(b,Se.value,W),Se!==null&&(z=a(Se,z,ye),oe===null?G=Se:oe.sibling=Se,oe=Se);return Vn&&$o(b,ye),G}for(se=i(b,se);!Se.done;ye++,Se=P.next())Se=y(se,b,ye,Se.value,W),Se!==null&&(e&&Se.alternate!==null&&se.delete(Se.key===null?ye:Se.key),z=a(Se,z,ye),oe===null?G=Se:oe.sibling=Se,oe=Se);return e&&se.forEach(function(X){return t(b,X)}),Vn&&$o(b,ye),G}function D(b,z,P,W){if(typeof P=="object"&&P!==null&&P.type===za&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case hu:e:{for(var G=P.key,oe=z;oe!==null;){if(oe.key===G){if(G=P.type,G===za){if(oe.tag===7){r(b,oe.sibling),z=o(oe,P.props.children),z.return=b,b=z;break e}}else if(oe.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Zi&&og(G)===oe.type){r(b,oe.sibling),z=o(oe,P.props),z.ref=Cl(b,oe,P),z.return=b,b=z;break e}r(b,oe);break}else t(b,oe);oe=oe.sibling}P.type===za?(z=Do(P.props.children,b.mode,W,P.key),z.return=b,b=z):(W=Qu(P.type,P.key,P.props,null,b.mode,W),W.ref=Cl(b,z,P),W.return=b,b=W)}return c(b);case ka:e:{for(oe=P.key;z!==null;){if(z.key===oe)if(z.tag===4&&z.stateNode.containerInfo===P.containerInfo&&z.stateNode.implementation===P.implementation){r(b,z.sibling),z=o(z,P.children||[]),z.return=b,b=z;break e}else{r(b,z);break}else t(b,z);z=z.sibling}z=qp(P,b.mode,W),z.return=b,b=z}return c(b);case Zi:return oe=P._init,D(b,z,oe(P._payload),W)}if(Bl(P))return A(b,z,P,W);if(zl(P))return N(b,z,P,W);Nu(b,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,z!==null&&z.tag===6?(r(b,z.sibling),z=o(z,P),z.return=b,b=z):(r(b,z),z=Zp(P,b.mode,W),z.return=b,b=z),c(b)):r(b,z)}return D}var Wa=Mb(!0),Tb=Mb(!1),hd=mo(null),md=null,$a=null,R0=null;function D0(){R0=$a=md=null}function O0(e){var t=hd.current;Un(hd),e._currentValue=t}function Wf(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Oa(e,t){md=e,R0=$a=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(qr=!0),e.firstContext=null)}function Cs(e){var t=e._currentValue;if(R0!==e)if(e={context:e,memoizedValue:t,next:null},$a===null){if(md===null)throw Error(Xe(308));$a=e,md.dependencies={lanes:0,firstContext:e}}else $a=$a.next=e;return t}var Po=null;function L0(e){Po===null?Po=[e]:Po.push(e)}function Pb(e,t,r,i){var o=t.interleaved;return o===null?(r.next=r,L0(t)):(r.next=o.next,o.next=r),t.interleaved=r,Si(e,i)}function Si(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var qi=!1;function U0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ab(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ji(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ao(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,hn&2){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,Si(e,r)}return o=i.interleaved,o===null?(t.next=t,L0(i)):(t.next=o.next,o.next=t),i.interleaved=t,Si(e,r)}function Yu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,N0(e,r)}}function ag(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var o=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var c={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?o=a=c:a=a.next=c,r=r.next}while(r!==null);a===null?o=a=t:a=a.next=t}else o=a=t;r={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function gd(e,t,r,i){var o=e.updateQueue;qi=!1;var a=o.firstBaseUpdate,c=o.lastBaseUpdate,p=o.shared.pending;if(p!==null){o.shared.pending=null;var m=p,w=m.next;m.next=null,c===null?a=w:c.next=w,c=m;var $=e.alternate;$!==null&&($=$.updateQueue,p=$.lastBaseUpdate,p!==c&&(p===null?$.firstBaseUpdate=w:p.next=w,$.lastBaseUpdate=m))}if(a!==null){var T=o.baseState;c=0,$=w=m=null,p=a;do{var E=p.lane,y=p.eventTime;if((i&E)===E){$!==null&&($=$.next={eventTime:y,lane:0,tag:p.tag,payload:p.payload,callback:p.callback,next:null});e:{var A=e,N=p;switch(E=t,y=r,N.tag){case 1:if(A=N.payload,typeof A=="function"){T=A.call(y,T,E);break e}T=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=N.payload,E=typeof A=="function"?A.call(y,T,E):A,E==null)break e;T=Jn({},T,E);break e;case 2:qi=!0}}p.callback!==null&&p.lane!==0&&(e.flags|=64,E=o.effects,E===null?o.effects=[p]:E.push(p))}else y={eventTime:y,lane:E,tag:p.tag,payload:p.payload,callback:p.callback,next:null},$===null?(w=$=y,m=T):$=$.next=y,c|=E;if(p=p.next,p===null){if(p=o.shared.pending,p===null)break;E=p,p=E.next,E.next=null,o.lastBaseUpdate=E,o.shared.pending=null}}while(!0);if($===null&&(m=T),o.baseState=m,o.firstBaseUpdate=w,o.lastBaseUpdate=$,t=o.shared.interleaved,t!==null){o=t;do c|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Fo|=c,e.lanes=c,e.memoizedState=T}}function lg(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(o!==null){if(i.callback=null,i=r,typeof o!="function")throw Error(Xe(191,o));o.call(i)}}}var Sc={},li=mo(Sc),xc=mo(Sc),bc=mo(Sc);function Ao(e){if(e===Sc)throw Error(Xe(174));return e}function F0(e,t){switch(Pn(bc,t),Pn(xc,e),Pn(li,Sc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:zf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=zf(t,e)}Un(li),Pn(li,t)}function Ha(){Un(li),Un(xc),Un(bc)}function Rb(e){Ao(bc.current);var t=Ao(li.current),r=zf(t,e.type);t!==r&&(Pn(xc,e),Pn(li,r))}function B0(e){xc.current===e&&(Un(li),Un(xc))}var Gn=mo(0);function xd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vp=[];function W0(){for(var e=0;e<Vp.length;e++)Vp[e]._workInProgressVersionPrimary=null;Vp.length=0}var Gu=Ii.ReactCurrentDispatcher,Kp=Ii.ReactCurrentBatchConfig,Uo=0,Xn=null,cr=null,br=null,bd=!1,Ql=!1,yc=0,N2=0;function Er(){throw Error(Xe(321))}function H0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ys(e[r],t[r]))return!1;return!0}function V0(e,t,r,i,o,a){if(Uo=a,Xn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Gu.current=e===null||e.memoizedState===null?I2:E2,e=r(i,o),Ql){a=0;do{if(Ql=!1,yc=0,25<=a)throw Error(Xe(301));a+=1,br=cr=null,t.updateQueue=null,Gu.current=$2,e=r(i,o)}while(Ql)}if(Gu.current=yd,t=cr!==null&&cr.next!==null,Uo=0,br=cr=Xn=null,bd=!1,t)throw Error(Xe(300));return e}function K0(){var e=yc!==0;return yc=0,e}function ri(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?Xn.memoizedState=br=e:br=br.next=e,br}function Is(){if(cr===null){var e=Xn.alternate;e=e!==null?e.memoizedState:null}else e=cr.next;var t=br===null?Xn.memoizedState:br.next;if(t!==null)br=t,cr=e;else{if(e===null)throw Error(Xe(310));cr=e,e={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},br===null?Xn.memoizedState=br=e:br=br.next=e}return br}function vc(e,t){return typeof t=="function"?t(e):t}function Yp(e){var t=Is(),r=t.queue;if(r===null)throw Error(Xe(311));r.lastRenderedReducer=e;var i=cr,o=i.baseQueue,a=r.pending;if(a!==null){if(o!==null){var c=o.next;o.next=a.next,a.next=c}i.baseQueue=o=a,r.pending=null}if(o!==null){a=o.next,i=i.baseState;var p=c=null,m=null,w=a;do{var $=w.lane;if((Uo&$)===$)m!==null&&(m=m.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),i=w.hasEagerState?w.eagerState:e(i,w.action);else{var T={lane:$,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};m===null?(p=m=T,c=i):m=m.next=T,Xn.lanes|=$,Fo|=$}w=w.next}while(w!==null&&w!==a);m===null?c=i:m.next=p,Ys(i,t.memoizedState)||(qr=!0),t.memoizedState=i,t.baseState=c,t.baseQueue=m,r.lastRenderedState=i}if(e=r.interleaved,e!==null){o=e;do a=o.lane,Xn.lanes|=a,Fo|=a,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Gp(e){var t=Is(),r=t.queue;if(r===null)throw Error(Xe(311));r.lastRenderedReducer=e;var i=r.dispatch,o=r.pending,a=t.memoizedState;if(o!==null){r.pending=null;var c=o=o.next;do a=e(a,c.action),c=c.next;while(c!==o);Ys(a,t.memoizedState)||(qr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,i]}function Db(){}function Ob(e,t){var r=Xn,i=Is(),o=t(),a=!Ys(i.memoizedState,o);if(a&&(i.memoizedState=o,qr=!0),i=i.queue,Y0(Fb.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||br!==null&&br.memoizedState.tag&1){if(r.flags|=2048,wc(9,Ub.bind(null,r,i,o,t),void 0,null),yr===null)throw Error(Xe(349));Uo&30||Lb(r,t,o)}return o}function Lb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Ub(e,t,r,i){t.value=r,t.getSnapshot=i,Bb(t)&&Wb(e)}function Fb(e,t,r){return r(function(){Bb(t)&&Wb(e)})}function Bb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ys(e,r)}catch{return!0}}function Wb(e){var t=Si(e,1);t!==null&&Ks(t,e,1,-1)}function cg(e){var t=ri();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vc,lastRenderedState:e},t.queue=e,e=e.dispatch=C2.bind(null,Xn,e),[t.memoizedState,e]}function wc(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function Hb(){return Is().memoizedState}function Xu(e,t,r,i){var o=ri();Xn.flags|=e,o.memoizedState=wc(1|t,r,void 0,i===void 0?null:i)}function Dd(e,t,r,i){var o=Is();i=i===void 0?null:i;var a=void 0;if(cr!==null){var c=cr.memoizedState;if(a=c.destroy,i!==null&&H0(i,c.deps)){o.memoizedState=wc(t,r,a,i);return}}Xn.flags|=e,o.memoizedState=wc(1|t,r,a,i)}function ug(e,t){return Xu(8390656,8,e,t)}function Y0(e,t){return Dd(2048,8,e,t)}function Vb(e,t){return Dd(4,2,e,t)}function Kb(e,t){return Dd(4,4,e,t)}function Yb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Gb(e,t,r){return r=r!=null?r.concat([e]):null,Dd(4,4,Yb.bind(null,t,e),r)}function G0(){}function Xb(e,t){var r=Is();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&H0(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function Jb(e,t){var r=Is();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&H0(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function Zb(e,t,r){return Uo&21?(Ys(r,t)||(r=nb(),Xn.lanes|=r,Fo|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,qr=!0),e.memoizedState=r)}function _2(e,t){var r=zn;zn=r!==0&&4>r?r:4,e(!0);var i=Kp.transition;Kp.transition={};try{e(!1),t()}finally{zn=r,Kp.transition=i}}function qb(){return Is().memoizedState}function S2(e,t,r){var i=co(e);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},Qb(e))ey(t,r);else if(r=Pb(e,t,r,i),r!==null){var o=Hr();Ks(r,e,i,o),ty(r,t,i)}}function C2(e,t,r){var i=co(e),o={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(Qb(e))ey(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var c=t.lastRenderedState,p=a(c,r);if(o.hasEagerState=!0,o.eagerState=p,Ys(p,c)){var m=t.interleaved;m===null?(o.next=o,L0(t)):(o.next=m.next,m.next=o),t.interleaved=o;return}}catch{}finally{}r=Pb(e,t,o,i),r!==null&&(o=Hr(),Ks(r,e,i,o),ty(r,t,i))}}function Qb(e){var t=e.alternate;return e===Xn||t!==null&&t===Xn}function ey(e,t){Ql=bd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function ty(e,t,r){if(r&4194240){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,N0(e,r)}}var yd={readContext:Cs,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useInsertionEffect:Er,useLayoutEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useMutableSource:Er,useSyncExternalStore:Er,useId:Er,unstable_isNewReconciler:!1},I2={readContext:Cs,useCallback:function(e,t){return ri().memoizedState=[e,t===void 0?null:t],e},useContext:Cs,useEffect:ug,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Xu(4194308,4,Yb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Xu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xu(4,2,e,t)},useMemo:function(e,t){var r=ri();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=ri();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=S2.bind(null,Xn,e),[i.memoizedState,e]},useRef:function(e){var t=ri();return e={current:e},t.memoizedState=e},useState:cg,useDebugValue:G0,useDeferredValue:function(e){return ri().memoizedState=e},useTransition:function(){var e=cg(!1),t=e[0];return e=_2.bind(null,e[1]),ri().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=Xn,o=ri();if(Vn){if(r===void 0)throw Error(Xe(407));r=r()}else{if(r=t(),yr===null)throw Error(Xe(349));Uo&30||Lb(i,t,r)}o.memoizedState=r;var a={value:r,getSnapshot:t};return o.queue=a,ug(Fb.bind(null,i,a,e),[e]),i.flags|=2048,wc(9,Ub.bind(null,i,a,r,t),void 0,null),r},useId:function(){var e=ri(),t=yr.identifierPrefix;if(Vn){var r=zi,i=ki;r=(i&~(1<<32-Vs(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=yc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=N2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},E2={readContext:Cs,useCallback:Xb,useContext:Cs,useEffect:Y0,useImperativeHandle:Gb,useInsertionEffect:Vb,useLayoutEffect:Kb,useMemo:Jb,useReducer:Yp,useRef:Hb,useState:function(){return Yp(vc)},useDebugValue:G0,useDeferredValue:function(e){var t=Is();return Zb(t,cr.memoizedState,e)},useTransition:function(){var e=Yp(vc)[0],t=Is().memoizedState;return[e,t]},useMutableSource:Db,useSyncExternalStore:Ob,useId:qb,unstable_isNewReconciler:!1},$2={readContext:Cs,useCallback:Xb,useContext:Cs,useEffect:Y0,useImperativeHandle:Gb,useInsertionEffect:Vb,useLayoutEffect:Kb,useMemo:Jb,useReducer:Gp,useRef:Hb,useState:function(){return Gp(vc)},useDebugValue:G0,useDeferredValue:function(e){var t=Is();return cr===null?t.memoizedState=e:Zb(t,cr.memoizedState,e)},useTransition:function(){var e=Gp(vc)[0],t=Is().memoizedState;return[e,t]},useMutableSource:Db,useSyncExternalStore:Ob,useId:qb,unstable_isNewReconciler:!1};function Bs(e,t){if(e&&e.defaultProps){t=Jn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Hf(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:Jn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Od={isMounted:function(e){return(e=e._reactInternals)?Ko(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=Hr(),o=co(e),a=ji(i,o);a.payload=t,r!=null&&(a.callback=r),t=ao(e,a,o),t!==null&&(Ks(t,e,o,i),Yu(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=Hr(),o=co(e),a=ji(i,o);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ao(e,a,o),t!==null&&(Ks(t,e,o,i),Yu(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Hr(),i=co(e),o=ji(r,i);o.tag=2,t!=null&&(o.callback=t),t=ao(e,o,i),t!==null&&(Ks(t,e,i,r),Yu(t,e,i))}};function dg(e,t,r,i,o,a,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,a,c):t.prototype&&t.prototype.isPureReactComponent?!fc(r,i)||!fc(o,a):!0}function ny(e,t,r){var i=!1,o=fo,a=t.contextType;return typeof a=="object"&&a!==null?a=Cs(a):(o=es(t)?Oo:Tr.current,i=t.contextTypes,a=(i=i!=null)?Fa(e,o):fo),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Od,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function pg(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&Od.enqueueReplaceState(t,t.state,null)}function Vf(e,t,r,i){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},U0(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=Cs(a):(a=es(t)?Oo:Tr.current,o.context=Fa(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Hf(e,t,a,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Od.enqueueReplaceState(o,o.state,null),gd(e,r,o,i),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Va(e,t){try{var r="",i=t;do r+=iw(i),i=i.return;while(i);var o=r}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function Xp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Kf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var M2=typeof WeakMap=="function"?WeakMap:Map;function ry(e,t,r){r=ji(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){wd||(wd=!0,n0=i),Kf(e,t)},r}function sy(e,t,r){r=ji(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var o=t.value;r.payload=function(){return i(o)},r.callback=function(){Kf(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Kf(e,t),typeof i!="function"&&(lo===null?lo=new Set([this]):lo.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),r}function fg(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new M2;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(r)||(o.add(r),e=K2.bind(null,e,t,r),t.then(e,e))}function hg(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function mg(e,t,r,i,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ji(-1,1),t.tag=2,ao(r,t,1))),r.lanes|=1),e)}var T2=Ii.ReactCurrentOwner,qr=!1;function Wr(e,t,r,i){t.child=e===null?Tb(t,null,r,i):Wa(t,e.child,r,i)}function gg(e,t,r,i,o){r=r.render;var a=t.ref;return Oa(t,o),i=V0(e,t,r,i,a,o),r=K0(),e!==null&&!qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ci(e,t,o)):(Vn&&r&&T0(t),t.flags|=1,Wr(e,t,i,o),t.child)}function xg(e,t,r,i,o){if(e===null){var a=r.type;return typeof a=="function"&&!nh(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,iy(e,t,a,i,o)):(e=Qu(r.type,null,i,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var c=a.memoizedProps;if(r=r.compare,r=r!==null?r:fc,r(c,i)&&e.ref===t.ref)return Ci(e,t,o)}return t.flags|=1,e=uo(a,i),e.ref=t.ref,e.return=t,t.child=e}function iy(e,t,r,i,o){if(e!==null){var a=e.memoizedProps;if(fc(a,i)&&e.ref===t.ref)if(qr=!1,t.pendingProps=i=a,(e.lanes&o)!==0)e.flags&131072&&(qr=!0);else return t.lanes=e.lanes,Ci(e,t,o)}return Yf(e,t,r,i,o)}function oy(e,t,r){var i=t.pendingProps,o=i.children,a=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pn(Ta,us),us|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Pn(Ta,us),us|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=a!==null?a.baseLanes:r,Pn(Ta,us),us|=i}else a!==null?(i=a.baseLanes|r,t.memoizedState=null):i=r,Pn(Ta,us),us|=i;return Wr(e,t,o,r),t.child}function ay(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Yf(e,t,r,i,o){var a=es(r)?Oo:Tr.current;return a=Fa(t,a),Oa(t,o),r=V0(e,t,r,i,a,o),i=K0(),e!==null&&!qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ci(e,t,o)):(Vn&&i&&T0(t),t.flags|=1,Wr(e,t,r,o),t.child)}function bg(e,t,r,i,o){if(es(r)){var a=!0;dd(t)}else a=!1;if(Oa(t,o),t.stateNode===null)Ju(e,t),ny(t,r,i),Vf(t,r,i,o),i=!0;else if(e===null){var c=t.stateNode,p=t.memoizedProps;c.props=p;var m=c.context,w=r.contextType;typeof w=="object"&&w!==null?w=Cs(w):(w=es(r)?Oo:Tr.current,w=Fa(t,w));var $=r.getDerivedStateFromProps,T=typeof $=="function"||typeof c.getSnapshotBeforeUpdate=="function";T||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(p!==i||m!==w)&&pg(t,c,i,w),qi=!1;var E=t.memoizedState;c.state=E,gd(t,i,c,o),m=t.memoizedState,p!==i||E!==m||Qr.current||qi?(typeof $=="function"&&(Hf(t,r,$,i),m=t.memoizedState),(p=qi||dg(t,r,p,i,E,m,w))?(T||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=m),c.props=i,c.state=m,c.context=w,i=p):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{c=t.stateNode,Ab(e,t),p=t.memoizedProps,w=t.type===t.elementType?p:Bs(t.type,p),c.props=w,T=t.pendingProps,E=c.context,m=r.contextType,typeof m=="object"&&m!==null?m=Cs(m):(m=es(r)?Oo:Tr.current,m=Fa(t,m));var y=r.getDerivedStateFromProps;($=typeof y=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(p!==T||E!==m)&&pg(t,c,i,m),qi=!1,E=t.memoizedState,c.state=E,gd(t,i,c,o);var A=t.memoizedState;p!==T||E!==A||Qr.current||qi?(typeof y=="function"&&(Hf(t,r,y,i),A=t.memoizedState),(w=qi||dg(t,r,w,i,E,A,m)||!1)?($||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(i,A,m),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(i,A,m)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||p===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=A),c.props=i,c.state=A,c.context=m,i=w):(typeof c.componentDidUpdate!="function"||p===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||p===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),i=!1)}return Gf(e,t,r,i,a,o)}function Gf(e,t,r,i,o,a){ay(e,t);var c=(t.flags&128)!==0;if(!i&&!c)return o&&rg(t,r,!1),Ci(e,t,a);i=t.stateNode,T2.current=t;var p=c&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&c?(t.child=Wa(t,e.child,null,a),t.child=Wa(t,null,p,a)):Wr(e,t,p,a),t.memoizedState=i.state,o&&rg(t,r,!0),t.child}function ly(e){var t=e.stateNode;t.pendingContext?ng(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ng(e,t.context,!1),F0(e,t.containerInfo)}function yg(e,t,r,i,o){return Ba(),A0(o),t.flags|=256,Wr(e,t,r,i),t.child}var Xf={dehydrated:null,treeContext:null,retryLane:0};function Jf(e){return{baseLanes:e,cachePool:null,transitions:null}}function cy(e,t,r){var i=t.pendingProps,o=Gn.current,a=!1,c=(t.flags&128)!==0,p;if((p=c)||(p=e!==null&&e.memoizedState===null?!1:(o&2)!==0),p?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Pn(Gn,o&1),e===null)return Bf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=i.children,e=i.fallback,a?(i=t.mode,a=t.child,c={mode:"hidden",children:c},!(i&1)&&a!==null?(a.childLanes=0,a.pendingProps=c):a=Fd(c,i,0,null),e=Do(e,i,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Jf(r),t.memoizedState=Xf,e):X0(t,c));if(o=e.memoizedState,o!==null&&(p=o.dehydrated,p!==null))return P2(e,t,c,i,p,o,r);if(a){a=i.fallback,c=t.mode,o=e.child,p=o.sibling;var m={mode:"hidden",children:i.children};return!(c&1)&&t.child!==o?(i=t.child,i.childLanes=0,i.pendingProps=m,t.deletions=null):(i=uo(o,m),i.subtreeFlags=o.subtreeFlags&14680064),p!==null?a=uo(p,a):(a=Do(a,c,r,null),a.flags|=2),a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,c=e.child.memoizedState,c=c===null?Jf(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~r,t.memoizedState=Xf,i}return a=e.child,e=a.sibling,i=uo(a,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=r),i.return=t,i.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function X0(e,t){return t=Fd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _u(e,t,r,i){return i!==null&&A0(i),Wa(t,e.child,null,r),e=X0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function P2(e,t,r,i,o,a,c){if(r)return t.flags&256?(t.flags&=-257,i=Xp(Error(Xe(422))),_u(e,t,c,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=i.fallback,o=t.mode,i=Fd({mode:"visible",children:i.children},o,0,null),a=Do(a,o,c,null),a.flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,t.mode&1&&Wa(t,e.child,null,c),t.child.memoizedState=Jf(c),t.memoizedState=Xf,a);if(!(t.mode&1))return _u(e,t,c,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var p=i.dgst;return i=p,a=Error(Xe(419)),i=Xp(a,i,void 0),_u(e,t,c,i)}if(p=(c&e.childLanes)!==0,qr||p){if(i=yr,i!==null){switch(c&-c){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(i.suspendedLanes|c)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,Si(e,o),Ks(i,e,o,-1))}return th(),i=Xp(Error(Xe(421))),_u(e,t,c,i)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Y2.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,ps=oo(o.nextSibling),fs=t,Vn=!0,Hs=null,e!==null&&(js[Ns++]=ki,js[Ns++]=zi,js[Ns++]=Lo,ki=e.id,zi=e.overflow,Lo=t),t=X0(t,i.children),t.flags|=4096,t)}function vg(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Wf(e.return,t,r)}function Jp(e,t,r,i,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=r,a.tailMode=o)}function uy(e,t,r){var i=t.pendingProps,o=i.revealOrder,a=i.tail;if(Wr(e,t,i.children,r),i=Gn.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vg(e,r,t);else if(e.tag===19)vg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Pn(Gn,i),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&xd(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Jp(t,!1,o,r,a);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&xd(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Jp(t,!0,r,null,a);break;case"together":Jp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ju(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ci(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Fo|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Xe(153));if(t.child!==null){for(e=t.child,r=uo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=uo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function A2(e,t,r){switch(t.tag){case 3:ly(t),Ba();break;case 5:Rb(t);break;case 1:es(t.type)&&dd(t);break;case 4:F0(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,o=t.memoizedProps.value;Pn(hd,i._currentValue),i._currentValue=o;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Pn(Gn,Gn.current&1),t.flags|=128,null):r&t.child.childLanes?cy(e,t,r):(Pn(Gn,Gn.current&1),e=Ci(e,t,r),e!==null?e.sibling:null);Pn(Gn,Gn.current&1);break;case 19:if(i=(r&t.childLanes)!==0,e.flags&128){if(i)return uy(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Pn(Gn,Gn.current),i)break;return null;case 22:case 23:return t.lanes=0,oy(e,t,r)}return Ci(e,t,r)}var dy,Zf,py,fy;dy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Zf=function(){};py=function(e,t,r,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,Ao(li.current);var a=null;switch(r){case"input":o=yf(e,o),i=yf(e,i),a=[];break;case"select":o=Jn({},o,{value:void 0}),i=Jn({},i,{value:void 0}),a=[];break;case"textarea":o=kf(e,o),i=kf(e,i),a=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=cd)}jf(r,i);var c;r=null;for(w in o)if(!i.hasOwnProperty(w)&&o.hasOwnProperty(w)&&o[w]!=null)if(w==="style"){var p=o[w];for(c in p)p.hasOwnProperty(c)&&(r||(r={}),r[c]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(oc.hasOwnProperty(w)?a||(a=[]):(a=a||[]).push(w,null));for(w in i){var m=i[w];if(p=o!=null?o[w]:void 0,i.hasOwnProperty(w)&&m!==p&&(m!=null||p!=null))if(w==="style")if(p){for(c in p)!p.hasOwnProperty(c)||m&&m.hasOwnProperty(c)||(r||(r={}),r[c]="");for(c in m)m.hasOwnProperty(c)&&p[c]!==m[c]&&(r||(r={}),r[c]=m[c])}else r||(a||(a=[]),a.push(w,r)),r=m;else w==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,p=p?p.__html:void 0,m!=null&&p!==m&&(a=a||[]).push(w,m)):w==="children"?typeof m!="string"&&typeof m!="number"||(a=a||[]).push(w,""+m):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(oc.hasOwnProperty(w)?(m!=null&&w==="onScroll"&&Ln("scroll",e),a||p===m||(a=[])):(a=a||[]).push(w,m))}r&&(a=a||[]).push("style",r);var w=a;(t.updateQueue=w)&&(t.flags|=4)}};fy=function(e,t,r,i){r!==i&&(t.flags|=4)};function Il(e,t){if(!Vn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function $r(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function R2(e,t,r){var i=t.pendingProps;switch(P0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $r(t),null;case 1:return es(t.type)&&ud(),$r(t),null;case 3:return i=t.stateNode,Ha(),Un(Qr),Un(Tr),W0(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(ju(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Hs!==null&&(i0(Hs),Hs=null))),Zf(e,t),$r(t),null;case 5:B0(t);var o=Ao(bc.current);if(r=t.type,e!==null&&t.stateNode!=null)py(e,t,r,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Xe(166));return $r(t),null}if(e=Ao(li.current),ju(t)){i=t.stateNode,r=t.type;var a=t.memoizedProps;switch(i[si]=t,i[gc]=a,e=(t.mode&1)!==0,r){case"dialog":Ln("cancel",i),Ln("close",i);break;case"iframe":case"object":case"embed":Ln("load",i);break;case"video":case"audio":for(o=0;o<Hl.length;o++)Ln(Hl[o],i);break;case"source":Ln("error",i);break;case"img":case"image":case"link":Ln("error",i),Ln("load",i);break;case"details":Ln("toggle",i);break;case"input":Im(i,a),Ln("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Ln("invalid",i);break;case"textarea":$m(i,a),Ln("invalid",i)}jf(r,a),o=null;for(var c in a)if(a.hasOwnProperty(c)){var p=a[c];c==="children"?typeof p=="string"?i.textContent!==p&&(a.suppressHydrationWarning!==!0&&zu(i.textContent,p,e),o=["children",p]):typeof p=="number"&&i.textContent!==""+p&&(a.suppressHydrationWarning!==!0&&zu(i.textContent,p,e),o=["children",""+p]):oc.hasOwnProperty(c)&&p!=null&&c==="onScroll"&&Ln("scroll",i)}switch(r){case"input":mu(i),Em(i,a,!0);break;case"textarea":mu(i),Mm(i);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(i.onclick=cd)}i=o,t.updateQueue=i,i!==null&&(t.flags|=4)}else{c=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=c.createElement(r,{is:i.is}):(e=c.createElement(r),r==="select"&&(c=e,i.multiple?c.multiple=!0:i.size&&(c.size=i.size))):e=c.createElementNS(e,r),e[si]=t,e[gc]=i,dy(e,t,!1,!1),t.stateNode=e;e:{switch(c=Nf(r,i),r){case"dialog":Ln("cancel",e),Ln("close",e),o=i;break;case"iframe":case"object":case"embed":Ln("load",e),o=i;break;case"video":case"audio":for(o=0;o<Hl.length;o++)Ln(Hl[o],e);o=i;break;case"source":Ln("error",e),o=i;break;case"img":case"image":case"link":Ln("error",e),Ln("load",e),o=i;break;case"details":Ln("toggle",e),o=i;break;case"input":Im(e,i),o=yf(e,i),Ln("invalid",e);break;case"option":o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=Jn({},i,{value:void 0}),Ln("invalid",e);break;case"textarea":$m(e,i),o=kf(e,i),Ln("invalid",e);break;default:o=i}jf(r,o),p=o;for(a in p)if(p.hasOwnProperty(a)){var m=p[a];a==="style"?Hx(e,m):a==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&Bx(e,m)):a==="children"?typeof m=="string"?(r!=="textarea"||m!=="")&&ac(e,m):typeof m=="number"&&ac(e,""+m):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(oc.hasOwnProperty(a)?m!=null&&a==="onScroll"&&Ln("scroll",e):m!=null&&y0(e,a,m,c))}switch(r){case"input":mu(e),Em(e,i,!1);break;case"textarea":mu(e),Mm(e);break;case"option":i.value!=null&&e.setAttribute("value",""+po(i.value));break;case"select":e.multiple=!!i.multiple,a=i.value,a!=null?Pa(e,!!i.multiple,a,!1):i.defaultValue!=null&&Pa(e,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=cd)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return $r(t),null;case 6:if(e&&t.stateNode!=null)fy(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Xe(166));if(r=Ao(bc.current),Ao(li.current),ju(t)){if(i=t.stateNode,r=t.memoizedProps,i[si]=t,(a=i.nodeValue!==r)&&(e=fs,e!==null))switch(e.tag){case 3:zu(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zu(i.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[si]=t,t.stateNode=i}return $r(t),null;case 13:if(Un(Gn),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Vn&&ps!==null&&t.mode&1&&!(t.flags&128))$b(),Ba(),t.flags|=98560,a=!1;else if(a=ju(t),i!==null&&i.dehydrated!==null){if(e===null){if(!a)throw Error(Xe(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Xe(317));a[si]=t}else Ba(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;$r(t),a=!1}else Hs!==null&&(i0(Hs),Hs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Gn.current&1?ur===0&&(ur=3):th())),t.updateQueue!==null&&(t.flags|=4),$r(t),null);case 4:return Ha(),Zf(e,t),e===null&&hc(t.stateNode.containerInfo),$r(t),null;case 10:return O0(t.type._context),$r(t),null;case 17:return es(t.type)&&ud(),$r(t),null;case 19:if(Un(Gn),a=t.memoizedState,a===null)return $r(t),null;if(i=(t.flags&128)!==0,c=a.rendering,c===null)if(i)Il(a,!1);else{if(ur!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(c=xd(e),c!==null){for(t.flags|=128,Il(a,!1),i=c.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)a=r,e=i,a.flags&=14680066,c=a.alternate,c===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,e=c.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Pn(Gn,Gn.current&1|2),t.child}e=e.sibling}a.tail!==null&&nr()>Ka&&(t.flags|=128,i=!0,Il(a,!1),t.lanes=4194304)}else{if(!i)if(e=xd(c),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Il(a,!0),a.tail===null&&a.tailMode==="hidden"&&!c.alternate&&!Vn)return $r(t),null}else 2*nr()-a.renderingStartTime>Ka&&r!==1073741824&&(t.flags|=128,i=!0,Il(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(r=a.last,r!==null?r.sibling=c:t.child=c,a.last=c)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=nr(),t.sibling=null,r=Gn.current,Pn(Gn,i?r&1|2:r&1),t):($r(t),null);case 22:case 23:return eh(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?us&1073741824&&($r(t),t.subtreeFlags&6&&(t.flags|=8192)):$r(t),null;case 24:return null;case 25:return null}throw Error(Xe(156,t.tag))}function D2(e,t){switch(P0(t),t.tag){case 1:return es(t.type)&&ud(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ha(),Un(Qr),Un(Tr),W0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return B0(t),null;case 13:if(Un(Gn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Xe(340));Ba()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Un(Gn),null;case 4:return Ha(),null;case 10:return O0(t.type._context),null;case 22:case 23:return eh(),null;case 24:return null;default:return null}}var Su=!1,Mr=!1,O2=typeof WeakSet=="function"?WeakSet:Set,Et=null;function Ma(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){qn(e,t,i)}else r.current=null}function qf(e,t,r){try{r()}catch(i){qn(e,t,i)}}var wg=!1;function L2(e,t){if(Af=od,e=bb(),M0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var o=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var c=0,p=-1,m=-1,w=0,$=0,T=e,E=null;t:for(;;){for(var y;T!==r||o!==0&&T.nodeType!==3||(p=c+o),T!==a||i!==0&&T.nodeType!==3||(m=c+i),T.nodeType===3&&(c+=T.nodeValue.length),(y=T.firstChild)!==null;)E=T,T=y;for(;;){if(T===e)break t;if(E===r&&++w===o&&(p=c),E===a&&++$===i&&(m=c),(y=T.nextSibling)!==null)break;T=E,E=T.parentNode}T=y}r=p===-1||m===-1?null:{start:p,end:m}}else r=null}r=r||{start:0,end:0}}else r=null;for(Rf={focusedElem:e,selectionRange:r},od=!1,Et=t;Et!==null;)if(t=Et,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Et=e;else for(;Et!==null;){t=Et;try{var A=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var N=A.memoizedProps,D=A.memoizedState,b=t.stateNode,z=b.getSnapshotBeforeUpdate(t.elementType===t.type?N:Bs(t.type,N),D);b.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var P=t.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Xe(163))}}catch(W){qn(t,t.return,W)}if(e=t.sibling,e!==null){e.return=t.return,Et=e;break}Et=t.return}return A=wg,wg=!1,A}function ec(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&qf(t,r,a)}o=o.next}while(o!==i)}}function Ld(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function Qf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hy(e){var t=e.alternate;t!==null&&(e.alternate=null,hy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[si],delete t[gc],delete t[Lf],delete t[w2],delete t[k2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function my(e){return e.tag===5||e.tag===3||e.tag===4}function kg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||my(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function e0(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=cd));else if(i!==4&&(e=e.child,e!==null))for(e0(e,t,r),e=e.sibling;e!==null;)e0(e,t,r),e=e.sibling}function t0(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(t0(e,t,r),e=e.sibling;e!==null;)t0(e,t,r),e=e.sibling}var jr=null,Ws=!1;function Gi(e,t,r){for(r=r.child;r!==null;)gy(e,t,r),r=r.sibling}function gy(e,t,r){if(ai&&typeof ai.onCommitFiberUnmount=="function")try{ai.onCommitFiberUnmount($d,r)}catch{}switch(r.tag){case 5:Mr||Ma(r,t);case 6:var i=jr,o=Ws;jr=null,Gi(e,t,r),jr=i,Ws=o,jr!==null&&(Ws?(e=jr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jr.removeChild(r.stateNode));break;case 18:jr!==null&&(Ws?(e=jr,r=r.stateNode,e.nodeType===8?Wp(e.parentNode,r):e.nodeType===1&&Wp(e,r),dc(e)):Wp(jr,r.stateNode));break;case 4:i=jr,o=Ws,jr=r.stateNode.containerInfo,Ws=!0,Gi(e,t,r),jr=i,Ws=o;break;case 0:case 11:case 14:case 15:if(!Mr&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var a=o,c=a.destroy;a=a.tag,c!==void 0&&(a&2||a&4)&&qf(r,t,c),o=o.next}while(o!==i)}Gi(e,t,r);break;case 1:if(!Mr&&(Ma(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(p){qn(r,t,p)}Gi(e,t,r);break;case 21:Gi(e,t,r);break;case 22:r.mode&1?(Mr=(i=Mr)||r.memoizedState!==null,Gi(e,t,r),Mr=i):Gi(e,t,r);break;default:Gi(e,t,r)}}function zg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new O2),t.forEach(function(i){var o=G2.bind(null,e,i);r.has(i)||(r.add(i),i.then(o,o))})}}function Ls(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];try{var a=e,c=t,p=c;e:for(;p!==null;){switch(p.tag){case 5:jr=p.stateNode,Ws=!1;break e;case 3:jr=p.stateNode.containerInfo,Ws=!0;break e;case 4:jr=p.stateNode.containerInfo,Ws=!0;break e}p=p.return}if(jr===null)throw Error(Xe(160));gy(a,c,o),jr=null,Ws=!1;var m=o.alternate;m!==null&&(m.return=null),o.return=null}catch(w){qn(o,t,w)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xy(t,e),t=t.sibling}function xy(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ls(t,e),ti(e),i&4){try{ec(3,e,e.return),Ld(3,e)}catch(N){qn(e,e.return,N)}try{ec(5,e,e.return)}catch(N){qn(e,e.return,N)}}break;case 1:Ls(t,e),ti(e),i&512&&r!==null&&Ma(r,r.return);break;case 5:if(Ls(t,e),ti(e),i&512&&r!==null&&Ma(r,r.return),e.flags&32){var o=e.stateNode;try{ac(o,"")}catch(N){qn(e,e.return,N)}}if(i&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,c=r!==null?r.memoizedProps:a,p=e.type,m=e.updateQueue;if(e.updateQueue=null,m!==null)try{p==="input"&&a.type==="radio"&&a.name!=null&&Lx(o,a),Nf(p,c);var w=Nf(p,a);for(c=0;c<m.length;c+=2){var $=m[c],T=m[c+1];$==="style"?Hx(o,T):$==="dangerouslySetInnerHTML"?Bx(o,T):$==="children"?ac(o,T):y0(o,$,T,w)}switch(p){case"input":vf(o,a);break;case"textarea":Ux(o,a);break;case"select":var E=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var y=a.value;y!=null?Pa(o,!!a.multiple,y,!1):E!==!!a.multiple&&(a.defaultValue!=null?Pa(o,!!a.multiple,a.defaultValue,!0):Pa(o,!!a.multiple,a.multiple?[]:"",!1))}o[gc]=a}catch(N){qn(e,e.return,N)}}break;case 6:if(Ls(t,e),ti(e),i&4){if(e.stateNode===null)throw Error(Xe(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(N){qn(e,e.return,N)}}break;case 3:if(Ls(t,e),ti(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{dc(t.containerInfo)}catch(N){qn(e,e.return,N)}break;case 4:Ls(t,e),ti(e);break;case 13:Ls(t,e),ti(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(q0=nr())),i&4&&zg(e);break;case 22:if($=r!==null&&r.memoizedState!==null,e.mode&1?(Mr=(w=Mr)||$,Ls(t,e),Mr=w):Ls(t,e),ti(e),i&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!$&&e.mode&1)for(Et=e,$=e.child;$!==null;){for(T=Et=$;Et!==null;){switch(E=Et,y=E.child,E.tag){case 0:case 11:case 14:case 15:ec(4,E,E.return);break;case 1:Ma(E,E.return);var A=E.stateNode;if(typeof A.componentWillUnmount=="function"){i=E,r=E.return;try{t=i,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch(N){qn(i,r,N)}}break;case 5:Ma(E,E.return);break;case 22:if(E.memoizedState!==null){Ng(T);continue}}y!==null?(y.return=E,Et=y):Ng(T)}$=$.sibling}e:for($=null,T=e;;){if(T.tag===5){if($===null){$=T;try{o=T.stateNode,w?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(p=T.stateNode,m=T.memoizedProps.style,c=m!=null&&m.hasOwnProperty("display")?m.display:null,p.style.display=Wx("display",c))}catch(N){qn(e,e.return,N)}}}else if(T.tag===6){if($===null)try{T.stateNode.nodeValue=w?"":T.memoizedProps}catch(N){qn(e,e.return,N)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===e)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===e)break e;for(;T.sibling===null;){if(T.return===null||T.return===e)break e;$===T&&($=null),T=T.return}$===T&&($=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:Ls(t,e),ti(e),i&4&&zg(e);break;case 21:break;default:Ls(t,e),ti(e)}}function ti(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(my(r)){var i=r;break e}r=r.return}throw Error(Xe(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(ac(o,""),i.flags&=-33);var a=kg(e);t0(e,a,o);break;case 3:case 4:var c=i.stateNode.containerInfo,p=kg(e);e0(e,p,c);break;default:throw Error(Xe(161))}}catch(m){qn(e,e.return,m)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function U2(e,t,r){Et=e,by(e)}function by(e,t,r){for(var i=(e.mode&1)!==0;Et!==null;){var o=Et,a=o.child;if(o.tag===22&&i){var c=o.memoizedState!==null||Su;if(!c){var p=o.alternate,m=p!==null&&p.memoizedState!==null||Mr;p=Su;var w=Mr;if(Su=c,(Mr=m)&&!w)for(Et=o;Et!==null;)c=Et,m=c.child,c.tag===22&&c.memoizedState!==null?_g(o):m!==null?(m.return=c,Et=m):_g(o);for(;a!==null;)Et=a,by(a),a=a.sibling;Et=o,Su=p,Mr=w}jg(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,Et=a):jg(e)}}function jg(e){for(;Et!==null;){var t=Et;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mr||Ld(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Mr)if(r===null)i.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:Bs(t.type,r.memoizedProps);i.componentDidUpdate(o,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&lg(t,a,i);break;case 3:var c=t.updateQueue;if(c!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}lg(t,c,r)}break;case 5:var p=t.stateNode;if(r===null&&t.flags&4){r=p;var m=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&r.focus();break;case"img":m.src&&(r.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var w=t.alternate;if(w!==null){var $=w.memoizedState;if($!==null){var T=$.dehydrated;T!==null&&dc(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Xe(163))}Mr||t.flags&512&&Qf(t)}catch(E){qn(t,t.return,E)}}if(t===e){Et=null;break}if(r=t.sibling,r!==null){r.return=t.return,Et=r;break}Et=t.return}}function Ng(e){for(;Et!==null;){var t=Et;if(t===e){Et=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Et=r;break}Et=t.return}}function _g(e){for(;Et!==null;){var t=Et;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ld(4,t)}catch(m){qn(t,r,m)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var o=t.return;try{i.componentDidMount()}catch(m){qn(t,o,m)}}var a=t.return;try{Qf(t)}catch(m){qn(t,a,m)}break;case 5:var c=t.return;try{Qf(t)}catch(m){qn(t,c,m)}}}catch(m){qn(t,t.return,m)}if(t===e){Et=null;break}var p=t.sibling;if(p!==null){p.return=t.return,Et=p;break}Et=t.return}}var F2=Math.ceil,vd=Ii.ReactCurrentDispatcher,J0=Ii.ReactCurrentOwner,Ss=Ii.ReactCurrentBatchConfig,hn=0,yr=null,sr=null,Nr=0,us=0,Ta=mo(0),ur=0,kc=null,Fo=0,Ud=0,Z0=0,tc=null,Zr=null,q0=0,Ka=1/0,bi=null,wd=!1,n0=null,lo=null,Cu=!1,no=null,kd=0,nc=0,r0=null,Zu=-1,qu=0;function Hr(){return hn&6?nr():Zu!==-1?Zu:Zu=nr()}function co(e){return e.mode&1?hn&2&&Nr!==0?Nr&-Nr:j2.transition!==null?(qu===0&&(qu=nb()),qu):(e=zn,e!==0||(e=window.event,e=e===void 0?16:cb(e.type)),e):1}function Ks(e,t,r,i){if(50<nc)throw nc=0,r0=null,Error(Xe(185));jc(e,r,i),(!(hn&2)||e!==yr)&&(e===yr&&(!(hn&2)&&(Ud|=r),ur===4&&eo(e,Nr)),ts(e,i),r===1&&hn===0&&!(t.mode&1)&&(Ka=nr()+500,Rd&&go()))}function ts(e,t){var r=e.callbackNode;jw(e,t);var i=id(e,e===yr?Nr:0);if(i===0)r!==null&&Am(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&Am(r),t===1)e.tag===0?z2(Sg.bind(null,e)):Cb(Sg.bind(null,e)),y2(function(){!(hn&6)&&go()}),r=null;else{switch(rb(i)){case 1:r=j0;break;case 4:r=eb;break;case 16:r=sd;break;case 536870912:r=tb;break;default:r=sd}r=_y(r,yy.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function yy(e,t){if(Zu=-1,qu=0,hn&6)throw Error(Xe(327));var r=e.callbackNode;if(La()&&e.callbackNode!==r)return null;var i=id(e,e===yr?Nr:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=zd(e,i);else{t=i;var o=hn;hn|=2;var a=wy();(yr!==e||Nr!==t)&&(bi=null,Ka=nr()+500,Ro(e,t));do try{H2();break}catch(p){vy(e,p)}while(!0);D0(),vd.current=a,hn=o,sr!==null?t=0:(yr=null,Nr=0,t=ur)}if(t!==0){if(t===2&&(o=Ef(e),o!==0&&(i=o,t=s0(e,o))),t===1)throw r=kc,Ro(e,0),eo(e,i),ts(e,nr()),r;if(t===6)eo(e,i);else{if(o=e.current.alternate,!(i&30)&&!B2(o)&&(t=zd(e,i),t===2&&(a=Ef(e),a!==0&&(i=a,t=s0(e,a))),t===1))throw r=kc,Ro(e,0),eo(e,i),ts(e,nr()),r;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(Xe(345));case 2:Mo(e,Zr,bi);break;case 3:if(eo(e,i),(i&130023424)===i&&(t=q0+500-nr(),10<t)){if(id(e,0)!==0)break;if(o=e.suspendedLanes,(o&i)!==i){Hr(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Of(Mo.bind(null,e,Zr,bi),t);break}Mo(e,Zr,bi);break;case 4:if(eo(e,i),(i&4194240)===i)break;for(t=e.eventTimes,o=-1;0<i;){var c=31-Vs(i);a=1<<c,c=t[c],c>o&&(o=c),i&=~a}if(i=o,i=nr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*F2(i/1960))-i,10<i){e.timeoutHandle=Of(Mo.bind(null,e,Zr,bi),i);break}Mo(e,Zr,bi);break;case 5:Mo(e,Zr,bi);break;default:throw Error(Xe(329))}}}return ts(e,nr()),e.callbackNode===r?yy.bind(null,e):null}function s0(e,t){var r=tc;return e.current.memoizedState.isDehydrated&&(Ro(e,t).flags|=256),e=zd(e,t),e!==2&&(t=Zr,Zr=r,t!==null&&i0(t)),e}function i0(e){Zr===null?Zr=e:Zr.push.apply(Zr,e)}function B2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var o=r[i],a=o.getSnapshot;o=o.value;try{if(!Ys(a(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function eo(e,t){for(t&=~Z0,t&=~Ud,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Vs(t),i=1<<r;e[r]=-1,t&=~i}}function Sg(e){if(hn&6)throw Error(Xe(327));La();var t=id(e,0);if(!(t&1))return ts(e,nr()),null;var r=zd(e,t);if(e.tag!==0&&r===2){var i=Ef(e);i!==0&&(t=i,r=s0(e,i))}if(r===1)throw r=kc,Ro(e,0),eo(e,t),ts(e,nr()),r;if(r===6)throw Error(Xe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Mo(e,Zr,bi),ts(e,nr()),null}function Q0(e,t){var r=hn;hn|=1;try{return e(t)}finally{hn=r,hn===0&&(Ka=nr()+500,Rd&&go())}}function Bo(e){no!==null&&no.tag===0&&!(hn&6)&&La();var t=hn;hn|=1;var r=Ss.transition,i=zn;try{if(Ss.transition=null,zn=1,e)return e()}finally{zn=i,Ss.transition=r,hn=t,!(hn&6)&&go()}}function eh(){us=Ta.current,Un(Ta)}function Ro(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,b2(r)),sr!==null)for(r=sr.return;r!==null;){var i=r;switch(P0(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&ud();break;case 3:Ha(),Un(Qr),Un(Tr),W0();break;case 5:B0(i);break;case 4:Ha();break;case 13:Un(Gn);break;case 19:Un(Gn);break;case 10:O0(i.type._context);break;case 22:case 23:eh()}r=r.return}if(yr=e,sr=e=uo(e.current,null),Nr=us=t,ur=0,kc=null,Z0=Ud=Fo=0,Zr=tc=null,Po!==null){for(t=0;t<Po.length;t++)if(r=Po[t],i=r.interleaved,i!==null){r.interleaved=null;var o=i.next,a=r.pending;if(a!==null){var c=a.next;a.next=o,i.next=c}r.pending=i}Po=null}return e}function vy(e,t){do{var r=sr;try{if(D0(),Gu.current=yd,bd){for(var i=Xn.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}bd=!1}if(Uo=0,br=cr=Xn=null,Ql=!1,yc=0,J0.current=null,r===null||r.return===null){ur=1,kc=t,sr=null;break}e:{var a=e,c=r.return,p=r,m=t;if(t=Nr,p.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var w=m,$=p,T=$.tag;if(!($.mode&1)&&(T===0||T===11||T===15)){var E=$.alternate;E?($.updateQueue=E.updateQueue,$.memoizedState=E.memoizedState,$.lanes=E.lanes):($.updateQueue=null,$.memoizedState=null)}var y=hg(c);if(y!==null){y.flags&=-257,mg(y,c,p,a,t),y.mode&1&&fg(a,w,t),t=y,m=w;var A=t.updateQueue;if(A===null){var N=new Set;N.add(m),t.updateQueue=N}else A.add(m);break e}else{if(!(t&1)){fg(a,w,t),th();break e}m=Error(Xe(426))}}else if(Vn&&p.mode&1){var D=hg(c);if(D!==null){!(D.flags&65536)&&(D.flags|=256),mg(D,c,p,a,t),A0(Va(m,p));break e}}a=m=Va(m,p),ur!==4&&(ur=2),tc===null?tc=[a]:tc.push(a),a=c;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var b=ry(a,m,t);ag(a,b);break e;case 1:p=m;var z=a.type,P=a.stateNode;if(!(a.flags&128)&&(typeof z.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(lo===null||!lo.has(P)))){a.flags|=65536,t&=-t,a.lanes|=t;var W=sy(a,p,t);ag(a,W);break e}}a=a.return}while(a!==null)}zy(r)}catch(G){t=G,sr===r&&r!==null&&(sr=r=r.return);continue}break}while(!0)}function wy(){var e=vd.current;return vd.current=yd,e===null?yd:e}function th(){(ur===0||ur===3||ur===2)&&(ur=4),yr===null||!(Fo&268435455)&&!(Ud&268435455)||eo(yr,Nr)}function zd(e,t){var r=hn;hn|=2;var i=wy();(yr!==e||Nr!==t)&&(bi=null,Ro(e,t));do try{W2();break}catch(o){vy(e,o)}while(!0);if(D0(),hn=r,vd.current=i,sr!==null)throw Error(Xe(261));return yr=null,Nr=0,ur}function W2(){for(;sr!==null;)ky(sr)}function H2(){for(;sr!==null&&!mw();)ky(sr)}function ky(e){var t=Ny(e.alternate,e,us);e.memoizedProps=e.pendingProps,t===null?zy(e):sr=t,J0.current=null}function zy(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=D2(r,t),r!==null){r.flags&=32767,sr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ur=6,sr=null;return}}else if(r=R2(r,t,us),r!==null){sr=r;return}if(t=t.sibling,t!==null){sr=t;return}sr=t=e}while(t!==null);ur===0&&(ur=5)}function Mo(e,t,r){var i=zn,o=Ss.transition;try{Ss.transition=null,zn=1,V2(e,t,r,i)}finally{Ss.transition=o,zn=i}return null}function V2(e,t,r,i){do La();while(no!==null);if(hn&6)throw Error(Xe(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Xe(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Nw(e,a),e===yr&&(sr=yr=null,Nr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Cu||(Cu=!0,_y(sd,function(){return La(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ss.transition,Ss.transition=null;var c=zn;zn=1;var p=hn;hn|=4,J0.current=null,L2(e,r),xy(r,e),d2(Rf),od=!!Af,Rf=Af=null,e.current=r,U2(r),gw(),hn=p,zn=c,Ss.transition=a}else e.current=r;if(Cu&&(Cu=!1,no=e,kd=o),a=e.pendingLanes,a===0&&(lo=null),yw(r.stateNode),ts(e,nr()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],i(o.value,{componentStack:o.stack,digest:o.digest});if(wd)throw wd=!1,e=n0,n0=null,e;return kd&1&&e.tag!==0&&La(),a=e.pendingLanes,a&1?e===r0?nc++:(nc=0,r0=e):nc=0,go(),null}function La(){if(no!==null){var e=rb(kd),t=Ss.transition,r=zn;try{if(Ss.transition=null,zn=16>e?16:e,no===null)var i=!1;else{if(e=no,no=null,kd=0,hn&6)throw Error(Xe(331));var o=hn;for(hn|=4,Et=e.current;Et!==null;){var a=Et,c=a.child;if(Et.flags&16){var p=a.deletions;if(p!==null){for(var m=0;m<p.length;m++){var w=p[m];for(Et=w;Et!==null;){var $=Et;switch($.tag){case 0:case 11:case 15:ec(8,$,a)}var T=$.child;if(T!==null)T.return=$,Et=T;else for(;Et!==null;){$=Et;var E=$.sibling,y=$.return;if(hy($),$===w){Et=null;break}if(E!==null){E.return=y,Et=E;break}Et=y}}}var A=a.alternate;if(A!==null){var N=A.child;if(N!==null){A.child=null;do{var D=N.sibling;N.sibling=null,N=D}while(N!==null)}}Et=a}}if(a.subtreeFlags&2064&&c!==null)c.return=a,Et=c;else e:for(;Et!==null;){if(a=Et,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ec(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Et=b;break e}Et=a.return}}var z=e.current;for(Et=z;Et!==null;){c=Et;var P=c.child;if(c.subtreeFlags&2064&&P!==null)P.return=c,Et=P;else e:for(c=z;Et!==null;){if(p=Et,p.flags&2048)try{switch(p.tag){case 0:case 11:case 15:Ld(9,p)}}catch(G){qn(p,p.return,G)}if(p===c){Et=null;break e}var W=p.sibling;if(W!==null){W.return=p.return,Et=W;break e}Et=p.return}}if(hn=o,go(),ai&&typeof ai.onPostCommitFiberRoot=="function")try{ai.onPostCommitFiberRoot($d,e)}catch{}i=!0}return i}finally{zn=r,Ss.transition=t}}return!1}function Cg(e,t,r){t=Va(r,t),t=ry(e,t,1),e=ao(e,t,1),t=Hr(),e!==null&&(jc(e,1,t),ts(e,t))}function qn(e,t,r){if(e.tag===3)Cg(e,e,r);else for(;t!==null;){if(t.tag===3){Cg(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(lo===null||!lo.has(i))){e=Va(r,e),e=sy(t,e,1),t=ao(t,e,1),e=Hr(),t!==null&&(jc(t,1,e),ts(t,e));break}}t=t.return}}function K2(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=Hr(),e.pingedLanes|=e.suspendedLanes&r,yr===e&&(Nr&r)===r&&(ur===4||ur===3&&(Nr&130023424)===Nr&&500>nr()-q0?Ro(e,0):Z0|=r),ts(e,t)}function jy(e,t){t===0&&(e.mode&1?(t=bu,bu<<=1,!(bu&130023424)&&(bu=4194304)):t=1);var r=Hr();e=Si(e,t),e!==null&&(jc(e,t,r),ts(e,r))}function Y2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),jy(e,r)}function G2(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Xe(314))}i!==null&&i.delete(t),jy(e,r)}var Ny;Ny=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qr.current)qr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return qr=!1,A2(e,t,r);qr=!!(e.flags&131072)}else qr=!1,Vn&&t.flags&1048576&&Ib(t,fd,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ju(e,t),e=t.pendingProps;var o=Fa(t,Tr.current);Oa(t,r),o=V0(null,t,i,e,o,r);var a=K0();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,es(i)?(a=!0,dd(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,U0(t),o.updater=Od,t.stateNode=o,o._reactInternals=t,Vf(t,i,e,r),t=Gf(null,t,i,!0,a,r)):(t.tag=0,Vn&&a&&T0(t),Wr(null,t,o,r),t=t.child),t;case 16:i=t.elementType;e:{switch(Ju(e,t),e=t.pendingProps,o=i._init,i=o(i._payload),t.type=i,o=t.tag=J2(i),e=Bs(i,e),o){case 0:t=Yf(null,t,i,e,r);break e;case 1:t=bg(null,t,i,e,r);break e;case 11:t=gg(null,t,i,e,r);break e;case 14:t=xg(null,t,i,Bs(i.type,e),r);break e}throw Error(Xe(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Bs(i,o),Yf(e,t,i,o,r);case 1:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Bs(i,o),bg(e,t,i,o,r);case 3:e:{if(ly(t),e===null)throw Error(Xe(387));i=t.pendingProps,a=t.memoizedState,o=a.element,Ab(e,t),gd(t,i,null,r);var c=t.memoizedState;if(i=c.element,a.isDehydrated)if(a={element:i,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Va(Error(Xe(423)),t),t=yg(e,t,i,r,o);break e}else if(i!==o){o=Va(Error(Xe(424)),t),t=yg(e,t,i,r,o);break e}else for(ps=oo(t.stateNode.containerInfo.firstChild),fs=t,Vn=!0,Hs=null,r=Tb(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ba(),i===o){t=Ci(e,t,r);break e}Wr(e,t,i,r)}t=t.child}return t;case 5:return Rb(t),e===null&&Bf(t),i=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,c=o.children,Df(i,o)?c=null:a!==null&&Df(i,a)&&(t.flags|=32),ay(e,t),Wr(e,t,c,r),t.child;case 6:return e===null&&Bf(t),null;case 13:return cy(e,t,r);case 4:return F0(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Wa(t,null,i,r):Wr(e,t,i,r),t.child;case 11:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Bs(i,o),gg(e,t,i,o,r);case 7:return Wr(e,t,t.pendingProps,r),t.child;case 8:return Wr(e,t,t.pendingProps.children,r),t.child;case 12:return Wr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,a=t.memoizedProps,c=o.value,Pn(hd,i._currentValue),i._currentValue=c,a!==null)if(Ys(a.value,c)){if(a.children===o.children&&!Qr.current){t=Ci(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var p=a.dependencies;if(p!==null){c=a.child;for(var m=p.firstContext;m!==null;){if(m.context===i){if(a.tag===1){m=ji(-1,r&-r),m.tag=2;var w=a.updateQueue;if(w!==null){w=w.shared;var $=w.pending;$===null?m.next=m:(m.next=$.next,$.next=m),w.pending=m}}a.lanes|=r,m=a.alternate,m!==null&&(m.lanes|=r),Wf(a.return,r,t),p.lanes|=r;break}m=m.next}}else if(a.tag===10)c=a.type===t.type?null:a.child;else if(a.tag===18){if(c=a.return,c===null)throw Error(Xe(341));c.lanes|=r,p=c.alternate,p!==null&&(p.lanes|=r),Wf(c,r,t),c=a.sibling}else c=a.child;if(c!==null)c.return=a;else for(c=a;c!==null;){if(c===t){c=null;break}if(a=c.sibling,a!==null){a.return=c.return,c=a;break}c=c.return}a=c}Wr(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,Oa(t,r),o=Cs(o),i=i(o),t.flags|=1,Wr(e,t,i,r),t.child;case 14:return i=t.type,o=Bs(i,t.pendingProps),o=Bs(i.type,o),xg(e,t,i,o,r);case 15:return iy(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Bs(i,o),Ju(e,t),t.tag=1,es(i)?(e=!0,dd(t)):e=!1,Oa(t,r),ny(t,i,o),Vf(t,i,o,r),Gf(null,t,i,!0,e,r);case 19:return uy(e,t,r);case 22:return oy(e,t,r)}throw Error(Xe(156,t.tag))};function _y(e,t){return Qx(e,t)}function X2(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _s(e,t,r,i){return new X2(e,t,r,i)}function nh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function J2(e){if(typeof e=="function")return nh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===w0)return 11;if(e===k0)return 14}return 2}function uo(e,t){var r=e.alternate;return r===null?(r=_s(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Qu(e,t,r,i,o,a){var c=2;if(i=e,typeof e=="function")nh(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case za:return Do(r.children,o,a,t);case v0:c=8,o|=8;break;case mf:return e=_s(12,r,t,o|2),e.elementType=mf,e.lanes=a,e;case gf:return e=_s(13,r,t,o),e.elementType=gf,e.lanes=a,e;case xf:return e=_s(19,r,t,o),e.elementType=xf,e.lanes=a,e;case Rx:return Fd(r,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Px:c=10;break e;case Ax:c=9;break e;case w0:c=11;break e;case k0:c=14;break e;case Zi:c=16,i=null;break e}throw Error(Xe(130,e==null?e:typeof e,""))}return t=_s(c,r,t,o),t.elementType=e,t.type=i,t.lanes=a,t}function Do(e,t,r,i){return e=_s(7,e,i,t),e.lanes=r,e}function Fd(e,t,r,i){return e=_s(22,e,i,t),e.elementType=Rx,e.lanes=r,e.stateNode={isHidden:!1},e}function Zp(e,t,r){return e=_s(6,e,null,t),e.lanes=r,e}function qp(e,t,r){return t=_s(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Z2(e,t,r,i,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mp(0),this.expirationTimes=Mp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mp(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function rh(e,t,r,i,o,a,c,p,m){return e=new Z2(e,t,r,p,m),t===1?(t=1,a===!0&&(t|=8)):t=0,a=_s(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},U0(a),e}function q2(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ka,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function Sy(e){if(!e)return fo;e=e._reactInternals;e:{if(Ko(e)!==e||e.tag!==1)throw Error(Xe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(es(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Xe(171))}if(e.tag===1){var r=e.type;if(es(r))return Sb(e,r,t)}return t}function Cy(e,t,r,i,o,a,c,p,m){return e=rh(r,i,!0,e,o,a,c,p,m),e.context=Sy(null),r=e.current,i=Hr(),o=co(r),a=ji(i,o),a.callback=t??null,ao(r,a,o),e.current.lanes=o,jc(e,o,i),ts(e,i),e}function Bd(e,t,r,i){var o=t.current,a=Hr(),c=co(o);return r=Sy(r),t.context===null?t.context=r:t.pendingContext=r,t=ji(a,c),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=ao(o,t,c),e!==null&&(Ks(e,o,c,a),Yu(e,o,c)),c}function jd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ig(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function sh(e,t){Ig(e,t),(e=e.alternate)&&Ig(e,t)}function Q2(){return null}var Iy=typeof reportError=="function"?reportError:function(e){console.error(e)};function ih(e){this._internalRoot=e}Wd.prototype.render=ih.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Xe(409));Bd(e,t,null,null)};Wd.prototype.unmount=ih.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bo(function(){Bd(null,e,null,null)}),t[_i]=null}};function Wd(e){this._internalRoot=e}Wd.prototype.unstable_scheduleHydration=function(e){if(e){var t=ob();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Qi.length&&t!==0&&t<Qi[r].priority;r++);Qi.splice(r,0,e),r===0&&lb(e)}};function oh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Eg(){}function ek(e,t,r,i,o){if(o){if(typeof i=="function"){var a=i;i=function(){var w=jd(c);a.call(w)}}var c=Cy(t,i,e,0,null,!1,!1,"",Eg);return e._reactRootContainer=c,e[_i]=c.current,hc(e.nodeType===8?e.parentNode:e),Bo(),c}for(;o=e.lastChild;)e.removeChild(o);if(typeof i=="function"){var p=i;i=function(){var w=jd(m);p.call(w)}}var m=rh(e,0,!1,null,null,!1,!1,"",Eg);return e._reactRootContainer=m,e[_i]=m.current,hc(e.nodeType===8?e.parentNode:e),Bo(function(){Bd(t,m,r,i)}),m}function Vd(e,t,r,i,o){var a=r._reactRootContainer;if(a){var c=a;if(typeof o=="function"){var p=o;o=function(){var m=jd(c);p.call(m)}}Bd(t,c,e,o)}else c=ek(r,t,e,o,i);return jd(c)}sb=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Wl(t.pendingLanes);r!==0&&(N0(t,r|1),ts(t,nr()),!(hn&6)&&(Ka=nr()+500,go()))}break;case 13:Bo(function(){var i=Si(e,1);if(i!==null){var o=Hr();Ks(i,e,1,o)}}),sh(e,1)}};_0=function(e){if(e.tag===13){var t=Si(e,134217728);if(t!==null){var r=Hr();Ks(t,e,134217728,r)}sh(e,134217728)}};ib=function(e){if(e.tag===13){var t=co(e),r=Si(e,t);if(r!==null){var i=Hr();Ks(r,e,t,i)}sh(e,t)}};ob=function(){return zn};ab=function(e,t){var r=zn;try{return zn=e,t()}finally{zn=r}};Sf=function(e,t,r){switch(t){case"input":if(vf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var o=Ad(i);if(!o)throw Error(Xe(90));Ox(i),vf(i,o)}}}break;case"textarea":Ux(e,r);break;case"select":t=r.value,t!=null&&Pa(e,!!r.multiple,t,!1)}};Yx=Q0;Gx=Bo;var tk={usingClientEntryPoint:!1,Events:[_c,Sa,Ad,Vx,Kx,Q0]},El={findFiberByHostInstance:To,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nk={bundleType:El.bundleType,version:El.version,rendererPackageName:El.rendererPackageName,rendererConfig:El.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ii.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zx(e),e===null?null:e.stateNode},findFiberByHostInstance:El.findFiberByHostInstance||Q2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Iu.isDisabled&&Iu.supportsFiber)try{$d=Iu.inject(nk),ai=Iu}catch{}}ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tk;ms.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oh(t))throw Error(Xe(200));return q2(e,t,null,r)};ms.createRoot=function(e,t){if(!oh(e))throw Error(Xe(299));var r=!1,i="",o=Iy;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=rh(e,1,!1,null,null,r,!1,i,o),e[_i]=t.current,hc(e.nodeType===8?e.parentNode:e),new ih(t)};ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Xe(188)):(e=Object.keys(e).join(","),Error(Xe(268,e)));return e=Zx(t),e=e===null?null:e.stateNode,e};ms.flushSync=function(e){return Bo(e)};ms.hydrate=function(e,t,r){if(!Hd(t))throw Error(Xe(200));return Vd(null,e,t,!0,r)};ms.hydrateRoot=function(e,t,r){if(!oh(e))throw Error(Xe(405));var i=r!=null&&r.hydratedSources||null,o=!1,a="",c=Iy;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(c=r.onRecoverableError)),t=Cy(t,null,e,1,r??null,o,!1,a,c),e[_i]=t.current,hc(e),i)for(e=0;e<i.length;e++)r=i[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new Wd(t)};ms.render=function(e,t,r){if(!Hd(t))throw Error(Xe(200));return Vd(null,e,t,!1,r)};ms.unmountComponentAtNode=function(e){if(!Hd(e))throw Error(Xe(40));return e._reactRootContainer?(Bo(function(){Vd(null,null,e,!1,function(){e._reactRootContainer=null,e[_i]=null})}),!0):!1};ms.unstable_batchedUpdates=Q0;ms.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!Hd(r))throw Error(Xe(200));if(e==null||e._reactInternals===void 0)throw Error(Xe(38));return Vd(e,t,r,!1,i)};ms.version="18.3.1-next-f1338f8080-20240426";function Ey(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ey)}catch(e){console.error(e)}}Ey(),Ex.exports=ms;var Nd=Ex.exports,$g=Nd;ff.createRoot=$g.createRoot,ff.hydrateRoot=$g.hydrateRoot;function ah(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Yo=ah();function $y(e){Yo=e}const My=/[&<>"']/,rk=new RegExp(My.source,"g"),Ty=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,sk=new RegExp(Ty.source,"g"),ik={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Mg=e=>ik[e];function ds(e,t){if(t){if(My.test(e))return e.replace(rk,Mg)}else if(Ty.test(e))return e.replace(sk,Mg);return e}const ok=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function ak(e){return e.replace(ok,(t,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const lk=/(^|[^\[])\^/g;function Sn(e,t){let r=typeof e=="string"?e:e.source;t=t||"";const i={replace:(o,a)=>{let c=typeof a=="string"?a:a.source;return c=c.replace(lk,"$1"),r=r.replace(o,c),i},getRegex:()=>new RegExp(r,t)};return i}function Tg(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const rc={exec:()=>null};function Pg(e,t){const r=e.replace(/\|/g,(a,c,p)=>{let m=!1,w=c;for(;--w>=0&&p[w]==="\\";)m=!m;return m?"|":" |"}),i=r.split(/ \|/);let o=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),t)if(i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;o<i.length;o++)i[o]=i[o].trim().replace(/\\\|/g,"|");return i}function Eu(e,t,r){const i=e.length;if(i===0)return"";let o=0;for(;o<i&&e.charAt(i-o-1)===t;)o++;return e.slice(0,i-o)}function ck(e,t){if(e.indexOf(t[1])===-1)return-1;let r=0;for(let i=0;i<e.length;i++)if(e[i]==="\\")i++;else if(e[i]===t[0])r++;else if(e[i]===t[1]&&(r--,r<0))return i;return-1}function Ag(e,t,r,i){const o=t.href,a=t.title?ds(t.title):null,c=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){i.state.inLink=!0;const p={type:"link",raw:r,href:o,title:a,text:c,tokens:i.inlineTokens(c)};return i.state.inLink=!1,p}return{type:"image",raw:r,href:o,title:a,text:ds(c)}}function uk(e,t){const r=e.match(/^(\s+)(?:```)/);if(r===null)return t;const i=r[1];return t.split(`
`).map(o=>{const a=o.match(/^\s+/);if(a===null)return o;const[c]=a;return c.length>=i.length?o.slice(i.length):o}).join(`
`)}class _d{constructor(t){On(this,"options");On(this,"rules");On(this,"lexer");this.options=t||Yo}space(t){const r=this.rules.block.newline.exec(t);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(t){const r=this.rules.block.code.exec(t);if(r){const i=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Eu(i,`
`)}}}fences(t){const r=this.rules.block.fences.exec(t);if(r){const i=r[0],o=uk(i,r[3]||"");return{type:"code",raw:i,lang:r[2]?r[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):r[2],text:o}}}heading(t){const r=this.rules.block.heading.exec(t);if(r){let i=r[2].trim();if(/#$/.test(i)){const o=Eu(i,"#");(this.options.pedantic||!o||/ $/.test(o))&&(i=o.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(t){const r=this.rules.block.hr.exec(t);if(r)return{type:"hr",raw:r[0]}}blockquote(t){const r=this.rules.block.blockquote.exec(t);if(r){let i=r[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);i=Eu(i.replace(/^ *>[ \t]?/gm,""),`
`);const o=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(i);return this.lexer.state.top=o,{type:"blockquote",raw:r[0],tokens:a,text:i}}}list(t){let r=this.rules.block.list.exec(t);if(r){let i=r[1].trim();const o=i.length>1,a={type:"list",raw:"",ordered:o,start:o?+i.slice(0,-1):"",loose:!1,items:[]};i=o?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=o?i:"[*+-]");const c=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let p="",m="",w=!1;for(;t;){let $=!1;if(!(r=c.exec(t))||this.rules.block.hr.test(t))break;p=r[0],t=t.substring(p.length);let T=r[2].split(`
`,1)[0].replace(/^\t+/,b=>" ".repeat(3*b.length)),E=t.split(`
`,1)[0],y=0;this.options.pedantic?(y=2,m=T.trimStart()):(y=r[2].search(/[^ ]/),y=y>4?1:y,m=T.slice(y),y+=r[1].length);let A=!1;if(!T&&/^ *$/.test(E)&&(p+=E+`
`,t=t.substring(E.length+1),$=!0),!$){const b=new RegExp(`^ {0,${Math.min(3,y-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),z=new RegExp(`^ {0,${Math.min(3,y-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),P=new RegExp(`^ {0,${Math.min(3,y-1)}}(?:\`\`\`|~~~)`),W=new RegExp(`^ {0,${Math.min(3,y-1)}}#`);for(;t;){const G=t.split(`
`,1)[0];if(E=G,this.options.pedantic&&(E=E.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),P.test(E)||W.test(E)||b.test(E)||z.test(t))break;if(E.search(/[^ ]/)>=y||!E.trim())m+=`
`+E.slice(y);else{if(A||T.search(/[^ ]/)>=4||P.test(T)||W.test(T)||z.test(T))break;m+=`
`+E}!A&&!E.trim()&&(A=!0),p+=G+`
`,t=t.substring(G.length+1),T=E.slice(y)}}a.loose||(w?a.loose=!0:/\n *\n *$/.test(p)&&(w=!0));let N=null,D;this.options.gfm&&(N=/^\[[ xX]\] /.exec(m),N&&(D=N[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:p,task:!!N,checked:D,loose:!1,text:m,tokens:[]}),a.raw+=p}a.items[a.items.length-1].raw=p.trimEnd(),a.items[a.items.length-1].text=m.trimEnd(),a.raw=a.raw.trimEnd();for(let $=0;$<a.items.length;$++)if(this.lexer.state.top=!1,a.items[$].tokens=this.lexer.blockTokens(a.items[$].text,[]),!a.loose){const T=a.items[$].tokens.filter(y=>y.type==="space"),E=T.length>0&&T.some(y=>/\n.*\n/.test(y.raw));a.loose=E}if(a.loose)for(let $=0;$<a.items.length;$++)a.items[$].loose=!0;return a}}html(t){const r=this.rules.block.html.exec(t);if(r)return{type:"html",block:!0,raw:r[0],pre:r[1]==="pre"||r[1]==="script"||r[1]==="style",text:r[0]}}def(t){const r=this.rules.block.def.exec(t);if(r){const i=r[1].toLowerCase().replace(/\s+/g," "),o=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):r[3];return{type:"def",tag:i,raw:r[0],href:o,title:a}}}table(t){const r=this.rules.block.table.exec(t);if(!r||!/[:|]/.test(r[2]))return;const i=Pg(r[1]),o=r[2].replace(/^\||\| *$/g,"").split("|"),a=r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[],c={type:"table",raw:r[0],header:[],align:[],rows:[]};if(i.length===o.length){for(const p of o)/^ *-+: *$/.test(p)?c.align.push("right"):/^ *:-+: *$/.test(p)?c.align.push("center"):/^ *:-+ *$/.test(p)?c.align.push("left"):c.align.push(null);for(const p of i)c.header.push({text:p,tokens:this.lexer.inline(p)});for(const p of a)c.rows.push(Pg(p,c.header.length).map(m=>({text:m,tokens:this.lexer.inline(m)})));return c}}lheading(t){const r=this.rules.block.lheading.exec(t);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(t){const r=this.rules.block.paragraph.exec(t);if(r){const i=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:i,tokens:this.lexer.inline(i)}}}text(t){const r=this.rules.block.text.exec(t);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(t){const r=this.rules.inline.escape.exec(t);if(r)return{type:"escape",raw:r[0],text:ds(r[1])}}tag(t){const r=this.rules.inline.tag.exec(t);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:r[0]}}link(t){const r=this.rules.inline.link.exec(t);if(r){const i=r[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const c=Eu(i.slice(0,-1),"\\");if((i.length-c.length)%2===0)return}else{const c=ck(r[2],"()");if(c>-1){const m=(r[0].indexOf("!")===0?5:4)+r[1].length+c;r[2]=r[2].substring(0,c),r[0]=r[0].substring(0,m).trim(),r[3]=""}}let o=r[2],a="";if(this.options.pedantic){const c=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);c&&(o=c[1],a=c[3])}else a=r[3]?r[3].slice(1,-1):"";return o=o.trim(),/^</.test(o)&&(this.options.pedantic&&!/>$/.test(i)?o=o.slice(1):o=o.slice(1,-1)),Ag(r,{href:o&&o.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},r[0],this.lexer)}}reflink(t,r){let i;if((i=this.rules.inline.reflink.exec(t))||(i=this.rules.inline.nolink.exec(t))){const o=(i[2]||i[1]).replace(/\s+/g," "),a=r[o.toLowerCase()];if(!a){const c=i[0].charAt(0);return{type:"text",raw:c,text:c}}return Ag(i,a,i[0],this.lexer)}}emStrong(t,r,i=""){let o=this.rules.inline.emStrongLDelim.exec(t);if(!o||o[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(o[1]||o[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const c=[...o[0]].length-1;let p,m,w=c,$=0;const T=o[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(T.lastIndex=0,r=r.slice(-1*t.length+c);(o=T.exec(r))!=null;){if(p=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!p)continue;if(m=[...p].length,o[3]||o[4]){w+=m;continue}else if((o[5]||o[6])&&c%3&&!((c+m)%3)){$+=m;continue}if(w-=m,w>0)continue;m=Math.min(m,m+w+$);const E=[...o[0]][0].length,y=t.slice(0,c+o.index+E+m);if(Math.min(c,m)%2){const N=y.slice(1,-1);return{type:"em",raw:y,text:N,tokens:this.lexer.inlineTokens(N)}}const A=y.slice(2,-2);return{type:"strong",raw:y,text:A,tokens:this.lexer.inlineTokens(A)}}}}codespan(t){const r=this.rules.inline.code.exec(t);if(r){let i=r[2].replace(/\n/g," ");const o=/[^ ]/.test(i),a=/^ /.test(i)&&/ $/.test(i);return o&&a&&(i=i.substring(1,i.length-1)),i=ds(i,!0),{type:"codespan",raw:r[0],text:i}}}br(t){const r=this.rules.inline.br.exec(t);if(r)return{type:"br",raw:r[0]}}del(t){const r=this.rules.inline.del.exec(t);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(t){const r=this.rules.inline.autolink.exec(t);if(r){let i,o;return r[2]==="@"?(i=ds(r[1]),o="mailto:"+i):(i=ds(r[1]),o=i),{type:"link",raw:r[0],text:i,href:o,tokens:[{type:"text",raw:i,text:i}]}}}url(t){var i;let r;if(r=this.rules.inline.url.exec(t)){let o,a;if(r[2]==="@")o=ds(r[0]),a="mailto:"+o;else{let c;do c=r[0],r[0]=((i=this.rules.inline._backpedal.exec(r[0]))==null?void 0:i[0])??"";while(c!==r[0]);o=ds(r[0]),r[1]==="www."?a="http://"+r[0]:a=r[0]}return{type:"link",raw:r[0],text:o,href:a,tokens:[{type:"text",raw:o,text:o}]}}}inlineText(t){const r=this.rules.inline.text.exec(t);if(r){let i;return this.lexer.state.inRawBlock?i=r[0]:i=ds(r[0]),{type:"text",raw:r[0],text:i}}}}const dk=/^(?: *(?:\n|$))+/,pk=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fk=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Cc=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,hk=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Py=/(?:[*+-]|\d{1,9}[.)])/,Ay=Sn(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Py).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),lh=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,mk=/^[^\n]+/,ch=/(?!\s*\])(?:\\.|[^\[\]\\])+/,gk=Sn(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ch).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),xk=Sn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Py).getRegex(),Kd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",uh=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,bk=Sn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",uh).replace("tag",Kd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ry=Sn(lh).replace("hr",Cc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kd).getRegex(),yk=Sn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ry).getRegex(),dh={blockquote:yk,code:pk,def:gk,fences:fk,heading:hk,hr:Cc,html:bk,lheading:Ay,list:xk,newline:dk,paragraph:Ry,table:rc,text:mk},Rg=Sn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Cc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kd).getRegex(),vk={...dh,table:Rg,paragraph:Sn(lh).replace("hr",Cc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Rg).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kd).getRegex()},wk={...dh,html:Sn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",uh).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:rc,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Sn(lh).replace("hr",Cc).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ay).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Dy=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,kk=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Oy=/^( {2,}|\\)\n(?!\s*$)/,zk=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ic="\\p{P}\\p{S}",jk=Sn(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Ic).getRegex(),Nk=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,_k=Sn(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Ic).getRegex(),Sk=Sn("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Ic).getRegex(),Ck=Sn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Ic).getRegex(),Ik=Sn(/\\([punct])/,"gu").replace(/punct/g,Ic).getRegex(),Ek=Sn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),$k=Sn(uh).replace("(?:-->|$)","-->").getRegex(),Mk=Sn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",$k).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Sd=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Tk=Sn(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Sd).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ly=Sn(/^!?\[(label)\]\[(ref)\]/).replace("label",Sd).replace("ref",ch).getRegex(),Uy=Sn(/^!?\[(ref)\](?:\[\])?/).replace("ref",ch).getRegex(),Pk=Sn("reflink|nolink(?!\\()","g").replace("reflink",Ly).replace("nolink",Uy).getRegex(),ph={_backpedal:rc,anyPunctuation:Ik,autolink:Ek,blockSkip:Nk,br:Oy,code:kk,del:rc,emStrongLDelim:_k,emStrongRDelimAst:Sk,emStrongRDelimUnd:Ck,escape:Dy,link:Tk,nolink:Uy,punctuation:jk,reflink:Ly,reflinkSearch:Pk,tag:Mk,text:zk,url:rc},Ak={...ph,link:Sn(/^!?\[(label)\]\((.*?)\)/).replace("label",Sd).getRegex(),reflink:Sn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Sd).getRegex()},o0={...ph,escape:Sn(Dy).replace("])","~|])").getRegex(),url:Sn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Rk={...o0,br:Sn(Oy).replace("{2,}","*").getRegex(),text:Sn(o0.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},$u={normal:dh,gfm:vk,pedantic:wk},$l={normal:ph,gfm:o0,breaks:Rk,pedantic:Ak};class ii{constructor(t){On(this,"tokens");On(this,"options");On(this,"state");On(this,"tokenizer");On(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Yo,this.options.tokenizer=this.options.tokenizer||new _d,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:$u.normal,inline:$l.normal};this.options.pedantic?(r.block=$u.pedantic,r.inline=$l.pedantic):this.options.gfm&&(r.block=$u.gfm,this.options.breaks?r.inline=$l.breaks:r.inline=$l.gfm),this.tokenizer.rules=r}static get rules(){return{block:$u,inline:$l}}static lex(t,r){return new ii(r).lex(t)}static lexInline(t,r){return new ii(r).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){const i=this.inlineQueue[r];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,r=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(p,m,w)=>m+"    ".repeat(w.length));let i,o,a,c;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(p=>(i=p.call({lexer:this},t,r))?(t=t.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.space(t)){t=t.substring(i.raw.length),i.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(i);continue}if(i=this.tokenizer.code(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+i.raw,o.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(i);continue}if(i=this.tokenizer.fences(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.heading(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.hr(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.blockquote(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.list(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.html(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.def(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+i.raw,o.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.lheading(t)){t=t.substring(i.raw.length),r.push(i);continue}if(a=t,this.options.extensions&&this.options.extensions.startBlock){let p=1/0;const m=t.slice(1);let w;this.options.extensions.startBlock.forEach($=>{w=$.call({lexer:this},m),typeof w=="number"&&w>=0&&(p=Math.min(p,w))}),p<1/0&&p>=0&&(a=t.substring(0,p+1))}if(this.state.top&&(i=this.tokenizer.paragraph(a))){o=r[r.length-1],c&&o.type==="paragraph"?(o.raw+=`
`+i.raw,o.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(i),c=a.length!==t.length,t=t.substring(i.raw.length);continue}if(i=this.tokenizer.text(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&o.type==="text"?(o.raw+=`
`+i.raw,o.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(i);continue}if(t){const p="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let i,o,a,c=t,p,m,w;if(this.tokens.links){const $=Object.keys(this.tokens.links);if($.length>0)for(;(p=this.tokenizer.rules.inline.reflinkSearch.exec(c))!=null;)$.includes(p[0].slice(p[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,p.index)+"["+"a".repeat(p[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(p=this.tokenizer.rules.inline.blockSkip.exec(c))!=null;)c=c.slice(0,p.index)+"["+"a".repeat(p[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(p=this.tokenizer.rules.inline.anyPunctuation.exec(c))!=null;)c=c.slice(0,p.index)+"++"+c.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(m||(w=""),m=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some($=>(i=$.call({lexer:this},t,r))?(t=t.substring(i.raw.length),r.push(i),!0):!1))){if(i=this.tokenizer.escape(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.tag(t)){t=t.substring(i.raw.length),o=r[r.length-1],o&&i.type==="text"&&o.type==="text"?(o.raw+=i.raw,o.text+=i.text):r.push(i);continue}if(i=this.tokenizer.link(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(i.raw.length),o=r[r.length-1],o&&i.type==="text"&&o.type==="text"?(o.raw+=i.raw,o.text+=i.text):r.push(i);continue}if(i=this.tokenizer.emStrong(t,c,w)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.codespan(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.br(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.del(t)){t=t.substring(i.raw.length),r.push(i);continue}if(i=this.tokenizer.autolink(t)){t=t.substring(i.raw.length),r.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(t))){t=t.substring(i.raw.length),r.push(i);continue}if(a=t,this.options.extensions&&this.options.extensions.startInline){let $=1/0;const T=t.slice(1);let E;this.options.extensions.startInline.forEach(y=>{E=y.call({lexer:this},T),typeof E=="number"&&E>=0&&($=Math.min($,E))}),$<1/0&&$>=0&&(a=t.substring(0,$+1))}if(i=this.tokenizer.inlineText(a)){t=t.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(w=i.raw.slice(-1)),m=!0,o=r[r.length-1],o&&o.type==="text"?(o.raw+=i.raw,o.text+=i.text):r.push(i);continue}if(t){const $="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error($);break}else throw new Error($)}}return r}}class Cd{constructor(t){On(this,"options");this.options=t||Yo}code(t,r,i){var a;const o=(a=(r||"").match(/^\S*/))==null?void 0:a[0];return t=t.replace(/\n$/,"")+`
`,o?'<pre><code class="language-'+ds(o)+'">'+(i?t:ds(t,!0))+`</code></pre>
`:"<pre><code>"+(i?t:ds(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t,r){return t}heading(t,r,i){return`<h${r}>${t}</h${r}>
`}hr(){return`<hr>
`}list(t,r,i){const o=r?"ol":"ul",a=r&&i!==1?' start="'+i+'"':"";return"<"+o+a+`>
`+t+"</"+o+`>
`}listitem(t,r,i){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(t){return`<p>${t}</p>
`}table(t,r){return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,r){const i=r.header?"th":"td";return(r.align?`<${i} align="${r.align}">`:`<${i}>`)+t+`</${i}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return"<br>"}del(t){return`<del>${t}</del>`}link(t,r,i){const o=Tg(t);if(o===null)return i;t=o;let a='<a href="'+t+'"';return r&&(a+=' title="'+r+'"'),a+=">"+i+"</a>",a}image(t,r,i){const o=Tg(t);if(o===null)return i;t=o;let a=`<img src="${t}" alt="${i}"`;return r&&(a+=` title="${r}"`),a+=">",a}text(t){return t}}class fh{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,r,i){return""+i}image(t,r,i){return""+i}br(){return""}}class oi{constructor(t){On(this,"options");On(this,"renderer");On(this,"textRenderer");this.options=t||Yo,this.options.renderer=this.options.renderer||new Cd,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new fh}static parse(t,r){return new oi(r).parse(t)}static parseInline(t,r){return new oi(r).parseInline(t)}parse(t,r=!0){let i="";for(let o=0;o<t.length;o++){const a=t[o];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const c=a,p=this.options.extensions.renderers[c.type].call({parser:this},c);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){i+=p||"";continue}}switch(a.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{const c=a;i+=this.renderer.heading(this.parseInline(c.tokens),c.depth,ak(this.parseInline(c.tokens,this.textRenderer)));continue}case"code":{const c=a;i+=this.renderer.code(c.text,c.lang,!!c.escaped);continue}case"table":{const c=a;let p="",m="";for(let $=0;$<c.header.length;$++)m+=this.renderer.tablecell(this.parseInline(c.header[$].tokens),{header:!0,align:c.align[$]});p+=this.renderer.tablerow(m);let w="";for(let $=0;$<c.rows.length;$++){const T=c.rows[$];m="";for(let E=0;E<T.length;E++)m+=this.renderer.tablecell(this.parseInline(T[E].tokens),{header:!1,align:c.align[E]});w+=this.renderer.tablerow(m)}i+=this.renderer.table(p,w);continue}case"blockquote":{const c=a,p=this.parse(c.tokens);i+=this.renderer.blockquote(p);continue}case"list":{const c=a,p=c.ordered,m=c.start,w=c.loose;let $="";for(let T=0;T<c.items.length;T++){const E=c.items[T],y=E.checked,A=E.task;let N="";if(E.task){const D=this.renderer.checkbox(!!y);w?E.tokens.length>0&&E.tokens[0].type==="paragraph"?(E.tokens[0].text=D+" "+E.tokens[0].text,E.tokens[0].tokens&&E.tokens[0].tokens.length>0&&E.tokens[0].tokens[0].type==="text"&&(E.tokens[0].tokens[0].text=D+" "+E.tokens[0].tokens[0].text)):E.tokens.unshift({type:"text",text:D+" "}):N+=D+" "}N+=this.parse(E.tokens,w),$+=this.renderer.listitem(N,A,!!y)}i+=this.renderer.list($,p,m);continue}case"html":{const c=a;i+=this.renderer.html(c.text,c.block);continue}case"paragraph":{const c=a;i+=this.renderer.paragraph(this.parseInline(c.tokens));continue}case"text":{let c=a,p=c.tokens?this.parseInline(c.tokens):c.text;for(;o+1<t.length&&t[o+1].type==="text";)c=t[++o],p+=`
`+(c.tokens?this.parseInline(c.tokens):c.text);i+=r?this.renderer.paragraph(p):p;continue}default:{const c='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return i}parseInline(t,r){r=r||this.renderer;let i="";for(let o=0;o<t.length;o++){const a=t[o];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){i+=c||"";continue}}switch(a.type){case"escape":{const c=a;i+=r.text(c.text);break}case"html":{const c=a;i+=r.html(c.text);break}case"link":{const c=a;i+=r.link(c.href,c.title,this.parseInline(c.tokens,r));break}case"image":{const c=a;i+=r.image(c.href,c.title,c.text);break}case"strong":{const c=a;i+=r.strong(this.parseInline(c.tokens,r));break}case"em":{const c=a;i+=r.em(this.parseInline(c.tokens,r));break}case"codespan":{const c=a;i+=r.codespan(c.text);break}case"br":{i+=r.br();break}case"del":{const c=a;i+=r.del(this.parseInline(c.tokens,r));break}case"text":{const c=a;i+=r.text(c.text);break}default:{const c='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return i}}class sc{constructor(t){On(this,"options");this.options=t||Yo}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}}On(sc,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Ho,a0,Fy;class Dk{constructor(...t){km(this,Ho);On(this,"defaults",ah());On(this,"options",this.setOptions);On(this,"parse",pu(this,Ho,a0).call(this,ii.lex,oi.parse));On(this,"parseInline",pu(this,Ho,a0).call(this,ii.lexInline,oi.parseInline));On(this,"Parser",oi);On(this,"Renderer",Cd);On(this,"TextRenderer",fh);On(this,"Lexer",ii);On(this,"Tokenizer",_d);On(this,"Hooks",sc);this.use(...t)}walkTokens(t,r){var o,a;let i=[];for(const c of t)switch(i=i.concat(r.call(this,c)),c.type){case"table":{const p=c;for(const m of p.header)i=i.concat(this.walkTokens(m.tokens,r));for(const m of p.rows)for(const w of m)i=i.concat(this.walkTokens(w.tokens,r));break}case"list":{const p=c;i=i.concat(this.walkTokens(p.items,r));break}default:{const p=c;(a=(o=this.defaults.extensions)==null?void 0:o.childTokens)!=null&&a[p.type]?this.defaults.extensions.childTokens[p.type].forEach(m=>{const w=p[m].flat(1/0);i=i.concat(this.walkTokens(w,r))}):p.tokens&&(i=i.concat(this.walkTokens(p.tokens,r)))}}return i}use(...t){const r=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(i=>{const o={...i};if(o.async=this.defaults.async||o.async||!1,i.extensions&&(i.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const c=r.renderers[a.name];c?r.renderers[a.name]=function(...p){let m=a.renderer.apply(this,p);return m===!1&&(m=c.apply(this,p)),m}:r.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const c=r[a.level];c?c.unshift(a.tokenizer):r[a.level]=[a.tokenizer],a.start&&(a.level==="block"?r.startBlock?r.startBlock.push(a.start):r.startBlock=[a.start]:a.level==="inline"&&(r.startInline?r.startInline.push(a.start):r.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(r.childTokens[a.name]=a.childTokens)}),o.extensions=r),i.renderer){const a=this.defaults.renderer||new Cd(this.defaults);for(const c in i.renderer){if(!(c in a))throw new Error(`renderer '${c}' does not exist`);if(c==="options")continue;const p=c,m=i.renderer[p],w=a[p];a[p]=(...$)=>{let T=m.apply(a,$);return T===!1&&(T=w.apply(a,$)),T||""}}o.renderer=a}if(i.tokenizer){const a=this.defaults.tokenizer||new _d(this.defaults);for(const c in i.tokenizer){if(!(c in a))throw new Error(`tokenizer '${c}' does not exist`);if(["options","rules","lexer"].includes(c))continue;const p=c,m=i.tokenizer[p],w=a[p];a[p]=(...$)=>{let T=m.apply(a,$);return T===!1&&(T=w.apply(a,$)),T}}o.tokenizer=a}if(i.hooks){const a=this.defaults.hooks||new sc;for(const c in i.hooks){if(!(c in a))throw new Error(`hook '${c}' does not exist`);if(c==="options")continue;const p=c,m=i.hooks[p],w=a[p];sc.passThroughHooks.has(c)?a[p]=$=>{if(this.defaults.async)return Promise.resolve(m.call(a,$)).then(E=>w.call(a,E));const T=m.call(a,$);return w.call(a,T)}:a[p]=(...$)=>{let T=m.apply(a,$);return T===!1&&(T=w.apply(a,$)),T}}o.hooks=a}if(i.walkTokens){const a=this.defaults.walkTokens,c=i.walkTokens;o.walkTokens=function(p){let m=[];return m.push(c.call(this,p)),a&&(m=m.concat(a.call(this,p))),m}}this.defaults={...this.defaults,...o}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,r){return ii.lex(t,r??this.defaults)}parser(t,r){return oi.parse(t,r??this.defaults)}}Ho=new WeakSet,a0=function(t,r){return(i,o)=>{const a={...o},c={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(c.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),c.async=!0);const p=pu(this,Ho,Fy).call(this,!!c.silent,!!c.async);if(typeof i>"u"||i===null)return p(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return p(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(c.hooks&&(c.hooks.options=c),c.async)return Promise.resolve(c.hooks?c.hooks.preprocess(i):i).then(m=>t(m,c)).then(m=>c.hooks?c.hooks.processAllTokens(m):m).then(m=>c.walkTokens?Promise.all(this.walkTokens(m,c.walkTokens)).then(()=>m):m).then(m=>r(m,c)).then(m=>c.hooks?c.hooks.postprocess(m):m).catch(p);try{c.hooks&&(i=c.hooks.preprocess(i));let m=t(i,c);c.hooks&&(m=c.hooks.processAllTokens(m)),c.walkTokens&&this.walkTokens(m,c.walkTokens);let w=r(m,c);return c.hooks&&(w=c.hooks.postprocess(w)),w}catch(m){return p(m)}}},Fy=function(t,r){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const o="<p>An error occurred:</p><pre>"+ds(i.message+"",!0)+"</pre>";return r?Promise.resolve(o):o}if(r)return Promise.reject(i);throw i}};const Wo=new Dk;function kn(e,t){return Wo.parse(e,t)}kn.options=kn.setOptions=function(e){return Wo.setOptions(e),kn.defaults=Wo.defaults,$y(kn.defaults),kn};kn.getDefaults=ah;kn.defaults=Yo;kn.use=function(...e){return Wo.use(...e),kn.defaults=Wo.defaults,$y(kn.defaults),kn};kn.walkTokens=function(e,t){return Wo.walkTokens(e,t)};kn.parseInline=Wo.parseInline;kn.Parser=oi;kn.parser=oi.parse;kn.Renderer=Cd;kn.TextRenderer=fh;kn.Lexer=ii;kn.lexer=ii.lex;kn.Tokenizer=_d;kn.Hooks=sc;kn.parse=kn;kn.options;kn.setOptions;kn.use;kn.walkTokens;kn.parseInline;oi.parse;ii.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:By,setPrototypeOf:Dg,isFrozen:Ok,getPrototypeOf:Lk,getOwnPropertyDescriptor:Uk}=Object;let{freeze:Vr,seal:Es,create:l0}=Object,{apply:c0,construct:u0}=typeof Reflect<"u"&&Reflect;Vr||(Vr=function(t){return t});Es||(Es=function(t){return t});c0||(c0=function(t,r){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return t.apply(r,o)});u0||(u0=function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return new t(...i)});const Mu=Kr(Array.prototype.forEach),Fk=Kr(Array.prototype.lastIndexOf),Og=Kr(Array.prototype.pop),Ml=Kr(Array.prototype.push),Bk=Kr(Array.prototype.splice),ed=Kr(String.prototype.toLowerCase),Qp=Kr(String.prototype.toString),ef=Kr(String.prototype.match),Tl=Kr(String.prototype.replace),Wk=Kr(String.prototype.indexOf),Hk=Kr(String.prototype.trim),Fs=Kr(Object.prototype.hasOwnProperty),Ur=Kr(RegExp.prototype.test),Pl=Vk(TypeError);function Kr(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return c0(e,t,i)}}function Vk(e){return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return u0(e,r)}}function ln(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ed;Dg&&Dg(e,null);let i=t.length;for(;i--;){let o=t[i];if(typeof o=="string"){const a=r(o);a!==o&&(Ok(t)||(t[i]=a),o=a)}e[o]=!0}return e}function Kk(e){for(let t=0;t<e.length;t++)Fs(e,t)||(e[t]=null);return e}function ni(e){const t=l0(null);for(const[r,i]of By(e))Fs(e,r)&&(Array.isArray(i)?t[r]=Kk(i):i&&typeof i=="object"&&i.constructor===Object?t[r]=ni(i):t[r]=i);return t}function Al(e,t){for(;e!==null;){const i=Uk(e,t);if(i){if(i.get)return Kr(i.get);if(typeof i.value=="function")return Kr(i.value)}e=Lk(e)}function r(){return null}return r}const Lg=Vr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),tf=Vr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nf=Vr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Yk=Vr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),rf=Vr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Gk=Vr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ug=Vr(["#text"]),Fg=Vr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),sf=Vr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Bg=Vr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Tu=Vr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Xk=Es(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Jk=Es(/<%[\w\W]*|[\w\W]*%>/gm),Zk=Es(/\$\{[\w\W]*/gm),qk=Es(/^data-[\-\w.\u00B7-\uFFFF]+$/),Qk=Es(/^aria-[\-\w]+$/),Wy=Es(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ez=Es(/^(?:\w+script|data):/i),tz=Es(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Hy=Es(/^html$/i),nz=Es(/^[a-z][.\w]*(-[.\w]+)+$/i);var Wg=Object.freeze({__proto__:null,ARIA_ATTR:Qk,ATTR_WHITESPACE:tz,CUSTOM_ELEMENT:nz,DATA_ATTR:qk,DOCTYPE_NAME:Hy,ERB_EXPR:Jk,IS_ALLOWED_URI:Wy,IS_SCRIPT_OR_DATA:ez,MUSTACHE_EXPR:Xk,TMPLIT_EXPR:Zk});const Rl={element:1,text:3,progressingInstruction:7,comment:8,document:9},rz=function(){return typeof window>"u"?null:window},sz=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let i=null;const o="data-tt-policy-suffix";r&&r.hasAttribute(o)&&(i=r.getAttribute(o));const a="dompurify"+(i?"#"+i:"");try{return t.createPolicy(a,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Hg=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Vy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rz();const t=Ft=>Vy(Ft);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==Rl.document||!e.Element)return t.isSupported=!1,t;let{document:r}=e;const i=r,o=i.currentScript,{DocumentFragment:a,HTMLTemplateElement:c,Node:p,Element:m,NodeFilter:w,NamedNodeMap:$=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:T,DOMParser:E,trustedTypes:y}=e,A=m.prototype,N=Al(A,"cloneNode"),D=Al(A,"remove"),b=Al(A,"nextSibling"),z=Al(A,"childNodes"),P=Al(A,"parentNode");if(typeof c=="function"){const Ft=r.createElement("template");Ft.content&&Ft.content.ownerDocument&&(r=Ft.content.ownerDocument)}let W,G="";const{implementation:oe,createNodeIterator:se,createDocumentFragment:ye,getElementsByTagName:we}=r,{importNode:Se}=i;let Ke=Hg();t.isSupported=typeof By=="function"&&typeof P=="function"&&oe&&oe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:_e,TMPLIT_EXPR:I,DATA_ATTR:je,ARIA_ATTR:ht,IS_SCRIPT_OR_DATA:ke,ATTR_WHITESPACE:ve,CUSTOM_ELEMENT:me}=Wg;let{IS_ALLOWED_URI:Re}=Wg,ce=null;const fe=ln({},[...Lg,...tf,...nf,...rf,...Ug]);let ct=null;const it=ln({},[...Fg,...sf,...Bg,...Tu]);let Fe=Object.seal(l0(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),on=null,Cn=null;const Xt=Object.seal(l0(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let cn=!0,En=!0,$t=!1,dr=!0,Qn=!1,k=!0,Ne=!1,ue=!1,K=!1,H=!1,ae=!1,Me=!1,Be=!0,be=!1;const Ze="user-content-";let dt=!0,Ye=!1,_t={},rn=null;const Qt=ln({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let vr=null;const Gs=ln({},["audio","video","img","source","image","track"]);let ir=null;const Xs=ln({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),jn="http://www.w3.org/1998/Math/MathML",$s="http://www.w3.org/2000/svg",Pr="http://www.w3.org/1999/xhtml";let or=Pr,Ei=!1,pr=null;const xo=ln({},[jn,$s,Pr],Qp);let $i=ln({},["mi","mo","mn","ms","mtext"]),Ms=ln({},["annotation-xml"]);const Js=ln({},["title","style","font","a","script"]);let Ar=null;const bo=["application/xhtml+xml","text/html"],er="text/html";let Zn=null,wr=null;const Yd=r.createElement("form"),In=function(ee){return ee instanceof RegExp||ee instanceof Function},Ja=function(){let ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wr&&wr===ee)){if((!ee||typeof ee!="object")&&(ee={}),ee=ni(ee),Ar=bo.indexOf(ee.PARSER_MEDIA_TYPE)===-1?er:ee.PARSER_MEDIA_TYPE,Zn=Ar==="application/xhtml+xml"?Qp:ed,ce=Fs(ee,"ALLOWED_TAGS")?ln({},ee.ALLOWED_TAGS,Zn):fe,ct=Fs(ee,"ALLOWED_ATTR")?ln({},ee.ALLOWED_ATTR,Zn):it,pr=Fs(ee,"ALLOWED_NAMESPACES")?ln({},ee.ALLOWED_NAMESPACES,Qp):xo,ir=Fs(ee,"ADD_URI_SAFE_ATTR")?ln(ni(Xs),ee.ADD_URI_SAFE_ATTR,Zn):Xs,vr=Fs(ee,"ADD_DATA_URI_TAGS")?ln(ni(Gs),ee.ADD_DATA_URI_TAGS,Zn):Gs,rn=Fs(ee,"FORBID_CONTENTS")?ln({},ee.FORBID_CONTENTS,Zn):Qt,on=Fs(ee,"FORBID_TAGS")?ln({},ee.FORBID_TAGS,Zn):ni({}),Cn=Fs(ee,"FORBID_ATTR")?ln({},ee.FORBID_ATTR,Zn):ni({}),_t=Fs(ee,"USE_PROFILES")?ee.USE_PROFILES:!1,cn=ee.ALLOW_ARIA_ATTR!==!1,En=ee.ALLOW_DATA_ATTR!==!1,$t=ee.ALLOW_UNKNOWN_PROTOCOLS||!1,dr=ee.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Qn=ee.SAFE_FOR_TEMPLATES||!1,k=ee.SAFE_FOR_XML!==!1,Ne=ee.WHOLE_DOCUMENT||!1,H=ee.RETURN_DOM||!1,ae=ee.RETURN_DOM_FRAGMENT||!1,Me=ee.RETURN_TRUSTED_TYPE||!1,K=ee.FORCE_BODY||!1,Be=ee.SANITIZE_DOM!==!1,be=ee.SANITIZE_NAMED_PROPS||!1,dt=ee.KEEP_CONTENT!==!1,Ye=ee.IN_PLACE||!1,Re=ee.ALLOWED_URI_REGEXP||Wy,or=ee.NAMESPACE||Pr,$i=ee.MATHML_TEXT_INTEGRATION_POINTS||$i,Ms=ee.HTML_INTEGRATION_POINTS||Ms,Fe=ee.CUSTOM_ELEMENT_HANDLING||{},ee.CUSTOM_ELEMENT_HANDLING&&In(ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Fe.tagNameCheck=ee.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ee.CUSTOM_ELEMENT_HANDLING&&In(ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Fe.attributeNameCheck=ee.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ee.CUSTOM_ELEMENT_HANDLING&&typeof ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Fe.allowCustomizedBuiltInElements=ee.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Qn&&(En=!1),ae&&(H=!0),_t&&(ce=ln({},Ug),ct=[],_t.html===!0&&(ln(ce,Lg),ln(ct,Fg)),_t.svg===!0&&(ln(ce,tf),ln(ct,sf),ln(ct,Tu)),_t.svgFilters===!0&&(ln(ce,nf),ln(ct,sf),ln(ct,Tu)),_t.mathMl===!0&&(ln(ce,rf),ln(ct,Bg),ln(ct,Tu))),ee.ADD_TAGS&&(typeof ee.ADD_TAGS=="function"?Xt.tagCheck=ee.ADD_TAGS:(ce===fe&&(ce=ni(ce)),ln(ce,ee.ADD_TAGS,Zn))),ee.ADD_ATTR&&(typeof ee.ADD_ATTR=="function"?Xt.attributeCheck=ee.ADD_ATTR:(ct===it&&(ct=ni(ct)),ln(ct,ee.ADD_ATTR,Zn))),ee.ADD_URI_SAFE_ATTR&&ln(ir,ee.ADD_URI_SAFE_ATTR,Zn),ee.FORBID_CONTENTS&&(rn===Qt&&(rn=ni(rn)),ln(rn,ee.FORBID_CONTENTS,Zn)),ee.ADD_FORBID_CONTENTS&&(rn===Qt&&(rn=ni(rn)),ln(rn,ee.ADD_FORBID_CONTENTS,Zn)),dt&&(ce["#text"]=!0),Ne&&ln(ce,["html","head","body"]),ce.table&&(ln(ce,["tbody"]),delete on.tbody),ee.TRUSTED_TYPES_POLICY){if(typeof ee.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pl('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ee.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pl('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');W=ee.TRUSTED_TYPES_POLICY,G=W.createHTML("")}else W===void 0&&(W=sz(y,o)),W!==null&&typeof G=="string"&&(G=W.createHTML(""));Vr&&Vr(ee),wr=ee}},fn=ln({},[...tf,...nf,...Yk]),Go=ln({},[...rf,...Gk]),Rr=function(ee){let qe=P(ee);(!qe||!qe.tagName)&&(qe={namespaceURI:or,tagName:"template"});const Mt=ed(ee.tagName),an=ed(qe.tagName);return pr[ee.namespaceURI]?ee.namespaceURI===$s?qe.namespaceURI===Pr?Mt==="svg":qe.namespaceURI===jn?Mt==="svg"&&(an==="annotation-xml"||$i[an]):!!fn[Mt]:ee.namespaceURI===jn?qe.namespaceURI===Pr?Mt==="math":qe.namespaceURI===$s?Mt==="math"&&Ms[an]:!!Go[Mt]:ee.namespaceURI===Pr?qe.namespaceURI===$s&&!Ms[an]||qe.namespaceURI===jn&&!$i[an]?!1:!Go[Mt]&&(Js[Mt]||!fn[Mt]):!!(Ar==="application/xhtml+xml"&&pr[ee.namespaceURI]):!1},kr=function(ee){Ml(t.removed,{element:ee});try{P(ee).removeChild(ee)}catch{D(ee)}},Dr=function(ee,qe){try{Ml(t.removed,{attribute:qe.getAttributeNode(ee),from:qe})}catch{Ml(t.removed,{attribute:null,from:qe})}if(qe.removeAttribute(ee),ee==="is")if(H||ae)try{kr(qe)}catch{}else try{qe.setAttribute(ee,"")}catch{}},ci=function(ee){let qe=null,Mt=null;if(K)ee="<remove></remove>"+ee;else{const bn=ef(ee,/^[\r\n\t ]+/);Mt=bn&&bn[0]}Ar==="application/xhtml+xml"&&or===Pr&&(ee='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ee+"</body></html>");const an=W?W.createHTML(ee):ee;if(or===Pr)try{qe=new E().parseFromString(an,Ar)}catch{}if(!qe||!qe.documentElement){qe=oe.createDocument(or,"template",null);try{qe.documentElement.innerHTML=Ei?G:an}catch{}}const Fn=qe.body||qe.documentElement;return ee&&Mt&&Fn.insertBefore(r.createTextNode(Mt),Fn.childNodes[0]||null),or===Pr?we.call(qe,Ne?"html":"body")[0]:Ne?qe.documentElement:Fn},Xo=function(ee){return se.call(ee.ownerDocument||ee,ee,w.SHOW_ELEMENT|w.SHOW_COMMENT|w.SHOW_TEXT|w.SHOW_PROCESSING_INSTRUCTION|w.SHOW_CDATA_SECTION,null)},ns=function(ee){return ee instanceof T&&(typeof ee.nodeName!="string"||typeof ee.textContent!="string"||typeof ee.removeChild!="function"||!(ee.attributes instanceof $)||typeof ee.removeAttribute!="function"||typeof ee.setAttribute!="function"||typeof ee.namespaceURI!="string"||typeof ee.insertBefore!="function"||typeof ee.hasChildNodes!="function")},Pt=function(ee){return typeof p=="function"&&ee instanceof p};function St(Ft,ee,qe){Mu(Ft,Mt=>{Mt.call(t,ee,qe,wr)})}const yo=function(ee){let qe=null;if(St(Ke.beforeSanitizeElements,ee,null),ns(ee))return kr(ee),!0;const Mt=Zn(ee.nodeName);if(St(Ke.uponSanitizeElement,ee,{tagName:Mt,allowedTags:ce}),k&&ee.hasChildNodes()&&!Pt(ee.firstElementChild)&&Ur(/<[/\w!]/g,ee.innerHTML)&&Ur(/<[/\w!]/g,ee.textContent)||ee.nodeType===Rl.progressingInstruction||k&&ee.nodeType===Rl.comment&&Ur(/<[/\w]/g,ee.data))return kr(ee),!0;if(!(Xt.tagCheck instanceof Function&&Xt.tagCheck(Mt))&&(!ce[Mt]||on[Mt])){if(!on[Mt]&&fr(Mt)&&(Fe.tagNameCheck instanceof RegExp&&Ur(Fe.tagNameCheck,Mt)||Fe.tagNameCheck instanceof Function&&Fe.tagNameCheck(Mt)))return!1;if(dt&&!rn[Mt]){const an=P(ee)||ee.parentNode,Fn=z(ee)||ee.childNodes;if(Fn&&an){const bn=Fn.length;for(let rr=bn-1;rr>=0;--rr){const Sr=N(Fn[rr],!0);Sr.__removalCount=(ee.__removalCount||0)+1,an.insertBefore(Sr,b(ee))}}}return kr(ee),!0}return ee instanceof m&&!Rr(ee)||(Mt==="noscript"||Mt==="noembed"||Mt==="noframes")&&Ur(/<\/no(script|embed|frames)/i,ee.innerHTML)?(kr(ee),!0):(Qn&&ee.nodeType===Rl.text&&(qe=ee.textContent,Mu([X,_e,I],an=>{qe=Tl(qe,an," ")}),ee.textContent!==qe&&(Ml(t.removed,{element:ee.cloneNode()}),ee.textContent=qe)),St(Ke.afterSanitizeElements,ee,null),!1)},Mi=function(ee,qe,Mt){if(Be&&(qe==="id"||qe==="name")&&(Mt in r||Mt in Yd))return!1;if(!(En&&!Cn[qe]&&Ur(je,qe))){if(!(cn&&Ur(ht,qe))){if(!(Xt.attributeCheck instanceof Function&&Xt.attributeCheck(qe,ee))){if(!ct[qe]||Cn[qe]){if(!(fr(ee)&&(Fe.tagNameCheck instanceof RegExp&&Ur(Fe.tagNameCheck,ee)||Fe.tagNameCheck instanceof Function&&Fe.tagNameCheck(ee))&&(Fe.attributeNameCheck instanceof RegExp&&Ur(Fe.attributeNameCheck,qe)||Fe.attributeNameCheck instanceof Function&&Fe.attributeNameCheck(qe,ee))||qe==="is"&&Fe.allowCustomizedBuiltInElements&&(Fe.tagNameCheck instanceof RegExp&&Ur(Fe.tagNameCheck,Mt)||Fe.tagNameCheck instanceof Function&&Fe.tagNameCheck(Mt))))return!1}else if(!ir[qe]){if(!Ur(Re,Tl(Mt,ve,""))){if(!((qe==="src"||qe==="xlink:href"||qe==="href")&&ee!=="script"&&Wk(Mt,"data:")===0&&vr[ee])){if(!($t&&!Ur(ke,Tl(Mt,ve,"")))){if(Mt)return!1}}}}}}}return!0},fr=function(ee){return ee!=="annotation-xml"&&ef(ee,me)},hr=function(ee){St(Ke.beforeSanitizeAttributes,ee,null);const{attributes:qe}=ee;if(!qe||ns(ee))return;const Mt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ct,forceKeepAttr:void 0};let an=qe.length;for(;an--;){const Fn=qe[an],{name:bn,namespaceURI:rr,value:Sr}=Fn,ui=Zn(bn),di=Sr;let An=bn==="value"?di:Hk(di);if(Mt.attrName=ui,Mt.attrValue=An,Mt.keepAttr=!0,Mt.forceKeepAttr=void 0,St(Ke.uponSanitizeAttribute,ee,Mt),An=Mt.attrValue,be&&(ui==="id"||ui==="name")&&(Dr(bn,ee),An=Ze+An),k&&Ur(/((--!?|])>)|<\/(style|title|textarea)/i,An)){Dr(bn,ee);continue}if(ui==="attributename"&&ef(An,"href")){Dr(bn,ee);continue}if(Mt.forceKeepAttr)continue;if(!Mt.keepAttr){Dr(bn,ee);continue}if(!dr&&Ur(/\/>/i,An)){Dr(bn,ee);continue}Qn&&Mu([X,_e,I],$c=>{An=Tl(An,$c," ")});const Ec=Zn(ee.nodeName);if(!Mi(Ec,ui,An)){Dr(bn,ee);continue}if(W&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!rr)switch(y.getAttributeType(Ec,ui)){case"TrustedHTML":{An=W.createHTML(An);break}case"TrustedScriptURL":{An=W.createScriptURL(An);break}}if(An!==di)try{rr?ee.setAttributeNS(rr,bn,An):ee.setAttribute(bn,An),ns(ee)?kr(ee):Og(t.removed)}catch{Dr(bn,ee)}}St(Ke.afterSanitizeAttributes,ee,null)},Jo=function Ft(ee){let qe=null;const Mt=Xo(ee);for(St(Ke.beforeSanitizeShadowDOM,ee,null);qe=Mt.nextNode();)St(Ke.uponSanitizeShadowNode,qe,null),yo(qe),hr(qe),qe.content instanceof a&&Ft(qe.content);St(Ke.afterSanitizeShadowDOM,ee,null)};return t.sanitize=function(Ft){let ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},qe=null,Mt=null,an=null,Fn=null;if(Ei=!Ft,Ei&&(Ft="\x3C!-->"),typeof Ft!="string"&&!Pt(Ft))if(typeof Ft.toString=="function"){if(Ft=Ft.toString(),typeof Ft!="string")throw Pl("dirty is not a string, aborting")}else throw Pl("toString is not a function");if(!t.isSupported)return Ft;if(ue||Ja(ee),t.removed=[],typeof Ft=="string"&&(Ye=!1),Ye){if(Ft.nodeName){const Sr=Zn(Ft.nodeName);if(!ce[Sr]||on[Sr])throw Pl("root node is forbidden and cannot be sanitized in-place")}}else if(Ft instanceof p)qe=ci("\x3C!---->"),Mt=qe.ownerDocument.importNode(Ft,!0),Mt.nodeType===Rl.element&&Mt.nodeName==="BODY"||Mt.nodeName==="HTML"?qe=Mt:qe.appendChild(Mt);else{if(!H&&!Qn&&!Ne&&Ft.indexOf("<")===-1)return W&&Me?W.createHTML(Ft):Ft;if(qe=ci(Ft),!qe)return H?null:Me?G:""}qe&&K&&kr(qe.firstChild);const bn=Xo(Ye?Ft:qe);for(;an=bn.nextNode();)yo(an),hr(an),an.content instanceof a&&Jo(an.content);if(Ye)return Ft;if(H){if(ae)for(Fn=ye.call(qe.ownerDocument);qe.firstChild;)Fn.appendChild(qe.firstChild);else Fn=qe;return(ct.shadowroot||ct.shadowrootmode)&&(Fn=Se.call(i,Fn,!0)),Fn}let rr=Ne?qe.outerHTML:qe.innerHTML;return Ne&&ce["!doctype"]&&qe.ownerDocument&&qe.ownerDocument.doctype&&qe.ownerDocument.doctype.name&&Ur(Hy,qe.ownerDocument.doctype.name)&&(rr="<!DOCTYPE "+qe.ownerDocument.doctype.name+`>
`+rr),Qn&&Mu([X,_e,I],Sr=>{rr=Tl(rr,Sr," ")}),W&&Me?W.createHTML(rr):rr},t.setConfig=function(){let Ft=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ja(Ft),ue=!0},t.clearConfig=function(){wr=null,ue=!1},t.isValidAttribute=function(Ft,ee,qe){wr||Ja({});const Mt=Zn(Ft),an=Zn(ee);return Mi(Mt,an,qe)},t.addHook=function(Ft,ee){typeof ee=="function"&&Ml(Ke[Ft],ee)},t.removeHook=function(Ft,ee){if(ee!==void 0){const qe=Fk(Ke[Ft],ee);return qe===-1?void 0:Bk(Ke[Ft],qe,1)[0]}return Og(Ke[Ft])},t.removeHooks=function(Ft){Ke[Ft]=[]},t.removeAllHooks=function(){Ke=Hg()},t}var iz=Vy();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var oz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Nt=(e,t)=>{const r=R.forwardRef(({color:i="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:c,className:p="",children:m,...w},$)=>R.createElement("svg",{ref:$,...oz,width:o,height:o,stroke:i,strokeWidth:c?Number(a)*24/Number(o):a,className:["lucide",`lucide-${az(e)}`,p].join(" "),...w},[...t.map(([T,E])=>R.createElement(T,E)),...Array.isArray(m)?m:[m]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=Nt("ArrowRightSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=Nt("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=Nt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=Nt("Brush",[["path",{d:"m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08",key:"1styjt"}],["path",{d:"M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z",key:"z0l1mu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=Nt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=Nt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=Nt("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=Nt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=Nt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=Nt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=Nt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=Nt("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=Nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=Nt("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=Nt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=Nt("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=Nt("CopyPlus",[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Nt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=Nt("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=Nt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=Nt("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=Nt("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=Nt("FileSearch",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"1vg67v"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Nt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=Nt("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=Nt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=Nt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=Nt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=Nt("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=Nt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=Nt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Nt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=Nt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=Nt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Nt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Nt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=Nt("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=Nt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=Nt("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=Nt("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=Nt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=Nt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=Nt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=Nt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=Nt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=Nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=Nt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=Nt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=Nt("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=Nt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=Nt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=Nt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=Nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=Nt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=Nt("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=Nt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=Nt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=Nt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=Nt("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=Nt("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=Nt("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=Nt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=Nt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=Nt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=Nt("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=Nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=Nt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Ou(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yy={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(i,o,a){function c(w,$){if(!o[w]){if(!i[w]){var T=typeof Ou=="function"&&Ou;if(!$&&T)return T(w,!0);if(p)return p(w,!0);var E=new Error("Cannot find module '"+w+"'");throw E.code="MODULE_NOT_FOUND",E}var y=o[w]={exports:{}};i[w][0].call(y.exports,function(A){var N=i[w][1][A];return c(N||A)},y,y.exports,r,i,o,a)}return o[w].exports}for(var p=typeof Ou=="function"&&Ou,m=0;m<a.length;m++)c(a[m]);return c}({1:[function(r,i,o){var a=r("./utils"),c=r("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(m){for(var w,$,T,E,y,A,N,D=[],b=0,z=m.length,P=z,W=a.getTypeOf(m)!=="string";b<m.length;)P=z-b,T=W?(w=m[b++],$=b<z?m[b++]:0,b<z?m[b++]:0):(w=m.charCodeAt(b++),$=b<z?m.charCodeAt(b++):0,b<z?m.charCodeAt(b++):0),E=w>>2,y=(3&w)<<4|$>>4,A=1<P?(15&$)<<2|T>>6:64,N=2<P?63&T:64,D.push(p.charAt(E)+p.charAt(y)+p.charAt(A)+p.charAt(N));return D.join("")},o.decode=function(m){var w,$,T,E,y,A,N=0,D=0,b="data:";if(m.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var z,P=3*(m=m.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(m.charAt(m.length-1)===p.charAt(64)&&P--,m.charAt(m.length-2)===p.charAt(64)&&P--,P%1!=0)throw new Error("Invalid base64 input, bad content length.");for(z=c.uint8array?new Uint8Array(0|P):new Array(0|P);N<m.length;)w=p.indexOf(m.charAt(N++))<<2|(E=p.indexOf(m.charAt(N++)))>>4,$=(15&E)<<4|(y=p.indexOf(m.charAt(N++)))>>2,T=(3&y)<<6|(A=p.indexOf(m.charAt(N++))),z[D++]=w,y!==64&&(z[D++]=$),A!==64&&(z[D++]=T);return z}},{"./support":30,"./utils":32}],2:[function(r,i,o){var a=r("./external"),c=r("./stream/DataWorker"),p=r("./stream/Crc32Probe"),m=r("./stream/DataLengthProbe");function w($,T,E,y,A){this.compressedSize=$,this.uncompressedSize=T,this.crc32=E,this.compression=y,this.compressedContent=A}w.prototype={getContentWorker:function(){var $=new c(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new m("data_length")),T=this;return $.on("end",function(){if(this.streamInfo.data_length!==T.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),$},getCompressedWorker:function(){return new c(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},w.createWorkerFrom=function($,T,E){return $.pipe(new p).pipe(new m("uncompressedSize")).pipe(T.compressWorker(E)).pipe(new m("compressedSize")).withStreamInfo("compression",T)},i.exports=w},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,i,o){var a=r("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},o.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,i,o){var a=r("./utils"),c=function(){for(var p,m=[],w=0;w<256;w++){p=w;for(var $=0;$<8;$++)p=1&p?3988292384^p>>>1:p>>>1;m[w]=p}return m}();i.exports=function(p,m){return p!==void 0&&p.length?a.getTypeOf(p)!=="string"?function(w,$,T,E){var y=c,A=E+T;w^=-1;for(var N=E;N<A;N++)w=w>>>8^y[255&(w^$[N])];return-1^w}(0|m,p,p.length,0):function(w,$,T,E){var y=c,A=E+T;w^=-1;for(var N=E;N<A;N++)w=w>>>8^y[255&(w^$.charCodeAt(N))];return-1^w}(0|m,p,p.length,0):0}},{"./utils":32}],5:[function(r,i,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(r,i,o){var a=null;a=typeof Promise<"u"?Promise:r("lie"),i.exports={Promise:a}},{lie:37}],7:[function(r,i,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=r("pako"),p=r("./utils"),m=r("./stream/GenericWorker"),w=a?"uint8array":"array";function $(T,E){m.call(this,"FlateWorker/"+T),this._pako=null,this._pakoAction=T,this._pakoOptions=E,this.meta={}}o.magic="\b\0",p.inherits($,m),$.prototype.processChunk=function(T){this.meta=T.meta,this._pako===null&&this._createPako(),this._pako.push(p.transformTo(w,T.data),!1)},$.prototype.flush=function(){m.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},$.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this._pako=null},$.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var T=this;this._pako.onData=function(E){T.push({data:E,meta:T.meta})}},o.compressWorker=function(T){return new $("Deflate",T)},o.uncompressWorker=function(){return new $("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,i,o){function a(y,A){var N,D="";for(N=0;N<A;N++)D+=String.fromCharCode(255&y),y>>>=8;return D}function c(y,A,N,D,b,z){var P,W,G=y.file,oe=y.compression,se=z!==w.utf8encode,ye=p.transformTo("string",z(G.name)),we=p.transformTo("string",w.utf8encode(G.name)),Se=G.comment,Ke=p.transformTo("string",z(Se)),X=p.transformTo("string",w.utf8encode(Se)),_e=we.length!==G.name.length,I=X.length!==Se.length,je="",ht="",ke="",ve=G.dir,me=G.date,Re={crc32:0,compressedSize:0,uncompressedSize:0};A&&!N||(Re.crc32=y.crc32,Re.compressedSize=y.compressedSize,Re.uncompressedSize=y.uncompressedSize);var ce=0;A&&(ce|=8),se||!_e&&!I||(ce|=2048);var fe=0,ct=0;ve&&(fe|=16),b==="UNIX"?(ct=798,fe|=function(Fe,on){var Cn=Fe;return Fe||(Cn=on?16893:33204),(65535&Cn)<<16}(G.unixPermissions,ve)):(ct=20,fe|=function(Fe){return 63&(Fe||0)}(G.dosPermissions)),P=me.getUTCHours(),P<<=6,P|=me.getUTCMinutes(),P<<=5,P|=me.getUTCSeconds()/2,W=me.getUTCFullYear()-1980,W<<=4,W|=me.getUTCMonth()+1,W<<=5,W|=me.getUTCDate(),_e&&(ht=a(1,1)+a($(ye),4)+we,je+="up"+a(ht.length,2)+ht),I&&(ke=a(1,1)+a($(Ke),4)+X,je+="uc"+a(ke.length,2)+ke);var it="";return it+=`
\0`,it+=a(ce,2),it+=oe.magic,it+=a(P,2),it+=a(W,2),it+=a(Re.crc32,4),it+=a(Re.compressedSize,4),it+=a(Re.uncompressedSize,4),it+=a(ye.length,2),it+=a(je.length,2),{fileRecord:T.LOCAL_FILE_HEADER+it+ye+je,dirRecord:T.CENTRAL_FILE_HEADER+a(ct,2)+it+a(Ke.length,2)+"\0\0\0\0"+a(fe,4)+a(D,4)+ye+je+Ke}}var p=r("../utils"),m=r("../stream/GenericWorker"),w=r("../utf8"),$=r("../crc32"),T=r("../signature");function E(y,A,N,D){m.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=A,this.zipPlatform=N,this.encodeFileName=D,this.streamFiles=y,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(E,m),E.prototype.push=function(y){var A=y.meta.percent||0,N=this.entriesCount,D=this._sources.length;this.accumulate?this.contentBuffer.push(y):(this.bytesWritten+=y.data.length,m.prototype.push.call(this,{data:y.data,meta:{currentFile:this.currentFile,percent:N?(A+100*(N-D-1))/N:100}}))},E.prototype.openedSource=function(y){this.currentSourceOffset=this.bytesWritten,this.currentFile=y.file.name;var A=this.streamFiles&&!y.file.dir;if(A){var N=c(y,A,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:N.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(y){this.accumulate=!1;var A=this.streamFiles&&!y.file.dir,N=c(y,A,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(N.dirRecord),A)this.push({data:function(D){return T.DATA_DESCRIPTOR+a(D.crc32,4)+a(D.compressedSize,4)+a(D.uncompressedSize,4)}(y),meta:{percent:100}});else for(this.push({data:N.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var y=this.bytesWritten,A=0;A<this.dirRecords.length;A++)this.push({data:this.dirRecords[A],meta:{percent:100}});var N=this.bytesWritten-y,D=function(b,z,P,W,G){var oe=p.transformTo("string",G(W));return T.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(b,2)+a(b,2)+a(z,4)+a(P,4)+a(oe.length,2)+oe}(this.dirRecords.length,N,y,this.zipComment,this.encodeFileName);this.push({data:D,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(y){this._sources.push(y);var A=this;return y.on("data",function(N){A.processChunk(N)}),y.on("end",function(){A.closedSource(A.previous.streamInfo),A._sources.length?A.prepareNextSource():A.end()}),y.on("error",function(N){A.error(N)}),this},E.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(y){var A=this._sources;if(!m.prototype.error.call(this,y))return!1;for(var N=0;N<A.length;N++)try{A[N].error(y)}catch{}return!0},E.prototype.lock=function(){m.prototype.lock.call(this);for(var y=this._sources,A=0;A<y.length;A++)y[A].lock()},i.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,i,o){var a=r("../compressions"),c=r("./ZipFileWorker");o.generateWorker=function(p,m,w){var $=new c(m.streamFiles,w,m.platform,m.encodeFileName),T=0;try{p.forEach(function(E,y){T++;var A=function(z,P){var W=z||P,G=a[W];if(!G)throw new Error(W+" is not a valid compression method !");return G}(y.options.compression,m.compression),N=y.options.compressionOptions||m.compressionOptions||{},D=y.dir,b=y.date;y._compressWorker(A,N).withStreamInfo("file",{name:E,dir:D,date:b,comment:y.comment||"",unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions}).pipe($)}),$.entriesCount=T}catch(E){$.error(E)}return $}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,i,o){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new a;for(var p in this)typeof this[p]!="function"&&(c[p]=this[p]);return c}}(a.prototype=r("./object")).loadAsync=r("./load"),a.support=r("./support"),a.defaults=r("./defaults"),a.version="3.10.1",a.loadAsync=function(c,p){return new a().loadAsync(c,p)},a.external=r("./external"),i.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,i,o){var a=r("./utils"),c=r("./external"),p=r("./utf8"),m=r("./zipEntries"),w=r("./stream/Crc32Probe"),$=r("./nodejsUtils");function T(E){return new c.Promise(function(y,A){var N=E.decompressed.getContentWorker().pipe(new w);N.on("error",function(D){A(D)}).on("end",function(){N.streamInfo.crc32!==E.decompressed.crc32?A(new Error("Corrupted zip : CRC32 mismatch")):y()}).resume()})}i.exports=function(E,y){var A=this;return y=a.extend(y||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),$.isNode&&$.isStream(E)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",E,!0,y.optimizedBinaryString,y.base64).then(function(N){var D=new m(y);return D.load(N),D}).then(function(N){var D=[c.Promise.resolve(N)],b=N.files;if(y.checkCRC32)for(var z=0;z<b.length;z++)D.push(T(b[z]));return c.Promise.all(D)}).then(function(N){for(var D=N.shift(),b=D.files,z=0;z<b.length;z++){var P=b[z],W=P.fileNameStr,G=a.resolve(P.fileNameStr);A.file(G,P.decompressed,{binary:!0,optimizedBinaryString:!0,date:P.date,dir:P.dir,comment:P.fileCommentStr.length?P.fileCommentStr:null,unixPermissions:P.unixPermissions,dosPermissions:P.dosPermissions,createFolders:y.createFolders}),P.dir||(A.file(G).unsafeOriginalName=W)}return D.zipComment.length&&(A.comment=D.zipComment),A})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,i,o){var a=r("../utils"),c=r("../stream/GenericWorker");function p(m,w){c.call(this,"Nodejs stream input adapter for "+m),this._upstreamEnded=!1,this._bindStream(w)}a.inherits(p,c),p.prototype._bindStream=function(m){var w=this;(this._stream=m).pause(),m.on("data",function($){w.push({data:$,meta:{percent:0}})}).on("error",function($){w.isPaused?this.generatedError=$:w.error($)}).on("end",function(){w.isPaused?w._upstreamEnded=!0:w.end()})},p.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,i,o){var a=r("readable-stream").Readable;function c(p,m,w){a.call(this,m),this._helper=p;var $=this;p.on("data",function(T,E){$.push(T)||$._helper.pause(),w&&w(E)}).on("error",function(T){$.emit("error",T)}).on("end",function(){$.push(null)})}r("../utils").inherits(c,a),c.prototype._read=function(){this._helper.resume()},i.exports=c},{"../utils":32,"readable-stream":16}],14:[function(r,i,o){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,c);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,c)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var c=new Buffer(a);return c.fill(0),c},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(r,i,o){function a(G,oe,se){var ye,we=p.getTypeOf(oe),Se=p.extend(se||{},$);Se.date=Se.date||new Date,Se.compression!==null&&(Se.compression=Se.compression.toUpperCase()),typeof Se.unixPermissions=="string"&&(Se.unixPermissions=parseInt(Se.unixPermissions,8)),Se.unixPermissions&&16384&Se.unixPermissions&&(Se.dir=!0),Se.dosPermissions&&16&Se.dosPermissions&&(Se.dir=!0),Se.dir&&(G=b(G)),Se.createFolders&&(ye=D(G))&&z.call(this,ye,!0);var Ke=we==="string"&&Se.binary===!1&&Se.base64===!1;se&&se.binary!==void 0||(Se.binary=!Ke),(oe instanceof T&&oe.uncompressedSize===0||Se.dir||!oe||oe.length===0)&&(Se.base64=!1,Se.binary=!0,oe="",Se.compression="STORE",we="string");var X=null;X=oe instanceof T||oe instanceof m?oe:A.isNode&&A.isStream(oe)?new N(G,oe):p.prepareContent(G,oe,Se.binary,Se.optimizedBinaryString,Se.base64);var _e=new E(G,X,Se);this.files[G]=_e}var c=r("./utf8"),p=r("./utils"),m=r("./stream/GenericWorker"),w=r("./stream/StreamHelper"),$=r("./defaults"),T=r("./compressedObject"),E=r("./zipObject"),y=r("./generate"),A=r("./nodejsUtils"),N=r("./nodejs/NodejsStreamInputAdapter"),D=function(G){G.slice(-1)==="/"&&(G=G.substring(0,G.length-1));var oe=G.lastIndexOf("/");return 0<oe?G.substring(0,oe):""},b=function(G){return G.slice(-1)!=="/"&&(G+="/"),G},z=function(G,oe){return oe=oe!==void 0?oe:$.createFolders,G=b(G),this.files[G]||a.call(this,G,null,{dir:!0,createFolders:oe}),this.files[G]};function P(G){return Object.prototype.toString.call(G)==="[object RegExp]"}var W={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(G){var oe,se,ye;for(oe in this.files)ye=this.files[oe],(se=oe.slice(this.root.length,oe.length))&&oe.slice(0,this.root.length)===this.root&&G(se,ye)},filter:function(G){var oe=[];return this.forEach(function(se,ye){G(se,ye)&&oe.push(ye)}),oe},file:function(G,oe,se){if(arguments.length!==1)return G=this.root+G,a.call(this,G,oe,se),this;if(P(G)){var ye=G;return this.filter(function(Se,Ke){return!Ke.dir&&ye.test(Se)})}var we=this.files[this.root+G];return we&&!we.dir?we:null},folder:function(G){if(!G)return this;if(P(G))return this.filter(function(we,Se){return Se.dir&&G.test(we)});var oe=this.root+G,se=z.call(this,oe),ye=this.clone();return ye.root=se.name,ye},remove:function(G){G=this.root+G;var oe=this.files[G];if(oe||(G.slice(-1)!=="/"&&(G+="/"),oe=this.files[G]),oe&&!oe.dir)delete this.files[G];else for(var se=this.filter(function(we,Se){return Se.name.slice(0,G.length)===G}),ye=0;ye<se.length;ye++)delete this.files[se[ye].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(G){var oe,se={};try{if((se=p.extend(G||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=se.type.toLowerCase(),se.compression=se.compression.toUpperCase(),se.type==="binarystring"&&(se.type="string"),!se.type)throw new Error("No output type specified.");p.checkSupport(se.type),se.platform!=="darwin"&&se.platform!=="freebsd"&&se.platform!=="linux"&&se.platform!=="sunos"||(se.platform="UNIX"),se.platform==="win32"&&(se.platform="DOS");var ye=se.comment||this.comment||"";oe=y.generateWorker(this,se,ye)}catch(we){(oe=new m("error")).error(we)}return new w(oe,se.type||"string",se.mimeType)},generateAsync:function(G,oe){return this.generateInternalStream(G).accumulate(oe)},generateNodeStream:function(G,oe){return(G=G||{}).type||(G.type="nodebuffer"),this.generateInternalStream(G).toNodejsStream(oe)}};i.exports=W},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,i,o){i.exports=r("stream")},{stream:void 0}],17:[function(r,i,o){var a=r("./DataReader");function c(p){a.call(this,p);for(var m=0;m<this.data.length;m++)p[m]=255&p[m]}r("../utils").inherits(c,a),c.prototype.byteAt=function(p){return this.data[this.zero+p]},c.prototype.lastIndexOfSignature=function(p){for(var m=p.charCodeAt(0),w=p.charCodeAt(1),$=p.charCodeAt(2),T=p.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===m&&this.data[E+1]===w&&this.data[E+2]===$&&this.data[E+3]===T)return E-this.zero;return-1},c.prototype.readAndCheckSignature=function(p){var m=p.charCodeAt(0),w=p.charCodeAt(1),$=p.charCodeAt(2),T=p.charCodeAt(3),E=this.readData(4);return m===E[0]&&w===E[1]&&$===E[2]&&T===E[3]},c.prototype.readData=function(p){if(this.checkOffset(p),p===0)return[];var m=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,m},i.exports=c},{"../utils":32,"./DataReader":18}],18:[function(r,i,o){var a=r("../utils");function c(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var m,w=0;for(this.checkOffset(p),m=this.index+p-1;m>=this.index;m--)w=(w<<8)+this.byteAt(m);return this.index+=p,w},readString:function(p){return a.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},i.exports=c},{"../utils":32}],19:[function(r,i,o){var a=r("./Uint8ArrayReader");function c(p){a.call(this,p)}r("../utils").inherits(c,a),c.prototype.readData=function(p){this.checkOffset(p);var m=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,m},i.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,i,o){var a=r("./DataReader");function c(p){a.call(this,p)}r("../utils").inherits(c,a),c.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},c.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},c.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},c.prototype.readData=function(p){this.checkOffset(p);var m=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,m},i.exports=c},{"../utils":32,"./DataReader":18}],21:[function(r,i,o){var a=r("./ArrayReader");function c(p){a.call(this,p)}r("../utils").inherits(c,a),c.prototype.readData=function(p){if(this.checkOffset(p),p===0)return new Uint8Array(0);var m=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,m},i.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(r,i,o){var a=r("../utils"),c=r("../support"),p=r("./ArrayReader"),m=r("./StringReader"),w=r("./NodeBufferReader"),$=r("./Uint8ArrayReader");i.exports=function(T){var E=a.getTypeOf(T);return a.checkSupport(E),E!=="string"||c.uint8array?E==="nodebuffer"?new w(T):c.uint8array?new $(a.transformTo("uint8array",T)):new p(a.transformTo("array",T)):new m(T)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,i,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,i,o){var a=r("./GenericWorker"),c=r("../utils");function p(m){a.call(this,"ConvertWorker to "+m),this.destType=m}c.inherits(p,a),p.prototype.processChunk=function(m){this.push({data:c.transformTo(this.destType,m.data),meta:m.meta})},i.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(r,i,o){var a=r("./GenericWorker"),c=r("../crc32");function p(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(p,a),p.prototype.processChunk=function(m){this.streamInfo.crc32=c(m.data,this.streamInfo.crc32||0),this.push(m)},i.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,i,o){var a=r("../utils"),c=r("./GenericWorker");function p(m){c.call(this,"DataLengthProbe for "+m),this.propName=m,this.withStreamInfo(m,0)}a.inherits(p,c),p.prototype.processChunk=function(m){if(m){var w=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=w+m.data.length}c.prototype.processChunk.call(this,m)},i.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(r,i,o){var a=r("../utils"),c=r("./GenericWorker");function p(m){c.call(this,"DataWorker");var w=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,m.then(function($){w.dataIsReady=!0,w.data=$,w.max=$&&$.length||0,w.type=a.getTypeOf($),w.isPaused||w._tickAndRepeat()},function($){w.error($)})}a.inherits(p,c),p.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var m=null,w=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,w);break;case"uint8array":m=this.data.subarray(this.index,w);break;case"array":case"nodebuffer":m=this.data.slice(this.index,w)}return this.index=w,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(r,i,o){function a(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,p){return this._listeners[c].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,p){if(this._listeners[c])for(var m=0;m<this._listeners[c].length;m++)this._listeners[c][m].call(this,p)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var p=this;return c.on("data",function(m){p.processChunk(m)}),c.on("end",function(){p.end()}),c.on("error",function(m){p.error(m)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,p){return this.extraStreamInfo[c]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},i.exports=a},{}],29:[function(r,i,o){var a=r("../utils"),c=r("./ConvertWorker"),p=r("./GenericWorker"),m=r("../base64"),w=r("../support"),$=r("../external"),T=null;if(w.nodestream)try{T=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(A,N){return new $.Promise(function(D,b){var z=[],P=A._internalType,W=A._outputType,G=A._mimeType;A.on("data",function(oe,se){z.push(oe),N&&N(se)}).on("error",function(oe){z=[],b(oe)}).on("end",function(){try{var oe=function(se,ye,we){switch(se){case"blob":return a.newBlob(a.transformTo("arraybuffer",ye),we);case"base64":return m.encode(ye);default:return a.transformTo(se,ye)}}(W,function(se,ye){var we,Se=0,Ke=null,X=0;for(we=0;we<ye.length;we++)X+=ye[we].length;switch(se){case"string":return ye.join("");case"array":return Array.prototype.concat.apply([],ye);case"uint8array":for(Ke=new Uint8Array(X),we=0;we<ye.length;we++)Ke.set(ye[we],Se),Se+=ye[we].length;return Ke;case"nodebuffer":return Buffer.concat(ye);default:throw new Error("concat : unsupported type '"+se+"'")}}(P,z),G);D(oe)}catch(se){b(se)}z=[]}).resume()})}function y(A,N,D){var b=N;switch(N){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=N,this._mimeType=D,a.checkSupport(b),this._worker=A.pipe(new c(b)),A.lock()}catch(z){this._worker=new p("error"),this._worker.error(z)}}y.prototype={accumulate:function(A){return E(this,A)},on:function(A,N){var D=this;return A==="data"?this._worker.on(A,function(b){N.call(D,b.data,b.meta)}):this._worker.on(A,function(){a.delay(N,arguments,D)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(A){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new T(this,{objectMode:this._outputType!=="nodebuffer"},A)}},i.exports=y},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,i,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var a=new ArrayBuffer(0);try{o.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(a),o.blob=c.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!r("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(r,i,o){for(var a=r("./utils"),c=r("./support"),p=r("./nodejsUtils"),m=r("./stream/GenericWorker"),w=new Array(256),$=0;$<256;$++)w[$]=252<=$?6:248<=$?5:240<=$?4:224<=$?3:192<=$?2:1;w[254]=w[254]=1;function T(){m.call(this,"utf-8 decode"),this.leftOver=null}function E(){m.call(this,"utf-8 encode")}o.utf8encode=function(y){return c.nodebuffer?p.newBufferFrom(y,"utf-8"):function(A){var N,D,b,z,P,W=A.length,G=0;for(z=0;z<W;z++)(64512&(D=A.charCodeAt(z)))==55296&&z+1<W&&(64512&(b=A.charCodeAt(z+1)))==56320&&(D=65536+(D-55296<<10)+(b-56320),z++),G+=D<128?1:D<2048?2:D<65536?3:4;for(N=c.uint8array?new Uint8Array(G):new Array(G),z=P=0;P<G;z++)(64512&(D=A.charCodeAt(z)))==55296&&z+1<W&&(64512&(b=A.charCodeAt(z+1)))==56320&&(D=65536+(D-55296<<10)+(b-56320),z++),D<128?N[P++]=D:(D<2048?N[P++]=192|D>>>6:(D<65536?N[P++]=224|D>>>12:(N[P++]=240|D>>>18,N[P++]=128|D>>>12&63),N[P++]=128|D>>>6&63),N[P++]=128|63&D);return N}(y)},o.utf8decode=function(y){return c.nodebuffer?a.transformTo("nodebuffer",y).toString("utf-8"):function(A){var N,D,b,z,P=A.length,W=new Array(2*P);for(N=D=0;N<P;)if((b=A[N++])<128)W[D++]=b;else if(4<(z=w[b]))W[D++]=65533,N+=z-1;else{for(b&=z===2?31:z===3?15:7;1<z&&N<P;)b=b<<6|63&A[N++],z--;1<z?W[D++]=65533:b<65536?W[D++]=b:(b-=65536,W[D++]=55296|b>>10&1023,W[D++]=56320|1023&b)}return W.length!==D&&(W.subarray?W=W.subarray(0,D):W.length=D),a.applyFromCharCode(W)}(y=a.transformTo(c.uint8array?"uint8array":"array",y))},a.inherits(T,m),T.prototype.processChunk=function(y){var A=a.transformTo(c.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var N=A;(A=new Uint8Array(N.length+this.leftOver.length)).set(this.leftOver,0),A.set(N,this.leftOver.length)}else A=this.leftOver.concat(A);this.leftOver=null}var D=function(z,P){var W;for((P=P||z.length)>z.length&&(P=z.length),W=P-1;0<=W&&(192&z[W])==128;)W--;return W<0||W===0?P:W+w[z[W]]>P?W:P}(A),b=A;D!==A.length&&(c.uint8array?(b=A.subarray(0,D),this.leftOver=A.subarray(D,A.length)):(b=A.slice(0,D),this.leftOver=A.slice(D,A.length))),this.push({data:o.utf8decode(b),meta:y.meta})},T.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=T,a.inherits(E,m),E.prototype.processChunk=function(y){this.push({data:o.utf8encode(y.data),meta:y.meta})},o.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,i,o){var a=r("./support"),c=r("./base64"),p=r("./nodejsUtils"),m=r("./external");function w(N){return N}function $(N,D){for(var b=0;b<N.length;++b)D[b]=255&N.charCodeAt(b);return D}r("setimmediate"),o.newBlob=function(N,D){o.checkSupport("blob");try{return new Blob([N],{type:D})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(N),b.getBlob(D)}catch{throw new Error("Bug : can't construct the Blob.")}}};var T={stringifyByChunk:function(N,D,b){var z=[],P=0,W=N.length;if(W<=b)return String.fromCharCode.apply(null,N);for(;P<W;)D==="array"||D==="nodebuffer"?z.push(String.fromCharCode.apply(null,N.slice(P,Math.min(P+b,W)))):z.push(String.fromCharCode.apply(null,N.subarray(P,Math.min(P+b,W)))),P+=b;return z.join("")},stringifyByChar:function(N){for(var D="",b=0;b<N.length;b++)D+=String.fromCharCode(N[b]);return D},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,p.allocBuffer(1)).length===1}catch{return!1}}()}};function E(N){var D=65536,b=o.getTypeOf(N),z=!0;if(b==="uint8array"?z=T.applyCanBeUsed.uint8array:b==="nodebuffer"&&(z=T.applyCanBeUsed.nodebuffer),z)for(;1<D;)try{return T.stringifyByChunk(N,b,D)}catch{D=Math.floor(D/2)}return T.stringifyByChar(N)}function y(N,D){for(var b=0;b<N.length;b++)D[b]=N[b];return D}o.applyFromCharCode=E;var A={};A.string={string:w,array:function(N){return $(N,new Array(N.length))},arraybuffer:function(N){return A.string.uint8array(N).buffer},uint8array:function(N){return $(N,new Uint8Array(N.length))},nodebuffer:function(N){return $(N,p.allocBuffer(N.length))}},A.array={string:E,array:w,arraybuffer:function(N){return new Uint8Array(N).buffer},uint8array:function(N){return new Uint8Array(N)},nodebuffer:function(N){return p.newBufferFrom(N)}},A.arraybuffer={string:function(N){return E(new Uint8Array(N))},array:function(N){return y(new Uint8Array(N),new Array(N.byteLength))},arraybuffer:w,uint8array:function(N){return new Uint8Array(N)},nodebuffer:function(N){return p.newBufferFrom(new Uint8Array(N))}},A.uint8array={string:E,array:function(N){return y(N,new Array(N.length))},arraybuffer:function(N){return N.buffer},uint8array:w,nodebuffer:function(N){return p.newBufferFrom(N)}},A.nodebuffer={string:E,array:function(N){return y(N,new Array(N.length))},arraybuffer:function(N){return A.nodebuffer.uint8array(N).buffer},uint8array:function(N){return y(N,new Uint8Array(N.length))},nodebuffer:w},o.transformTo=function(N,D){if(D=D||"",!N)return D;o.checkSupport(N);var b=o.getTypeOf(D);return A[b][N](D)},o.resolve=function(N){for(var D=N.split("/"),b=[],z=0;z<D.length;z++){var P=D[z];P==="."||P===""&&z!==0&&z!==D.length-1||(P===".."?b.pop():b.push(P))}return b.join("/")},o.getTypeOf=function(N){return typeof N=="string"?"string":Object.prototype.toString.call(N)==="[object Array]"?"array":a.nodebuffer&&p.isBuffer(N)?"nodebuffer":a.uint8array&&N instanceof Uint8Array?"uint8array":a.arraybuffer&&N instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(N){if(!a[N.toLowerCase()])throw new Error(N+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(N){var D,b,z="";for(b=0;b<(N||"").length;b++)z+="\\x"+((D=N.charCodeAt(b))<16?"0":"")+D.toString(16).toUpperCase();return z},o.delay=function(N,D,b){setImmediate(function(){N.apply(b||null,D||[])})},o.inherits=function(N,D){function b(){}b.prototype=D.prototype,N.prototype=new b},o.extend=function(){var N,D,b={};for(N=0;N<arguments.length;N++)for(D in arguments[N])Object.prototype.hasOwnProperty.call(arguments[N],D)&&b[D]===void 0&&(b[D]=arguments[N][D]);return b},o.prepareContent=function(N,D,b,z,P){return m.Promise.resolve(D).then(function(W){return a.blob&&(W instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(W))!==-1)&&typeof FileReader<"u"?new m.Promise(function(G,oe){var se=new FileReader;se.onload=function(ye){G(ye.target.result)},se.onerror=function(ye){oe(ye.target.error)},se.readAsArrayBuffer(W)}):W}).then(function(W){var G=o.getTypeOf(W);return G?(G==="arraybuffer"?W=o.transformTo("uint8array",W):G==="string"&&(P?W=c.decode(W):b&&z!==!0&&(W=function(oe){return $(oe,a.uint8array?new Uint8Array(oe.length):new Array(oe.length))}(W))),W):m.Promise.reject(new Error("Can't read the data of '"+N+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,i,o){var a=r("./reader/readerFor"),c=r("./utils"),p=r("./signature"),m=r("./zipEntry"),w=r("./support");function $(T){this.files=[],this.loadOptions=T}$.prototype={checkSignature:function(T){if(!this.reader.readAndCheckSignature(T)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(E)+", expected "+c.pretty(T)+")")}},isSignature:function(T,E){var y=this.reader.index;this.reader.setIndex(T);var A=this.reader.readString(4)===E;return this.reader.setIndex(y),A},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var T=this.reader.readData(this.zipCommentLength),E=w.uint8array?"uint8array":"array",y=c.transformTo(E,T);this.zipComment=this.loadOptions.decodeFileName(y)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var T,E,y,A=this.zip64EndOfCentralSize-44;0<A;)T=this.reader.readInt(2),E=this.reader.readInt(4),y=this.reader.readData(E),this.zip64ExtensibleData[T]={id:T,length:E,value:y}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var T,E;for(T=0;T<this.files.length;T++)E=this.files[T],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var T;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(T=new m({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(T);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var T=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(T<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(T);var E=T;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(T=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(T),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var y=this.centralDirOffset+this.centralDirSize;this.zip64&&(y+=20,y+=12+this.zip64EndOfCentralSize);var A=E-y;if(0<A)this.isSignature(E,p.CENTRAL_FILE_HEADER)||(this.reader.zero=A);else if(A<0)throw new Error("Corrupted zip: missing "+Math.abs(A)+" bytes.")},prepareReader:function(T){this.reader=a(T)},load:function(T){this.prepareReader(T),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=$},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,i,o){var a=r("./reader/readerFor"),c=r("./utils"),p=r("./compressedObject"),m=r("./crc32"),w=r("./utf8"),$=r("./compressions"),T=r("./support");function E(y,A){this.options=y,this.loadOptions=A}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(y){var A,N;if(y.skip(22),this.fileNameLength=y.readInt(2),N=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(N),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((A=function(D){for(var b in $)if(Object.prototype.hasOwnProperty.call($,b)&&$[b].magic===D)return $[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,A,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var A=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(A),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),y==0&&(this.dosPermissions=63&this.externalFileAttributes),y==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=a(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var A,N,D,b=y.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});y.index+4<b;)A=y.readInt(2),N=y.readInt(2),D=y.readData(N),this.extraFields[A]={id:A,length:N,value:D};y.setIndex(b)},handleUTF8:function(){var y=T.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=w.utf8decode(this.fileName),this.fileCommentStr=w.utf8decode(this.fileComment);else{var A=this.findExtraFieldUnicodePath();if(A!==null)this.fileNameStr=A;else{var N=c.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(N)}var D=this.findExtraFieldUnicodeComment();if(D!==null)this.fileCommentStr=D;else{var b=c.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var A=a(y.value);return A.readInt(1)!==1||m(this.fileName)!==A.readInt(4)?null:w.utf8decode(A.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var A=a(y.value);return A.readInt(1)!==1||m(this.fileComment)!==A.readInt(4)?null:w.utf8decode(A.readData(y.length-5))}return null}},i.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,i,o){function a(A,N,D){this.name=A,this.dir=D.dir,this.date=D.date,this.comment=D.comment,this.unixPermissions=D.unixPermissions,this.dosPermissions=D.dosPermissions,this._data=N,this._dataBinary=D.binary,this.options={compression:D.compression,compressionOptions:D.compressionOptions}}var c=r("./stream/StreamHelper"),p=r("./stream/DataWorker"),m=r("./utf8"),w=r("./compressedObject"),$=r("./stream/GenericWorker");a.prototype={internalStream:function(A){var N=null,D="string";try{if(!A)throw new Error("No output type specified.");var b=(D=A.toLowerCase())==="string"||D==="text";D!=="binarystring"&&D!=="text"||(D="string"),N=this._decompressWorker();var z=!this._dataBinary;z&&!b&&(N=N.pipe(new m.Utf8EncodeWorker)),!z&&b&&(N=N.pipe(new m.Utf8DecodeWorker))}catch(P){(N=new $("error")).error(P)}return new c(N,D,"")},async:function(A,N){return this.internalStream(A).accumulate(N)},nodeStream:function(A,N){return this.internalStream(A||"nodebuffer").toNodejsStream(N)},_compressWorker:function(A,N){if(this._data instanceof w&&this._data.compression.magic===A.magic)return this._data.getCompressedWorker();var D=this._decompressWorker();return this._dataBinary||(D=D.pipe(new m.Utf8EncodeWorker)),w.createWorkerFrom(D,A,N)},_decompressWorker:function(){return this._data instanceof w?this._data.getContentWorker():this._data instanceof $?this._data:new p(this._data)}};for(var T=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},y=0;y<T.length;y++)a.prototype[T[y]]=E;i.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,i,o){(function(a){var c,p,m=a.MutationObserver||a.WebKitMutationObserver;if(m){var w=0,$=new m(A),T=a.document.createTextNode("");$.observe(T,{characterData:!0}),c=function(){T.data=w=++w%2}}else if(a.setImmediate||a.MessageChannel===void 0)c="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var N=a.document.createElement("script");N.onreadystatechange=function(){A(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},a.document.documentElement.appendChild(N)}:function(){setTimeout(A,0)};else{var E=new a.MessageChannel;E.port1.onmessage=A,c=function(){E.port2.postMessage(0)}}var y=[];function A(){var N,D;p=!0;for(var b=y.length;b;){for(D=y,y=[],N=-1;++N<b;)D[N]();b=y.length}p=!1}i.exports=function(N){y.push(N)!==1||p||c()}}).call(this,typeof vi<"u"?vi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,i,o){var a=r("immediate");function c(){}var p={},m=["REJECTED"],w=["FULFILLED"],$=["PENDING"];function T(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=$,this.queue=[],this.outcome=void 0,b!==c&&N(this,b)}function E(b,z,P){this.promise=b,typeof z=="function"&&(this.onFulfilled=z,this.callFulfilled=this.otherCallFulfilled),typeof P=="function"&&(this.onRejected=P,this.callRejected=this.otherCallRejected)}function y(b,z,P){a(function(){var W;try{W=z(P)}catch(G){return p.reject(b,G)}W===b?p.reject(b,new TypeError("Cannot resolve promise with itself")):p.resolve(b,W)})}function A(b){var z=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof z=="function")return function(){z.apply(b,arguments)}}function N(b,z){var P=!1;function W(se){P||(P=!0,p.reject(b,se))}function G(se){P||(P=!0,p.resolve(b,se))}var oe=D(function(){z(G,W)});oe.status==="error"&&W(oe.value)}function D(b,z){var P={};try{P.value=b(z),P.status="success"}catch(W){P.status="error",P.value=W}return P}(i.exports=T).prototype.finally=function(b){if(typeof b!="function")return this;var z=this.constructor;return this.then(function(P){return z.resolve(b()).then(function(){return P})},function(P){return z.resolve(b()).then(function(){throw P})})},T.prototype.catch=function(b){return this.then(null,b)},T.prototype.then=function(b,z){if(typeof b!="function"&&this.state===w||typeof z!="function"&&this.state===m)return this;var P=new this.constructor(c);return this.state!==$?y(P,this.state===w?b:z,this.outcome):this.queue.push(new E(P,b,z)),P},E.prototype.callFulfilled=function(b){p.resolve(this.promise,b)},E.prototype.otherCallFulfilled=function(b){y(this.promise,this.onFulfilled,b)},E.prototype.callRejected=function(b){p.reject(this.promise,b)},E.prototype.otherCallRejected=function(b){y(this.promise,this.onRejected,b)},p.resolve=function(b,z){var P=D(A,z);if(P.status==="error")return p.reject(b,P.value);var W=P.value;if(W)N(b,W);else{b.state=w,b.outcome=z;for(var G=-1,oe=b.queue.length;++G<oe;)b.queue[G].callFulfilled(z)}return b},p.reject=function(b,z){b.state=m,b.outcome=z;for(var P=-1,W=b.queue.length;++P<W;)b.queue[P].callRejected(z);return b},T.resolve=function(b){return b instanceof this?b:p.resolve(new this(c),b)},T.reject=function(b){var z=new this(c);return p.reject(z,b)},T.all=function(b){var z=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=b.length,W=!1;if(!P)return this.resolve([]);for(var G=new Array(P),oe=0,se=-1,ye=new this(c);++se<P;)we(b[se],se);return ye;function we(Se,Ke){z.resolve(Se).then(function(X){G[Ke]=X,++oe!==P||W||(W=!0,p.resolve(ye,G))},function(X){W||(W=!0,p.reject(ye,X))})}},T.race=function(b){var z=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=b.length,W=!1;if(!P)return this.resolve([]);for(var G=-1,oe=new this(c);++G<P;)se=b[G],z.resolve(se).then(function(ye){W||(W=!0,p.resolve(oe,ye))},function(ye){W||(W=!0,p.reject(oe,ye))});var se;return oe}},{immediate:36}],38:[function(r,i,o){var a={};(0,r("./lib/utils/common").assign)(a,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),i.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,i,o){var a=r("./zlib/deflate"),c=r("./utils/common"),p=r("./utils/strings"),m=r("./zlib/messages"),w=r("./zlib/zstream"),$=Object.prototype.toString,T=0,E=-1,y=0,A=8;function N(b){if(!(this instanceof N))return new N(b);this.options=c.assign({level:E,method:A,chunkSize:16384,windowBits:15,memLevel:8,strategy:y,to:""},b||{});var z=this.options;z.raw&&0<z.windowBits?z.windowBits=-z.windowBits:z.gzip&&0<z.windowBits&&z.windowBits<16&&(z.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var P=a.deflateInit2(this.strm,z.level,z.method,z.windowBits,z.memLevel,z.strategy);if(P!==T)throw new Error(m[P]);if(z.header&&a.deflateSetHeader(this.strm,z.header),z.dictionary){var W;if(W=typeof z.dictionary=="string"?p.string2buf(z.dictionary):$.call(z.dictionary)==="[object ArrayBuffer]"?new Uint8Array(z.dictionary):z.dictionary,(P=a.deflateSetDictionary(this.strm,W))!==T)throw new Error(m[P]);this._dict_set=!0}}function D(b,z){var P=new N(z);if(P.push(b,!0),P.err)throw P.msg||m[P.err];return P.result}N.prototype.push=function(b,z){var P,W,G=this.strm,oe=this.options.chunkSize;if(this.ended)return!1;W=z===~~z?z:z===!0?4:0,typeof b=="string"?G.input=p.string2buf(b):$.call(b)==="[object ArrayBuffer]"?G.input=new Uint8Array(b):G.input=b,G.next_in=0,G.avail_in=G.input.length;do{if(G.avail_out===0&&(G.output=new c.Buf8(oe),G.next_out=0,G.avail_out=oe),(P=a.deflate(G,W))!==1&&P!==T)return this.onEnd(P),!(this.ended=!0);G.avail_out!==0&&(G.avail_in!==0||W!==4&&W!==2)||(this.options.to==="string"?this.onData(p.buf2binstring(c.shrinkBuf(G.output,G.next_out))):this.onData(c.shrinkBuf(G.output,G.next_out)))}while((0<G.avail_in||G.avail_out===0)&&P!==1);return W===4?(P=a.deflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===T):W!==2||(this.onEnd(T),!(G.avail_out=0))},N.prototype.onData=function(b){this.chunks.push(b)},N.prototype.onEnd=function(b){b===T&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},o.Deflate=N,o.deflate=D,o.deflateRaw=function(b,z){return(z=z||{}).raw=!0,D(b,z)},o.gzip=function(b,z){return(z=z||{}).gzip=!0,D(b,z)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,i,o){var a=r("./zlib/inflate"),c=r("./utils/common"),p=r("./utils/strings"),m=r("./zlib/constants"),w=r("./zlib/messages"),$=r("./zlib/zstream"),T=r("./zlib/gzheader"),E=Object.prototype.toString;function y(N){if(!(this instanceof y))return new y(N);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},N||{});var D=this.options;D.raw&&0<=D.windowBits&&D.windowBits<16&&(D.windowBits=-D.windowBits,D.windowBits===0&&(D.windowBits=-15)),!(0<=D.windowBits&&D.windowBits<16)||N&&N.windowBits||(D.windowBits+=32),15<D.windowBits&&D.windowBits<48&&!(15&D.windowBits)&&(D.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $,this.strm.avail_out=0;var b=a.inflateInit2(this.strm,D.windowBits);if(b!==m.Z_OK)throw new Error(w[b]);this.header=new T,a.inflateGetHeader(this.strm,this.header)}function A(N,D){var b=new y(D);if(b.push(N,!0),b.err)throw b.msg||w[b.err];return b.result}y.prototype.push=function(N,D){var b,z,P,W,G,oe,se=this.strm,ye=this.options.chunkSize,we=this.options.dictionary,Se=!1;if(this.ended)return!1;z=D===~~D?D:D===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof N=="string"?se.input=p.binstring2buf(N):E.call(N)==="[object ArrayBuffer]"?se.input=new Uint8Array(N):se.input=N,se.next_in=0,se.avail_in=se.input.length;do{if(se.avail_out===0&&(se.output=new c.Buf8(ye),se.next_out=0,se.avail_out=ye),(b=a.inflate(se,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&we&&(oe=typeof we=="string"?p.string2buf(we):E.call(we)==="[object ArrayBuffer]"?new Uint8Array(we):we,b=a.inflateSetDictionary(this.strm,oe)),b===m.Z_BUF_ERROR&&Se===!0&&(b=m.Z_OK,Se=!1),b!==m.Z_STREAM_END&&b!==m.Z_OK)return this.onEnd(b),!(this.ended=!0);se.next_out&&(se.avail_out!==0&&b!==m.Z_STREAM_END&&(se.avail_in!==0||z!==m.Z_FINISH&&z!==m.Z_SYNC_FLUSH)||(this.options.to==="string"?(P=p.utf8border(se.output,se.next_out),W=se.next_out-P,G=p.buf2string(se.output,P),se.next_out=W,se.avail_out=ye-W,W&&c.arraySet(se.output,se.output,P,W,0),this.onData(G)):this.onData(c.shrinkBuf(se.output,se.next_out)))),se.avail_in===0&&se.avail_out===0&&(Se=!0)}while((0<se.avail_in||se.avail_out===0)&&b!==m.Z_STREAM_END);return b===m.Z_STREAM_END&&(z=m.Z_FINISH),z===m.Z_FINISH?(b=a.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===m.Z_OK):z!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(se.avail_out=0))},y.prototype.onData=function(N){this.chunks.push(N)},y.prototype.onEnd=function(N){N===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},o.Inflate=y,o.inflate=A,o.inflateRaw=function(N,D){return(D=D||{}).raw=!0,A(N,D)},o.ungzip=A},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,i,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(m){for(var w=Array.prototype.slice.call(arguments,1);w.length;){var $=w.shift();if($){if(typeof $!="object")throw new TypeError($+"must be non-object");for(var T in $)$.hasOwnProperty(T)&&(m[T]=$[T])}}return m},o.shrinkBuf=function(m,w){return m.length===w?m:m.subarray?m.subarray(0,w):(m.length=w,m)};var c={arraySet:function(m,w,$,T,E){if(w.subarray&&m.subarray)m.set(w.subarray($,$+T),E);else for(var y=0;y<T;y++)m[E+y]=w[$+y]},flattenChunks:function(m){var w,$,T,E,y,A;for(w=T=0,$=m.length;w<$;w++)T+=m[w].length;for(A=new Uint8Array(T),w=E=0,$=m.length;w<$;w++)y=m[w],A.set(y,E),E+=y.length;return A}},p={arraySet:function(m,w,$,T,E){for(var y=0;y<T;y++)m[E+y]=w[$+y]},flattenChunks:function(m){return[].concat.apply([],m)}};o.setTyped=function(m){m?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,c)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,p))},o.setTyped(a)},{}],42:[function(r,i,o){var a=r("./common"),c=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var m=new a.Buf8(256),w=0;w<256;w++)m[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;function $(T,E){if(E<65537&&(T.subarray&&p||!T.subarray&&c))return String.fromCharCode.apply(null,a.shrinkBuf(T,E));for(var y="",A=0;A<E;A++)y+=String.fromCharCode(T[A]);return y}m[254]=m[254]=1,o.string2buf=function(T){var E,y,A,N,D,b=T.length,z=0;for(N=0;N<b;N++)(64512&(y=T.charCodeAt(N)))==55296&&N+1<b&&(64512&(A=T.charCodeAt(N+1)))==56320&&(y=65536+(y-55296<<10)+(A-56320),N++),z+=y<128?1:y<2048?2:y<65536?3:4;for(E=new a.Buf8(z),N=D=0;D<z;N++)(64512&(y=T.charCodeAt(N)))==55296&&N+1<b&&(64512&(A=T.charCodeAt(N+1)))==56320&&(y=65536+(y-55296<<10)+(A-56320),N++),y<128?E[D++]=y:(y<2048?E[D++]=192|y>>>6:(y<65536?E[D++]=224|y>>>12:(E[D++]=240|y>>>18,E[D++]=128|y>>>12&63),E[D++]=128|y>>>6&63),E[D++]=128|63&y);return E},o.buf2binstring=function(T){return $(T,T.length)},o.binstring2buf=function(T){for(var E=new a.Buf8(T.length),y=0,A=E.length;y<A;y++)E[y]=T.charCodeAt(y);return E},o.buf2string=function(T,E){var y,A,N,D,b=E||T.length,z=new Array(2*b);for(y=A=0;y<b;)if((N=T[y++])<128)z[A++]=N;else if(4<(D=m[N]))z[A++]=65533,y+=D-1;else{for(N&=D===2?31:D===3?15:7;1<D&&y<b;)N=N<<6|63&T[y++],D--;1<D?z[A++]=65533:N<65536?z[A++]=N:(N-=65536,z[A++]=55296|N>>10&1023,z[A++]=56320|1023&N)}return $(z,A)},o.utf8border=function(T,E){var y;for((E=E||T.length)>T.length&&(E=T.length),y=E-1;0<=y&&(192&T[y])==128;)y--;return y<0||y===0?E:y+m[T[y]]>E?y:E}},{"./common":41}],43:[function(r,i,o){i.exports=function(a,c,p,m){for(var w=65535&a|0,$=a>>>16&65535|0,T=0;p!==0;){for(p-=T=2e3<p?2e3:p;$=$+(w=w+c[m++]|0)|0,--T;);w%=65521,$%=65521}return w|$<<16|0}},{}],44:[function(r,i,o){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,i,o){var a=function(){for(var c,p=[],m=0;m<256;m++){c=m;for(var w=0;w<8;w++)c=1&c?3988292384^c>>>1:c>>>1;p[m]=c}return p}();i.exports=function(c,p,m,w){var $=a,T=w+m;c^=-1;for(var E=w;E<T;E++)c=c>>>8^$[255&(c^p[E])];return-1^c}},{}],46:[function(r,i,o){var a,c=r("../utils/common"),p=r("./trees"),m=r("./adler32"),w=r("./crc32"),$=r("./messages"),T=0,E=4,y=0,A=-2,N=-1,D=4,b=2,z=8,P=9,W=286,G=30,oe=19,se=2*W+1,ye=15,we=3,Se=258,Ke=Se+we+1,X=42,_e=113,I=1,je=2,ht=3,ke=4;function ve(k,Ne){return k.msg=$[Ne],Ne}function me(k){return(k<<1)-(4<k?9:0)}function Re(k){for(var Ne=k.length;0<=--Ne;)k[Ne]=0}function ce(k){var Ne=k.state,ue=Ne.pending;ue>k.avail_out&&(ue=k.avail_out),ue!==0&&(c.arraySet(k.output,Ne.pending_buf,Ne.pending_out,ue,k.next_out),k.next_out+=ue,Ne.pending_out+=ue,k.total_out+=ue,k.avail_out-=ue,Ne.pending-=ue,Ne.pending===0&&(Ne.pending_out=0))}function fe(k,Ne){p._tr_flush_block(k,0<=k.block_start?k.block_start:-1,k.strstart-k.block_start,Ne),k.block_start=k.strstart,ce(k.strm)}function ct(k,Ne){k.pending_buf[k.pending++]=Ne}function it(k,Ne){k.pending_buf[k.pending++]=Ne>>>8&255,k.pending_buf[k.pending++]=255&Ne}function Fe(k,Ne){var ue,K,H=k.max_chain_length,ae=k.strstart,Me=k.prev_length,Be=k.nice_match,be=k.strstart>k.w_size-Ke?k.strstart-(k.w_size-Ke):0,Ze=k.window,dt=k.w_mask,Ye=k.prev,_t=k.strstart+Se,rn=Ze[ae+Me-1],Qt=Ze[ae+Me];k.prev_length>=k.good_match&&(H>>=2),Be>k.lookahead&&(Be=k.lookahead);do if(Ze[(ue=Ne)+Me]===Qt&&Ze[ue+Me-1]===rn&&Ze[ue]===Ze[ae]&&Ze[++ue]===Ze[ae+1]){ae+=2,ue++;do;while(Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&Ze[++ae]===Ze[++ue]&&ae<_t);if(K=Se-(_t-ae),ae=_t-Se,Me<K){if(k.match_start=Ne,Be<=(Me=K))break;rn=Ze[ae+Me-1],Qt=Ze[ae+Me]}}while((Ne=Ye[Ne&dt])>be&&--H!=0);return Me<=k.lookahead?Me:k.lookahead}function on(k){var Ne,ue,K,H,ae,Me,Be,be,Ze,dt,Ye=k.w_size;do{if(H=k.window_size-k.lookahead-k.strstart,k.strstart>=Ye+(Ye-Ke)){for(c.arraySet(k.window,k.window,Ye,Ye,0),k.match_start-=Ye,k.strstart-=Ye,k.block_start-=Ye,Ne=ue=k.hash_size;K=k.head[--Ne],k.head[Ne]=Ye<=K?K-Ye:0,--ue;);for(Ne=ue=Ye;K=k.prev[--Ne],k.prev[Ne]=Ye<=K?K-Ye:0,--ue;);H+=Ye}if(k.strm.avail_in===0)break;if(Me=k.strm,Be=k.window,be=k.strstart+k.lookahead,Ze=H,dt=void 0,dt=Me.avail_in,Ze<dt&&(dt=Ze),ue=dt===0?0:(Me.avail_in-=dt,c.arraySet(Be,Me.input,Me.next_in,dt,be),Me.state.wrap===1?Me.adler=m(Me.adler,Be,dt,be):Me.state.wrap===2&&(Me.adler=w(Me.adler,Be,dt,be)),Me.next_in+=dt,Me.total_in+=dt,dt),k.lookahead+=ue,k.lookahead+k.insert>=we)for(ae=k.strstart-k.insert,k.ins_h=k.window[ae],k.ins_h=(k.ins_h<<k.hash_shift^k.window[ae+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[ae+we-1])&k.hash_mask,k.prev[ae&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=ae,ae++,k.insert--,!(k.lookahead+k.insert<we)););}while(k.lookahead<Ke&&k.strm.avail_in!==0)}function Cn(k,Ne){for(var ue,K;;){if(k.lookahead<Ke){if(on(k),k.lookahead<Ke&&Ne===T)return I;if(k.lookahead===0)break}if(ue=0,k.lookahead>=we&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+we-1])&k.hash_mask,ue=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),ue!==0&&k.strstart-ue<=k.w_size-Ke&&(k.match_length=Fe(k,ue)),k.match_length>=we)if(K=p._tr_tally(k,k.strstart-k.match_start,k.match_length-we),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=we){for(k.match_length--;k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+we-1])&k.hash_mask,ue=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart,--k.match_length!=0;);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else K=p._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(K&&(fe(k,!1),k.strm.avail_out===0))return I}return k.insert=k.strstart<we-1?k.strstart:we-1,Ne===E?(fe(k,!0),k.strm.avail_out===0?ht:ke):k.last_lit&&(fe(k,!1),k.strm.avail_out===0)?I:je}function Xt(k,Ne){for(var ue,K,H;;){if(k.lookahead<Ke){if(on(k),k.lookahead<Ke&&Ne===T)return I;if(k.lookahead===0)break}if(ue=0,k.lookahead>=we&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+we-1])&k.hash_mask,ue=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=we-1,ue!==0&&k.prev_length<k.max_lazy_match&&k.strstart-ue<=k.w_size-Ke&&(k.match_length=Fe(k,ue),k.match_length<=5&&(k.strategy===1||k.match_length===we&&4096<k.strstart-k.match_start)&&(k.match_length=we-1)),k.prev_length>=we&&k.match_length<=k.prev_length){for(H=k.strstart+k.lookahead-we,K=p._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-we),k.lookahead-=k.prev_length-1,k.prev_length-=2;++k.strstart<=H&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+we-1])&k.hash_mask,ue=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),--k.prev_length!=0;);if(k.match_available=0,k.match_length=we-1,k.strstart++,K&&(fe(k,!1),k.strm.avail_out===0))return I}else if(k.match_available){if((K=p._tr_tally(k,0,k.window[k.strstart-1]))&&fe(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return I}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(K=p._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<we-1?k.strstart:we-1,Ne===E?(fe(k,!0),k.strm.avail_out===0?ht:ke):k.last_lit&&(fe(k,!1),k.strm.avail_out===0)?I:je}function cn(k,Ne,ue,K,H){this.good_length=k,this.max_lazy=Ne,this.nice_length=ue,this.max_chain=K,this.func=H}function En(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*se),this.dyn_dtree=new c.Buf16(2*(2*G+1)),this.bl_tree=new c.Buf16(2*(2*oe+1)),Re(this.dyn_ltree),Re(this.dyn_dtree),Re(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(ye+1),this.heap=new c.Buf16(2*W+1),Re(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*W+1),Re(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $t(k){var Ne;return k&&k.state?(k.total_in=k.total_out=0,k.data_type=b,(Ne=k.state).pending=0,Ne.pending_out=0,Ne.wrap<0&&(Ne.wrap=-Ne.wrap),Ne.status=Ne.wrap?X:_e,k.adler=Ne.wrap===2?0:1,Ne.last_flush=T,p._tr_init(Ne),y):ve(k,A)}function dr(k){var Ne=$t(k);return Ne===y&&function(ue){ue.window_size=2*ue.w_size,Re(ue.head),ue.max_lazy_match=a[ue.level].max_lazy,ue.good_match=a[ue.level].good_length,ue.nice_match=a[ue.level].nice_length,ue.max_chain_length=a[ue.level].max_chain,ue.strstart=0,ue.block_start=0,ue.lookahead=0,ue.insert=0,ue.match_length=ue.prev_length=we-1,ue.match_available=0,ue.ins_h=0}(k.state),Ne}function Qn(k,Ne,ue,K,H,ae){if(!k)return A;var Me=1;if(Ne===N&&(Ne=6),K<0?(Me=0,K=-K):15<K&&(Me=2,K-=16),H<1||P<H||ue!==z||K<8||15<K||Ne<0||9<Ne||ae<0||D<ae)return ve(k,A);K===8&&(K=9);var Be=new En;return(k.state=Be).strm=k,Be.wrap=Me,Be.gzhead=null,Be.w_bits=K,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=H+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+we-1)/we),Be.window=new c.Buf8(2*Be.w_size),Be.head=new c.Buf16(Be.hash_size),Be.prev=new c.Buf16(Be.w_size),Be.lit_bufsize=1<<H+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new c.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=Ne,Be.strategy=ae,Be.method=ue,dr(k)}a=[new cn(0,0,0,0,function(k,Ne){var ue=65535;for(ue>k.pending_buf_size-5&&(ue=k.pending_buf_size-5);;){if(k.lookahead<=1){if(on(k),k.lookahead===0&&Ne===T)return I;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var K=k.block_start+ue;if((k.strstart===0||k.strstart>=K)&&(k.lookahead=k.strstart-K,k.strstart=K,fe(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-Ke&&(fe(k,!1),k.strm.avail_out===0))return I}return k.insert=0,Ne===E?(fe(k,!0),k.strm.avail_out===0?ht:ke):(k.strstart>k.block_start&&(fe(k,!1),k.strm.avail_out),I)}),new cn(4,4,8,4,Cn),new cn(4,5,16,8,Cn),new cn(4,6,32,32,Cn),new cn(4,4,16,16,Xt),new cn(8,16,32,32,Xt),new cn(8,16,128,128,Xt),new cn(8,32,128,256,Xt),new cn(32,128,258,1024,Xt),new cn(32,258,258,4096,Xt)],o.deflateInit=function(k,Ne){return Qn(k,Ne,z,15,8,0)},o.deflateInit2=Qn,o.deflateReset=dr,o.deflateResetKeep=$t,o.deflateSetHeader=function(k,Ne){return k&&k.state?k.state.wrap!==2?A:(k.state.gzhead=Ne,y):A},o.deflate=function(k,Ne){var ue,K,H,ae;if(!k||!k.state||5<Ne||Ne<0)return k?ve(k,A):A;if(K=k.state,!k.output||!k.input&&k.avail_in!==0||K.status===666&&Ne!==E)return ve(k,k.avail_out===0?-5:A);if(K.strm=k,ue=K.last_flush,K.last_flush=Ne,K.status===X)if(K.wrap===2)k.adler=0,ct(K,31),ct(K,139),ct(K,8),K.gzhead?(ct(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),ct(K,255&K.gzhead.time),ct(K,K.gzhead.time>>8&255),ct(K,K.gzhead.time>>16&255),ct(K,K.gzhead.time>>24&255),ct(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),ct(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(ct(K,255&K.gzhead.extra.length),ct(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(k.adler=w(k.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(ct(K,0),ct(K,0),ct(K,0),ct(K,0),ct(K,0),ct(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),ct(K,3),K.status=_e);else{var Me=z+(K.w_bits-8<<4)<<8;Me|=(2<=K.strategy||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(Me|=32),Me+=31-Me%31,K.status=_e,it(K,Me),K.strstart!==0&&(it(K,k.adler>>>16),it(K,65535&k.adler)),k.adler=1}if(K.status===69)if(K.gzhead.extra){for(H=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>H&&(k.adler=w(k.adler,K.pending_buf,K.pending-H,H)),ce(k),H=K.pending,K.pending!==K.pending_buf_size));)ct(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>H&&(k.adler=w(k.adler,K.pending_buf,K.pending-H,H)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){H=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>H&&(k.adler=w(k.adler,K.pending_buf,K.pending-H,H)),ce(k),H=K.pending,K.pending===K.pending_buf_size)){ae=1;break}ae=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,ct(K,ae)}while(ae!==0);K.gzhead.hcrc&&K.pending>H&&(k.adler=w(k.adler,K.pending_buf,K.pending-H,H)),ae===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){H=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>H&&(k.adler=w(k.adler,K.pending_buf,K.pending-H,H)),ce(k),H=K.pending,K.pending===K.pending_buf_size)){ae=1;break}ae=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,ct(K,ae)}while(ae!==0);K.gzhead.hcrc&&K.pending>H&&(k.adler=w(k.adler,K.pending_buf,K.pending-H,H)),ae===0&&(K.status=103)}else K.status=103;if(K.status===103&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&ce(k),K.pending+2<=K.pending_buf_size&&(ct(K,255&k.adler),ct(K,k.adler>>8&255),k.adler=0,K.status=_e)):K.status=_e),K.pending!==0){if(ce(k),k.avail_out===0)return K.last_flush=-1,y}else if(k.avail_in===0&&me(Ne)<=me(ue)&&Ne!==E)return ve(k,-5);if(K.status===666&&k.avail_in!==0)return ve(k,-5);if(k.avail_in!==0||K.lookahead!==0||Ne!==T&&K.status!==666){var Be=K.strategy===2?function(be,Ze){for(var dt;;){if(be.lookahead===0&&(on(be),be.lookahead===0)){if(Ze===T)return I;break}if(be.match_length=0,dt=p._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++,dt&&(fe(be,!1),be.strm.avail_out===0))return I}return be.insert=0,Ze===E?(fe(be,!0),be.strm.avail_out===0?ht:ke):be.last_lit&&(fe(be,!1),be.strm.avail_out===0)?I:je}(K,Ne):K.strategy===3?function(be,Ze){for(var dt,Ye,_t,rn,Qt=be.window;;){if(be.lookahead<=Se){if(on(be),be.lookahead<=Se&&Ze===T)return I;if(be.lookahead===0)break}if(be.match_length=0,be.lookahead>=we&&0<be.strstart&&(Ye=Qt[_t=be.strstart-1])===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]){rn=be.strstart+Se;do;while(Ye===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]&&Ye===Qt[++_t]&&_t<rn);be.match_length=Se-(rn-_t),be.match_length>be.lookahead&&(be.match_length=be.lookahead)}if(be.match_length>=we?(dt=p._tr_tally(be,1,be.match_length-we),be.lookahead-=be.match_length,be.strstart+=be.match_length,be.match_length=0):(dt=p._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++),dt&&(fe(be,!1),be.strm.avail_out===0))return I}return be.insert=0,Ze===E?(fe(be,!0),be.strm.avail_out===0?ht:ke):be.last_lit&&(fe(be,!1),be.strm.avail_out===0)?I:je}(K,Ne):a[K.level].func(K,Ne);if(Be!==ht&&Be!==ke||(K.status=666),Be===I||Be===ht)return k.avail_out===0&&(K.last_flush=-1),y;if(Be===je&&(Ne===1?p._tr_align(K):Ne!==5&&(p._tr_stored_block(K,0,0,!1),Ne===3&&(Re(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),ce(k),k.avail_out===0))return K.last_flush=-1,y}return Ne!==E?y:K.wrap<=0?1:(K.wrap===2?(ct(K,255&k.adler),ct(K,k.adler>>8&255),ct(K,k.adler>>16&255),ct(K,k.adler>>24&255),ct(K,255&k.total_in),ct(K,k.total_in>>8&255),ct(K,k.total_in>>16&255),ct(K,k.total_in>>24&255)):(it(K,k.adler>>>16),it(K,65535&k.adler)),ce(k),0<K.wrap&&(K.wrap=-K.wrap),K.pending!==0?y:1)},o.deflateEnd=function(k){var Ne;return k&&k.state?(Ne=k.state.status)!==X&&Ne!==69&&Ne!==73&&Ne!==91&&Ne!==103&&Ne!==_e&&Ne!==666?ve(k,A):(k.state=null,Ne===_e?ve(k,-3):y):A},o.deflateSetDictionary=function(k,Ne){var ue,K,H,ae,Me,Be,be,Ze,dt=Ne.length;if(!k||!k.state||(ae=(ue=k.state).wrap)===2||ae===1&&ue.status!==X||ue.lookahead)return A;for(ae===1&&(k.adler=m(k.adler,Ne,dt,0)),ue.wrap=0,dt>=ue.w_size&&(ae===0&&(Re(ue.head),ue.strstart=0,ue.block_start=0,ue.insert=0),Ze=new c.Buf8(ue.w_size),c.arraySet(Ze,Ne,dt-ue.w_size,ue.w_size,0),Ne=Ze,dt=ue.w_size),Me=k.avail_in,Be=k.next_in,be=k.input,k.avail_in=dt,k.next_in=0,k.input=Ne,on(ue);ue.lookahead>=we;){for(K=ue.strstart,H=ue.lookahead-(we-1);ue.ins_h=(ue.ins_h<<ue.hash_shift^ue.window[K+we-1])&ue.hash_mask,ue.prev[K&ue.w_mask]=ue.head[ue.ins_h],ue.head[ue.ins_h]=K,K++,--H;);ue.strstart=K,ue.lookahead=we-1,on(ue)}return ue.strstart+=ue.lookahead,ue.block_start=ue.strstart,ue.insert=ue.lookahead,ue.lookahead=0,ue.match_length=ue.prev_length=we-1,ue.match_available=0,k.next_in=Be,k.input=be,k.avail_in=Me,ue.wrap=ae,y},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,i,o){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,i,o){i.exports=function(a,c){var p,m,w,$,T,E,y,A,N,D,b,z,P,W,G,oe,se,ye,we,Se,Ke,X,_e,I,je;p=a.state,m=a.next_in,I=a.input,w=m+(a.avail_in-5),$=a.next_out,je=a.output,T=$-(c-a.avail_out),E=$+(a.avail_out-257),y=p.dmax,A=p.wsize,N=p.whave,D=p.wnext,b=p.window,z=p.hold,P=p.bits,W=p.lencode,G=p.distcode,oe=(1<<p.lenbits)-1,se=(1<<p.distbits)-1;e:do{P<15&&(z+=I[m++]<<P,P+=8,z+=I[m++]<<P,P+=8),ye=W[z&oe];t:for(;;){if(z>>>=we=ye>>>24,P-=we,(we=ye>>>16&255)===0)je[$++]=65535&ye;else{if(!(16&we)){if(!(64&we)){ye=W[(65535&ye)+(z&(1<<we)-1)];continue t}if(32&we){p.mode=12;break e}a.msg="invalid literal/length code",p.mode=30;break e}Se=65535&ye,(we&=15)&&(P<we&&(z+=I[m++]<<P,P+=8),Se+=z&(1<<we)-1,z>>>=we,P-=we),P<15&&(z+=I[m++]<<P,P+=8,z+=I[m++]<<P,P+=8),ye=G[z&se];n:for(;;){if(z>>>=we=ye>>>24,P-=we,!(16&(we=ye>>>16&255))){if(!(64&we)){ye=G[(65535&ye)+(z&(1<<we)-1)];continue n}a.msg="invalid distance code",p.mode=30;break e}if(Ke=65535&ye,P<(we&=15)&&(z+=I[m++]<<P,(P+=8)<we&&(z+=I[m++]<<P,P+=8)),y<(Ke+=z&(1<<we)-1)){a.msg="invalid distance too far back",p.mode=30;break e}if(z>>>=we,P-=we,(we=$-T)<Ke){if(N<(we=Ke-we)&&p.sane){a.msg="invalid distance too far back",p.mode=30;break e}if(_e=b,(X=0)===D){if(X+=A-we,we<Se){for(Se-=we;je[$++]=b[X++],--we;);X=$-Ke,_e=je}}else if(D<we){if(X+=A+D-we,(we-=D)<Se){for(Se-=we;je[$++]=b[X++],--we;);if(X=0,D<Se){for(Se-=we=D;je[$++]=b[X++],--we;);X=$-Ke,_e=je}}}else if(X+=D-we,we<Se){for(Se-=we;je[$++]=b[X++],--we;);X=$-Ke,_e=je}for(;2<Se;)je[$++]=_e[X++],je[$++]=_e[X++],je[$++]=_e[X++],Se-=3;Se&&(je[$++]=_e[X++],1<Se&&(je[$++]=_e[X++]))}else{for(X=$-Ke;je[$++]=je[X++],je[$++]=je[X++],je[$++]=je[X++],2<(Se-=3););Se&&(je[$++]=je[X++],1<Se&&(je[$++]=je[X++]))}break}}break}}while(m<w&&$<E);m-=Se=P>>3,z&=(1<<(P-=Se<<3))-1,a.next_in=m,a.next_out=$,a.avail_in=m<w?w-m+5:5-(m-w),a.avail_out=$<E?E-$+257:257-($-E),p.hold=z,p.bits=P}},{}],49:[function(r,i,o){var a=r("../utils/common"),c=r("./adler32"),p=r("./crc32"),m=r("./inffast"),w=r("./inftrees"),$=1,T=2,E=0,y=-2,A=1,N=852,D=592;function b(X){return(X>>>24&255)+(X>>>8&65280)+((65280&X)<<8)+((255&X)<<24)}function z(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function P(X){var _e;return X&&X.state?(_e=X.state,X.total_in=X.total_out=_e.total=0,X.msg="",_e.wrap&&(X.adler=1&_e.wrap),_e.mode=A,_e.last=0,_e.havedict=0,_e.dmax=32768,_e.head=null,_e.hold=0,_e.bits=0,_e.lencode=_e.lendyn=new a.Buf32(N),_e.distcode=_e.distdyn=new a.Buf32(D),_e.sane=1,_e.back=-1,E):y}function W(X){var _e;return X&&X.state?((_e=X.state).wsize=0,_e.whave=0,_e.wnext=0,P(X)):y}function G(X,_e){var I,je;return X&&X.state?(je=X.state,_e<0?(I=0,_e=-_e):(I=1+(_e>>4),_e<48&&(_e&=15)),_e&&(_e<8||15<_e)?y:(je.window!==null&&je.wbits!==_e&&(je.window=null),je.wrap=I,je.wbits=_e,W(X))):y}function oe(X,_e){var I,je;return X?(je=new z,(X.state=je).window=null,(I=G(X,_e))!==E&&(X.state=null),I):y}var se,ye,we=!0;function Se(X){if(we){var _e;for(se=new a.Buf32(512),ye=new a.Buf32(32),_e=0;_e<144;)X.lens[_e++]=8;for(;_e<256;)X.lens[_e++]=9;for(;_e<280;)X.lens[_e++]=7;for(;_e<288;)X.lens[_e++]=8;for(w($,X.lens,0,288,se,0,X.work,{bits:9}),_e=0;_e<32;)X.lens[_e++]=5;w(T,X.lens,0,32,ye,0,X.work,{bits:5}),we=!1}X.lencode=se,X.lenbits=9,X.distcode=ye,X.distbits=5}function Ke(X,_e,I,je){var ht,ke=X.state;return ke.window===null&&(ke.wsize=1<<ke.wbits,ke.wnext=0,ke.whave=0,ke.window=new a.Buf8(ke.wsize)),je>=ke.wsize?(a.arraySet(ke.window,_e,I-ke.wsize,ke.wsize,0),ke.wnext=0,ke.whave=ke.wsize):(je<(ht=ke.wsize-ke.wnext)&&(ht=je),a.arraySet(ke.window,_e,I-je,ht,ke.wnext),(je-=ht)?(a.arraySet(ke.window,_e,I-je,je,0),ke.wnext=je,ke.whave=ke.wsize):(ke.wnext+=ht,ke.wnext===ke.wsize&&(ke.wnext=0),ke.whave<ke.wsize&&(ke.whave+=ht))),0}o.inflateReset=W,o.inflateReset2=G,o.inflateResetKeep=P,o.inflateInit=function(X){return oe(X,15)},o.inflateInit2=oe,o.inflate=function(X,_e){var I,je,ht,ke,ve,me,Re,ce,fe,ct,it,Fe,on,Cn,Xt,cn,En,$t,dr,Qn,k,Ne,ue,K,H=0,ae=new a.Buf8(4),Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!X||!X.state||!X.output||!X.input&&X.avail_in!==0)return y;(I=X.state).mode===12&&(I.mode=13),ve=X.next_out,ht=X.output,Re=X.avail_out,ke=X.next_in,je=X.input,me=X.avail_in,ce=I.hold,fe=I.bits,ct=me,it=Re,Ne=E;e:for(;;)switch(I.mode){case A:if(I.wrap===0){I.mode=13;break}for(;fe<16;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(2&I.wrap&&ce===35615){ae[I.check=0]=255&ce,ae[1]=ce>>>8&255,I.check=p(I.check,ae,2,0),fe=ce=0,I.mode=2;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&ce)<<8)+(ce>>8))%31){X.msg="incorrect header check",I.mode=30;break}if((15&ce)!=8){X.msg="unknown compression method",I.mode=30;break}if(fe-=4,k=8+(15&(ce>>>=4)),I.wbits===0)I.wbits=k;else if(k>I.wbits){X.msg="invalid window size",I.mode=30;break}I.dmax=1<<k,X.adler=I.check=1,I.mode=512&ce?10:12,fe=ce=0;break;case 2:for(;fe<16;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(I.flags=ce,(255&I.flags)!=8){X.msg="unknown compression method",I.mode=30;break}if(57344&I.flags){X.msg="unknown header flags set",I.mode=30;break}I.head&&(I.head.text=ce>>8&1),512&I.flags&&(ae[0]=255&ce,ae[1]=ce>>>8&255,I.check=p(I.check,ae,2,0)),fe=ce=0,I.mode=3;case 3:for(;fe<32;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}I.head&&(I.head.time=ce),512&I.flags&&(ae[0]=255&ce,ae[1]=ce>>>8&255,ae[2]=ce>>>16&255,ae[3]=ce>>>24&255,I.check=p(I.check,ae,4,0)),fe=ce=0,I.mode=4;case 4:for(;fe<16;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}I.head&&(I.head.xflags=255&ce,I.head.os=ce>>8),512&I.flags&&(ae[0]=255&ce,ae[1]=ce>>>8&255,I.check=p(I.check,ae,2,0)),fe=ce=0,I.mode=5;case 5:if(1024&I.flags){for(;fe<16;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}I.length=ce,I.head&&(I.head.extra_len=ce),512&I.flags&&(ae[0]=255&ce,ae[1]=ce>>>8&255,I.check=p(I.check,ae,2,0)),fe=ce=0}else I.head&&(I.head.extra=null);I.mode=6;case 6:if(1024&I.flags&&(me<(Fe=I.length)&&(Fe=me),Fe&&(I.head&&(k=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),a.arraySet(I.head.extra,je,ke,Fe,k)),512&I.flags&&(I.check=p(I.check,je,Fe,ke)),me-=Fe,ke+=Fe,I.length-=Fe),I.length))break e;I.length=0,I.mode=7;case 7:if(2048&I.flags){if(me===0)break e;for(Fe=0;k=je[ke+Fe++],I.head&&k&&I.length<65536&&(I.head.name+=String.fromCharCode(k)),k&&Fe<me;);if(512&I.flags&&(I.check=p(I.check,je,Fe,ke)),me-=Fe,ke+=Fe,k)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=8;case 8:if(4096&I.flags){if(me===0)break e;for(Fe=0;k=je[ke+Fe++],I.head&&k&&I.length<65536&&(I.head.comment+=String.fromCharCode(k)),k&&Fe<me;);if(512&I.flags&&(I.check=p(I.check,je,Fe,ke)),me-=Fe,ke+=Fe,k)break e}else I.head&&(I.head.comment=null);I.mode=9;case 9:if(512&I.flags){for(;fe<16;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(ce!==(65535&I.check)){X.msg="header crc mismatch",I.mode=30;break}fe=ce=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),X.adler=I.check=0,I.mode=12;break;case 10:for(;fe<32;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}X.adler=I.check=b(ce),fe=ce=0,I.mode=11;case 11:if(I.havedict===0)return X.next_out=ve,X.avail_out=Re,X.next_in=ke,X.avail_in=me,I.hold=ce,I.bits=fe,2;X.adler=I.check=1,I.mode=12;case 12:if(_e===5||_e===6)break e;case 13:if(I.last){ce>>>=7&fe,fe-=7&fe,I.mode=27;break}for(;fe<3;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}switch(I.last=1&ce,fe-=1,3&(ce>>>=1)){case 0:I.mode=14;break;case 1:if(Se(I),I.mode=20,_e!==6)break;ce>>>=2,fe-=2;break e;case 2:I.mode=17;break;case 3:X.msg="invalid block type",I.mode=30}ce>>>=2,fe-=2;break;case 14:for(ce>>>=7&fe,fe-=7&fe;fe<32;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if((65535&ce)!=(ce>>>16^65535)){X.msg="invalid stored block lengths",I.mode=30;break}if(I.length=65535&ce,fe=ce=0,I.mode=15,_e===6)break e;case 15:I.mode=16;case 16:if(Fe=I.length){if(me<Fe&&(Fe=me),Re<Fe&&(Fe=Re),Fe===0)break e;a.arraySet(ht,je,ke,Fe,ve),me-=Fe,ke+=Fe,Re-=Fe,ve+=Fe,I.length-=Fe;break}I.mode=12;break;case 17:for(;fe<14;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(I.nlen=257+(31&ce),ce>>>=5,fe-=5,I.ndist=1+(31&ce),ce>>>=5,fe-=5,I.ncode=4+(15&ce),ce>>>=4,fe-=4,286<I.nlen||30<I.ndist){X.msg="too many length or distance symbols",I.mode=30;break}I.have=0,I.mode=18;case 18:for(;I.have<I.ncode;){for(;fe<3;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}I.lens[Me[I.have++]]=7&ce,ce>>>=3,fe-=3}for(;I.have<19;)I.lens[Me[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,ue={bits:I.lenbits},Ne=w(0,I.lens,0,19,I.lencode,0,I.work,ue),I.lenbits=ue.bits,Ne){X.msg="invalid code lengths set",I.mode=30;break}I.have=0,I.mode=19;case 19:for(;I.have<I.nlen+I.ndist;){for(;cn=(H=I.lencode[ce&(1<<I.lenbits)-1])>>>16&255,En=65535&H,!((Xt=H>>>24)<=fe);){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(En<16)ce>>>=Xt,fe-=Xt,I.lens[I.have++]=En;else{if(En===16){for(K=Xt+2;fe<K;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(ce>>>=Xt,fe-=Xt,I.have===0){X.msg="invalid bit length repeat",I.mode=30;break}k=I.lens[I.have-1],Fe=3+(3&ce),ce>>>=2,fe-=2}else if(En===17){for(K=Xt+3;fe<K;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}fe-=Xt,k=0,Fe=3+(7&(ce>>>=Xt)),ce>>>=3,fe-=3}else{for(K=Xt+7;fe<K;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}fe-=Xt,k=0,Fe=11+(127&(ce>>>=Xt)),ce>>>=7,fe-=7}if(I.have+Fe>I.nlen+I.ndist){X.msg="invalid bit length repeat",I.mode=30;break}for(;Fe--;)I.lens[I.have++]=k}}if(I.mode===30)break;if(I.lens[256]===0){X.msg="invalid code -- missing end-of-block",I.mode=30;break}if(I.lenbits=9,ue={bits:I.lenbits},Ne=w($,I.lens,0,I.nlen,I.lencode,0,I.work,ue),I.lenbits=ue.bits,Ne){X.msg="invalid literal/lengths set",I.mode=30;break}if(I.distbits=6,I.distcode=I.distdyn,ue={bits:I.distbits},Ne=w(T,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,ue),I.distbits=ue.bits,Ne){X.msg="invalid distances set",I.mode=30;break}if(I.mode=20,_e===6)break e;case 20:I.mode=21;case 21:if(6<=me&&258<=Re){X.next_out=ve,X.avail_out=Re,X.next_in=ke,X.avail_in=me,I.hold=ce,I.bits=fe,m(X,it),ve=X.next_out,ht=X.output,Re=X.avail_out,ke=X.next_in,je=X.input,me=X.avail_in,ce=I.hold,fe=I.bits,I.mode===12&&(I.back=-1);break}for(I.back=0;cn=(H=I.lencode[ce&(1<<I.lenbits)-1])>>>16&255,En=65535&H,!((Xt=H>>>24)<=fe);){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(cn&&!(240&cn)){for($t=Xt,dr=cn,Qn=En;cn=(H=I.lencode[Qn+((ce&(1<<$t+dr)-1)>>$t)])>>>16&255,En=65535&H,!($t+(Xt=H>>>24)<=fe);){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}ce>>>=$t,fe-=$t,I.back+=$t}if(ce>>>=Xt,fe-=Xt,I.back+=Xt,I.length=En,cn===0){I.mode=26;break}if(32&cn){I.back=-1,I.mode=12;break}if(64&cn){X.msg="invalid literal/length code",I.mode=30;break}I.extra=15&cn,I.mode=22;case 22:if(I.extra){for(K=I.extra;fe<K;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}I.length+=ce&(1<<I.extra)-1,ce>>>=I.extra,fe-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=23;case 23:for(;cn=(H=I.distcode[ce&(1<<I.distbits)-1])>>>16&255,En=65535&H,!((Xt=H>>>24)<=fe);){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(!(240&cn)){for($t=Xt,dr=cn,Qn=En;cn=(H=I.distcode[Qn+((ce&(1<<$t+dr)-1)>>$t)])>>>16&255,En=65535&H,!($t+(Xt=H>>>24)<=fe);){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}ce>>>=$t,fe-=$t,I.back+=$t}if(ce>>>=Xt,fe-=Xt,I.back+=Xt,64&cn){X.msg="invalid distance code",I.mode=30;break}I.offset=En,I.extra=15&cn,I.mode=24;case 24:if(I.extra){for(K=I.extra;fe<K;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}I.offset+=ce&(1<<I.extra)-1,ce>>>=I.extra,fe-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){X.msg="invalid distance too far back",I.mode=30;break}I.mode=25;case 25:if(Re===0)break e;if(Fe=it-Re,I.offset>Fe){if((Fe=I.offset-Fe)>I.whave&&I.sane){X.msg="invalid distance too far back",I.mode=30;break}on=Fe>I.wnext?(Fe-=I.wnext,I.wsize-Fe):I.wnext-Fe,Fe>I.length&&(Fe=I.length),Cn=I.window}else Cn=ht,on=ve-I.offset,Fe=I.length;for(Re<Fe&&(Fe=Re),Re-=Fe,I.length-=Fe;ht[ve++]=Cn[on++],--Fe;);I.length===0&&(I.mode=21);break;case 26:if(Re===0)break e;ht[ve++]=I.length,Re--,I.mode=21;break;case 27:if(I.wrap){for(;fe<32;){if(me===0)break e;me--,ce|=je[ke++]<<fe,fe+=8}if(it-=Re,X.total_out+=it,I.total+=it,it&&(X.adler=I.check=I.flags?p(I.check,ht,it,ve-it):c(I.check,ht,it,ve-it)),it=Re,(I.flags?ce:b(ce))!==I.check){X.msg="incorrect data check",I.mode=30;break}fe=ce=0}I.mode=28;case 28:if(I.wrap&&I.flags){for(;fe<32;){if(me===0)break e;me--,ce+=je[ke++]<<fe,fe+=8}if(ce!==(4294967295&I.total)){X.msg="incorrect length check",I.mode=30;break}fe=ce=0}I.mode=29;case 29:Ne=1;break e;case 30:Ne=-3;break e;case 31:return-4;case 32:default:return y}return X.next_out=ve,X.avail_out=Re,X.next_in=ke,X.avail_in=me,I.hold=ce,I.bits=fe,(I.wsize||it!==X.avail_out&&I.mode<30&&(I.mode<27||_e!==4))&&Ke(X,X.output,X.next_out,it-X.avail_out)?(I.mode=31,-4):(ct-=X.avail_in,it-=X.avail_out,X.total_in+=ct,X.total_out+=it,I.total+=it,I.wrap&&it&&(X.adler=I.check=I.flags?p(I.check,ht,it,X.next_out-it):c(I.check,ht,it,X.next_out-it)),X.data_type=I.bits+(I.last?64:0)+(I.mode===12?128:0)+(I.mode===20||I.mode===15?256:0),(ct==0&&it===0||_e===4)&&Ne===E&&(Ne=-5),Ne)},o.inflateEnd=function(X){if(!X||!X.state)return y;var _e=X.state;return _e.window&&(_e.window=null),X.state=null,E},o.inflateGetHeader=function(X,_e){var I;return X&&X.state&&2&(I=X.state).wrap?((I.head=_e).done=!1,E):y},o.inflateSetDictionary=function(X,_e){var I,je=_e.length;return X&&X.state?(I=X.state).wrap!==0&&I.mode!==11?y:I.mode===11&&c(1,_e,je,0)!==I.check?-3:Ke(X,_e,je,je)?(I.mode=31,-4):(I.havedict=1,E):y},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,i,o){var a=r("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function($,T,E,y,A,N,D,b){var z,P,W,G,oe,se,ye,we,Se,Ke=b.bits,X=0,_e=0,I=0,je=0,ht=0,ke=0,ve=0,me=0,Re=0,ce=0,fe=null,ct=0,it=new a.Buf16(16),Fe=new a.Buf16(16),on=null,Cn=0;for(X=0;X<=15;X++)it[X]=0;for(_e=0;_e<y;_e++)it[T[E+_e]]++;for(ht=Ke,je=15;1<=je&&it[je]===0;je--);if(je<ht&&(ht=je),je===0)return A[N++]=20971520,A[N++]=20971520,b.bits=1,0;for(I=1;I<je&&it[I]===0;I++);for(ht<I&&(ht=I),X=me=1;X<=15;X++)if(me<<=1,(me-=it[X])<0)return-1;if(0<me&&($===0||je!==1))return-1;for(Fe[1]=0,X=1;X<15;X++)Fe[X+1]=Fe[X]+it[X];for(_e=0;_e<y;_e++)T[E+_e]!==0&&(D[Fe[T[E+_e]]++]=_e);if(se=$===0?(fe=on=D,19):$===1?(fe=c,ct-=257,on=p,Cn-=257,256):(fe=m,on=w,-1),X=I,oe=N,ve=_e=ce=0,W=-1,G=(Re=1<<(ke=ht))-1,$===1&&852<Re||$===2&&592<Re)return 1;for(;;){for(ye=X-ve,Se=D[_e]<se?(we=0,D[_e]):D[_e]>se?(we=on[Cn+D[_e]],fe[ct+D[_e]]):(we=96,0),z=1<<X-ve,I=P=1<<ke;A[oe+(ce>>ve)+(P-=z)]=ye<<24|we<<16|Se|0,P!==0;);for(z=1<<X-1;ce&z;)z>>=1;if(z!==0?(ce&=z-1,ce+=z):ce=0,_e++,--it[X]==0){if(X===je)break;X=T[E+D[_e]]}if(ht<X&&(ce&G)!==W){for(ve===0&&(ve=ht),oe+=I,me=1<<(ke=X-ve);ke+ve<je&&!((me-=it[ke+ve])<=0);)ke++,me<<=1;if(Re+=1<<ke,$===1&&852<Re||$===2&&592<Re)return 1;A[W=ce&G]=ht<<24|ke<<16|oe-N|0}}return ce!==0&&(A[oe+ce]=X-ve<<24|64<<16|0),b.bits=ht,0}},{"../utils/common":41}],51:[function(r,i,o){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,i,o){var a=r("../utils/common"),c=0,p=1;function m(H){for(var ae=H.length;0<=--ae;)H[ae]=0}var w=0,$=29,T=256,E=T+1+$,y=30,A=19,N=2*E+1,D=15,b=16,z=7,P=256,W=16,G=17,oe=18,se=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ye=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],we=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ke=new Array(2*(E+2));m(Ke);var X=new Array(2*y);m(X);var _e=new Array(512);m(_e);var I=new Array(256);m(I);var je=new Array($);m(je);var ht,ke,ve,me=new Array(y);function Re(H,ae,Me,Be,be){this.static_tree=H,this.extra_bits=ae,this.extra_base=Me,this.elems=Be,this.max_length=be,this.has_stree=H&&H.length}function ce(H,ae){this.dyn_tree=H,this.max_code=0,this.stat_desc=ae}function fe(H){return H<256?_e[H]:_e[256+(H>>>7)]}function ct(H,ae){H.pending_buf[H.pending++]=255&ae,H.pending_buf[H.pending++]=ae>>>8&255}function it(H,ae,Me){H.bi_valid>b-Me?(H.bi_buf|=ae<<H.bi_valid&65535,ct(H,H.bi_buf),H.bi_buf=ae>>b-H.bi_valid,H.bi_valid+=Me-b):(H.bi_buf|=ae<<H.bi_valid&65535,H.bi_valid+=Me)}function Fe(H,ae,Me){it(H,Me[2*ae],Me[2*ae+1])}function on(H,ae){for(var Me=0;Me|=1&H,H>>>=1,Me<<=1,0<--ae;);return Me>>>1}function Cn(H,ae,Me){var Be,be,Ze=new Array(D+1),dt=0;for(Be=1;Be<=D;Be++)Ze[Be]=dt=dt+Me[Be-1]<<1;for(be=0;be<=ae;be++){var Ye=H[2*be+1];Ye!==0&&(H[2*be]=on(Ze[Ye]++,Ye))}}function Xt(H){var ae;for(ae=0;ae<E;ae++)H.dyn_ltree[2*ae]=0;for(ae=0;ae<y;ae++)H.dyn_dtree[2*ae]=0;for(ae=0;ae<A;ae++)H.bl_tree[2*ae]=0;H.dyn_ltree[2*P]=1,H.opt_len=H.static_len=0,H.last_lit=H.matches=0}function cn(H){8<H.bi_valid?ct(H,H.bi_buf):0<H.bi_valid&&(H.pending_buf[H.pending++]=H.bi_buf),H.bi_buf=0,H.bi_valid=0}function En(H,ae,Me,Be){var be=2*ae,Ze=2*Me;return H[be]<H[Ze]||H[be]===H[Ze]&&Be[ae]<=Be[Me]}function $t(H,ae,Me){for(var Be=H.heap[Me],be=Me<<1;be<=H.heap_len&&(be<H.heap_len&&En(ae,H.heap[be+1],H.heap[be],H.depth)&&be++,!En(ae,Be,H.heap[be],H.depth));)H.heap[Me]=H.heap[be],Me=be,be<<=1;H.heap[Me]=Be}function dr(H,ae,Me){var Be,be,Ze,dt,Ye=0;if(H.last_lit!==0)for(;Be=H.pending_buf[H.d_buf+2*Ye]<<8|H.pending_buf[H.d_buf+2*Ye+1],be=H.pending_buf[H.l_buf+Ye],Ye++,Be===0?Fe(H,be,ae):(Fe(H,(Ze=I[be])+T+1,ae),(dt=se[Ze])!==0&&it(H,be-=je[Ze],dt),Fe(H,Ze=fe(--Be),Me),(dt=ye[Ze])!==0&&it(H,Be-=me[Ze],dt)),Ye<H.last_lit;);Fe(H,P,ae)}function Qn(H,ae){var Me,Be,be,Ze=ae.dyn_tree,dt=ae.stat_desc.static_tree,Ye=ae.stat_desc.has_stree,_t=ae.stat_desc.elems,rn=-1;for(H.heap_len=0,H.heap_max=N,Me=0;Me<_t;Me++)Ze[2*Me]!==0?(H.heap[++H.heap_len]=rn=Me,H.depth[Me]=0):Ze[2*Me+1]=0;for(;H.heap_len<2;)Ze[2*(be=H.heap[++H.heap_len]=rn<2?++rn:0)]=1,H.depth[be]=0,H.opt_len--,Ye&&(H.static_len-=dt[2*be+1]);for(ae.max_code=rn,Me=H.heap_len>>1;1<=Me;Me--)$t(H,Ze,Me);for(be=_t;Me=H.heap[1],H.heap[1]=H.heap[H.heap_len--],$t(H,Ze,1),Be=H.heap[1],H.heap[--H.heap_max]=Me,H.heap[--H.heap_max]=Be,Ze[2*be]=Ze[2*Me]+Ze[2*Be],H.depth[be]=(H.depth[Me]>=H.depth[Be]?H.depth[Me]:H.depth[Be])+1,Ze[2*Me+1]=Ze[2*Be+1]=be,H.heap[1]=be++,$t(H,Ze,1),2<=H.heap_len;);H.heap[--H.heap_max]=H.heap[1],function(Qt,vr){var Gs,ir,Xs,jn,$s,Pr,or=vr.dyn_tree,Ei=vr.max_code,pr=vr.stat_desc.static_tree,xo=vr.stat_desc.has_stree,$i=vr.stat_desc.extra_bits,Ms=vr.stat_desc.extra_base,Js=vr.stat_desc.max_length,Ar=0;for(jn=0;jn<=D;jn++)Qt.bl_count[jn]=0;for(or[2*Qt.heap[Qt.heap_max]+1]=0,Gs=Qt.heap_max+1;Gs<N;Gs++)Js<(jn=or[2*or[2*(ir=Qt.heap[Gs])+1]+1]+1)&&(jn=Js,Ar++),or[2*ir+1]=jn,Ei<ir||(Qt.bl_count[jn]++,$s=0,Ms<=ir&&($s=$i[ir-Ms]),Pr=or[2*ir],Qt.opt_len+=Pr*(jn+$s),xo&&(Qt.static_len+=Pr*(pr[2*ir+1]+$s)));if(Ar!==0){do{for(jn=Js-1;Qt.bl_count[jn]===0;)jn--;Qt.bl_count[jn]--,Qt.bl_count[jn+1]+=2,Qt.bl_count[Js]--,Ar-=2}while(0<Ar);for(jn=Js;jn!==0;jn--)for(ir=Qt.bl_count[jn];ir!==0;)Ei<(Xs=Qt.heap[--Gs])||(or[2*Xs+1]!==jn&&(Qt.opt_len+=(jn-or[2*Xs+1])*or[2*Xs],or[2*Xs+1]=jn),ir--)}}(H,ae),Cn(Ze,rn,H.bl_count)}function k(H,ae,Me){var Be,be,Ze=-1,dt=ae[1],Ye=0,_t=7,rn=4;for(dt===0&&(_t=138,rn=3),ae[2*(Me+1)+1]=65535,Be=0;Be<=Me;Be++)be=dt,dt=ae[2*(Be+1)+1],++Ye<_t&&be===dt||(Ye<rn?H.bl_tree[2*be]+=Ye:be!==0?(be!==Ze&&H.bl_tree[2*be]++,H.bl_tree[2*W]++):Ye<=10?H.bl_tree[2*G]++:H.bl_tree[2*oe]++,Ze=be,rn=(Ye=0)===dt?(_t=138,3):be===dt?(_t=6,3):(_t=7,4))}function Ne(H,ae,Me){var Be,be,Ze=-1,dt=ae[1],Ye=0,_t=7,rn=4;for(dt===0&&(_t=138,rn=3),Be=0;Be<=Me;Be++)if(be=dt,dt=ae[2*(Be+1)+1],!(++Ye<_t&&be===dt)){if(Ye<rn)for(;Fe(H,be,H.bl_tree),--Ye!=0;);else be!==0?(be!==Ze&&(Fe(H,be,H.bl_tree),Ye--),Fe(H,W,H.bl_tree),it(H,Ye-3,2)):Ye<=10?(Fe(H,G,H.bl_tree),it(H,Ye-3,3)):(Fe(H,oe,H.bl_tree),it(H,Ye-11,7));Ze=be,rn=(Ye=0)===dt?(_t=138,3):be===dt?(_t=6,3):(_t=7,4)}}m(me);var ue=!1;function K(H,ae,Me,Be){it(H,(w<<1)+(Be?1:0),3),function(be,Ze,dt,Ye){cn(be),ct(be,dt),ct(be,~dt),a.arraySet(be.pending_buf,be.window,Ze,dt,be.pending),be.pending+=dt}(H,ae,Me)}o._tr_init=function(H){ue||(function(){var ae,Me,Be,be,Ze,dt=new Array(D+1);for(be=Be=0;be<$-1;be++)for(je[be]=Be,ae=0;ae<1<<se[be];ae++)I[Be++]=be;for(I[Be-1]=be,be=Ze=0;be<16;be++)for(me[be]=Ze,ae=0;ae<1<<ye[be];ae++)_e[Ze++]=be;for(Ze>>=7;be<y;be++)for(me[be]=Ze<<7,ae=0;ae<1<<ye[be]-7;ae++)_e[256+Ze++]=be;for(Me=0;Me<=D;Me++)dt[Me]=0;for(ae=0;ae<=143;)Ke[2*ae+1]=8,ae++,dt[8]++;for(;ae<=255;)Ke[2*ae+1]=9,ae++,dt[9]++;for(;ae<=279;)Ke[2*ae+1]=7,ae++,dt[7]++;for(;ae<=287;)Ke[2*ae+1]=8,ae++,dt[8]++;for(Cn(Ke,E+1,dt),ae=0;ae<y;ae++)X[2*ae+1]=5,X[2*ae]=on(ae,5);ht=new Re(Ke,se,T+1,E,D),ke=new Re(X,ye,0,y,D),ve=new Re(new Array(0),we,0,A,z)}(),ue=!0),H.l_desc=new ce(H.dyn_ltree,ht),H.d_desc=new ce(H.dyn_dtree,ke),H.bl_desc=new ce(H.bl_tree,ve),H.bi_buf=0,H.bi_valid=0,Xt(H)},o._tr_stored_block=K,o._tr_flush_block=function(H,ae,Me,Be){var be,Ze,dt=0;0<H.level?(H.strm.data_type===2&&(H.strm.data_type=function(Ye){var _t,rn=4093624447;for(_t=0;_t<=31;_t++,rn>>>=1)if(1&rn&&Ye.dyn_ltree[2*_t]!==0)return c;if(Ye.dyn_ltree[18]!==0||Ye.dyn_ltree[20]!==0||Ye.dyn_ltree[26]!==0)return p;for(_t=32;_t<T;_t++)if(Ye.dyn_ltree[2*_t]!==0)return p;return c}(H)),Qn(H,H.l_desc),Qn(H,H.d_desc),dt=function(Ye){var _t;for(k(Ye,Ye.dyn_ltree,Ye.l_desc.max_code),k(Ye,Ye.dyn_dtree,Ye.d_desc.max_code),Qn(Ye,Ye.bl_desc),_t=A-1;3<=_t&&Ye.bl_tree[2*Se[_t]+1]===0;_t--);return Ye.opt_len+=3*(_t+1)+5+5+4,_t}(H),be=H.opt_len+3+7>>>3,(Ze=H.static_len+3+7>>>3)<=be&&(be=Ze)):be=Ze=Me+5,Me+4<=be&&ae!==-1?K(H,ae,Me,Be):H.strategy===4||Ze===be?(it(H,2+(Be?1:0),3),dr(H,Ke,X)):(it(H,4+(Be?1:0),3),function(Ye,_t,rn,Qt){var vr;for(it(Ye,_t-257,5),it(Ye,rn-1,5),it(Ye,Qt-4,4),vr=0;vr<Qt;vr++)it(Ye,Ye.bl_tree[2*Se[vr]+1],3);Ne(Ye,Ye.dyn_ltree,_t-1),Ne(Ye,Ye.dyn_dtree,rn-1)}(H,H.l_desc.max_code+1,H.d_desc.max_code+1,dt+1),dr(H,H.dyn_ltree,H.dyn_dtree)),Xt(H),Be&&cn(H)},o._tr_tally=function(H,ae,Me){return H.pending_buf[H.d_buf+2*H.last_lit]=ae>>>8&255,H.pending_buf[H.d_buf+2*H.last_lit+1]=255&ae,H.pending_buf[H.l_buf+H.last_lit]=255&Me,H.last_lit++,ae===0?H.dyn_ltree[2*Me]++:(H.matches++,ae--,H.dyn_ltree[2*(I[Me]+T+1)]++,H.dyn_dtree[2*fe(ae)]++),H.last_lit===H.lit_bufsize-1},o._tr_align=function(H){it(H,2,3),Fe(H,P,Ke),function(ae){ae.bi_valid===16?(ct(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)}(H)}},{"../utils/common":41}],53:[function(r,i,o){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,i,o){(function(a){(function(c,p){if(!c.setImmediate){var m,w,$,T,E=1,y={},A=!1,N=c.document,D=Object.getPrototypeOf&&Object.getPrototypeOf(c);D=D&&D.setTimeout?D:c,m={}.toString.call(c.process)==="[object process]"?function(W){process.nextTick(function(){z(W)})}:function(){if(c.postMessage&&!c.importScripts){var W=!0,G=c.onmessage;return c.onmessage=function(){W=!1},c.postMessage("","*"),c.onmessage=G,W}}()?(T="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",P,!1):c.attachEvent("onmessage",P),function(W){c.postMessage(T+W,"*")}):c.MessageChannel?(($=new MessageChannel).port1.onmessage=function(W){z(W.data)},function(W){$.port2.postMessage(W)}):N&&"onreadystatechange"in N.createElement("script")?(w=N.documentElement,function(W){var G=N.createElement("script");G.onreadystatechange=function(){z(W),G.onreadystatechange=null,w.removeChild(G),G=null},w.appendChild(G)}):function(W){setTimeout(z,0,W)},D.setImmediate=function(W){typeof W!="function"&&(W=new Function(""+W));for(var G=new Array(arguments.length-1),oe=0;oe<G.length;oe++)G[oe]=arguments[oe+1];var se={callback:W,args:G};return y[E]=se,m(E),E++},D.clearImmediate=b}function b(W){delete y[W]}function z(W){if(A)setTimeout(z,0,W);else{var G=y[W];if(G){A=!0;try{(function(oe){var se=oe.callback,ye=oe.args;switch(ye.length){case 0:se();break;case 1:se(ye[0]);break;case 2:se(ye[0],ye[1]);break;case 3:se(ye[0],ye[1],ye[2]);break;default:se.apply(p,ye)}})(G)}finally{b(W),A=!1}}}}function P(W){W.source===c&&typeof W.data=="string"&&W.data.indexOf(T)===0&&z(+W.data.slice(T.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof vi<"u"?vi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Yy);var Pz=Yy.exports;const sx=bx(Pz);var Gy={exports:{}};(function(e,t){(function(r,i){i()})(vi,function(){function r(w,$){return typeof $>"u"?$={autoBom:!1}:typeof $!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),$={autoBom:!$}),$.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(w.type)?new Blob(["\uFEFF",w],{type:w.type}):w}function i(w,$,T){var E=new XMLHttpRequest;E.open("GET",w),E.responseType="blob",E.onload=function(){m(E.response,$,T)},E.onerror=function(){console.error("could not download file")},E.send()}function o(w){var $=new XMLHttpRequest;$.open("HEAD",w,!1);try{$.send()}catch{}return 200<=$.status&&299>=$.status}function a(w){try{w.dispatchEvent(new MouseEvent("click"))}catch{var $=document.createEvent("MouseEvents");$.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),w.dispatchEvent($)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof vi=="object"&&vi.global===vi?vi:void 0,p=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(w,$,T){var E=c.URL||c.webkitURL,y=document.createElement("a");$=$||w.name||"download",y.download=$,y.rel="noopener",typeof w=="string"?(y.href=w,y.origin===location.origin?a(y):o(y.href)?i(w,$,T):a(y,y.target="_blank")):(y.href=E.createObjectURL(w),setTimeout(function(){E.revokeObjectURL(y.href)},4e4),setTimeout(function(){a(y)},0))}:"msSaveOrOpenBlob"in navigator?function(w,$,T){if($=$||w.name||"download",typeof w!="string")navigator.msSaveOrOpenBlob(r(w,T),$);else if(o(w))i(w,$,T);else{var E=document.createElement("a");E.href=w,E.target="_blank",setTimeout(function(){a(E)})}}:function(w,$,T,E){if(E=E||open("","_blank"),E&&(E.document.title=E.document.body.innerText="downloading..."),typeof w=="string")return i(w,$,T);var y=w.type==="application/octet-stream",A=/constructor/i.test(c.HTMLElement)||c.safari,N=/CriOS\/[\d]+/.test(navigator.userAgent);if((N||y&&A||p)&&typeof FileReader<"u"){var D=new FileReader;D.onloadend=function(){var P=D.result;P=N?P:P.replace(/^data:[^;]*;/,"data:attachment/file;"),E?E.location.href=P:location=P,E=null},D.readAsDataURL(w)}else{var b=c.URL||c.webkitURL,z=b.createObjectURL(w);E?E.location=z:location.href=z,E=null,setTimeout(function(){b.revokeObjectURL(z)},4e4)}});c.saveAs=m.saveAs=m,e.exports=m})})(Gy);var ix=Gy.exports;(function(){const e=console.error,t=console.warn,r=console.log,i=o=>{for(let a of o){let c="";if(typeof a=="string"?c=a:a&&typeof a=="object"?a.message?c=a.message:a.toString?c=a.toString():c=JSON.stringify(a):a!=null&&(c=String(a)),c.includes("Unable to preventDefault inside passive event listener")||c.includes("passive event listener invocation")||c.includes("preventDefault")&&c.includes("passive"))return!0}return!1};console.error=function(...o){i(o)||e.apply(console,o)},console.warn=function(...o){i(o)||t.apply(console,o)},console.log=function(...o){i(o)||r.apply(console,o)}})();const Az=({canvasRef:e,isDrawing:t})=>{const[r,i]=R.useState(""),o=R.useRef(null),a=R.useCallback(()=>{e.current&&i(e.current.toDataURL())},[e]);return R.useEffect(()=>{e.current&&a()},[e,a]),R.useEffect(()=>{if(!t){a();return}const c=()=>{a(),t&&(o.current=requestAnimationFrame(c))};return o.current=requestAnimationFrame(c),()=>{o.current&&cancelAnimationFrame(o.current)}},[t,a]),r?s.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"rgba(255, 0, 0, 0.3)",mixBlendMode:"multiply",WebkitMaskImage:`url(${r})`,maskImage:`url(${r})`,WebkitMaskSize:"100% 100%",maskSize:"100% 100%",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}}):null},wi=(()=>{const e="tapnow_images_db",r="images";let i=null,o=null;const a=new Map,c=()=>o||(o=new Promise((y,A)=>{if(!window.indexedDB){console.warn("[LocalImageManager] IndexedDB not supported, falling back to memory"),y(null);return}const N=indexedDB.open(e,1);N.onerror=D=>{console.error("[LocalImageManager] IndexedDB init failed:",D.target.error),y(null)},N.onsuccess=D=>{i=D.target.result,console.log("[LocalImageManager] IndexedDB initialized"),y(i)},N.onupgradeneeded=D=>{const b=D.target.result;b.objectStoreNames.contains(r)||(b.createObjectStore(r,{keyPath:"id"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("[LocalImageManager] Object store created"))}}),o),p=()=>`img_${Date.now()}_${Math.random().toString(36).substring(2,9)}`;return{saveImage:async(y,A=null)=>{const N=await c();if(!N)return null;const D=A||p();return new Promise((b,z)=>{var P;try{let W;if(typeof y=="string"&&y.startsWith("data:")){const we=y.split(","),Se=((P=we[0].match(/:(.*?);/))==null?void 0:P[1])||"image/png",Ke=atob(we[1]),X=new Uint8Array(Ke.length);for(let _e=0;_e<Ke.length;_e++)X[_e]=Ke.charCodeAt(_e);W=new Blob([X],{type:Se})}else if(y instanceof Blob)W=y;else{console.warn("[LocalImageManager] Invalid data type for saveImage"),b(null);return}const oe=N.transaction([r],"readwrite").objectStore(r),se={id:D,blob:W,timestamp:Date.now(),size:W.size},ye=oe.put(se);ye.onsuccess=()=>{b(D)},ye.onerror=we=>{console.error("[LocalImageManager] Save failed:",we.target.error),b(null)}}catch(W){console.error("[LocalImageManager] Save error:",W),b(null)}})},getImage:async y=>{if(a.has(y))return a.get(y);const A=await c();return A?new Promise(N=>{try{const z=A.transaction([r],"readonly").objectStore(r).get(y);z.onsuccess=()=>{const P=z.result;if(P&&P.blob){const W=new FileReader;W.onloadend=()=>{const G=W.result;a.set(y,G),N(G)},W.onerror=()=>{console.error("[LocalImageManager] Failed to convert blob to base64"),N(null)},W.readAsDataURL(P.blob)}else N(null)},z.onerror=()=>N(null)}catch(D){console.error("[LocalImageManager] Get error:",D),N(null)}}):null},deleteImage:async y=>{const A=await c();if(!A)return!1;if(a.has(y)){const N=a.get(y);N&&N.startsWith("blob:")&&URL.revokeObjectURL(N),a.delete(y)}return new Promise(N=>{const z=A.transaction([r],"readwrite").objectStore(r).delete(y);z.onsuccess=()=>N(!0),z.onerror=()=>N(!1)})},getStats:async()=>{const y=await c();return y?new Promise(A=>{const b=y.transaction([r],"readonly").objectStore(r).getAll();b.onsuccess=()=>{const z=b.result||[],P=z.reduce((W,G)=>W+(G.size||0),0);A({count:z.length,totalSize:P})},b.onerror=()=>A({count:0,totalSize:0})}):{count:0,totalSize:0}},isImageId:y=>typeof y=="string"&&y.startsWith("img_"),initDB:c}})();window.LocalImageManager=wi;const Yn=({src:e,className:t,alt:r,onError:i,onLoad:o,...a})=>{const[c,p]=R.useState(null),[m,w]=R.useState(!1),[$,T]=R.useState(!1),E=R.useRef(null);return R.useEffect(()=>{if(!e||e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")){p(e),T(!1);return}if(wi.isImageId(e)){T(!0),(async()=>{try{const A=await wi.getImage(e);A?(E.current=A,p(A)):(console.warn(`[LazyBase64Image] Image not found in IDB: ${e}`),w(!0))}catch(A){console.error("[LazyBase64Image] IDB resolve failed:",A),w(!0)}T(!1)})();return}return e.startsWith("data:")?(async()=>{try{const N=await(await fetch(e)).blob(),D=URL.createObjectURL(N);E.current=D,p(D)}catch(A){console.error("Base64Blob",A),w(!0),p(e)}})():p(e),()=>{E.current&&E.current.startsWith("blob:")&&(URL.revokeObjectURL(E.current),E.current=null)}},[e]),$||m&&!c||!c||wi.isImageId(c)?null:s.jsx("img",{src:c,className:t,alt:r,onError:i,onLoad:o,...a})},Rz=({visible:e,progress:t,status:r,type:i})=>e?s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-[2px] animate-in fade-in duration-300 pointer-events-none select-none",children:s.jsxs("div",{className:"relative bg-[#09090b]/90 border border-white/10 rounded-2xl p-8 shadow-2xl flex flex-col items-center min-w-[300px] backdrop-blur-xl",children:[s.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 w-20 h-20 bg-blue-500/20 blur-[50px] rounded-full pointer-events-none"}),s.jsxs("div",{className:"flex flex-col items-center gap-1 mb-6 z-10",children:[s.jsx("span",{className:"font-mono text-[10px] tracking-[0.3em] uppercase text-zinc-500",children:i==="import"?"DATA INGESTION":"SYSTEM ARCHIVING"}),s.jsxs("div",{className:"text-4xl font-bold text-zinc-200 tracking-tighter font-sans",children:[t.toFixed(0),s.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"%"})]})]}),s.jsx("div",{className:"relative w-full h-[2px] bg-zinc-800 rounded-full overflow-hidden mb-4",children:s.jsx("div",{className:"absolute top-0 left-0 h-full bg-white shadow-[0_0_10px_rgba(255,255,255,0.5)] transition-all duration-100 ease-linear",style:{width:`${t}%`}})}),s.jsx("span",{className:"text-[10px] font-mono text-zinc-400 tracking-widest uppercase animate-pulse",children:r})]})}):null,ox=R.memo(({item:e,theme:t,lightboxItem:r,onDelete:i,onClick:o,onContextMenu:a,onImageClick:c,onImageContextMenu:p,onRefresh:m,onRebuildThumbnail:w,performanceMode:$,localServerUrl:T,localCacheServerConnected:E,onCacheMissing:y,isSelected:A,onSelect:N,providers:D,defaultProviders:b})=>{var X,_e;const z=e.localCacheUrl||(e.localCacheMap?Object.values(e.localCacheMap)[0]:null),P=!!(E&&z),W=e.thumbnailUrl||null,G=e.status==="completed"&&(e.type==="image"||e.mjImages&&e.mjImages.length>0),oe=I=>P?z:$!=="off"&&W?W:I,[se,ye]=R.useState(null),we=(I=null)=>{if(I)return E&&e.localCacheMap&&e.localCacheMap[I]?e.localCacheMap[I]:I;if(e.mjImages&&e.mjImages.length>0){const je=e.selectedMjImageIndex??0,ht=e.mjImages[je]||e.mjImages[0];if(ht)return E&&e.localCacheMap&&e.localCacheMap[ht]?e.localCacheMap[ht]:ht}return e.originalUrl||e.mjOriginalUrl||e.url||e.localCacheUrl||(e.localCacheMap?Object.values(e.localCacheMap)[0]:"")||""},Se=(I,je=null)=>{const ht=we(je);if(!ht)return;const ke={source:"history",itemId:e.id,url:ht,selectedIndex:e.selectedMjImageIndex??0};I.dataTransfer.effectAllowed="copy",I.dataTransfer.setData("application/x-tapnow-history",JSON.stringify(ke)),I.dataTransfer.setData("text/uri-list",ht),I.dataTransfer.setData("text/plain",ht)};R.useEffect(()=>{const I=e.url||e.originalUrl||e.mjOriginalUrl;ye(P?z:I)},[e.url,e.originalUrl,e.mjOriginalUrl,P,z]);const Ke=R.useRef({url:null,time:0});return R.useEffect(()=>{if(!P||!z)return;const I=Date.now();Ke.current.url===z&&I-Ke.current.time<1e4||(Ke.current={url:z,time:I},fetch(z,{method:"HEAD"}).then(je=>{je.ok||y&&y(e.id,z)}).catch(()=>{y&&y(e.id,z)}))},[P,z,e.id,y]),s.jsxs("div",{className:`group rounded-lg overflow-hidden border relative cursor-pointer transition-colors ${A?"border-blue-500 ring-2 ring-blue-500/30":t==="dark"?"bg-zinc-900 border-zinc-800 hover:border-blue-500/50":"bg-white border-zinc-200 hover:border-blue-500/50"}`,style:{contentVisibility:"auto",containIntrinsicSize:"1px 300px"},onClick:o,onContextMenu:a,draggable:G,onDragStart:G?I=>Se(I):void 0,children:[P&&s.jsx("div",{className:"absolute top-1 left-1 z-10 px-1 py-0.5 rounded text-[8px] bg-black/60 text-green-300",children:""}),!P&&$!=="off"&&W&&s.jsx("div",{className:`absolute top-1 left-1 z-10 px-1 py-0.5 rounded text-[8px] bg-black/60 ${$==="ultra"?"text-orange-400":"text-zinc-400"}`,children:$==="ultra"?"":""}),N&&s.jsx("button",{onClick:I=>{I.stopPropagation(),I.preventDefault(),N(e.id)},className:`absolute bottom-2 right-2 z-20 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ${A?"bg-green-500 border-green-400 opacity-100":"border-white/60 bg-black/50 opacity-100 hover:bg-black/70"}`,title:A?"":"",children:A&&s.jsx(Vl,{size:16,className:"text-white"})}),s.jsxs("div",{className:`bg-black relative ${e.mjImages&&(e.mjImages.length===4||e.mjImages.length>1)||e.mjNeedsSplit&&((_e=(X=e.apiConfig)==null?void 0:X.modelId)!=null&&_e.includes("mj"))?(()=>{const I=e.mjRatio||"1:1";return I==="16:9"?"aspect-video":I==="9:16"?"aspect-[9/16]":I==="4:3"?"aspect-[4/3]":I==="3:4"?"aspect-[3/4]":I==="21:9"?"aspect-[21/9]":"aspect-square"})():"aspect-video"}`,children:[e.status==="completed"?e.mjImages&&(e.mjImages.length===4||e.mjImages.length>1)?s.jsx("div",{className:`w-full h-full grid gap-0.5 p-0.5 ${e.mjImages.length===4?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:e.mjImages.map((I,je)=>{e.mjImageInfo&&e.mjImageInfo[je];const ke=(E&&e.localCacheMap?e.localCacheMap[I]:null)||($!=="off"&&e.mjThumbnails&&e.mjThumbnails[je]?e.mjThumbnails[je]:I);return s.jsxs("div",{onClick:ve=>c&&c(ve,e,I,je),onContextMenu:ve=>p&&p(ve,e,I,je),onDragStart:ve=>{G&&(ve.stopPropagation(),Se(ve,I))},draggable:G,className:`relative w-full h-full cursor-pointer border-2 transition-all overflow-hidden ${e.selectedMjImageIndex===je&&r&&r.id===e.id?"border-blue-500 scale-95":"border-transparent hover:border-blue-500/50"}`,children:[s.jsx(Yn,{src:ke,loading:"lazy",className:"w-full h-full object-contain",alt:` ${je+1}`,onError:ve=>{console.error(` ${je+1} `),y&&y(e.id,ke),ve.target.style.display="none"}}),e.selectedMjImageIndex===je&&r&&r.id===e.id&&s.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-blue-500 rounded-full flex items-center justify-center z-10",children:s.jsx("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},je)})}):e.type==="image"?s.jsx(Yn,{src:oe(e.url||e.originalUrl||e.mjOriginalUrl),loading:"lazy",className:"w-full h-full object-cover",alt:e.prompt||"",onError:I=>{console.error(":",e.url||e.originalUrl||e.mjOriginalUrl),y&&y(e.id,oe(e.url||e.originalUrl||e.mjOriginalUrl)),I.target.style.display="none"}}):s.jsx("video",{src:se||e.url||e.originalUrl,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata",onError:()=>{const I=e.url||e.originalUrl||e.mjOriginalUrl;P&&I&&se===z?(ye(I),y&&y(e.id,z)):console.error(":",I)}}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(xi,{className:"animate-spin text-zinc-600"})}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-zinc-800",children:s.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:`${e.progress}%`}})})]}),s.jsxs("div",{className:"px-3 py-2 text-[11px]",children:[s.jsxs("div",{className:"flex justify-between items-start gap-2",children:[s.jsx("span",{className:`line-clamp-2 ${t==="dark"?"text-zinc-300":"text-zinc-700"}`,children:e.prompt||"Untitled"}),s.jsxs("div",{className:"flex items-center gap-1 shrink-0 ml-1",children:[e.type==="video"&&(e.status==="generating"||e.status==="failed")&&s.jsx("button",{onClick:I=>{I.stopPropagation(),m&&m(e)},className:`shrink-0 p-0.5 ${t==="dark"?"text-zinc-500 hover:text-white":"text-zinc-400 hover:text-zinc-900"}`,title:"",children:s.jsx(ic,{size:12})}),e.type==="image"&&s.jsx("button",{onClick:I=>{I.stopPropagation(),w&&w(e)},className:`shrink-0 p-0.5 ${t==="dark"?"text-zinc-500 hover:text-blue-300":"text-zinc-400 hover:text-blue-600"}`,title:"",children:s.jsx(ic,{size:12})}),s.jsx("button",{onClick:I=>{I.stopPropagation(),i&&i(e.id)},className:`shrink-0 p-0.5 ${t==="dark"?"text-zinc-500 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,title:"",children:s.jsx(Fr,{size:12})})]})]}),e.status==="failed"&&e.errorMsg&&s.jsx("p",{className:"text-[9px] text-red-500 mt-1 break-words whitespace-pre-wrap",children:e.errorMsg.split(`
`).map((I,je)=>s.jsxs("span",{children:[I,je<e.errorMsg.split(`
`).length-1&&s.jsx("br",{})]},je))}),e.status==="generating"&&s.jsx("p",{className:"text-[9px] text-blue-500 mt-1",children:e.errorMsg||"..."}),s.jsx("div",{className:"h-1.5"}),s.jsxs("div",{className:"flex flex-col w-full",children:[s.jsx("span",{className:t==="dark"?"text-zinc-500":"text-zinc-400",children:(()=>{const I=e.hasInputImages===!0,je=e.type==="video",ht=je?I?"":"":I?"":"",ke=e.resolution||(e.width&&e.height?`${e.width}x${e.height}`:null);return[ht,e.ratio||e.mjRatio,ke,je&&e.duration?`${e.duration}s`:null].filter(Boolean).join("  ")})()}),s.jsxs("span",{className:t==="dark"?"text-zinc-500":"text-zinc-400",children:[e.time,"  ",s.jsx("span",{title:e.provider,children:e.modelName}),typeof e.durationMs=="number"&&e.durationMs>0&&s.jsxs(s.Fragment,{children:["   ",(e.durationMs/1e3).toFixed(1),"s"]})]})]})]})]})},(e,t)=>{var r,i;return e.item===t.item&&e.theme===t.theme&&((r=e.lightboxItem)==null?void 0:r.id)===((i=t.lightboxItem)==null?void 0:i.id)&&e.isSelected===t.isSelected&&e.performanceMode===t.performanceMode&&e.localCacheServerConnected===t.localCacheServerConnected}),Dz=({nodeId:e,imageUrl:t,imageDimensions:r,isActive:i,onClose:o,onSave:a,theme:c,view:p,maskContent:m,onUpdateNode:w})=>{const $=R.useRef(null),T=R.useRef(null),E=R.useRef(null),[y,A]=R.useState(30),[N,D]=R.useState(!1),[b,z]=R.useState([]),[P,W]=R.useState(-1),G=10,[oe,se]=R.useState(r);R.useEffect(()=>{r!=null&&r.w&&(r!=null&&r.h)&&se(r)},[r]),R.useEffect(()=>{if(!i||!t||r!=null&&r.w&&(r!=null&&r.h))return;let ke=!1;return Br(t).then(ve=>{ke||ve!=null&&ve.w&&(ve!=null&&ve.h)&&(se(ve),w&&w(e,{dimensions:ve}))}).catch(()=>{}),()=>{ke=!0}},[i,t,r,e,w]),R.useEffect(()=>{if(!i||!$.current||!oe)return;const ke=$.current,ve=ke.getContext("2d");if(T.current=ve,ke.width=oe.w,ke.height=oe.h,ve.clearRect(0,0,ke.width,ke.height),m){const me=new Image;me.onload=()=>{ve.drawImage(me,0,0),ye()},me.src=m}else ye()},[i,oe,e,m]);const ye=()=>{if(!$.current||!T.current)return;const ke=$.current,me=T.current.getImageData(0,0,ke.width,ke.height),Re=b.slice(0,P+1);Re.push(me),Re.length>G&&Re.shift(),z(Re),W(Re.length-1)},we=ke=>{if(!$.current)return null;const ve=$.current,me=ve.getBoundingClientRect(),Re=ke.clientX-me.left,ce=ke.clientY-me.top,fe=ve.width/me.width,ct=ve.height/me.height;return{x:Math.round(Re*fe),y:Math.round(ce*ct)}},Se=ke=>{if(!N||!$.current||!T.current)return;const ve=we(ke);if(!ve)return;const me=T.current;me.globalCompositeOperation="source-over",me.strokeStyle="#FFFFFF",me.fillStyle="#FFFFFF",me.lineWidth=y,me.lineCap="round",me.lineJoin="round",E.current?(me.beginPath(),me.moveTo(E.current.x,E.current.y),me.lineTo(ve.x,ve.y),me.stroke()):(me.beginPath(),me.arc(ve.x,ve.y,y/2,0,Math.PI*2),me.fill()),E.current=ve},Ke=ke=>{ke.button===0&&(ke.preventDefault(),ke.stopPropagation(),E.current=null,D(!0),ye(),Se(ke))},X=ke=>{N&&(ke.preventDefault(),ke.stopPropagation(),Se(ke))},_e=ke=>{N&&(ke.preventDefault(),ke.stopPropagation(),D(!1),E.current=null,ye())},I=()=>{if(P<=0||!$.current||!T.current)return;const ke=P-1;W(ke),T.current.putImageData(b[ke],0,0)},je=()=>{if(!$.current||!T.current)return;T.current.clearRect(0,0,$.current.width,$.current.height),ye()},ht=()=>{if(!$.current)return;const ve=$.current.toDataURL("image/png");w&&w(e,{maskContent:ve,isMasking:!1}),a&&a(ve),o&&o()};return R.useEffect(()=>{if(!i)return;const ke=ve=>{(ve.ctrlKey||ve.metaKey)&&ve.key==="z"&&!ve.shiftKey&&(ve.preventDefault(),I())};return window.addEventListener("keydown",ke),()=>window.removeEventListener("keydown",ke)},[i,P,b]),!i||!t||!oe?null:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"absolute inset-0 z-50 pointer-events-auto",style:{mixBlendMode:"normal"},onMouseDown:ke=>ke.stopPropagation(),onMouseMove:ke=>ke.stopPropagation(),onMouseUp:ke=>ke.stopPropagation(),children:[s.jsx("canvas",{ref:$,className:"absolute inset-0 w-full h-full",style:{opacity:.5,mixBlendMode:"multiply",cursor:"crosshair",pointerEvents:"auto",imageRendering:"auto"},onMouseDown:Ke,onMouseMove:X,onMouseUp:_e,onMouseLeave:_e}),s.jsx(Az,{canvasRef:$,isDrawing:N})]}),Nd.createPortal(s.jsxs("div",{className:`fixed bottom-4 left-1/2 -translate-x-1/2 flex flex-row items-center gap-4 p-2 rounded-full border backdrop-blur-md shadow-xl z-[9999] ${c==="dark"?"bg-zinc-900/90 border-zinc-700 text-zinc-200":"bg-white/90 border-zinc-300 text-zinc-800"}`,onMouseDown:ke=>ke.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[10px] font-medium whitespace-nowrap",children:""}),s.jsx("input",{type:"range",min:"10",max:"150",value:y,onChange:ke=>A(Number(ke.target.value)),className:"w-20",onMouseDown:ke=>ke.stopPropagation()}),s.jsxs("span",{className:"text-[10px] w-8 text-right whitespace-nowrap",children:[y,"px"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:I,disabled:P<=0,className:`p-1.5 rounded-full transition-colors ${c==="dark"?"hover:bg-zinc-800 disabled:opacity-50 disabled:cursor-not-allowed":"hover:bg-zinc-100 disabled:opacity-50 disabled:cursor-not-allowed"}`,title:" (Ctrl+Z)",children:s.jsx($z,{size:14})}),s.jsx("button",{onClick:je,className:`p-1.5 rounded-full transition-colors ${c==="dark"?"hover:bg-zinc-800":"hover:bg-zinc-100"}`,title:"",children:s.jsx(Ky,{size:14})}),s.jsx("button",{onClick:ht,className:"p-1.5 rounded-full bg-blue-600 hover:bg-blue-500 text-white transition-colors",title:"/",children:s.jsx(Kl,{size:14})})]})]}),document.body)]})},Oz=`
        /*  */
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
        
        /*  */
        #canvas-bg {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        
        /*  */
        #canvas-bg > div[style*="transform"] {
            transform: translateZ(0);
            will-change: transform;
        }
        
        /*  */
        .node-wrapper {
            transform: translateZ(0);
            backface-visibility: hidden;
            contain: layout style;
            will-change: transform, left, top;
        }
        
        /*  -  */
        .node-wrapper img,
        .node-wrapper video {
            image-rendering: auto;
            image-rendering: -webkit-optimize-contrast;
            transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            pointer-events: none;
        }
        
        /*  */
        svg {
            shape-rendering: geometricPrecision;
            text-rendering: optimizeLegibility;
        }
        
        /*  */
        .perf-mode .node-wrapper {
            box-shadow: none !important;
            backdrop-filter: none !important;
            border-radius: 0 !important;
            transition: none !important;
        }
        .perf-mode .connection-group {
            opacity: 1 !important;
        }
        
        /*  */
        .interacting .node-wrapper img {
            image-rendering: pixelated;
        }
        .interacting .connection-group {
            display: none;
            pointer-events: none;
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #52525b; }
        .resize-handle { cursor: nwse-resize; opacity: 0; transition: opacity 0.2s; }
        .node-wrapper:hover .resize-handle { opacity: 1; }
        
        /*  */
        .connector { position: absolute; top: 50%; transform: translateY(-50%); width: 0.9rem; height: 0.9rem; background-color: #27272a; border: 1px solid #71717a; color: #a1a1aa; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: crosshair; transition: all 0.2s; z-index: 30; opacity: 0; pointer-events: auto; }
        .node-wrapper:hover .connector { opacity: 1; }
        .connector:hover, .connector.active { background-color: #d4d4d8; border-color: #fff; transform: translateY(-50%) scale(1.2); opacity: 1; color: #000; }
        .connector-right { right: -0.45rem; }
        
        /*  */
        .input-point { position: absolute; top: 50%; transform: translateY(-50%); left: -0.25rem; width: 0.5rem; height: 0.5rem; background-color: #52525b; border-radius: 50%; border: 1px solid #18181b; transition: all 0.2s; z-index: 20; cursor: crosshair; }
        .node-wrapper:hover .input-point { background-color: #a1a1aa; }
        .input-point.connected { background-color: #60a5fa; box-shadow: 0 0 6px #60a5fa; }
        .input-point.active { background-color: #60a5fa; border-color: #fff; transform: translateY(-50%) scale(1.3); box-shadow: 0 0 8px #60a5fa; }

        /* Lightbox & Overlay */
        .lightbox-overlay { background-color: rgba(0, 0, 0, 0.95); backdrop-filter: blur(5px); }
        
        /* Stack Items */
        .thumb-stack-item {
             transition: transform 0.2s, z-index 0.2s;
        }
        .thumb-stack-item:hover {
            transform: scale(1.1) translateY(-2px);
            z-index: 10 !important;
            border-color: #60a5fa;
        }

        /*  */
        .connection-delete {
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: auto; /*  */
        }
        /*  */
        .connection-group:hover .connection-delete {
            opacity: 1;
        }

        /*  */
        .drop-zone {
            border: 2px dashed transparent;
            transition: all 0.3s;
        }
        .drop-zone.drag-over {
            border-color: #60a5fa;
            background-color: rgba(96, 165, 250, 0.1);
        }

        /* Markdown Styles for Chat */
        .markdown-body { font-size: 13px; line-height: 1.5; color: #e4e4e7; word-wrap: break-word; user-select: text !important; cursor: text; }
        .markdown-body * { user-select: text !important; cursor: text; }
        .markdown-body pre { background: #27272a; padding: 10px; border-radius: 6px; overflow-x: auto; margin: 8px 0; white-space: pre-wrap; word-wrap: break-word; user-select: text !important; cursor: text; }
        .markdown-body code { font-family: monospace; background: #3f3f46; padding: 2px 4px; border-radius: 4px; font-size: 12px; user-select: text !important; cursor: text; }
        .markdown-body pre code { background: transparent; padding: 0; color: #a1a1aa; user-select: text !important; cursor: text; }
        .markdown-body p { margin-bottom: 8px; user-select: text !important; cursor: text; }
        .markdown-body ul, .markdown-body ol { margin-left: 20px; margin-bottom: 8px; list-style: disc; user-select: text !important; cursor: text; }
        .markdown-body li { user-select: text !important; cursor: text; }
        .markdown-body video { max-width: 100%; border-radius: 0.5rem; margin-top: 0.5rem; }
        .markdown-body table { border-collapse: collapse; width: 100%; margin: 12px 0; }
        .markdown-body table th, .markdown-body table td { border: 1px solid #3f3f46; padding: 8px 12px; text-align: left; }
        .markdown-body table th { background-color: #3f3f46; font-weight: 600; }
        .markdown-body table tr:nth-child(even) { background-color: #27272a; }
        .theme-light .markdown-body table th, .theme-light .markdown-body table td { border-color: #d4d4d8; }
        .theme-light .markdown-body table th { background-color: #e4e4e7; }
        .theme-light .markdown-body table tr:nth-child(even) { background-color: #f4f4f5; }
        .theme-light .markdown-body { color: #18181b; }
        .theme-light .markdown-body pre { background: #f4f4f5; color: #18181b; }
        .theme-light .markdown-body code { background: #e4e4e7; color: #18181b; }
        .theme-light .markdown-body pre code { color: #18181b; }
        `,Lz=4e3,Uz=4e3,zr="https://ai.comfly.chat",Fz="http://localhost:5100",uf={openai:{key:"",url:zr},google:{key:"",url:zr},deepseek:{key:"",url:zr},flux:{key:"",url:zr},midjourney:{key:"",url:"https://api.midjourney.com"},jimeng:{key:"",url:Fz},grok:{key:"",url:"https://ai.t8star.cn"}},ax=[{id:"gpt-5.1",provider:"openai",type:"Chat"},{id:"gpt-5.2",provider:"openai",type:"Chat"},{id:"gpt-4o",provider:"openai",type:"Chat"},{id:"deepseek-v3-1-250821",provider:"deepseek",type:"Chat"},{id:"gemini-3-pro-preview",provider:"google",type:"Chat"},{id:"MJ V6",provider:"midjourney",type:"Image"},{id:"flux-kontext-pro",provider:"flux",type:"Image"},{id:"gpt-4o-image",provider:"openai",type:"Image"},{id:"jimeng-4.5",provider:"jimeng",type:"Image"},{id:"jimeng-4.1",provider:"jimeng",type:"Image"},{id:"jimeng-4.0",provider:"jimeng",type:"Image"},{id:"jimeng-3.1",provider:"jimeng",type:"Image"},{id:"jimeng-3.0",provider:"jimeng",type:"Image"},{id:"jimeng-2.1",provider:"jimeng",type:"Image"},{id:"jimeng-xl-pro",provider:"jimeng",type:"Image"},{id:"nanobananapro",provider:"jimeng",type:"Image"},{id:"nanobanana",provider:"jimeng",type:"Image"},{id:"sora-2",provider:"openai",type:"Video",durations:["5s","10s"]},{id:"sora-2-pro",provider:"openai",type:"Video",durations:["15s","25s"]},{id:"jimeng-video-3.5-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-veo3",provider:"jimeng",type:"Video",durations:["8s"]},{id:"jimeng-video-veo3.1",provider:"jimeng",type:"Video",durations:["8s"]},{id:"jimeng-video-sora2",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0-fast",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-2.0-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-2.0",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"grok-video-3",provider:"grok",type:"Video",durations:["8s","5s"]}],p0=["Auto","1:1","16:9","9:16","4:3","3:4","21:9","3:2","2:3"],Bz=["3:2","2:3","1:1"],Xy=["1080P","720P"],lx="tapnow_prompt_library",cx="3x3 gridKeep character strictly consistent9Character Sheet",ux="UpscaleSharpeningDenoisingBest quality, 8k, masterpiece, highres, ultra detailed, sharp focus, image restoration, upscale, faithful to original.",dx=`you are a veteran Hollywood storyboard artist with years of experience. You have the ability to accurately analyze character features and scene characteristics based on images. Provide me with the most suitable camera angles and storyboards. Strictly base this on the uploaded character and scene images, while maintaining a consistent visual style.

MANDATORY LAYOUT: Create a precise 3x3 GRID containing exactly 9 distinct panels.

- The output image MUST be a single image divided into a 3 (rows) by 3 (columns) matrix.
- There must be EXACTLY 3 horizontal rows and 3 vertical columns.
- Each panel must be completely separated by a thin, distinct, solid black line.
- DO NOT create a collage. DO NOT overlap images. DO NOT create random sizes. 
- The grid structure must be perfectly aligned for slicing.

Subject Content: "[]"

Styling Instructions:
- Each panel shows the SAME subject/scene from a DIFFERENT angle (e.g., Front, Side, Back, Action, Close-up).
- Maintain perfect consistency of the character/object across all panels.
- Cinematic lighting, high fidelity, 8k resolution.

Negative Constraints:
- No text, no captions, no UI elements.
- No watermarks.
- No broken grid lines.`,px=`(strictly mimic source image art style:1.5), (same visual style:1.4),
score_9, score_8_up, masterpiece, best quality, (character sheet:1.4), (reference sheet:1.3), (consistent art style:1.3), matching visual style, 

[Structure & General Annotations]:
multiple views, full body central figure, clean background, 
(heavy annotation:1.4), (text labels with arrows:1.3), handwriting, data readout,

[SPECIAL CHARACTER DESCRIPTION AREA]:
(prominent character profile text box:1.6), (dedicated biography section:1.5), large descriptive text block,
[],

[Clothing Breakdown]:
(clothing breakdown:1.5), (outfit decomposition:1.4), garment analysis, (floating apparel:1.3), 
displaying outerwear, displaying upper body garment, displaying lower body garment, 

[Footwear Focus]:
(detailed footwear display:1.5), (floating shoes:1.4), shoe design breakdown, focus on shoes, 

[Inventory & Details]:
(inventory knolling:1.2), open container, personal accessories, organized items display, expression panels`,fx=`# Directive: Create a "Rich Narrative Mood Board" (8-Grid Layout)

## 1. PROJECT INPUT 

**A. [Story & Concept / ]**
> []

**B. [Key Symbols /  (Optional)]**
> []

**C. [Color Preferences /  (Optional)]**
> []

**D. [Reference Images / ]**
> (See attached images / )

---

## 2. Role Definition
Act as a **Senior Art Director**. Synthesize the Input above into a single, cohesive, high-density **Visual Mood Board** using a complex **8-Panel Asymmetrical Grid Layout**.

## 3. Layout Mapping (Strict Adherence)
You must design a visual composition that tells the story through **8 distinct panels** within one image. **Do not** generate random grids. Map the content exactly as follows:

* **Panel 1 (The World):** A wide, cinematic establishing shot of the environment (based on Input A).
* **Panel 2 (The Protagonist):** A portrait close-up (based on reference images), focusing on micro-expressions.
* **Panel 3 (The Metaphor):** An **abstract symbolic object** representing the core theme (based on Input B).
* **Panel 4 (The Palette):** A graphical **Color Palette Strip** showcasing 5 specific colors extracted from the scene.
* **Panel 5 (The Texture):** Extreme macro close-up of a material surface (e.g., rust, skin, fabric) to add tactile richness.
* **Panel 6 (The Motion):** A motion-blurred or long-exposure shot representing time/chaos.
* **Panel 7 (The Detail):** A focused shot of a specific prop or accessory relevant to the plot.
* **Panel 8 (The AI Art Interpretation - CRITICAL):** This is your **free creative space**. Generate an artistic, surreal, or abstract re-interpretation of the story's emotion. **Do not just copy the inputs.** Create a "Vibe Image" (e.g., Double Exposure, Oil Painting style, or abstract geometry) that captures the *soul* of the narrative.

## 4. Execution Requirements
* **Composition Style:** High-end Editorial / Magazine Layout. Clean, thin white borders.
* **Visual Unity:** All panels must share the same lighting conditions and color grading logic (Unified Aesthetic).
* **Task:** Provide the **Final English Image Prompt** that explicitly describes this 8-grid layout, ensuring Panel 8 stands out as an artistic variation.`,hx=["gemini-image","qwen-image","doubao-seedream","jimeng","hailuo-02","kling-v1-6","wan-2.5"],mx=e=>e&&e.includes("grok")?Bz:p0,gx=["Auto","1K","2K","4K"],Ul=e=>{const t=String(e||"").toUpperCase();return t==="AUTO"?"Auto":t==="1K"?"1K":t==="2K"?"2K":t==="4K"?"4K":"2K"},Wz=["Auto",...Xy],Yl=e=>{const t=String(e||"").trim();if(!t)return"720P";if(t==="")return"Auto";const r=t.toUpperCase();return r==="AUTO"?"Auto":r==="1080P"?"1080P":"720P"},Lu=e=>{const t=Yl(e);return t==="Auto"?"":t==="1080P"?"1080p":"720p"},df=e=>e&&e.includes("jimeng-4.5")?["2K","4K"]:gx,pf=[{label:"MJ V7",value:"--v 7"},{label:"MJ V6.1",value:"--v 6.1"},{label:"MJ V6",value:"--v 6"},{label:"MJ V5.2",value:"--v 5.2"},{label:"MJ V5.1",value:"--v 5.1"},{label:"Niji V6",value:"--niji 6"},{label:"Niji V5",value:"--niji 5"},{label:"Niji V4",value:"--niji 4"}],Jy=(e,t)=>{let r=1024,i=1024;if(t==="1080P"?(r=1920,i=1080):t==="720P"?(r=1280,i=720):t==="2K"?(r=2048,i=2048):t==="4K"&&(r=3840,i=2160),e==="Auto")return{str:`${r}x${i}`,w:r,h:i};const[o,a]=e.split(":").map(Number);if(!o||!a)return{str:"1024x1024",w:1024,h:1024};let c,p;return Math.abs(o-a)<.1?(c=r,p=i):o>a?(c=t==="Auto"||t==="1K"?1280:r,p=Math.round(c*(a/o))):(p=t==="Auto"||t==="1K"?1280:r,c=Math.round(p*(o/a))),c=Math.round(c/16)*16,p=Math.round(p/16)*16,{str:`${c}x${p}`,w:c,h:p}},Hz=(e,t,r)=>{const{str:i,w:o,h:a}=Jy(t,r);return e.includes("minimax")?{sizeStr:r==="4K"?"1080p":"720p",w:o,h:a}:e.includes("jimeng")||e.includes("veo")?{sizeStr:t,w:o,h:a}:e.includes("grok")?{sizeStr:t,w:o,h:a}:{sizeStr:i,w:o,h:a}},Br=e=>new Promise((t,r)=>{const i=new Image;i.onload=()=>t({w:i.naturalWidth,h:i.naturalHeight}),i.onerror=()=>r(new Error("Failed to load image")),i.src=e}),Hn=e=>{if(!e)return!1;if(e.startsWith("data:video")||e.includes("force_video_display=true"))return!0;const t=e.split(".").pop().split("?")[0].toLowerCase();return["mp4","webm","ogg","mov"].includes(t)},xx=e=>new Promise((t,r)=>{const i=document.createElement("video");i.preload="metadata",i.muted=!0,i.playsInline=!0,i.onloadedmetadata=()=>{t({duration:Number(i.duration)||0,w:i.videoWidth||0,h:i.videoHeight||0})},i.onerror=()=>r(new Error("")),i.src=e}),Vz=(e,{fps:t=2}={})=>new Promise((r,i)=>{const o=document.createElement("video"),a=document.createElement("canvas"),c=a.getContext("2d");o.muted=!0,o.playsInline=!0,o.crossOrigin="anonymous",o.src=e;const p=[],m=()=>i(new Error(""));o.onerror=m,o.onloadedmetadata=()=>{const w=Number(o.duration)||0;if(!w||!isFinite(w)){i(new Error(""));return}a.width=o.videoWidth||1280,a.height=o.videoHeight||720;const $=1/Math.max(.1,t);let T=0;const E=()=>{c.drawImage(o,0,0,a.width,a.height),p.push({time:Number(T.toFixed(2)),url:a.toDataURL("image/jpeg",.82)}),T+=$,T<=w?o.currentTime=Math.min(T,w):r(p)};o.onseeked=E,o.currentTime=0}}),Kz=Ed.memo(({img1:e,img2:t})=>{const[r,i]=R.useState(50),o=R.useRef(null),[a,c]=R.useState(!1),p=R.useRef(),m=R.useCallback(T=>{o.current&&(p.current||(p.current=requestAnimationFrame(()=>{if(!o.current)return;const E=o.current.getBoundingClientRect(),y=T.touches?T.touches[0].clientX:T.clientX,A=Math.max(0,Math.min(y-E.left,E.width));i(A/E.width*100),p.current=null})))},[]);R.useEffect(()=>()=>{p.current&&cancelAnimationFrame(p.current)},[]);const w=e,$=t||e;return w?s.jsxs("div",{ref:o,className:"relative w-full h-full cursor-col-resize overflow-hidden group rounded-lg select-none shadow-2xl border border-zinc-800 bg-[#09090b]",onMouseMove:m,onTouchMove:m,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:[s.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"conic-gradient(#333 90deg, transparent 90deg), conic-gradient(transparent 90deg, #333 90deg)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"}}),s.jsx("img",{src:w,loading:"lazy",decoding:"async",className:"absolute inset-0 w-full h-full object-contain pointer-events-none select-none",draggable:!1}),s.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden pointer-events-none select-none",style:{clipPath:`inset(0 0 0 ${r}%)`},children:s.jsx("img",{src:$,loading:"lazy",decoding:"async",className:"absolute inset-0 w-full h-full object-contain",draggable:!1})}),s.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/80 shadow-[0_0_10px_rgba(0,0,0,0.5)] pointer-events-none",style:{left:`${r}%`},children:s.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-white rounded-full shadow-lg flex items-center justify-center text-black",children:s.jsx(d0,{size:12,className:"rotate-90"})})}),s.jsx("div",{className:`absolute bottom-2 left-2 bg-black/70 text-white text-[10px] font-medium px-2 py-0.5 rounded border border-white/10 transition-opacity duration-200 pointer-events-none ${a?"opacity-100":"opacity-60"}`,children:""}),s.jsx("div",{className:`absolute bottom-2 right-2 bg-blue-600/80 text-white text-[10px] font-medium px-2 py-0.5 rounded border border-white/10 transition-opacity duration-200 pointer-events-none ${a?"opacity-100":"opacity-60"}`,children:""})]}):s.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-900/50 rounded-lg border border-zinc-800 border-dashed pointer-events-none",children:[s.jsx(d0,{size:24,className:"mb-2 opacity-50"}),s.jsx("span",{className:"text-xs font-medium",children:""})]})}),Uu=Ed.memo(({children:e,onClick:t,className:r="",variant:i="primary",icon:o,disabled:a=!1,title:c=""})=>{const p="flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 font-medium text-xs select-none disabled:opacity-50 disabled:cursor-not-allowed",m={primary:"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 active:scale-95",secondary:"bg-zinc-800 hover:bg-zinc-700 text-zinc-300 border border-zinc-700 active:scale-95",ghost:"bg-transparent hover:bg-zinc-800 text-zinc-400 hover:text-white",danger:"bg-red-900/30 hover:bg-red-800 text-red-200 border border-red-800 active:scale-95"};return s.jsxs("button",{onClick:t,disabled:a,className:`${p} ${m[i]} ${r}`,title:c,children:[o&&s.jsx(o,{size:14,className:e?"mr-1.5":""}),e]})}),Fu=(e,t)=>{let r;return function(...o){const a=()=>{clearTimeout(r),e(...o)};clearTimeout(r),r=setTimeout(a,t)}},Yz=({isOpen:e,onClose:t,title:r,children:i,theme:o="dark"})=>{if(!e)return null;const a=o==="dark";return s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm",onMouseDown:t,children:s.jsxs("div",{className:`rounded-xl shadow-2xl w-[680px] max-w-[90vw] overflow-hidden animate-in fade-in zoom-in-95 duration-200 flex flex-col max-h-[85vh] border ${a?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,onMouseDown:c=>c.stopPropagation(),onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:`flex items-center justify-between p-5 border-b shrink-0 ${a?"border-zinc-800/50":"border-zinc-200"}`,children:[s.jsx("h3",{className:`font-bold text-lg ${a?"text-white":"text-zinc-900"}`,children:r}),s.jsx("button",{onClick:t,className:a?"text-zinc-500 hover:text-white":"text-zinc-500 hover:text-zinc-900",children:s.jsx(cs,{size:20})})]}),s.jsx("div",{className:`p-0 overflow-y-auto custom-scrollbar flex-1 ${a?"bg-[#09090b]":"bg-white"}`,children:i})]})})},Gz=({item:e,onClose:t,onNavigate:r,onShotNavigate:i,onHistoryNavigate:o})=>{var E;if(!e)return null;const a=R.useRef(e);R.useEffect(()=>{a.current=e},[e]);const c=e.type==="video"||e.url&&Hn(e.url),p=R.useMemo(()=>{const y=[],A=N=>{N&&!y.includes(N)&&y.push(N)};return A(e.url),c||A(e.thumbnailUrl),A(e.originalUrl),A(e.mjOriginalUrl),y},[e,c]),[m,w]=R.useState(0);R.useEffect(()=>{w(0)},[e,p.length]);const $=p[m]||e.url,T=R.useCallback(()=>{w(y=>y<p.length-1?y+1:y)},[p.length]);return R.useEffect(()=>{if(!e)return;const y=A=>{const N=a.current;if(N&&!(A.target.tagName==="INPUT"||A.target.tagName==="TEXTAREA"))if(A.key==="ArrowLeft"||A.key==="Left"){if(!N.mjImages||N.mjImages.length<=1)return;A.preventDefault(),A.stopPropagation();const D=N.selectedMjImageIndex!==void 0?N.selectedMjImageIndex:0,b=D>0?D-1:N.mjImages.length-1;b>=0&&b<N.mjImages.length&&r&&(a.current={...N,selectedMjImageIndex:b,url:N.mjImages[b]},r(b))}else if(A.key==="ArrowRight"||A.key==="Right"){if(!N.mjImages||N.mjImages.length<=1)return;A.preventDefault(),A.stopPropagation();const D=N.selectedMjImageIndex!==void 0?N.selectedMjImageIndex:0,b=D<N.mjImages.length-1?D+1:0;b>=0&&b<N.mjImages.length&&r&&(a.current={...N,selectedMjImageIndex:b,url:N.mjImages[b]},r(b))}else if(A.key==="ArrowUp"||A.key==="Up")if(A.preventDefault(),A.stopPropagation(),N.storyboardContext&&i){const{shotIndex:D,allShots:b}=N.storyboardContext;D>0&&i(D-1,b)}else o&&o(-1);else if(A.key==="ArrowDown"||A.key==="Down")if(A.preventDefault(),A.stopPropagation(),N.storyboardContext&&i){const{shotIndex:D,allShots:b}=N.storyboardContext;D<b.length-1&&i(D+1,b)}else o&&o(1);else(A.key==="Escape"||A.key==="Esc")&&(A.preventDefault(),A.stopPropagation(),t&&t())};return window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}},[e,r,i,o]),s.jsxs("div",{className:"fixed inset-0 z-[200] lightbox-overlay flex flex-col items-center justify-center animate-in fade-in duration-200",onClick:t,children:[s.jsx("button",{className:"absolute top-4 right-4 text-white/70 hover:text-white p-2 bg-black/50 rounded-full transition-colors",onClick:t,children:s.jsx(cs,{size:24})}),s.jsxs("div",{className:"max-w-[90vw] max-h-[85vh] relative",onClick:y=>y.stopPropagation(),children:[e.type==="image"?s.jsx(Yn,{src:$,alt:e.prompt,className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl object-contain",onError:T}):s.jsx("video",{src:$,controls:!0,autoPlay:!0,className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl",poster:e.thumbnailUrl||void 0,onError:T}),s.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur-md px-6 py-3 rounded-full text-white text-sm font-medium border border-white/10 text-center shadow-2xl",children:[s.jsx("div",{className:"line-clamp-1 max-w-xl",children:e.prompt}),s.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:[e.width,"x",e.height,"  ",e.id,e.mjImages&&e.mjImages.length>1&&s.jsxs("span",{className:"ml-2",children:["(",(e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0)+1,"/",e.mjImages.length,")"]}),e.storyboardContext&&s.jsxs("span",{className:"ml-2 text-blue-400",children:["Shot ",e.storyboardContext.shotIndex+1,"/",((E=e.storyboardContext.allShots)==null?void 0:E.length)||1]})]})]}),e.mjImages&&e.mjImages.length>1&&s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/70 hover:text-white p-3 bg-black/50 rounded-full transition-colors",onClick:y=>{y.stopPropagation();const A=e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0,N=A>0?A-1:e.mjImages.length-1;r&&r(N)},title:" ()",children:s.jsx(dz,{size:24})}),s.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-white/70 hover:text-white p-3 bg-black/50 rounded-full transition-colors",onClick:y=>{y.stopPropagation();const A=e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0,N=A<e.mjImages.length-1?A+1:0;r&&r(N)},title:" ()",children:s.jsx(wa,{size:24})})]})]})]})};function Xz(){var bm,ym;const[e,t]=R.useState(()=>{try{return localStorage.getItem("tapnow_theme")||"dark"}catch{return"dark"}}),[r,i]=R.useState([]),o=R.useCallback((n,l="info",d=3e3)=>{const f=Date.now();i(u=>[...u,{id:f,message:n,type:l}]),setTimeout(()=>{i(u=>u.filter(h=>h.id!==f))},d)},[]);R.useEffect(()=>{const n=document.createElement("style");return n.innerText=Oz,document.head.appendChild(n),()=>{document.head.removeChild(n)}},[]),R.useEffect(()=>{try{localStorage.setItem("tapnow_theme",e)}catch{}const n=document.documentElement;e==="dark"?(n.classList.add("theme-dark"),n.classList.remove("theme-light"),document.body.style.backgroundColor="#09090b"):(n.classList.add("theme-light"),n.classList.remove("theme-dark"),document.body.style.backgroundColor="#f4f4f5")},[e]),R.useEffect(()=>{const n=setInterval(()=>{try{const l={nodes:Jr.current,connections:dl.current,timestamp:Date.now()};localStorage.setItem("tapnow_autosave",JSON.stringify(l)),console.log("[AutoSave] ",new Date().toLocaleTimeString())}catch(l){console.warn("[AutoSave] :",l.message)}},6e4);return()=>clearInterval(n)},[]),R.useEffect(()=>{const n=l=>{if(Jr.current&&Jr.current.length>0)return l.preventDefault(),l.returnValue="",l.returnValue};return window.addEventListener("beforeunload",n),()=>window.removeEventListener("beforeunload",n)},[]);const[a,c]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_autosave");if(n)return JSON.parse(n).nodes||[];const l=localStorage.getItem("tapnow_nodes");return l?JSON.parse(l):[]}catch{return[]}}),[p,m]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_autosave");if(n)return JSON.parse(n).connections||[];const l=localStorage.getItem("tapnow_connections");return l?JSON.parse(l):[]}catch{return[]}}),[w,$]=R.useState(()=>{const n=localStorage.getItem("tapnow_max_undo_steps");return n?Math.min(30,Math.max(1,parseInt(n)||5)):5}),[T,E]=R.useState([]),[y,A]=R.useState([]),N=R.useRef(!1),[D,b]=R.useState(null),[z,P]=R.useState(null),[W,G]=R.useState(null),[oe,se]=R.useState([]),[ye,we]=R.useState([]),Se=R.useRef(new Map),Ke=R.useRef(new Map),[X,_e]=R.useState(()=>{try{return localStorage.getItem("tapnow_batch_queue_mode")||"parallel"}catch{return"parallel"}}),[I,je]=R.useState(0),[ht,ke]=R.useState(()=>parseInt(localStorage.getItem("tapnow_batch_concurrency")||"1")),ve=R.useRef(new Set),me=R.useRef("idle");R.useEffect(()=>{localStorage.setItem("tapnow_batch_concurrency",ht)},[ht]),R.useEffect(()=>{localStorage.setItem("tapnow_batch_queue_mode",X)},[X]);const Re=R.useCallback(()=>{N.current||(E(n=>[...n,{nodes:JSON.parse(JSON.stringify(a)),connections:JSON.parse(JSON.stringify(p))}].slice(-w)),A([]))},[a,p]),ce=R.useRef(Re);R.useEffect(()=>{ce.current=Re},[Re]),R.useEffect(()=>{if(oe.length===0){me.current="idle",ve.current.clear();return}let n=0;const l=[],d=Date.now(),f=6e4;if(a.forEach(x=>{var _;(_=x.settings)!=null&&_.shots&&x.settings.shots.forEach(S=>{S.status==="generating"&&(n++,S.generationStartTime&&d-S.generationStartTime>f&&l.push({nodeId:x.id,shotId:S.id}));const j=`${x.id}:${S.id}`;ve.current.has(j)&&(S.status==="generating"||S.status==="done"||S.status==="failed")&&ve.current.delete(j)})}),l.length>0&&(console.warn(`[Batch] ${l.length} tasks timed out (>${f/1e3}s). Auto-marking as failed.`),l.forEach(({nodeId:x,shotId:_})=>{Gt(x,_,{status:"failed",errorMsg:"60s"},{onlyIfStatus:"generating"})}),n-=l.length),n+ve.current.size>0){me.current="running";return}if(me.current==="running"){me.current="cooling",setTimeout(()=>{me.current="idle",je(x=>x+1)},1e3);return}if(me.current==="cooling")return;const h=ht===0?oe.length:ht,g=oe.slice(0,h),v=oe.slice(h);g.length>0&&(se(v),me.current="running",g.forEach(x=>{var j,C;ve.current.add(`${x.nodeId}:${x.shotId}`);const _=a.find(L=>L.id===x.nodeId),S=(C=(j=_==null?void 0:_.settings)==null?void 0:j.shots)==null?void 0:C.find(L=>L.id===x.shotId);S&&(x.mode==="image"?cm(x.nodeId,S):lm(x.nodeId,S))}))},[oe,a,ht,I]),R.useEffect(()=>{if(oe.length===0)return;const n=setInterval(()=>{je(l=>l+1)},5e3);return()=>clearInterval(n)},[oe.length>0]);const fe=R.useCallback((n=!1)=>{se([]),ve.current.clear(),me.current="idle",Ke.current.clear(),n&&c(l=>l.map(d=>{var g;if(d.type!=="storyboard-node")return d;const f=((g=d.settings)==null?void 0:g.shots)||[];let u=!1;const h=f.map(v=>v.status==="generating"?(u=!0,{...v,status:"failed",errorMsg:""}):v);return u?{...d,settings:{...d.settings,shots:h}}:d}))},[se,c]),ct=R.useCallback((n,l)=>{se(d=>d.filter(f=>!(f.nodeId===n&&f.shotId===l))),ve.current.delete(`${n}:${l}`),Gt(n,l,{status:"draft",errorMsg:""})},[se]),it=R.useCallback((n,l)=>{Gt(n,l,{status:"failed",errorMsg:""})},[]),Fe=R.useCallback(n=>{se(l=>l.filter(d=>d.batchId!==n?!0:(ve.current.delete(`${d.nodeId}:${d.shotId}`),Ke.current.delete(`${d.nodeId}:${d.shotId}`),Gt(d.nodeId,d.shotId,{status:"draft",errorMsg:""}),!1)))},[se]),on=R.useCallback((n,l=!1)=>{se(d=>d.filter(f=>f.nodeId!==n?!0:(ve.current.delete(`${f.nodeId}:${f.shotId}`),Ke.current.delete(`${f.nodeId}:${f.shotId}`),!1))),l&&c(d=>d.map(f=>{var v;if(f.id!==n||f.type!=="storyboard-node")return f;const u=((v=f.settings)==null?void 0:v.shots)||[];let h=!1;const g=u.map(x=>x.status==="generating"?(h=!0,{...x,status:"failed",errorMsg:""}):x);return h?{...f,settings:{...f.settings,shots:g}}:f}))},[se,c]),Cn=R.useMemo(()=>oe.map((n,l)=>{var g,v;const d=a.find(x=>x.id===n.nodeId),f=((g=d==null?void 0:d.settings)==null?void 0:g.shots)||[],u=f.findIndex(x=>x.id===n.shotId),h=u>=0?f[u]:null;return{...n,order:l+1,projectTitle:((v=d==null?void 0:d.settings)==null?void 0:v.projectTitle)||"",sceneIndex:(h==null?void 0:h.scene_index)||(u>=0?u+1:"?"),taskIndex:n.taskIndex,batchId:n.batchId,batchOrder:n.batchOrder,batchConcurrency:n.batchConcurrency}}),[oe,a]),Xt=R.useMemo(()=>{const n=[];return a.forEach(l=>{var f;if(l.type!=="storyboard-node")return;(((f=l.settings)==null?void 0:f.shots)||[]).forEach((u,h)=>{var v;if(u.status!=="generating")return;const g=Ke.current.get(`${l.id}:${u.id}`)||{};n.push({nodeId:l.id,shotId:u.id,projectTitle:((v=l.settings)==null?void 0:v.projectTitle)||"",sceneIndex:u.scene_index||h+1,batchId:g.batchId,batchOrder:g.batchOrder,taskIndex:g.taskIndex})})}),n},[a]);R.useEffect(()=>{const n=new Set;if(oe.forEach(l=>{n.add(`${l.nodeId}:${l.shotId}`)}),a.forEach(l=>{var f;if(l.type!=="storyboard-node")return;(((f=l.settings)==null?void 0:f.shots)||[]).forEach(u=>{u.status==="generating"&&n.add(`${l.id}:${u.id}`)})}),n.size===0){Ke.current.clear(),we([]);return}Ke.current.forEach((l,d)=>{n.has(d)||Ke.current.delete(d)}),we(l=>l.filter(d=>d.shotIds.some(f=>n.has(`${d.nodeId}:${f}`))))},[oe,a]);const cn=R.useCallback(()=>{if(T.length===0)return;N.current=!0;const n=T[T.length-1];A(l=>[...l,{nodes:JSON.parse(JSON.stringify(a)),connections:JSON.parse(JSON.stringify(p))}]),c(n.nodes),m(n.connections),E(l=>l.slice(0,-1)),setTimeout(()=>{N.current=!1},100)},[T,a,p]),En=R.useCallback(()=>{if(y.length===0)return;N.current=!0;const n=y[y.length-1];E(l=>[...l,{nodes:JSON.parse(JSON.stringify(a)),connections:JSON.parse(JSON.stringify(p))}]),c(n.nodes),m(n.connections),A(l=>l.slice(0,-1)),setTimeout(()=>{N.current=!1},100)},[y,a,p]);R.useEffect(()=>{const n=l=>{(l.ctrlKey||l.metaKey)&&l.key==="z"&&(l.shiftKey?(l.preventDefault(),En()):(l.preventDefault(),cn()))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[cn,En]);const[$t,dr]=R.useState({x:0,y:0,zoom:1}),Qn=R.useRef({x:0,y:0,zoom:1});R.useRef(null),R.useRef(new Map),R.useRef(new Map);const[k,Ne]=R.useState(null),[ue,K]=R.useState(()=>{const n=localStorage.getItem("tapnow_api_configs");if(n)try{let l=JSON.parse(n);l=l.map(u=>{if(u.modelName&&u.modelName!==u.id)return{id:u.modelName,provider:u.provider,type:u.type,...u.durations?{durations:u.durations}:{}};const{displayName:h,modelName:g,isCustom:v,...x}=u;return x}),l=l.filter(u=>!hx.includes(u.id));const d=new Map;return l.forEach(u=>{u.id&&d.set(u.id,u)}),ax.filter(u=>u.type==="Chat").forEach(u=>{d.has(u.id)||d.set(u.id,u)}),l=Array.from(d.values()),l=l.map(u=>u._uid?u:{...u,_uid:`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}),l}catch(l){console.error("[V3.6.0]  apiConfigs :",l)}return ax.map(l=>({...l,_uid:`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}))}),[H,ae]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_providers");if(n)return JSON.parse(n)}catch(n){console.error(" providers :",n)}return{...uf}});R.useEffect(()=>{try{localStorage.setItem("tapnow_providers",JSON.stringify(H))}catch(n){console.error(" providers :",n)}},[H]),R.useCallback(n=>{const l=ue.find(f=>f.id===n);if(!l)return{key:"",url:zr,id:n};const d=H[l.provider]||{};return{...l,modelName:l.id,key:d.key||"",url:d.url||zr}},[ue,H]);const[Me,Be]=R.useState(()=>localStorage.getItem("tapnow_global_key")||""),[be,Ze]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_api_blacklist");if(!n)return{};const l=JSON.parse(n),d=new Date().toDateString();return l.date!==d?{}:l.blacklist||{}}catch{return{}}});R.useEffect(()=>{try{localStorage.setItem("tapnow_api_blacklist",JSON.stringify({date:new Date().toDateString(),blacklist:be}))}catch{}},[be]);const dt=R.useRef(be);R.useEffect(()=>{dt.current=be},[be]);const Ye=(n,l)=>{if(!n)return;const d={date:new Date().toDateString(),reason:l,timestamp:Date.now()},f=dt.current||{};dt.current={...f,[n]:d},Ze(u=>({...u,[n]:d}))},[_t,rn]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_api_suspend");if(!n)return{};const l=JSON.parse(n),d=Date.now();return Object.fromEntries(Object.entries(l).filter(([,f])=>d-f.timestamp<60*60*1e3))}catch{return{}}});R.useEffect(()=>{try{localStorage.setItem("tapnow_api_suspend",JSON.stringify(_t))}catch{}},[_t]);const Qt=R.useRef(_t);R.useEffect(()=>{Qt.current=_t},[_t]);const vr=(n,l,d=60*60*1e3)=>{if(!n)return;const f={reason:l,timestamp:Date.now(),ttl:d};Qt.current={...Qt.current,[n]:f},rn(u=>({...u,[n]:f}))},Gs=n=>{var d;const l=(d=Qt.current)==null?void 0:d[n];return l?Date.now()-l.timestamp<(l.ttl||60*60*1e3):!1},ir=R.useRef([]),Xs=2*60*1e3,jn=10,$s=()=>{const n=Date.now(),l=ir.current.filter(d=>n-d<Xs);return ir.current=l,l.length>=jn},Pr=()=>{ir.current.push(Date.now())},[or,Ei]=R.useState(()=>{const n=localStorage.getItem("tapnow_jimeng_use_local_file");return n!==null?n==="true":!0}),[pr,xo]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_nodes");return!n||JSON.parse(n).length===0?(localStorage.removeItem("tapnow_project_name"),""):localStorage.getItem("tapnow_project_name")||""}catch{return""}}),[$i,Ms]=R.useState(!1),Js=R.useRef(null),[Ar,bo]=R.useState({visible:!1,progress:0,status:"",type:"import"}),[er,Zn]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_history_performance_mode");return n!==null?n==="true"?"normal":n==="false"?"off":n||"off":localStorage.getItem("tapnow_performance_mode")||"off"}catch{return"off"}}),[wr,Yd]=R.useState(()=>{try{return localStorage.getItem("tapnow_global_performance_mode")||"off"}catch{return"off"}}),[In,Ja]=R.useState(()=>localStorage.getItem("tapnow_local_server_url")||"http://127.0.0.1:9527"),[fn,Go]=R.useState(!1),[Rr,kr]=R.useState({savePath:"",imageSavePath:"",videoSavePath:"",convertPngToJpg:!0,jpgQuality:95,pilAvailable:!1}),Dr=R.useRef(new Map),ci=R.useRef(new Set),Xo=R.useRef(new Map),ns=R.useRef(new Map);R.useEffect(()=>{localStorage.setItem("tapnow_performance_mode",er),localStorage.setItem("tapnow_history_performance_mode",er)},[er]),R.useEffect(()=>{localStorage.setItem("tapnow_global_performance_mode",wr)},[wr]),R.useEffect(()=>{localStorage.setItem("tapnow_local_server_url",In)},[In]);const[Pt,St]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_history");return n?JSON.parse(n).map(d=>{var f,u;return d.mjNeedsSplit&&d.mjOriginalUrl&&((u=(f=d.apiConfig)==null?void 0:f.modelId)!=null&&u.includes("mj"))?{...d,url:d.mjOriginalUrl,mjImages:null,mjNeedsSplit:!0}:d}):[]}catch(n){return console.error(":",n),[]}}),[yo]=R.useState(()=>Date.now()),[Mi,fr]=R.useState({active:!1,current:0,total:0,filename:""}),[hr,Jo]=R.useState(new Set),[Ft,ee]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_auto_save_config");return n?JSON.parse(n):{enabled:!1,interval:5,folderPath:""}}catch{return{enabled:!1,interval:5,folderPath:""}}}),[qe,Mt]=R.useState(!1),[an,Fn]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_chat_sessions");return n?JSON.parse(n):[{id:"default",title:"",messages:[]}]}catch{return[{id:"default",title:"",messages:[]}]}}),[bn,rr]=R.useState("default"),[Sr,ui]=R.useState(""),[di,An]=R.useState(!1),[Ec,$c]=R.useState(400),[Zo,Ti]=R.useState([]),[xs,Zy]=R.useState(()=>{try{return localStorage.getItem("tapnow_chat_model")||"gemini-3-pro"}catch{return"gemini-3-pro"}}),[hh,mh]=R.useState(!1),[Mc,Tc]=R.useState(null),[Pc,gh]=R.useState(!1);R.useEffect(()=>{try{localStorage.setItem("tapnow_chat_model",xs)}catch{}},[xs]);const[Pi,$n]=R.useState(null),Ac=R.useRef(Pi);R.useEffect(()=>{Ac.current=Pi},[Pi]);const[Za,xh]=R.useState(()=>{try{const n=localStorage.getItem(lx),l=n?JSON.parse(n):[],d=[{id:"grid-default",name:"",prompt:cx},{id:"upscale-default",name:"",prompt:ux},{id:"moodboard-default",name:"",prompt:fx},{id:"storyboard-default",name:"",prompt:dx},{id:"character-sheet-default",name:"",prompt:px}],f=new Set((l||[]).map(h=>h.id)),u=[...l];return d.forEach(h=>{const g=u.some(v=>v.name===h.name);!f.has(h.id)&&!g&&u.unshift(h)}),u}catch{return[{id:"grid-default",name:"",prompt:cx},{id:"upscale-default",name:"",prompt:ux},{id:"moodboard-default",name:"",prompt:fx},{id:"storyboard-default",name:"",prompt:dx},{id:"character-sheet-default",name:"",prompt:px}]}}),[Rc,Gd]=R.useState({name:"",prompt:""}),[bh,qy]=R.useState(!1),[Xd,Qy]=R.useState(!1);R.useEffect(()=>{try{localStorage.setItem(lx,JSON.stringify(Za))}catch{}},[Za]);const[qo,qa]=R.useState(!1),[Jd,Qa]=R.useState(!1),[Xr,el]=R.useState(null),[Qo,Dc]=R.useState(null),[Bn,ea]=R.useState(null),[gn,bs]=R.useState(null),[ys,vs]=R.useState(null),[Zd,Ts]=R.useState({x:0,y:0}),[ta,Ai]=R.useState(null),[Jz,yh]=R.useState(!1),[vh,qd]=R.useState({});R.useEffect(()=>{const n=setInterval(()=>{const l=Date.now(),d={};let f=!1;Jr.current&&Jr.current.forEach(u=>{var h;u.type==="storyboard-node"&&((h=u.settings)!=null&&h.shots)&&u.settings.shots.forEach(g=>{if(g.status==="generating"&&g.generationStartTime){const v=(l-g.generationStartTime)/1e3;d[`${u.id}-${g.id}`]=`${v.toFixed(1)}s`,f=!0}})}),f&&qd(d)},100);return()=>clearInterval(n)},[]);const[Ri,Qd]=R.useState(!1),[Ps,ep]=R.useState(null),[Mn,Or]=R.useState(new Set),pi=R.useRef(!1),[mr,na]=R.useState({x:0,y:0,worldX:0,worldY:0,visible:!1}),[e1,Di]=R.useState(!1),[tp,np]=R.useState({visible:!1,x:0,y:0}),[Cr,As]=R.useState({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null}),[rs,tl]=R.useState({nodeId:null,shotId:null}),[Oi,rp]=R.useState({visible:!1,x:0,y:0,nodeId:null,frame:null}),[Li,wh]=R.useState({visible:!1,x:0,y:0,item:null}),[nl,kh]=R.useState({visible:!1,x:0,y:0,nodeId:null}),[t1,ss]=R.useState(!1),[Oc,Lc]=R.useState(!1),[zh,n1]=R.useState(!1),[jh,r1]=R.useState(!1),[Zz,sp]=R.useState(-1),[Nh,ra]=R.useState(!1),[Wn,sa]=R.useState(()=>{try{const n=localStorage.getItem("tapnow_characters");return n?JSON.parse(n):[]}catch(n){return console.error(":",n),[]}}),[s1,rl]=R.useState(!1),[fi,Uc]=R.useState("url"),[ia,Fc]=R.useState(""),[oa,Bc]=R.useState(""),[aa,_h]=R.useState(1),[la,Sh]=R.useState(3),[sl,il]=R.useState(""),[ip,ca]=R.useState(!1),[Ch,ol]=R.useState(null),[Ih,Wc]=R.useState({}),[i1,Hc]=R.useState(!1),[ar,vo]=R.useState(new Set),[Eh,op]=R.useState(!1),[o1,a1]=R.useState("select"),[Ce,nn]=R.useState(null),[Nn,tr]=R.useState(null),[al,ap]=R.useState({}),[ua,Vc]=R.useState(null),[l1,lp]=R.useState(null),[$h,cp]=R.useState(null),[up,ll]=R.useState({}),[Mh,c1]=R.useState({}),[Ui,dp]=R.useState(()=>{try{return localStorage.getItem("tapnow_last_image_model")||"nano-banana"}catch{return"nano-banana"}}),[wo,pp]=R.useState(()=>{try{return localStorage.getItem("tapnow_last_video_model")||"sora-2"}catch{return"sora-2"}}),[hi,u1]=R.useState(()=>{try{return localStorage.getItem("tapnow_last_ratio")||"1:1"}catch{return"1:1"}}),[ko,d1]=R.useState(()=>{try{return Ul(localStorage.getItem("tapnow_last_image_res")||"2K")}catch{return"2K"}}),[da,Th]=R.useState(()=>{try{return Yl(localStorage.getItem("tapnow_last_video_res")||"720P")}catch{return"720P"}}),[p1,f1]=R.useState(()=>{try{return localStorage.getItem("tapnow_last_segment_duration")||"3"}catch{return"3"}}),[h1,m1]=R.useState(()=>{try{return localStorage.getItem("tapnow_last_analyze_model")||"gemini-3-pro"}catch{return"gemini-3-pro"}}),[Fi,fp]=R.useState(()=>{try{return localStorage.getItem("tapnow_last_extract_model")||""}catch{return""}});R.useEffect(()=>{const n=(In||"").replace(/\/+$/,"");if(!n){Go(!1);return}const l=async()=>{try{const f=await fetch(`${n}/ping`,{method:"GET"});if(f.ok){const u=await f.json();Go(!0),kr(h=>({...h,savePath:Ir(u.save_path||h.savePath||""),imageSavePath:Ir(u.image_save_path||""),videoSavePath:Ir(u.video_save_path||""),convertPngToJpg:u.convert_png_to_jpg!==!1,jpgQuality:u.jpg_quality||h.jpgQuality,pilAvailable:u.pil_available||!1}));return}}catch{}Go(!1)};l();const d=setInterval(l,3e4);return()=>clearInterval(d)},[In]),R.useEffect(()=>{c(n=>n.map(l=>{var f,u;if(l.type!=="local-save"||(f=l.settings)!=null&&f.serverUrl)return l;const d=fn?"connected":"disconnected";return((u=l.settings)==null?void 0:u.serverStatus)===d?l:{...l,settings:{...l.settings,serverStatus:d}}}))},[fn]);const is=R.useCallback(n=>n?n.replace(/[<>:"/\\|?*\x00-\x1F]/g,"_").replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"").slice(0,120):"",[]),Ir=R.useCallback(n=>n?/^[a-zA-Z]:/.test(n)?n.replace(/\//g,"\\").replace(/\\+/g,"\\").trim():n.trim():"",[]),os=R.useCallback(n=>{if(!n)return null;try{const d=n.split("?")[0].split("/"),u=d[d.length-1].replace(/\.[^.]+$/,"");return is(u||"")||null}catch{return null}},[is]),Bi=R.useCallback((n,l="")=>{if(!n||!n.startsWith("data:"))return l;const d=n.match(/^data:([^;]+);/i);if(!d)return l;const f=d[1].toLowerCase();return{"image/jpeg":".jpg","image/jpg":".jpg","image/png":".png","image/webp":".webp","image/gif":".gif","video/mp4":".mp4","video/webm":".webm","video/quicktime":".mov"}[f]||l},[]),pa=R.useCallback((n,l="")=>{if(!n)return l;const f=n.split("?")[0].split("#")[0].match(/\.([a-zA-Z0-9]+)$/);if(!f)return l;const u=`.${f[1].toLowerCase()}`;return u===".jpeg"?".jpg":u},[]),Kc=R.useCallback((n,l)=>{const d=os(n);return d||is(l||"")||`cache_${Date.now()}`},[os,is]),fa=R.useCallback(async(n,l="normal")=>{const d=l==="ultra"?{maxSize:80,jpegQuality:.3}:{maxSize:150,jpegQuality:.6};return new Promise(f=>{try{const u=new Image;u.crossOrigin="anonymous",u.onload=()=>{const h=document.createElement("canvas");let g=u.naturalWidth,v=u.naturalHeight;g>v?g>d.maxSize&&(v=v*d.maxSize/g,g=d.maxSize):v>d.maxSize&&(g=g*d.maxSize/v,v=d.maxSize),h.width=g,h.height=v,h.getContext("2d").drawImage(u,0,0,g,v),f(h.toDataURL("image/jpeg",d.jpegQuality))},u.onerror=()=>f(null),u.src=n}catch{f(null)}})},[]),Yc=R.useCallback(async(n,l,d="history",f={})=>{if(!fn)return null;const u=(In||"").replace(/\/+$/,"");if(!u)return null;try{const g=(f!=null&&f.forceId?is(n||""):"")||Kc(l,n);let v=l;if(!l.startsWith("data:")){const j=await(await fetch(l)).blob();v=await new Promise(C=>{const L=new FileReader;L.onloadend=()=>C(L.result),L.readAsDataURL(j)})}const x=Bi(v,pa(l,".jpg")),_=await fetch(`${u}/save-cache`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:g,content:v,category:d,ext:x,type:"image"})});if(_.ok){const S=await _.json();if(S.success)return{url:S.url,path:S.path}}}catch(h){console.warn("[] :",h)}return null},[fn,In,Kc,Bi,pa,is]),Ph=R.useCallback(async(n,l,d="history")=>{if(!fn)return null;const f=(In||"").replace(/\/+$/,"");if(!f)return null;try{const u=Kc(l,n),g=await(await fetch(l)).blob(),v=await new Promise(S=>{const j=new FileReader;j.onloadend=()=>S(j.result),j.readAsDataURL(g)}),x=Bi(v,pa(l,".mp4")),_=await fetch(`${f}/save-cache`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:u,content:v,category:d,ext:x,type:"video"})});if(_.ok){const S=await _.json();if(S.success)return{url:S.url,path:S.path}}}catch(u){console.warn("[] :",u)}return null},[fn,In,Kc,Bi,pa]),cl=R.useCallback(async(n,l={})=>{const d=l.silent===!0,f=(In||"").replace(/\/+$/,"");if(!f)return d||o("","error"),!1;const u={...n};u.save_path&&(u.save_path=Ir(u.save_path)),u.image_save_path&&(u.image_save_path=Ir(u.image_save_path)),u.video_save_path&&(u.video_save_path=Ir(u.video_save_path));try{const h=await fetch(`${f}/config`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!h.ok){const v=await h.text();throw new Error(v||"")}const g=await h.json();return g!=null&&g.config&&kr(v=>({...v,savePath:Ir(g.config.save_path||v.savePath||""),imageSavePath:Ir(g.config.image_save_path||""),videoSavePath:Ir(g.config.video_save_path||""),convertPngToJpg:g.config.convert_png_to_jpg!==!1,jpgQuality:g.config.jpg_quality||v.jpgQuality})),d||o((g==null?void 0:g.message)||"","success",2e3),!0}catch(h){return d||o(`: ${h.message||""}`,"error",2e3),!1}},[In,o,Ir]),g1=R.useCallback(()=>{ci.current=new Set,Dr.current=new Map,Xo.current=new Map,ns.current=new Map,St(n=>n.map(l=>({...l,localCacheUrl:null,localFilePath:null,localCacheMap:null}))),sa(n=>n.map(l=>({...l,localCacheUrl:null,localFilePath:null}))),o("","success")},[o]),Ah=R.useCallback((n,l)=>{if(n){if(l)for(const[d,f]of ns.current.entries())f===l&&ns.current.delete(d);St(d=>d.map(f=>{if(f.id!==n)return f;if(!l)return{...f,localCacheUrl:null,localFilePath:null,localCacheMap:null};let u=f.localCacheMap?{...f.localCacheMap}:null;u&&u[l]&&delete u[l];const h=u?Object.keys(u):[],g=f.localCacheUrl===l?h.length>0?u[h[0]]:null:f.localCacheUrl;return{...f,localCacheUrl:g||null,localFilePath:g?f.localFilePath:null,localCacheMap:h.length>0?u:null}}))}},[]),Rn=R.useCallback((n,l=null)=>n?l?fn&&n.localCacheMap&&n.localCacheMap[l]?n.localCacheMap[l]:l:(fn?n.localCacheUrl||(n.localCacheMap?Object.values(n.localCacheMap)[0]:null):null)||n.url||n.originalUrl||n.mjOriginalUrl||"":"",[fn]);R.useCallback((n,l=null)=>{if(!n)return"";if(l){if(fn&&n.localCacheMap&&n.localCacheMap[l])return n.localCacheMap[l];if(er!=="off"&&n.mjImages&&n.mjThumbnails){const f=n.mjImages.indexOf(l);if(f>=0&&n.mjThumbnails[f])return n.mjThumbnails[f]}return l}const d=fn?n.localCacheUrl||(n.localCacheMap?Object.values(n.localCacheMap)[0]:null):null;return er==="off"?d||n.url||n.originalUrl||n.mjOriginalUrl||"":d||n.thumbnailUrl||n.url||n.originalUrl||n.mjOriginalUrl||""},[fn,er]);const Rh=R.useCallback(async n=>{if(!n)return;const l=n.mjImages&&n.mjImages.length>0?n.mjImages:[n.url||n.originalUrl||n.mjOriginalUrl].filter(Boolean);if(l.length===0){o("","warning");return}const d=er==="ultra"?"ultra":"normal";if(l.forEach(f=>{f&&Dr.current.delete(f);const u=Rn(n,f);u&&Dr.current.delete(u)}),l.length>1){const f=await Promise.all(l.map(async u=>{const h=Rn(n,u);return h?await fa(h,d):null}));St(u=>u.map(h=>h.id===n.id?{...h,mjThumbnails:f}:h))}else{const f=Rn(n,l[0]),u=f?await fa(f,d):null;St(h=>h.map(g=>g.id===n.id?{...g,thumbnailUrl:u||null}:g))}o("","success")},[fa,er,Rn,o]),Dh=R.useCallback((n,l)=>{const d=document.createElement("input");d.type="file",d.setAttribute("webkitdirectory",""),d.setAttribute("directory",""),d.multiple=!0,d.onchange=()=>{const f=d.files&&d.files[0];if(!f)return;const u=f.path||"";if(!u){o("","warning",3e3);return}const h=u.replace(/[\\/][^\\/]+$/,""),g=Ir(h);kr(v=>({...v,[n]:g})),cl({[l]:g},{silent:!0}),o("","success",2e3)},d.click()},[Ir,cl,o]);R.useEffect(()=>{if(er==="off")return;const l=setTimeout(async()=>{const d=er==="ultra"?"ultra":"normal",u=Pt.filter(h=>h.status==="completed"&&h.type==="image"&&(h.url||h.originalUrl||h.mjOriginalUrl)&&!h.thumbnailUrl).slice(0,5);if(u.length!==0)for(const h of u)try{const g=h.url||h.originalUrl||h.mjOriginalUrl;if(!g)continue;let v=Dr.current.get(g);v||(v=await fa(g,d),v&&Dr.current.set(g,v));let x=null;h.mjImages&&h.mjImages.length>0&&(x=await Promise.all(h.mjImages.map(async _=>{if(!_)return null;const S=Dr.current.get(_);if(S)return S;const j=await fa(_,d);return j&&Dr.current.set(_,j),j}))),(v||x)&&St(_=>_.map(S=>S.id===h.id?{...S,thumbnailUrl:v||S.thumbnailUrl,mjThumbnails:x||S.mjThumbnails}:S))}catch(g){console.warn("[] :",g)}},100);return()=>clearTimeout(l)},[er,Pt,fa]),R.useEffect(()=>{if(!fn)return;const l=setTimeout(async()=>{for(const d of Wn)if(!d.localCacheUrl&&!(!d.profile_picture_url||d.profile_picture_url.startsWith("blob:")))try{const f=await Yc(d.id,d.profile_picture_url,"characters");f&&sa(u=>u.map(h=>h.id===d.id?{...h,localCacheUrl:f.url,localFilePath:f.path}:h))}catch(f){console.warn("[] :",d.username,f)}},2e3);return()=>clearTimeout(l)},[Wn,fn,Yc]),R.useEffect(()=>{if(!fn)return;const l=setTimeout(async()=>{const d=(In||"").replace(/\/+$/,"");if(!d)return;const f="history";for(const u of Pt){if(u.status!=="completed"||u.type!=="image")continue;let h=u.localCacheUrl||null,g=u.localFilePath||null,v=u.localCacheMap?{...u.localCacheMap}:{},x=!1;const _=h||(Object.keys(v).length>0?Object.values(v)[0]:null);if(_){const M=Date.now(),U=Xo.current.get(u.id)||0;if(M-U>3e4){Xo.current.set(u.id,M);let V=!1;try{(await fetch(_,{method:"HEAD"})).ok||(V=!0)}catch{V=!0}V&&(v&&Object.keys(v).length>0&&Object.entries(v).forEach(([F,J])=>{ns.current.get(F)===J&&ns.current.delete(F)}),h=null,g=null,v={},x=!0,ci.current.delete(u.id))}}const S=u.mjImages&&u.mjImages.length>0?u.mjImages:u.output_images&&u.output_images.length>0?u.output_images:[u.url||u.originalUrl||u.mjOriginalUrl].filter(Boolean),j=[...new Set(S.filter(Boolean))];if(j.length===0)continue;const C=j.length>1,L=j.reduce((M,U)=>v[U]?M+1:M,0);if(!(ci.current.has(u.id)&&L>=j.length)){ci.current.add(u.id);for(let M=0;M<j.length;M++){const U=j[M];if(!U||U.startsWith("blob:")||U.includes("..."))continue;if(ns.current.has(U)){const Y=ns.current.get(U);Y&&!v[U]&&(v[U]=Y,x=!0),!h&&Y&&(h=Y);continue}const V=is(`${u.id}-${M}`)||`${u.id}-${M}`,F=C?V:os(U)||V;let J=!1;for(const Y of[".jpg",".png"])try{const de=`${f}/${F}${Y}`,Z=`${d}/file/${de}`;if((await fetch(Z,{method:"HEAD"})).ok){ns.current.set(U,Z),v[U]=Z,x=!0,h||(h=Z,g=de),J=!0;break}}catch{}if(!J)try{const Y=await Yc(`${u.id}-${M}`,U,"history",{forceId:C});Y&&(ns.current.set(U,Y.url),v[U]=Y.url,x=!0,h||(h=Y.url,g=Y.path))}catch(Y){console.warn("[] :",u.id,Y)}}if(x||h!==u.localCacheUrl){const M=Object.keys(v).length>0?v:null;St(U=>U.map(V=>V.id===u.id?{...V,localCacheUrl:h||null,localFilePath:g||null,localCacheMap:M}:V))}}}},3e3);return()=>clearTimeout(l)},[Pt,fn,Yc,os,is,Rr.imageSavePath,Rr.savePath,In]),R.useEffect(()=>{if(!fn)return;const l=setTimeout(async()=>{const d=(In||"").replace(/\/+$/,"");if(d)for(const f of Pt){if(f.status!=="completed"||f.type!=="video"||f.localCacheUrl||ci.current.has(f.id))continue;ci.current.add(f.id);const u=f.url||f.originalUrl;if(u&&(u.includes("localhost:")||u.includes("127.0.0.1:")))continue;const g=[u?os(u):null,f.id].filter(Boolean);let v=!1;const x="history";for(const _ of g){if(v)break;try{const S=`${x}/${_}.mp4`,j=`${d}/file/${S}`;(await fetch(j,{method:"HEAD"})).ok&&(St(L=>L.map(M=>M.id===f.id?{...M,localCacheUrl:j,localFilePath:S}:M)),v=!0)}catch{}}if(!v&&!(!u||u.startsWith("blob:")||u.includes("...")))try{const _=await Ph(f.id,u,"history");_&&St(S=>S.map(j=>j.id===f.id?{...j,localCacheUrl:_.url,localFilePath:_.path}:j))}catch(_){console.warn("[] :",f.id,_)}}},5e3);return()=>clearTimeout(l)},[Pt,fn,Ph,os,Rr.videoSavePath,Rr.savePath,In]);const Zs=R.useRef(null),ul=R.useRef({x:0,y:0}),Oh=R.useRef(null),Jr=R.useRef(a),Wi=R.useRef(k),qs=R.useRef(Mn),dl=R.useRef(p),Gc=R.useRef({}),mi=R.useRef(null),ha=R.useRef(!1),gi=R.useRef(null),Qs=R.useRef(null),Hi=R.useRef(null),pl=R.useRef(null);R.useEffect(()=>{localStorage.setItem("tapnow_api_configs",JSON.stringify(ue))},[ue]);const hp=R.useCallback(n=>{Re(),c(l=>l.filter(d=>d.id!==n)),m(l=>l.filter(d=>d.from!==n&&d.to!==n)),k===n&&Ne(null)},[k,Re]),Le=R.useCallback((n,l)=>{c(d=>d.map(f=>f.id===n?{...f,settings:{...f.settings,...l}}:f))},[]),fl=(n,l)=>{if(!l)return;const d=new FileReader;d.onload=async f=>{const u=f.target.result;let h={duration:0,w:0,h:0};try{h=await xx(u)}catch(g){console.warn("",g)}c(g=>g.map(v=>v.id===n?{...v,content:u,videoMeta:h,frames:[],selectedKeyframes:[],extractingFrames:!1,videoFileName:l.name}:v))},d.readAsDataURL(l)};R.useEffect(()=>{const n=l=>{if(!(l.target.tagName==="INPUT"||l.target.tagName==="TEXTAREA"||l.target.isContentEditable)&&(l.key==="Delete"||l.key==="Del")){l.preventDefault(),l.stopPropagation();const d=Wi.current,f=qs.current;if(d)hp(d),Ne(null);else if(f&&f.size>0){ce.current&&ce.current();const u=new Set(f);c(h=>h.filter(g=>!u.has(g.id))),m(h=>h.filter(g=>!u.has(g.from)&&!u.has(g.to))),Or(new Set)}}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]);const Lh=R.useMemo(()=>Fu(n=>{try{localStorage.setItem("tapnow_characters",JSON.stringify(n))}catch(l){console.error(":",l)}},500),[]);R.useEffect(()=>{Lh(Wn)},[Wn,Lh]),R.useEffect(()=>{ol(null)},[ia,oa,fi]),R.useEffect(()=>{if(!Oc){sp(-1);return}const n=l=>{l.target.tagName==="INPUT"||l.target.tagName==="TEXTAREA"||Pi||(l.key==="ArrowUp"||l.key==="Up"?(l.preventDefault(),l.stopPropagation(),sp(d=>{const f=d<=0?Pt.length-1:d-1,u=Pt[f],h=Rn(u);return h&&$n({...u,url:h,storyboardContext:null}),f})):l.key==="ArrowDown"||l.key==="Down"?(l.preventDefault(),l.stopPropagation(),sp(d=>{const f=d>=Pt.length-1?0:d+1,u=Pt[f],h=Rn(u);return h&&$n({...u,url:h,storyboardContext:null}),f})):(l.key==="Escape"||l.key==="Esc")&&(l.preventDefault(),l.stopPropagation(),Lc(!1)))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[Oc,Pt,Pi,Rn]);const hl=R.useMemo(()=>Fu(n=>{try{localStorage.setItem("tapnow_history",JSON.stringify(n))}catch(l){console.error(":",l);try{const d=n.map(f=>{var u;return{id:f.id,type:f.type,url:f.url,prompt:((u=f.prompt)==null?void 0:u.substring(0,200))||"",time:f.time,status:f.status,modelName:f.modelName,width:f.width,height:f.height,ratio:f.ratio,mjImages:f.mjImages,selectedMjImageIndex:f.selectedMjImageIndex,mjRatio:f.mjRatio,mjNeedsSplit:f.mjNeedsSplit,mjImageInfo:f.mjImageInfo}});localStorage.setItem("tapnow_history",JSON.stringify(d))}catch(d){console.error(":",d);try{const f=n.map(u=>{var h;return{id:u.id,type:u.type,url:u.url,prompt:((h=u.prompt)==null?void 0:h.substring(0,100))||"",time:u.time,status:u.status,modelName:u.modelName}});hl(f)}catch(f){console.error(":",f)}}}},1e3),[]),Uh=R.useMemo(()=>Fu(n=>{localStorage.setItem("tapnow_global_key",n)},1e3),[]);R.useEffect(()=>{Uh(Me)},[Me,Uh]),R.useEffect(()=>{try{const n=Pt.map(l=>{var u,h,g,v;const d={...l},f=((h=(u=l.apiConfig)==null?void 0:u.modelId)==null?void 0:h.includes("mj"))||((v=(g=l.modelName)==null?void 0:g.toLowerCase())==null?void 0:v.includes("midjourney"));return l.mjImages&&l.mjImages.length===4&&f&&(d.mjImages=null,d.mjNeedsSplit=!0,d.mjOriginalUrl=l.mjOriginalUrl||l.url),l.url&&l.url.startsWith("data:")&&l.url.length>5e3&&(d.url=l.url.substring(0,100)+"..."),delete d.mjImageInfo,d});hl(n)}catch(n){console.error(":",n);try{const l=Pt.slice(0,20).map(d=>{const f={...d};return f.url&&f.url.startsWith("data:")&&(f.url=f.url.substring(0,100)+"..."),f.mjImages&&(f.mjImages=null),f.mjImageInfo&&delete f.mjImageInfo,f});hl(l)}catch(l){console.error(":",l);try{const d=Pt.slice(0,10).map(f=>{var u;return{id:f.id,type:f.type,prompt:(u=f.prompt)==null?void 0:u.substring(0,100),time:f.time,status:f.status,modelName:f.modelName}});hl(d)}catch(d){console.error(":",d)}}}},[Pt,hl]);const Fh=R.useMemo(()=>Fu(n=>{try{localStorage.setItem("tapnow_chat_sessions",JSON.stringify(n))}catch{}},1e3),[]);R.useEffect(()=>{Fh(an)},[an,Fh]),R.useEffect(()=>{Jr.current=a,Wi.current=k,qs.current=Mn,dl.current=p,pi.current=Ri},[a,k,Mn,p,Ri]);const Dt=R.useMemo(()=>{const n=new Map;return a.forEach(l=>{n.set(l.id,l)}),n},[a]),mn=R.useMemo(()=>{const n=new Map;return ue.forEach(l=>{n.set(l.id,l)}),n},[ue]),as=R.useCallback(n=>{const l=mn.get(n);if(!l)return{key:Me,url:zr.replace(/\/+$/,""),modelName:n,displayName:n};const d=H[l.provider],f=(d==null?void 0:d.key)||Me,u=((d==null?void 0:d.url)||zr).replace(/\/+$/,"");return{key:f,url:u,modelName:l.modelName,displayName:l.displayName,provider:l.provider,type:l.type}},[mn,H,Me]),Xc=R.useCallback(n=>{if(!n)return"";const l=mn.get(n);return(l==null?void 0:l.displayName)||(l==null?void 0:l.modelName)||(l==null?void 0:l.id)||n},[mn]),gr=R.useMemo(()=>{const n={};return Object.entries(H).forEach(([l])=>{n[l]={name:l,models:[]}}),ue.forEach(l=>{if(hx.includes(l.id))return;const d=l.provider||"Other";n[d]||(n[d]={name:d,models:[]}),n[d].models.push(l)}),n},[ue,H]),zo=R.useMemo(()=>{const n=new Map;return Pt.forEach(l=>{n.set(l.id,l)}),n},[Pt]),Jc=R.useMemo(()=>{if(!Zs.current)return a;const n=Zs.current.getBoundingClientRect(),l=200,d=Qn.current,f=(-d.x-l)/d.zoom,u=(n.width-d.x+l)/d.zoom,h=(-d.y-l)/d.zoom,g=(n.height-d.y+l)/d.zoom;return a.filter(v=>{const x=v.x+(v.width||0),_=v.y+(v.height||0);return v.x<u&&x>f&&v.y<g&&_>h})},[a,$t.x,$t.y,$t.zoom]);R.useCallback(n=>n>=.8?"high":n>=.4?"medium":"low",[]),R.useEffect(()=>{Qn.current=$t},[$t]);const Vi=R.useMemo(()=>{const n={to:new Map,from:new Map};return p.forEach(l=>{n.to.has(l.to)||n.to.set(l.to,[]),n.to.get(l.to).push(l),n.from.has(l.from)||n.from.set(l.from,[]),n.from.get(l.from).push(l)}),n},[p]),mp=R.useCallback(n=>{const l=[],d=new Set,f=Vi.to.get(n)||[],u=(h,g="image",v={})=>{if(!h)return;const x=`${g}:${h}`;d.has(x)||(d.add(x),l.push({url:h,type:g,...v}))};return f.forEach(h=>{var v,x,_,S,j;const g=Dt.get(h.from);if(g){if(g.type==="gen-image"||g.type==="gen-video"){const C=Pt.find(M=>M.sourceNodeId===g.id&&M.status==="completed");if(!C)return;const L=C.prompt||((v=g.settings)==null?void 0:v.prompt)||((x=g.settings)==null?void 0:x.videoPrompt)||"";if(C.mjImages&&C.mjImages.length>0)C.mjImages.forEach(M=>u(M,C.type||"image",{prompt:L,originalUrl:C.mjOriginalUrl||C.originalUrl||M}));else if(C.output_images&&C.output_images.length>0)C.output_images.forEach(M=>u(M,C.type||"image",{prompt:L,originalUrl:C.originalUrl||M}));else{const M=C.url||C.originalUrl||C.mjOriginalUrl;M&&u(M,C.type||(g.type==="gen-video"?"video":"image"),{prompt:L,originalUrl:C.originalUrl||M})}return}if(g.type==="storyboard-node"){const C=((_=g.settings)==null?void 0:_.shots)||[],L=((S=g.settings)==null?void 0:S.mode)||"video",M=((j=g.settings)==null?void 0:j.projectTitle)||"";C.forEach(U=>{if(U.outputEnabled)if(L==="image")if(U.output_images&&U.output_images.length>0)U.output_images.forEach(V=>{u(V,"image",{prompt:U.prompt||U.description||"",projectTitle:M,originalUrl:V})});else{const V=U.selectedImageIndex??-1;V>=0&&U.output_images&&U.output_images[V]&&u(U.output_images[V],"image",{prompt:U.prompt||U.description||"",projectTitle:M,originalUrl:U.output_images[V]})}else{const V=U.output_url||U.image_url;V&&u(V,Hn(V)?"video":"image",{prompt:U.prompt||U.description||"",projectTitle:M,originalUrl:V})}});return}if(g.type==="video-input"){const C=g.selectedKeyframes&&g.selectedKeyframes.length>0?g.selectedKeyframes.map(L=>L.url):[];C.length>0?C.forEach(L=>u(L,"image",{name:g.videoFileName||"",originalUrl:L})):g.frames&&g.frames.length>0&&u(g.frames[0].url,"image",{name:g.videoFileName||"",originalUrl:g.frames[0].url});return}if(g.type==="input-image"||g.type==="preview"){g.content&&u(g.content,Hn(g.content)?"video":"image",{name:g.title||"",originalUrl:g.content}),g.previewMjImages&&g.previewMjImages.forEach(C=>u(C,"image",{name:g.title||"",originalUrl:C}));return}}}),l},[Vi,Dt,Pt]);R.useEffect(()=>{const n=setInterval(()=>{const l=Date.now(),d=Pt.filter(u=>u.sourceNodeId&&u.status==="generating"&&u.startTime),f={};d.forEach(u=>{const h=Math.floor((l-u.startTime)/100);f[u.sourceNodeId]=h/10}),c1(f)},500);return()=>clearInterval(n)},[Pt]);const Zc=R.useRef(new Set);R.useEffect(()=>{Pt.forEach(n=>{var l,d;if(n.mjNeedsSplit&&n.mjOriginalUrl&&((d=(l=n.apiConfig)==null?void 0:l.modelId)!=null&&d.includes("mj"))&&n.status==="completed"){if(Zc.current.has(n.id))return;Zc.current.add(n.id),setTimeout(()=>{let f=n.mjRatio||"1:1";if(n.prompt&&n.prompt.includes("--ar ")){const u=n.prompt.match(/--ar\s+([\d:]+)/);u&&u[1]&&(f=u[1])}rm(n.mjOriginalUrl,f).then(u=>{const h=u.map(x=>typeof x=="string"?x:x.url),g=u[0],v=typeof g=="string"?g:g.url;St(x=>x.map(_=>_.id===n.id?{..._,mjImages:h,url:v,selectedMjImageIndex:0,mjRatio:f,mjNeedsSplit:!1,mjImageInfo:u.map(S=>typeof S=="string"?null:{width:S.width,height:S.height,ratio:S.ratio})}:_)),Zc.current.delete(n.id)}).catch(u=>{console.error("Midjourney: :",u),Zc.current.delete(n.id),St(h=>h.map(g=>g.id===n.id?{...g,mjNeedsSplit:!0}:g))})},500)}})},[Pt]);const Bh=R.useCallback(async(n=[])=>{const l=[],d=new Map,f=new Set;for(let u=0;u<n.length;u++){const h=n[u],g=h==null?void 0:h.url;if(g&&!f.has(g)){f.add(g);try{let v=g;if(!g.startsWith("data:")){const F=await(await fetch(g)).blob();v=await new Promise(J=>{const Y=new FileReader;Y.onloadend=()=>J(Y.result),Y.readAsDataURL(F)})}const x=h.type==="video"||g.startsWith("data:video")||Hn(g),_=Bi(v,x?".mp4":".png"),j=[h.projectTitle||(pr&&pr!==""?pr:""),h.prompt].filter(Boolean).join("-")||os(g)||h.name||"tapnow";let C=is(j)||"tapnow";C=C.slice(0,80);const L=(d.get(C)||0)+1;d.set(C,L);const M=h.dedupeKey||h.originalUrl||g,U=os(M)||M;l.push({filename:`${C}-${L}${_}`,content:v,sourceUrl:g,dedupeKey:U,scopedKey:h.scopedKey||""})}catch(v){console.warn("[] :",v)}}}return l},[Bi,os,is,pr]),qc=R.useCallback(n=>{var d;return(((d=n==null?void 0:n.settings)==null?void 0:d.serverUrl)||In||"").trim().replace(/\/+$/,"")},[In]),gp=R.useCallback(async(n,l,d={})=>{var J,Y,de,Z,xe;const f=d.silent===!0,u=qc(n);if(!u){f||o("","error");return}const h=((J=n.settings)==null?void 0:J.lastSavedUrls)||[],g=(((Y=n.settings)==null?void 0:Y.subfolder)||"").trim(),v=`${u}::${g}`,x=l.map(le=>{if(!le)return le;const ne=le.dedupeKey||le.originalUrl||le.url,te=ne?os(ne)||ne:"",$e=te?`${v}::${te}`:"",rt=!g&&te&&h.includes(te),Oe=$e&&h.includes($e)||rt;return{...le,dedupeKey:te,scopedKey:$e,isDuplicate:Oe}}),_=x.filter(le=>(le==null?void 0:le.url)&&le.scopedKey&&!le.isDuplicate),S=x.filter(le=>(le==null?void 0:le.url)&&le.scopedKey&&le.isDuplicate).length;if(_.length===0){f||o("","success");return}const j=await Bh(_);if(j.length===0){f||o("","warning");return}let C;try{C=await fetch(`${u}/save-batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:j,subfolder:((de=n.settings)==null?void 0:de.subfolder)||""})})}catch(le){throw f||o("","error"),le}if(!C.ok){const le=await C.text();throw new Error(le||"")}const L=await C.json(),M=L.results||[],U=M.map((le,ne)=>{var te,$e;return le!=null&&le.success?((te=j[ne])==null?void 0:te.scopedKey)||(($e=_[ne])==null?void 0:$e.scopedKey):null}).filter(Boolean),V=Array.from(new Set([...((Z=n.settings)==null?void 0:Z.lastSavedUrls)||[],...U]));Le(n.id,{lastSavedUrls:V,lastSaved:new Date().toLocaleString(),savedFiles:[...((xe=n.settings)==null?void 0:xe.savedFiles)||[],...M.map(le=>le.path).filter(Boolean)]});const F=M.filter(le=>le.success).length;if(!f){const le=S>0?` ${S} `:"";o(L.message||` ${F} ${le}`,"success")}},[Bh,os,qc,o]),x1=R.useCallback(async(n,l)=>{const d=(l||In||"").trim().replace(/\/+$/,"");if(!d){o("","warning");return}Le(n,{serverStatus:"checking"});try{if((await fetch(`${d}/ping`,{method:"GET"})).ok){Le(n,{serverStatus:"connected"}),o("","success");return}}catch{}Le(n,{serverStatus:"disconnected"}),o("","error")},[In,o,Le]),xp=R.useRef(new Set);R.useEffect(()=>{const n=a.filter(l=>{var d;return l.type==="local-save"&&((d=l.settings)==null?void 0:d.autoSave)});n.length!==0&&n.forEach(async l=>{var _,S;const d=qc(l);if(!d)return;const f=mp(l.id);if(f.length===0)return;const u=((_=l.settings)==null?void 0:_.lastSavedUrls)||[],h=(((S=l.settings)==null?void 0:S.subfolder)||"").trim(),g=`${d}::${h}`,v=f.filter(j=>{const C=(j==null?void 0:j.originalUrl)||(j==null?void 0:j.url),L=C?os(C)||C:"",M=L?`${g}::${L}`:"",U=!h&&L&&u.includes(L),V=M&&u.includes(M)||U;return M&&!V});if(v.length===0)return;const x=`${l.id}-${v.map(j=>j.url).join("|")}`;xp.current.has(x)||(xp.current.add(x),setTimeout(async()=>{try{await gp(l,v,{silent:!0})}catch(j){console.error(":",j)}finally{xp.current.delete(x)}},1e3))})},[a,Pt,mp,gp,qc,os]);const b1=n=>{n.preventDefault(),Wh(!0)},[Qc,Wh]=R.useState(!1),eu=R.useCallback(n=>{if(!Qc)return;const l=window.innerWidth-n.clientX;$c(Math.max(300,Math.min(l,800)))},[Qc]),tu=R.useCallback(()=>{Wh(!1)},[]);R.useEffect(()=>{const n=console.error,l=console.warn,d=f=>{const u=f.map(h=>typeof h=="string"?h:h&&h.toString?h.toString():"").join(" ");return u.includes("Unable to preventDefault")||u.includes("passive event listener")||u.includes("preventDefault")&&u.includes("passive")};return console.error=function(...f){d(f)||n.apply(console,f)},console.warn=function(...f){d(f)||l.apply(console,f)},()=>{console.error=n,console.warn=l}},[]),R.useEffect(()=>{const n=d=>{if(d.ctrlKey)try{d.cancelable&&(d.preventDefault(),d.stopPropagation())}catch{}},l={passive:!1,capture:!0};return window.addEventListener("wheel",n,l),document.addEventListener("wheel",n,l),window.addEventListener("mousewheel",n,l),document.addEventListener("mousewheel",n,l),()=>{window.removeEventListener("wheel",n,l),document.removeEventListener("wheel",n,l),window.removeEventListener("mousewheel",n,l),document.removeEventListener("mousewheel",n,l)}},[]),R.useEffect(()=>{const n=Zs.current;if(!n)return;const l=d=>{if(d.ctrlKey){try{d.cancelable&&(d.preventDefault(),d.stopPropagation())}catch{}return}const f=d.target;let u=!1,h=null;if(f.tagName==="TEXTAREA"&&f.scrollHeight>f.clientHeight){try{d.cancelable&&d.preventDefault()}catch{}const S=f.scrollHeight-f.clientHeight,j=f.scrollTop,C=Math.max(0,Math.min(S,j+d.deltaY));f.scrollTop=C;return}let g=f;for(;g&&g!==n;){if(g.classList){const S=g.classList.contains("flex")&&g.classList.contains("flex-col")&&g.classList.contains("h-full")&&g.classList.contains("rounded-xl")&&g.classList.contains("overflow-hidden");if(g.classList.contains("video-input-container")||g.classList.contains("video-analyze-container")||S){if(u=!0,S)h=g.querySelector(".flex-1.overflow-y-auto.custom-scrollbar"),h||(h=g.querySelector(".flex-1.overflow-y-auto"));else if(h=g.querySelector('.overflow-y-auto, .custom-scrollbar, [class*="overflow-y"]'),!h){const L=window.getComputedStyle(g);(L.overflowY==="auto"||L.overflowY==="scroll"||g.classList.contains("custom-scrollbar"))&&(h=g)}break}const j=g.closest(".video-input-container, .video-analyze-container");if(j){if(u=!0,h=j.querySelector('.overflow-y-auto, .custom-scrollbar, [class*="overflow-y"]'),!h){const L=window.getComputedStyle(j);(L.overflowY==="auto"||L.overflowY==="scroll")&&(h=j)}break}const C=g.closest(".flex.flex-col.h-full.rounded-xl.overflow-hidden");if(C){u=!0,h=C.querySelector(".flex-1.overflow-y-auto.custom-scrollbar"),h||(h=C.querySelector(".flex-1.overflow-y-auto"));break}}g=g.parentElement}if(u&&h){try{d.cancelable&&(d.preventDefault(),d.stopPropagation())}catch{}const S=h.scrollHeight-h.clientHeight,j=h.scrollTop,C=Math.max(0,Math.min(S,j+d.deltaY));h.scrollTop=C;return}try{d.cancelable&&d.preventDefault()}catch{}const v=n.getBoundingClientRect(),x=d.clientX-v.left,_=d.clientY-v.top;dr(S=>{const j=d.deltaY>0?.9:1.1;let C=Math.min(Math.max(S.zoom*j,.2),3);const L=C/S.zoom;return{zoom:C,x:x-(x-S.x)*L,y:_-(_-S.y)*L}})};return n.addEventListener("wheel",l,{passive:!1}),()=>{n.removeEventListener("wheel",l)}},[$t]),R.useEffect(()=>(Qc?(window.addEventListener("mousemove",eu),window.addEventListener("mouseup",tu)):(window.removeEventListener("mousemove",eu),window.removeEventListener("mouseup",tu)),()=>{window.removeEventListener("mousemove",eu),window.removeEventListener("mouseup",tu)}),[Qc,eu,tu]);const xn=R.useCallback((n,l)=>{var h;const d=(h=Zs.current)==null?void 0:h.getBoundingClientRect(),f=d?n-d.left:n,u=d?l-d.top:l;return{x:(f-$t.x)/$t.zoom,y:(u-$t.y)/$t.zoom}},[$t]),y1=n=>{var l;if((n.button===0||n.button===1)&&n.currentTarget.id==="canvas-bg"){const d=n.target;if(d&&(d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.tagName==="SELECT"||d.tagName==="BUTTON"||d.isContentEditable||d.closest('input, textarea, select, button, [contenteditable="true"]')))return;const f=window.getSelection();if(f&&f.toString().length>0&&f.removeAllRanges(),n.button===0&&(n.ctrlKey||n.metaKey)){n.preventDefault(),Qd(!0),pi.current=!0,qa(!1);const u=(l=Zs.current)==null?void 0:l.getBoundingClientRect(),h=n.clientX-((u==null?void 0:u.left)||0),g=n.clientY-((u==null?void 0:u.top)||0);ep({startX:h,startY:g,endX:h,endY:g}),Or(new Set),Ne(null);return}pi.current||(qa(!0),ha.current=!0,Qa(!1),ul.current={x:n.clientX,y:n.clientY})}},nu=R.useRef(null),ws=R.useRef(null),Ki=R.useRef(null),ml=R.useCallback(()=>{if(Ki.current){const d=Ki.current,f=new Map(d.map(({nodeId:u})=>[u,!0]));c(u=>{if(u.length>50&&d.length>10){const h=new Map;u.forEach((x,_)=>{f.has(x.id)&&h.set(x.id,_)});const g=[...u];let v=!1;return d.forEach(({nodeId:x,updater:_})=>{const S=h.get(x);if(S!==void 0){const j=_(g[S]);j!==g[S]&&(g[S]=j,v=!0)}}),v?g:u}else{const h=[...u];let g=!1;return d.forEach(({nodeId:v,updater:x})=>{const _=h.findIndex(S=>S.id===v);if(_!==-1){const S=x(h[_]);S!==h[_]&&(h[_]=S,g=!0)}}),g?h:u}}),Ki.current=null,ws.current=null;return}if(!nu.current){ws.current=null;return}const{nodeId:n,updater:l}=nu.current;c(d=>{const f=d.findIndex(g=>g.id===n);if(f===-1)return d;const u=l(d[f]);if(u===d[f])return d;const h=[...d];return h[f]=u,h}),nu.current=null,ws.current=null},[]),bp=R.useCallback((n,l)=>{nu.current={nodeId:n,updater:l},ws.current||(ws.current=requestAnimationFrame(ml))},[ml]),Hh=R.useCallback(n=>{if(Ki.current&&ws.current){const l=Ki.current,d=new Map;l.forEach(({nodeId:f,updater:u})=>{d.set(f,u)}),n.forEach(({nodeId:f,updater:u})=>{d.set(f,u)}),Ki.current=Array.from(d.entries()).map(([f,u])=>({nodeId:f,updater:u}))}else Ki.current=n;ws.current||(ws.current=requestAnimationFrame(ml))},[ml]);R.useEffect(()=>()=>{ws.current&&cancelAnimationFrame(ws.current),gi.current&&cancelAnimationFrame(gi.current)},[]);const gl=R.useRef(null),ru=R.useRef(null),Vh=R.useCallback(n=>{var u;const{clientX:l,clientY:d}=n,f=xn(l,d);if(Ts(f),Ri||pi.current){Ri||Qd(!0);const h=(u=Zs.current)==null?void 0:u.getBoundingClientRect(),g=l-((h==null?void 0:h.left)||0),v=d-((h==null?void 0:h.top)||0);ep(x=>x?{...x,endX:g,endY:v}:null),ru.current={endX:g,endY:v,rect:h},gl.current||(gl.current=requestAnimationFrame(()=>{if(!ru.current){gl.current=null;return}const{endX:x,endY:_,rect:S}=ru.current,j=Ps;if(!j){gl.current=null;return}const C=Math.min(j.startX,x),L=Math.min(j.startY,_),M=Math.max(j.startX,x),U=Math.max(j.startY,_),V=xn(C+((S==null?void 0:S.left)||0),L+((S==null?void 0:S.top)||0)),F=xn(M+((S==null?void 0:S.left)||0),U+((S==null?void 0:S.top)||0)),J=Jr.current,Y=new Set;J.forEach(de=>{const Z=de.x+(de.width||260),xe=de.y+(de.height||200);de.x<F.x&&Z>V.x&&de.y<F.y&&xe>V.y&&Y.add(de.id)}),Or(Y),ru.current=null,gl.current=null}));return}if((qo||ha.current)&&!pi.current){Qa(!0);const h=l-ul.current.x,g=d-ul.current.y;if(Math.abs(h)<1&&Math.abs(g)<1)return;Qs.current?(Qs.current.dx+=h,Qs.current.dy+=g):Qs.current={dx:h,dy:g},gi.current||(gi.current=requestAnimationFrame(()=>{if(!Qs.current){gi.current=null;return}const{dx:v,dy:x}=Qs.current;dr(_=>{const S=Math.max(.2,Math.min(3,_.zoom)),j=S<.5||S>2.5?1e3:100;return{..._,zoom:S,x:Math.round((_.x+v)*j)/j,y:Math.round((_.y+x)*j)/j}}),Qs.current=null,gi.current=null})),ul.current={x:l,y:d};return}if(Qo)bp(Qo,h=>({...h,width:Math.max(250,f.x-h.x),height:Math.max(250,f.y-h.y)}));else if(Xr){const h=Math.max(.2,Math.min(3,$t.zoom)),g=n.movementX/h,v=n.movementY/h,x=h<.5||h>2.5?.5:1;if(Math.abs(g)<x&&Math.abs(v)<x)return;const _=qs.current;if(_&&_.size>1&&_.has(Xr)){const S=Jr.current,j=Math.max(.2,Math.min(3,$t.zoom));(!Hi.current||pl.current!==null&&Math.abs(pl.current-j)>.01)&&(Hi.current={mouseX:l,mouseY:d,nodes:new Map(Array.from(_).map(U=>{const V=S.find(F=>F.id===U);return V?[U,{x:V.x,y:V.y}]:null}).filter(Boolean))}),pl.current=j;const C=(l-Hi.current.mouseX)/j,L=(d-Hi.current.mouseY)/j,M=Array.from(Hi.current.nodes.entries()).map(([U,V])=>({nodeId:U,updater:F=>({...F,x:V.x+C,y:V.y+L})}));Hh(M)}else Hi.current=null,bp(Xr,S=>({...S,x:S.x+g,y:S.y+v}))}},[qo,Ri,Ps,Xr,Qo,xn,$t.zoom,bp,Hh]),Kh=()=>{if(gi.current&&(cancelAnimationFrame(gi.current),gi.current=null),Qs.current){const{dx:n,dy:l}=Qs.current;dr(d=>{const f=Math.max(.2,Math.min(3,d.zoom)),u=f<.5||f>2.5?1e3:100;return{...d,zoom:f,x:Math.round((d.x+n)*u)/u,y:Math.round((d.y+l)*u)/u}}),Qs.current=null}if(Ki.current&&ws.current&&(cancelAnimationFrame(ws.current),ml()),Ri||pi.current){if(Qd(!1),pi.current=!1,ep(null),Mn.size===1){const n=Array.from(Mn)[0];Ne(n)}else Mn.size===0&&Ne(null);Qa(!1),qa(!1),ha.current=!1,Hi.current=null,pl.current=null;return}(qo||ha.current)&&(qa(!1),ha.current=!1,Qa(!1),!Bn&&!gn&&!Xr&&!Qo&&(Ne(null),Or(new Set),na(n=>({...n,visible:!1})),nn(null),As(n=>({...n,visible:!1})))),!Bn&&!gn&&(el(null),Dc(null),Hi.current=null,pl.current=null),Qa(!1),pi.current=!1,ul.current={x:0,y:0}};R.useEffect(()=>{if(!(qo||ha.current||Jd||Xr||Qo||Ri||pi.current||Bn||gn))return;const l=f=>{f.movementX===void 0&&(f.movementX=0),f.movementY===void 0&&(f.movementY=0),Vh(f)},d=()=>{Kh()};return window.addEventListener("pointermove",l,{passive:!1}),window.addEventListener("pointerup",d,{passive:!1}),()=>{window.removeEventListener("pointermove",l),window.removeEventListener("pointerup",d)}},[qo,Jd,Xr,Qo,Ri,Bn,gn,Vh,Kh]);const Rs=R.useCallback((n,l,d="default")=>{if(l.stopPropagation(),Bn&&Bn!==n)p.some(u=>u.from===Bn&&u.to===n&&(u.inputType||"default")===d)||(d!=="default"&&m(u=>u.filter(h=>!(h.to===n&&(h.inputType||"default")===d))),m(u=>[...u,{id:`conn-${Date.now()}`,from:Bn,to:n,inputType:d!=="default"?d:void 0}]));else if(gn&&gn!==n){const f=ys||d;p.some(h=>h.from===n&&h.to===gn&&(h.inputType||"default")===f)||(f!=="default"&&m(h=>h.filter(g=>!(g.to===gn&&(g.inputType||"default")===f))),m(h=>[...h,{id:`conn-${Date.now()}`,from:n,to:gn,inputType:f!=="default"?f:void 0}]))}ea(null),bs(null),vs(null),Ai(null),qa(!1),el(null),Dc(null)},[Bn,gn,ys,p]),v1=n=>{if(Bn){const l=xn(n.clientX,n.clientY);na({visible:!0,x:n.clientX,y:n.clientY,worldX:l.x,worldY:l.y,sourceNodeId:Bn}),Di(!1),ea(null)}else if(gn){const l=xn(n.clientX,n.clientY);na({visible:!0,x:n.clientX,y:n.clientY,worldX:l.x,worldY:l.y,targetNodeId:gn,inputType:ys}),Di(!1),bs(null),vs(null)}},w1=n=>{if(n.currentTarget.id==="canvas-bg"){const l=xn(n.clientX,n.clientY);na({visible:!0,x:n.clientX,y:n.clientY,worldX:l.x,worldY:l.y,sourceNodeId:void 0}),Di(!1)}},k1=n=>{n.preventDefault(),n.stopPropagation(),(Mn.size>0||k)&&np({visible:!0,x:n.clientX,y:n.clientY})},Yh=R.useMemo(()=>{const n=new Map;return p.forEach(l=>{var h,g;const d=l.inputType||"default";n.has(l.to)||n.set(l.to,new Map);const f=n.get(l.to);f.has(d)||f.set(d,[]);const u=Dt.get(l.from);if(u){let v=[];if(u.type==="video-input"){const x=u.selectedKeyframes&&u.selectedKeyframes.length>0?u.selectedKeyframes.map(_=>_.url):[];x.length>0?v=x:u.frames&&u.frames.length>0&&(v=[u.frames[0].url])}else if(u.type==="input-image"||u.type==="gen-image"||u.type==="preview")u.content&&v.push(u.content),u.previewMjImages&&v.push(...u.previewMjImages);else if(u.type==="storyboard-node"){const x=((h=u.settings)==null?void 0:h.shots)||[],_=((g=u.settings)==null?void 0:g.mode)||"video";x.forEach(S=>{if(S.outputEnabled)if(_==="image"){const j=S.selectedImageIndex??-1;j>=0&&S.output_images&&S.output_images.length>0&&S.output_images[j]&&v.push(S.output_images[j])}else S.output_url?v.push(S.output_url):S.image_url&&v.push(S.image_url)})}v.length>0&&f.get(d).push(...v)}}),n},[p,Dt,a,rs]),Gh=R.useCallback((n,l="default")=>{const d=Yh.get(n);return d?d.get(l)||[]:[]},[Yh]),Xh=R.useMemo(()=>{const n=new Map;return p.forEach(l=>{var d,f,u;if(!n.has(l.to)){const h=Dt.get(l.from);if(h){if(h.type==="video-input")n.set(l.to,h);else if(h.type==="input-image"){const g={...h,type:"input-image-as-video",videoFileName:"",videoMeta:{duration:0},frames:h.content?[{time:0,url:h.content}]:[],selectedKeyframes:h.content?[{time:0,url:h.content}]:[],isImageInput:!0};n.set(l.to,g)}else if(h.type==="storyboard-node"){const g=((d=h.settings)==null?void 0:d.shots)||[],v=((f=h.settings)==null?void 0:f.mode)||"video",x=((u=h.settings)==null?void 0:u.projectTitle)||"",_=[];g.forEach((j,C)=>{if(!j.outputEnabled)return;let L=null,M=j.image_filename||`${C+1}`;if(v==="image"){const U=j.selectedImageIndex??-1;U>=0&&j.output_images&&j.output_images[U]&&(L=j.output_images[U])}else L=j.output_url||j.image_url;L&&_.push({time:C,url:L,filename:M})});const S={...h,type:"storyboard-as-video",videoFileName:x,videoMeta:{duration:g.length},frames:_,selectedKeyframes:_,isStoryboardInput:!0};n.set(l.to,S)}}}}),n},[p,Dt]),xl=R.useCallback(n=>Xh.get(n)||null,[Xh]),z1=R.useCallback(n=>{for(const l of p)if(l.to===n){const d=Dt.get(l.from);if(d&&d.type==="video-analyze")return d}return null},[p,Dt]),bl=R.useCallback(n=>{const l=[];return p.forEach(d=>{var f;if(d.to===n){const u=Dt.get(d.from);if(u&&u.type==="text-node"){const h=((f=u.settings)==null?void 0:f.text)||"";h&&l.push(h)}}}),l},[p,Dt]),Jh=R.useMemo(()=>{const n=new Map;return p.forEach(l=>{const d=l.inputType||"default",f=`${l.to}:${d}`;if(!n.has(f)){const u=Dt.get(l.from);if(u){let h=null;if(u.type==="video-input"){const g=u.selectedKeyframes&&u.selectedKeyframes.length>0?u.selectedKeyframes[0].url:null;g?h=g:u.frames&&u.frames[0]&&(h=u.frames[0].url)}else u.type==="input-image"&&u.content&&(h=u.content);h&&n.set(f,h)}}}),n},[p,Dt,a]),su=R.useCallback((n,l)=>{const d=`${n}:${l||"default"}`;return Jh.get(d)||null},[Jh]),ei=(n,l,d="image",f=null,u=null,h=null)=>{if(!l&&(!u||u.length===0))return;let g=f;if(!g){const x=zo.get(n);g=x==null?void 0:x.sourceNodeId}if(!g){console.warn("[Tapnow] updatePreviewFromTask:  sourceNodeId for taskId:",n);return}setTimeout(()=>{var _;const x=Dt.get(g);if(x&&(x.type==="gen-image"||x.type==="gen-video")){const S=p.filter(j=>j.to===g);for(const j of S){const C=Dt.get(j.from),L=C&&C.type==="storyboard-node"?C:null;if(L&&((_=L.settings)!=null&&_.shots)){const M=L.settings.shots.find(U=>U.status==="generating");if(M){const U=l||(u&&u.length>0?u[0]:null);if(U){Gt(L.id,M.id,{image_url:U,image_filename:h||M.image_filename,status:"done"});break}}}}}},0);const v=dl.current;c(x=>{const _=v.filter(S=>S.from===g).map(S=>S.to);return _.length?x.map(S=>_.includes(S.id)&&S.type==="preview"?{...S,content:l||(u&&u.length>0?u[0]:l),previewType:d,previewMjImages:u,previewFilename:h||S.previewFilename||""}:S):x})},Zh=n=>{St(l=>{const d=l.filter(f=>f.id!==n);try{localStorage.setItem("tapnow_history",JSON.stringify(d))}catch(f){console.error(":",f)}return d}),Cr.item&&Cr.item.id===n&&As({visible:!1,x:0,y:0,item:null})},qh=(n,l)=>K(d=>d.map(f=>f.id===n?{...f,...l}:f)),j1=n=>K(l=>l.filter(d=>d.id!==n)),N1=async n=>{cp(n),ll(f=>({...f,[n]:"idle"}));const{key:l,url:d}=as(n);if(!l){ll(f=>({...f,[n]:"error"})),cp(null);return}try{(await fetch(`${d}/v1/models`,{method:"GET",headers:{Authorization:`Bearer ${l}`}})).ok?ll(u=>({...u,[n]:"success"})):ll(u=>({...u,[n]:"error"}))}catch{ll(f=>({...f,[n]:"error"}))}cp(null)},Ds=n=>{if(!n)return"bg-zinc-600";const l=up[n];if(l==="success")return"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.8)]";if(l==="error")return"bg-red-500";const{key:d}=as(n);return d?"bg-zinc-400":"bg-zinc-700"},ma=R.useMemo(()=>an.find(n=>n.id===bn)||an[0],[an,bn]),_1=()=>{var n;(n=Oh.current)==null||n.scrollIntoView({behavior:"smooth"})};R.useEffect(()=>{_1()},[ma==null?void 0:ma.messages,di]);const S1=()=>{const n=`chat-${Date.now()}`,l={id:n,title:"",messages:[]};Fn(d=>[l,...d]),rr(n)},C1=(n,l)=>{n.stopPropagation();const d=an.filter(f=>f.id!==l);d.length===0?(Fn([{id:"default",title:"",messages:[]}]),rr("default")):(Fn(d),bn===l&&rr(d[0].id))},I1=n=>{Array.from(n.target.files).forEach(d=>{const f=new FileReader;f.onload=u=>{var M;const h=u.target.result,g=((M=d.name.split(".").pop())==null?void 0:M.toLowerCase())||"",v=d.type.startsWith("image/"),x=d.type.startsWith("video/"),_=d.type.startsWith("audio/"),S=d.type==="application/pdf"||g==="pdf",j=["doc","docx"].includes(g)||d.type.includes("word"),C=["xls","xlsx"].includes(g)||d.type.includes("excel")||d.type.includes("spreadsheet"),L=["js","jsx","ts","tsx","py","java","cpp","c","html","css","json","xml","yaml","yml","md","txt","sh","bash"].includes(g);Ti(U=>[...U,{name:d.name,type:d.type,content:h,isImage:v,isVideo:x,isAudio:_,isPDF:S,isDoc:j,isExcel:C,isCode:L,fileExt:g}])},d.type.startsWith("image/")||d.type.startsWith("video/")||d.type.startsWith("audio/")||d.type==="application/pdf"?f.readAsDataURL(d):d.name.match(/\.(txt|md|js|jsx|ts|tsx|py|html|css|json|csv|xml|yaml|yml|sh|bash|java|cpp|c)$/i)?f.readAsText(d):f.readAsDataURL(d)}),n.target.value=""},E1=n=>{Ti(l=>l.filter((d,f)=>f!==n))},Qh=async()=>{var L,M,U,V,F,J,Y,de,Z,xe,le;if(!Sr.trim()&&Zo.length===0||Pc)return;const n=mn.get(xs),{key:l,url:d,modelName:f}=as(xs);if(!l){alert(" API  Key"),ss(!0);return}const u=bn||((L=an[0])==null?void 0:L.id),h=an.find(ne=>ne.id===u)||an[0],g=(h==null?void 0:h.messages)||[];h&&h.id!==bn&&rr(h.id),gh(!0);const v={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"user",content:Sr,files:[...Zo],timestamp:Date.now(),modelId:xs};Fn(ne=>ne.map(te=>te.id===u?{...te,messages:[...te.messages,v],title:te.messages.length===0?Sr.slice(0,20):te.title}:te)),ui(""),Ti([]);const x=[...g,v],_=20,S=x.length>_?x.slice(-_):x;let j=[{role:"system",content:"AI"},...S.map(ne=>({role:ne.role,content:ne.content}))];const C=[];v.content&&C.push({type:"text",text:v.content}),v.files.forEach(ne=>{const te=((n==null?void 0:n.modelName)??"").toLowerCase().includes("gemini");ne.isImage?C.push({type:"image_url",image_url:{url:ne.content}}):ne.isVideo?te?C.push({type:"image_url",image_url:{url:ne.content}}):C.push({type:"text",text:`
[User attached video: ${ne.name}]
`}):ne.isAudio?C.push({type:"text",text:`
[User attached audio: ${ne.name}]
`}):ne.isPDF||ne.isDoc||ne.isExcel?C.push({type:"text",text:`
[User attached document: ${ne.name} (${ne.isPDF?"PDF":ne.isDoc?"Word":"Excel"})]
`}):ne.isCode||ne.content&&typeof ne.content=="string"&&ne.content.length<5e4?C.push({type:"text",text:`
[File: ${ne.name}]
\`\`\`${ne.fileExt||"text"}
${ne.content}
\`\`\`
`}):C.push({type:"text",text:`
[User attached file: ${ne.name}]
`})}),j.push({role:"user",content:C});try{const ne=await fetch(`${d}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({model:f||xs,messages:j,stream:!1})});if(!ne.ok){const Oe=await ne.text();throw new Error(Oe||`API Error: ${ne.status}`)}const te=await ne.json();let $e=null;te.choices&&te.choices.length>0?$e=(U=(M=te.choices[0])==null?void 0:M.message)==null?void 0:U.content:te.content?$e=te.content:te.text?$e=te.text:te.message?$e=typeof te.message=="string"?te.message:te.message.content:te.result?$e=typeof te.result=="string"?te.result:te.result.content:(Y=(J=(F=(V=te.data)==null?void 0:V.choices)==null?void 0:F[0])==null?void 0:J.message)!=null&&Y.content?$e=te.data.choices[0].message.content:(de=te.data)!=null&&de.content?$e=te.data.content:(Z=te.data)!=null&&Z.text?$e=te.data.text:(xe=te.data)!=null&&xe.message?$e=typeof te.data.message=="string"?te.data.message:te.data.message.content:(le=te.data)!=null&&le.result&&($e=typeof te.data.result=="string"?te.data.result:te.data.result.content),(!$e||$e.trim()==="")&&(console.error("[] API :",te),$e="No response");const rt={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"assistant",content:$e,timestamp:Date.now(),modelId:xs};Fn(Oe=>Oe.map(He=>He.id===bn?{...He,messages:[...He.messages,rt]}:He))}catch(ne){console.error("Chat Error",ne);const te={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"assistant",content:`Error: ${ne.message}`,isError:!0,timestamp:Date.now()};Fn($e=>$e.map(rt=>rt.id===bn?{...rt,messages:[...rt.messages,te]}:rt))}finally{gh(!1)}},Os=async n=>await(await fetch(n)).blob(),Kn=async n=>{if(n.startsWith("data:"))return n.split(",")[1];const l=await Os(n);return new Promise((d,f)=>{const u=new FileReader;u.onloadend=()=>{const h=u.result;d(h.split(",")[1])},u.onerror=f,u.readAsDataURL(l)})},yp=n=>new Promise((l,d)=>{const f=new FileReader;f.onloadend=()=>l(f.result),f.onerror=d,f.readAsDataURL(n)}),em=async(n,l=2048,d=8)=>new Promise((f,u)=>{const h=new Image;h.crossOrigin="anonymous",h.onload=()=>{var V,F;const g=h.width,v=h.height;let x=g,_=v;if(g>l||v>l){const J=l/Math.max(g,v);x=Math.floor(g*J),_=Math.floor(v*J)}const S=document.createElement("canvas");S.width=x,S.height=_;const j=S.getContext("2d");j.imageSmoothingEnabled=!0,j.imageSmoothingQuality="high",j.drawImage(h,0,0,x,_);let C=.92,L=S.toDataURL("image/jpeg",C);(((V=L.split(",")[1])==null?void 0:V.length)||0)*3/4/(1024*1024)>d&&(C=.75,L=S.toDataURL("image/jpeg",C),(F=L.split(",")[1])!=null&&F.length),f(L)},h.onerror=g=>{console.error("Midjourney: ",g),f(n)},h.src=n}),$1=async(n,l,d)=>{try{const u=(await Promise.all(n.map(async(S,j)=>{if(S.startsWith("data:"))try{return await em(S,2048,8)}catch(C){return console.error(`Midjourney: [${j}]`,C),S}else try{const C=await Os(S),L=await yp(C);return await em(L,2048,8)}catch(C){throw console.error(`Midjourney: [${j}]URL`,C),C}}))).map((S,j)=>{let C=S;if(typeof C!="string")throw new Error(`base64[${j}]`);C.includes(",")?C=C.split(",")[1]:C.startsWith("data:")&&(C=C.replace(/^data:[^;]*;base64,?/i,""));const L=C.length;C=C.replace(/[^A-Za-z0-9+/=]/g,"");const M=C.length;if(!C||C.length<100)throw new Error(`base64[${j}]: ${(C==null?void 0:C.length)||0}`);const U=/^[A-Za-z0-9+/]+={0,2}$/;if(!U.test(C))throw console.error(`Midjourney: base64[${j}]: ${C.length}, 50: ${C.substring(0,50)}`),new Error(`invalid_base64_format: base64[${j}]`);const V=C.length%4;if(V!==0&&(C=C.replace(/=+$/,""),C+="=".repeat(4-V),!U.test(C)))throw console.error(`Midjourney: base64[${j}]: ${C.length}`),new Error(`invalid_base64_format: base64[${j}]`);try{const J=atob(C);if(!J||J.length===0)throw new Error("base64")}catch(J){throw console.error(`Midjourney: base64[${j}]:`,J),new Error(`invalid_base64_format: base64[${j}]`)}return`data:image/jpeg;base64,${C}`}),h=`${l}/mj/submit/upload-discord-images`;u.forEach((S,j)=>{if(!S||typeof S!="string")throw new Error(`base64[${j}]`);if(!S.startsWith("data:image/"))throw new Error(`base64[${j}]data URL`);let C="";if(S.includes(","))C=S.split(",")[1];else throw new Error(`base64[${j}]data URL`);if(!C||C.length<100)throw new Error(`base64[${j}]`);if(!/^[A-Za-z0-9+/]+={0,2}$/.test(C))throw console.error(`Midjourney: base64[${j}]`),new Error(`base64[${j}]`);if(C.length%4!==0)throw new Error(`base64[${j}]4: ${C.length}`);try{atob(C)}catch(M){throw new Error(`base64[${j}]: ${M.message}`)}});const v=JSON.stringify({base64Array:u}),x=await fetch(h,{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:v});if(!x.ok){let S="";try{S=await x.text();try{const j=JSON.parse(S);throw new Error(`: ${x.status} - ${j.description||j.message||S}`)}catch{throw new Error(`: ${x.status} - ${S}`)}}catch(j){throw new Error(`: ${x.status} - ${j.message||S}`)}}const _=await x.json();if(_.code===1&&_.result&&Array.isArray(_.result))return _.result;{const S=_.description||_.message||"";throw console.error("Midjourney: :",_),new Error(S)}}catch(f){throw console.error("Midjourney: :",f),f}},vp=async(n,l=1920,d=1920)=>new Promise((f,u)=>{const h=new Image;h.crossOrigin="anonymous",h.onload=()=>{const g=h.width,v=h.height;if(g<=l&&v<=d){n.startsWith("data:")?f(n):Kn(n).then(L=>{f(`data:image/png;base64,${L}`)}).catch(u);return}let x=g,_=v;if(g>l||v>d){const L=Math.min(l/g,d/v);x=Math.round(g*L),_=Math.round(v*L),x=x%2===0?x:x-1,_=_%2===0?_:_-1}const S=document.createElement("canvas");S.width=x,S.height=_;const j=S.getContext("2d");j.imageSmoothingEnabled=!0,j.imageSmoothingQuality="high",j.drawImage(h,0,0,x,_);const C=S.toDataURL("image/png",.95);f(C)},h.onerror=g=>{console.error("Veo: ",g),u(new Error(""))},n.startsWith("data:")||n.startsWith("blob:")?h.src=n:Os(n).then(g=>{const v=URL.createObjectURL(g);h.src=v}).catch(u)}),wp=R.useCallback(n=>{m(l=>l.filter(f=>f.id!==n))},[]),M1=(n,l)=>{l.preventDefault(),l.stopPropagation(),l.currentTarget.classList.remove("drag-over");const f=Array.from(l.dataTransfer.files).filter(u=>u.type.startsWith("image/"));if(f.length>0){const u=f[0],h=new FileReader;h.onload=async g=>{const v=g.target.result;let x={w:0,h:0};try{x=await Br(v)}catch{}Re(),c(_=>_.map(S=>S.id===n?{...S,content:v,dimensions:x}:S))},h.readAsDataURL(u)}},tm=R.useCallback(async(n,l)=>{var h;const d=Dt.get(n);if(!d)return;const f=Array.from(l||[]).filter(g=>g.type.startsWith("image/"));if(f.length===0)return;const u=await Promise.all(f.map(g=>new Promise(v=>{const x=new FileReader;x.onloadend=()=>v(x.result),x.readAsDataURL(g)})));Le(n,{referenceImages:[...((h=d.settings)==null?void 0:h.referenceImages)||[],...u]})},[Dt,Le]),T1=(n,l)=>{var d,f;l.preventDefault(),l.stopPropagation(),l.currentTarget.classList.remove("drag-over"),(f=(d=l.dataTransfer)==null?void 0:d.files)!=null&&f.length&&tm(n,l.dataTransfer.files)},nm=(n,l)=>{const d=l.target.files;d&&d.length>0&&tm(n,d),l.target.value=""},kp=n=>{n.preventDefault(),n.stopPropagation(),n.currentTarget.classList.add("drag-over")},zp=n=>{n.preventDefault(),n.stopPropagation(),n.currentTarget.classList.remove("drag-over")};R.useEffect(()=>{const n=async f=>{const u=f.target;if(u.tagName==="INPUT"||u.tagName==="TEXTAREA"||u.isContentEditable){const _=window.getSelection();if(_&&_.toString().trim())return;f.preventDefault();return}const g=Wi.current,v=qs.current,x=g?[g]:v&&v.size>0?Array.from(v):[];if(x.length>0){f.preventDefault(),f.stopPropagation();const _=Jr.current.filter(C=>x.includes(C.id)),j=dl.current.filter(C=>x.includes(C.from)||x.includes(C.to)).filter(C=>x.includes(C.from)&&x.includes(C.to));mi.current={nodes:_.map(C=>({...C})),connections:j.map(C=>({...C})),timestamp:Date.now()}}},l=async f=>{const u=f.target;if(u.tagName==="INPUT"||u.tagName==="TEXTAREA"||u.isContentEditable)return;const g=Wi.current;let v=null;if(g&&(v=Jr.current.find(x=>x.id===g)),v&&(v.type==="input-image"||v.type==="video-input")){const x=Array.from(f.clipboardData.items),_=x.find(j=>j.type.startsWith("image/")),S=x.find(j=>j.type.startsWith("video/"));if(_&&v.type==="input-image"){f.preventDefault();const j=_.getAsFile();if(j){const C=new FileReader;C.onload=async L=>{const M=L.target.result;let U={w:0,h:0};try{U=await Br(M)}catch{}Re(),c(V=>V.map(F=>F.id===v.id?{...F,content:M,dimensions:U}:F))},C.readAsDataURL(j)}return}else if(S&&v.type==="video-input"){f.preventDefault();const j=S.getAsFile();j&&fl(v.id,j);return}}if(mi.current&&mi.current.nodes&&mi.current.nodes.length>0){f.preventDefault(),f.stopPropagation();const x=mi.current,_=Zs.current;let S=0,j=0;if(_){const te=_.getBoundingClientRect(),$e=(te.left+te.width/2-$t.x)/$t.zoom,rt=(te.top+te.height/2-$t.y)/$t.zoom;S=$e,j=rt}const C=x.nodes;if(C.length===0)return;const L=Math.min(...C.map(te=>te.x||0)),M=Math.min(...C.map(te=>te.y||0)),U=Math.max(...C.map(te=>(te.x||0)+(te.width||0))),V=Math.max(...C.map(te=>(te.y||0)+(te.height||0))),F=(L+U)/2,J=(M+V)/2,Y=S-F,de=j-J,Z=new Map,xe=Date.now();x.nodes.forEach((te,$e)=>{const rt=`node-${xe}-${$e}-${Math.random().toString(36).substr(2,9)}`;Z.set(te.id,rt)});const le=x.nodes.map(te=>({...te,id:Z.get(te.id),x:te.x+Y,y:te.y+de})),ne=(x.connections||[]).filter(te=>te&&Z.has(te.from)&&Z.has(te.to)).map((te,$e)=>({...te,id:`conn-${xe}-${$e}-${Math.random().toString(36).substr(2,9)}`,from:Z.get(te.from),to:Z.get(te.to)}));Re(),c(te=>[...te,...le]),m(te=>[...te,...ne]),le.length===1?(Ne(le[0].id),Or(new Set([le[0].id]))):le.length>1&&(Ne(null),Or(new Set(le.map(te=>te.id))))}},d=f=>{const u=f.target;if(!(u.tagName==="INPUT"||u.tagName==="TEXTAREA"||u.isContentEditable)&&(f.ctrlKey||f.metaKey)&&f.key==="v"){const g=Wi.current;if(g){const v=Jr.current.find(x=>x.id===g);if(v&&(v.type==="input-image"||v.type==="video-input"))return}if(mi.current&&mi.current.nodes&&mi.current.nodes.length>0){f.preventDefault(),f.stopPropagation();const v=mi.current,x=Zs.current;let _=0,S=0;if(x){const ne=x.getBoundingClientRect(),te=(ne.left+ne.width/2-$t.x)/$t.zoom,$e=(ne.top+ne.height/2-$t.y)/$t.zoom;_=te,S=$e}const j=v.nodes;if(j.length===0)return;const C=Math.min(...j.map(ne=>ne.x||0)),L=Math.min(...j.map(ne=>ne.y||0)),M=Math.max(...j.map(ne=>(ne.x||0)+(ne.width||0))),U=Math.max(...j.map(ne=>(ne.y||0)+(ne.height||0))),V=(C+M)/2,F=(L+U)/2,J=_-V,Y=S-F,de=new Map,Z=Date.now();v.nodes.forEach((ne,te)=>{const $e=`node-${Z}-${te}-${Math.random().toString(36).substr(2,9)}`;de.set(ne.id,$e)});const xe=v.nodes.map(ne=>({...ne,id:de.get(ne.id),x:ne.x+J,y:ne.y+Y})),le=(v.connections||[]).filter(ne=>ne&&de.has(ne.from)&&de.has(ne.to)).map((ne,te)=>({...ne,id:`conn-${Z}-${te}-${Math.random().toString(36).substr(2,9)}`,from:de.get(ne.from),to:de.get(ne.to)}));Re(),c(ne=>[...ne,...xe]),m(ne=>[...ne,...le]),xe.length===1?(Ne(xe[0].id),Or(new Set([xe[0].id]))):xe.length>1&&(Ne(null),Or(new Set(xe.map(ne=>ne.id))))}}};return window.addEventListener("copy",n),window.addEventListener("paste",l),window.addEventListener("keydown",d),()=>{window.removeEventListener("copy",n),window.removeEventListener("paste",l),window.removeEventListener("keydown",d)}},[Le,fl,c,m,Ne,Or,$t]);const Yi=async(n,l,d,f,u,h,g=0)=>{if(g>90){St(S=>S.map(j=>j.id===l?{...j,status:"failed",errorMsg:"Veo "}:j));const _=Dn.current.get(l);_&&(Gt(_.nodeId,_.shotId,{status:"draft"}),Dn.current.delete(l));return}fetch(`${d}/v2/videos/generations/${n}`,{method:"GET",headers:{Authorization:`Bearer ${f}`}}).then(async _=>{var V,F,J,Y,de,Z,xe,le;const S=await _.text();let j;try{j=JSON.parse(S)}catch{setTimeout(()=>Yi(n,l,d,f,u,h,g+1),4e3);return}const C=((V=j==null?void 0:j.data)==null?void 0:V.status)||(j==null?void 0:j.status)||((F=j==null?void 0:j.data)==null?void 0:F.task_status),L=((J=j==null?void 0:j.data)==null?void 0:J.progress)||(j==null?void 0:j.progress)||"0%",M=((Y=j==null?void 0:j.data)==null?void 0:Y.fail_reason)||(j==null?void 0:j.fail_reason)||"";if(C==="SUCCESS"||C==="succeeded"||C==="FINISHED"||C==="completed"){const ne=((de=j==null?void 0:j.data)==null?void 0:de.output)||(j==null?void 0:j.output)||((Z=j==null?void 0:j.data)==null?void 0:Z.video_url)||(j==null?void 0:j.video_url)||((le=(xe=j==null?void 0:j.data)==null?void 0:xe.data)==null?void 0:le.output);if(!ne){console.warn("[Tapnow] Veo: URL",j),St($e=>$e.map(rt=>rt.id===l?{...rt,status:"failed",errorMsg:"URL"}:rt));return}const te=Date.now();St($e=>{const rt=$e.find(bt=>bt.id===l),Oe=rt==null?void 0:rt.sourceNodeId,He=rt==null?void 0:rt.ratio,gt=te-((rt==null?void 0:rt.startTime)||te);let xt=u,Ct=h;return(async()=>{try{const bt=await xx(ne);if(bt&&bt.w>0&&bt.h>0){const Jt=bt.w,Kt=bt.h;if(He==="16:9"){const un=Jt/Kt,B=16/9;Math.abs(un-B)>.1?(console.warn(`[Tapnow] Veo:  ${un.toFixed(2)}  16:9 (${B.toFixed(2)})`),console.warn(`[Tapnow] Veo: : ${Jt}x${Kt}, : 16:9`),console.warn(`[Tapnow] Veo:  16:9 : ${u}x${Math.round(u/(16/9))}`),xt=u,Ct=Math.round(u/(16/9))):(xt=Jt,Ct=Kt)}else if(He==="9:16"){const un=Jt/Kt,B=9/16;Math.abs(un-B)>.1?(console.warn(`[Tapnow] Veo:  ${un.toFixed(2)}  9:16 (${B.toFixed(2)})`),console.warn(`[Tapnow] Veo: : ${Jt}x${Kt}, : 9:16`),console.warn(`[Tapnow] Veo:  9:16 : ${Math.round(h*(9/16))}x${h}`),xt=Math.round(h*(9/16)),Ct=h):(xt=Jt,Ct=Kt)}else xt=Jt,Ct=Kt;St(un=>un.map(B=>B.id===l?{...B,status:"completed",progress:100,url:ne,width:xt,height:Ct,durationMs:gt,ratio:He||B.ratio}:B));const Zt=Dn.current.get(l);Zt?(Gt(Zt.nodeId,Zt.shotId,{video_url:ne,status:"done",durationCost:gt/1e3}),Dn.current.delete(l)):Oe&&setTimeout(()=>{ei(l,ne,"video",Oe)},0)}}catch(bt){console.warn("[Tapnow] Veo: ",bt);let Jt=u,Kt=h;if(He==="16:9"){const un=Jt/Kt;Math.abs(un-16/9)>.1&&(Kt=Math.round(Jt/(16/9)))}else if(He==="9:16"){const un=Jt/Kt;Math.abs(un-9/16)>.1&&(Jt=Math.round(Kt*(9/16)))}St(un=>un.map(B=>B.id===l?{...B,status:"completed",progress:100,url:ne,width:Jt,height:Kt,durationMs:gt,ratio:He||B.ratio}:B));const Zt=Dn.current.get(l);Zt?(Gt(Zt.nodeId,Zt.shotId,{video_url:ne,status:"done",durationCost:gt/1e3}),Dn.current.delete(l)):Oe&&setTimeout(()=>{ei(l,ne,"video",Oe)},0)}})(),$e});return}if(C==="FAILED"||C==="ERROR"||C==="CANCELLED"){let ne=`: ${C}`;if(M)try{const $e=typeof M=="string"?JSON.parse(M):M;ne=($e==null?void 0:$e.message)||($e==null?void 0:$e.code)||M}catch{ne=M||ne}console.error("[Tapnow] Veo: ",{status:C,failReason:M,errorMsg:ne}),St($e=>$e.map(rt=>rt.id===l?{...rt,status:"failed",errorMsg:ne}:rt));const te=Dn.current.get(l);if(te){const $e=zo.get(l),rt=$e?Date.now()-$e.startTime:0;Gt(te.nodeId,te.shotId,{status:"failed",errorMsg:ne,durationCost:rt/1e3}),Dn.current.delete(l)}return}if(C==="NOT_START"||C==="PENDING"||C==="QUEUED"){const ne=parseInt(L)||0;St(te=>te.map($e=>$e.id===l?{...$e,status:"generating",progress:Math.max(5,ne),errorMsg:C==="NOT_START"?"...":void 0}:$e)),setTimeout(()=>Yi(n,l,d,f,u,h,g+1),4e3);return}const U=parseInt(L)||Math.min(95,g*2+10);St(ne=>ne.map(te=>te.id===l?{...te,status:"generating",progress:U}:te)),setTimeout(()=>Yi(n,l,d,f,u,h,g+1),4e3)}).catch(_=>setTimeout(()=>Yi(n,l,d,f,u,h,g+1),4e3))},jo=(n,l,d,f,u,h,g="",v=0)=>{if(!n||n==="null"||n==="undefined"){console.error(`[Poll Error] Invalid JobId: ${n} for task ${l}`),St(j=>j.map(C=>C.id===l?{...C,status:"failed",errorMsg:"Task failed: No Job ID returned",durationMs:Date.now()-(C.startTime||Date.now())}:C));return}const x=g==="sora-2-pro"?360:80,_=5e3;if(v>x){St(C=>C.map(L=>L.id===l?{...L,status:"failed",errorMsg:"Sora "}:L));const j=Dn.current.get(l);j&&(Gt(j.nodeId,j.shotId,{status:"draft"}),Dn.current.delete(l));return}const S=g!=null&&g.includes("grok")?`${d}/v2/videos/generations/${encodeURIComponent(n)}`:`${d}/v1/videos/${encodeURIComponent(n)}`;fetch(S,{method:"GET",headers:{Authorization:`Bearer ${f}`}}).then(j=>{if(!j.ok)throw new Error(`HTTP ${j.status}: ${j.statusText}`);return j.text()}).then(j=>{var M,U,V,F,J;let C;try{C=JSON.parse(j)}catch(Y){console.error("[Tapnow] Sora/Grok Poll JSON :",Y,j),setTimeout(()=>jo(n,l,d,f,u,h,g,v+1),_);return}const L=((M=C==null?void 0:C.data)==null?void 0:M.status)||(C==null?void 0:C.status)||((U=C==null?void 0:C.data)==null?void 0:U.task_status)||(C==null?void 0:C.task_status);if(L==="SUCCESS"||L==="succeeded"||L==="FINISHED"||L==="completed"){const Y=((V=C==null?void 0:C.data)==null?void 0:V.output)||(C==null?void 0:C.output)||((F=C==null?void 0:C.data)==null?void 0:F.video_url)||((J=C==null?void 0:C.data)==null?void 0:J.url)||(C==null?void 0:C.video_url)||(C==null?void 0:C.url);if(!Y){St(le=>le.map(ne=>ne.id===l?{...ne,status:"failed",errorMsg:"URL"}:ne));return}const de=Date.now(),Z=zo.get(l);Z==null||Z.sourceNodeId;const xe=de-((Z==null?void 0:Z.startTime)||de);St(le=>{const ne=le.map($e=>$e.id===l?{...$e,status:"completed",progress:100,url:Y,width:u,height:h,durationMs:xe}:$e),te=Dn.current.get(l);if(te)Gt(te.nodeId,te.shotId,{video_url:Y,status:"done",durationCost:xe/1e3}),Dn.current.delete(l);else{const $e=ne.find(rt=>rt.id===l);$e!=null&&$e.sourceNodeId?setTimeout(()=>{ei(l,Y,"video",$e.sourceNodeId)},0):console.warn("[Tapnow] Sora:  sourceNodeId",{taskId:l,updatedItem:$e})}return ne});return}if(L==="FAILED"||L==="ERROR"||L==="CANCELLED"){St(le=>le.map(ne=>ne.id===l?{...ne,status:"failed",errorMsg:`: ${L}`}:ne));const Y=Date.now(),de=zo.get(l),Z=Y-((de==null?void 0:de.startTime)||Y),xe=Dn.current.get(l);xe&&(Gt(xe.nodeId,xe.shotId,{status:"failed",errorMsg:`: ${L}`,durationCost:Z/1e3}),Dn.current.delete(l));return}St(Y=>Y.map(de=>de.id===l?{...de,status:"generating",progress:Math.min(95,(de.progress||10)+2)}:de)),setTimeout(()=>jo(n,l,d,f,u,h,g,v+1),_)}).catch(j=>{console.error("[Tapnow] Sora/Grok Poll :",j),v<x-5?setTimeout(()=>jo(n,l,d,f,u,h,g,v+1),_):St(C=>C.map(L=>L.id===l?{...L,status:"failed",errorMsg:`: ${j.message||""}`}:L))})},rm=async(n,l="1:1")=>new Promise((d,f)=>{const u=new Image;u.crossOrigin="anonymous";const h=setTimeout(()=>{f(new Error(""))},3e4);u.onload=()=>{clearTimeout(h);try{const g=document.createElement("canvas"),v=g.getContext("2d"),x=Math.floor(u.width/2),_=Math.floor(u.height/2),S=x/_,j=[];for(let C=0;C<2;C++)for(let L=0;L<2;L++){const M=Math.max(0,Math.min(L*x,u.width-x)),U=Math.max(0,Math.min(C*_,u.height-_)),V=Math.min(x,u.width-M),F=Math.min(_,u.height-U);g.width=V,g.height=F,v.fillStyle="#ffffff",v.fillRect(0,0,V,F),v.drawImage(u,M,U,V,F,0,0,V,F);const J=g.toDataURL("image/png");j.push({url:J,width:V,height:F,ratio:S})}d(j)}catch(g){console.error("Midjourney: :",g),f(g)}},u.onerror=g=>{clearTimeout(h),console.error("Midjourney: Failed to load image for splitting:",g),f(new Error(""))},u.src=n}),iu=(n,l,d,f,u,h,g,v=0,x=!1)=>{const _=x?160:300,S=5e3;if(v>_){const L=x?800:1500;St(M=>M.map(U=>U.id===n?{...U,status:"failed",errorMsg:`${L}`}:U));return}const C=`${d.replace(/\/+$/,"")}/v1/images/tasks/${l}`;fetch(C,{method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}).then(L=>L.text()).then(L=>{var Z,xe,le,ne,te,$e,rt,Oe,He;let M;try{M=JSON.parse(L)}catch(gt){console.error("[Async Image] Failed to parse response:",gt),setTimeout(()=>iu(n,l,d,f,u,h,g,v+1,x),delayMs);return}const U=(((Z=M==null?void 0:M.data)==null?void 0:Z.status)||(M==null?void 0:M.status)||"").toUpperCase();console.log("[Async Image] :",U,":",{hasData:!!(M!=null&&M.data),hasDataData:!!((xe=M==null?void 0:M.data)!=null&&xe.data),hasDataStatus:!!((le=M==null?void 0:M.data)!=null&&le.status),hasStatus:!!(M!=null&&M.status),dataKeys:M?Object.keys(M):[]});let V=[];if((ne=M==null?void 0:M.data)!=null&&ne.data&&Array.isArray(M.data.data)&&M.data.data.length>0?V=M.data.data:(te=M==null?void 0:M.data)!=null&&te.images&&Array.isArray(M.data.images)&&M.data.images.length>0?V=M.data.images:M!=null&&M.images&&Array.isArray(M.images)&&M.images.length>0?V=M.images:M!=null&&M.data&&Array.isArray(M.data)&&M.data.length>0&&(V=M.data),V.length===0){if(($e=M==null?void 0:M.data)!=null&&$e.data&&Array.isArray(M.data.data)&&M.data.data.length>0){const gt=M.data.data[0];if(gt!=null&&gt.revised_prompt){const xt=gt.revised_prompt.match(/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/);xt&&xt[1]&&(V=[{url:xt[1]}])}}if(V.length===0&&((rt=M==null?void 0:M.data)!=null&&rt.revised_prompt)){const gt=M.data.revised_prompt.match(/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/);gt&&gt[1]&&(V=[{url:gt[1]}])}if(V.length===0&&((Oe=M==null?void 0:M.data)!=null&&Oe.data)&&Array.isArray(M.data.data)&&M.data.data.length>0){const gt=M.data.data.filter(xt=>(xt==null?void 0:xt.url)||(xt==null?void 0:xt.image_url)||(xt==null?void 0:xt.imageUrl));gt.length>0&&(V=gt)}if(V.length===0&&(U==="COMPLETED"||U==="SUCCESS"||U==="FINISHED"||U==="DONE")){const gt=(Ct,bt=0,Jt=new WeakSet)=>{if(bt>5||!Ct||typeof Ct!="object"||Jt.has(Ct))return null;Jt.add(Ct);const Kt=["url","image_url","imageUrl","image","src","link","href"];for(const Zt of Kt)if(Ct[Zt]&&typeof Ct[Zt]=="string"&&Ct[Zt].startsWith("http"))return Ct[Zt];if(Array.isArray(Ct)&&Ct.length>0){const Zt=gt(Ct[0],bt+1,Jt);if(Zt)return Zt}for(const Zt in Ct)if(Ct.hasOwnProperty(Zt)&&!Kt.includes(Zt)){const un=gt(Ct[Zt],bt+1,Jt);if(un)return un}return null},xt=gt(M);xt?V=[{url:xt}]:console.warn("[Async Image] URL:",JSON.stringify(M,null,2).substring(0,500))}}const F=(M==null?void 0:M.message)||(M==null?void 0:M.error)||(M==null?void 0:M.fail_reason)||"";St(gt=>{const xt=gt.map(bt=>{var Jt,Kt,Zt,un,B,pe,Ue,ot,kt,Ht,vt,Vt;if(bt.id===n)if(U==="COMPLETED"||U==="SUCCESS"||U==="FINISHED"||U==="DONE"){const pt=bt.sourceNodeId||g;if(V&&V.length>0){const ft=V.map(wt=>typeof wt=="string"?wt:(wt==null?void 0:wt.url)||(wt==null?void 0:wt.image_url)||(wt==null?void 0:wt.imageUrl)||"").filter(Boolean);if(ft.length>0){const wt=ft[0];if(Dn.current.has(n)){const Bt=Dn.current.get(n);Bt&&Bt.isImageMode?(Gt(Bt.nodeId,Bt.shotId,{output_images:ft,output_url:wt,selectedImageIndex:0,outputEnabled:!1,status:"done",durationCost:at?at/1e3:0}),Dn.current.delete(n)):console.warn("[V3.7.30 Async Debug] ")}let at=null;const At=((Jt=M==null?void 0:M.data)==null?void 0:Jt.duration)||((Kt=M==null?void 0:M.data)==null?void 0:Kt.cost_time)||((Zt=M==null?void 0:M.data)==null?void 0:Zt.elapsed_time)||((un=M==null?void 0:M.data)==null?void 0:un.time_cost)||((B=M==null?void 0:M.data)==null?void 0:B.spent_time)||(M==null?void 0:M.duration)||(M==null?void 0:M.cost_time)||(M==null?void 0:M.elapsed_time)||(M==null?void 0:M.time_cost)||(M==null?void 0:M.spent_time);if(At!=null){if(typeof At=="number")at=At<1e4?At*1e3:At;else if(typeof At=="string"){const Bt=At.match(/(\d+\.?\d*)\s*(s|ms||)/i);if(Bt){const zt=parseFloat(Bt[1]),yn=Bt[2].toLowerCase();at=yn==="s"||yn===""?zt*1e3:zt}else{const zt=parseFloat(At);isNaN(zt)||(at=zt<1e4?zt*1e3:zt)}}}if(at===null){const Bt=Date.now();at=Bt-(bt.startTime||Bt)}console.log("[Async Image] UI:",{taskId:n,url:wt,sourceNodeId:pt,imageCount:ft.length,durationMs:at,backendDuration:At,frontendCalculated:at===null?null:Date.now()-(bt.startTime||Date.now())});const Wt=pt||bt.sourceNodeId;return console.log("[Async Image] ",{taskId:n,url:wt,sourceNodeId:Wt,savedSourceNodeId:pt,hItemSourceNodeId:bt.sourceNodeId,imageCount:ft.length}),requestAnimationFrame(()=>{ei(n,wt,"image",Wt,ft.length>1?ft:null)}),{...bt,status:"completed",progress:100,url:wt,width:u,height:h,durationMs:at,errorMsg:null,sourceNodeId:pt||bt.sourceNodeId,...ft.length>1?{mjImages:ft,selectedMjImageIndex:0}:{}}}else console.error("[Async Image] URL:",V)}else{console.error("[Async Image] :",{status:U,hasData:!!(M!=null&&M.data),hasDataData:!!((pe=M==null?void 0:M.data)!=null&&pe.data),fullData:JSON.stringify(M,null,2).substring(0,1e3)});const ft=(at,At=0)=>{if(At>5||!at||typeof at!="object")return null;if(at.url&&typeof at.url=="string"&&at.url.startsWith("http"))return at.url;if(at.image_url&&typeof at.image_url=="string"&&at.image_url.startsWith("http"))return at.image_url;if(at.imageUrl&&typeof at.imageUrl=="string"&&at.imageUrl.startsWith("http"))return at.imageUrl;for(const Wt in at)if(at.hasOwnProperty(Wt)){const Bt=ft(at[Wt],At+1);if(Bt)return Bt}return null},wt=ft(M);if(wt){let at=null;const At=((Ue=M==null?void 0:M.data)==null?void 0:Ue.duration)||((ot=M==null?void 0:M.data)==null?void 0:ot.cost_time)||((kt=M==null?void 0:M.data)==null?void 0:kt.elapsed_time)||((Ht=M==null?void 0:M.data)==null?void 0:Ht.time_cost)||((vt=M==null?void 0:M.data)==null?void 0:vt.spent_time)||(M==null?void 0:M.duration)||(M==null?void 0:M.cost_time)||(M==null?void 0:M.elapsed_time)||(M==null?void 0:M.time_cost)||(M==null?void 0:M.spent_time);if(At!=null){if(typeof At=="number")at=At<1e4?At*1e3:At;else if(typeof At=="string"){const Bt=At.match(/(\d+\.?\d*)\s*(s|ms||)/i);if(Bt){const zt=parseFloat(Bt[1]),yn=Bt[2].toLowerCase();at=yn==="s"||yn===""?zt*1e3:zt}else{const zt=parseFloat(At);isNaN(zt)||(at=zt<1e4?zt*1e3:zt)}}}if(at===null){const Bt=Date.now();at=Bt-(bt.startTime||Bt)}const Wt=pt||bt.sourceNodeId;return console.log("[Async Image] ",{taskId:n,url:wt,sourceNodeId:Wt,savedSourceNodeId:pt,hItemSourceNodeId:bt.sourceNodeId}),requestAnimationFrame(()=>{ei(n,wt,"image",Wt,null)}),{...bt,status:"completed",progress:100,url:wt,width:u,height:h,durationMs:at,errorMsg:null,sourceNodeId:pt||bt.sourceNodeId}}}return{...bt,status:"failed",errorMsg:F||""}}else if(U==="FAILED"||U==="ERROR"||U==="CANCELLED"||U==="FAILURE"){if(Dn.current.has(n)){const pt=Dn.current.get(n),ft=Date.now(),wt=ft-(bt.startTime||ft);Gt(pt.nodeId,pt.shotId,{status:"failed",errorMsg:F||`: ${U}`,durationCost:wt/1e3}),Dn.current.delete(n)}return{...bt,status:"failed",errorMsg:F||`: ${U}`}}else if(U==="PENDING"||U==="PROCESSING"||U==="GENERATING"||U==="IN_PROGRESS"||U==="RUNNING"){let pt=10+v*2;if((Vt=M==null?void 0:M.data)!=null&&Vt.progress){const ft=String(M.data.progress);ft.includes("%")?pt=parseInt(ft.replace("%",""),10)||pt:typeof M.data.progress=="number"&&(pt=M.data.progress)}else if(M!=null&&M.progress){const ft=String(M.progress);ft.includes("%")?pt=parseInt(ft.replace("%",""),10)||pt:typeof M.progress=="number"&&(pt=M.progress)}return pt=Math.min(95,Math.max(10,pt)),{...bt,status:"generating",progress:pt,errorMsg:null}}else{const pt=Math.min(90,10+v*1.5);return{...bt,status:"generating",progress:pt,errorMsg:null}}return bt}),Ct=xt.find(bt=>bt.id===n);return Ct!=null&&Ct.progress,xt});const J=(((He=M==null?void 0:M.data)==null?void 0:He.status)||(M==null?void 0:M.status)||"").toUpperCase();!(J==="COMPLETED"||J==="SUCCESS"||J==="FINISHED"||J==="DONE")&&!(J==="FAILED"||J==="ERROR"||J==="CANCELLED"||J==="FAILURE")&&St(gt=>{const xt=gt.find(Jt=>Jt.id===n),Ct=(xt==null?void 0:xt.progress)||10;let bt=S;return Ct>=90?bt=1e3:Ct>=70?bt=2e3:Ct>=50?bt=3e3:v>50&&!x&&(bt=1e4),setTimeout(()=>{iu(n,l,d,f,u,h,g,v+1,x)},bt),gt})}).catch(L=>{console.error("[Async Image] Poll error:",L),setTimeout(()=>iu(n,l,d,f,u,h,g,v+1,x),S)})},ou=(n,l,d,f,u="fast",h,g,v=0)=>{if(v>120){St(S=>S.map(j=>j.id===l?{...j,status:"failed",errorMsg:"Midjourney "}:j));return}fetch(`${d}/${u}/mj/task/${n}/fetch`,{method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}).then(S=>S.text()).then(S=>{let j;try{j=JSON.parse(S)}catch(J){console.error("Midjourney: Failed to parse response:",J),setTimeout(()=>ou(n,l,d,f,u,h,g,v+1),5e3);return}const C=(j==null?void 0:j.status)||"",L=(j==null?void 0:j.progress)||"0%",M=(j==null?void 0:j.imageUrl)||"",U=(j==null?void 0:j.failReason)||"",V=(j==null?void 0:j.buttons)||[];let F=0;typeof L=="string"&&L.includes("%")?F=parseInt(L.replace("%",""),10)||0:typeof L=="number"&&(F=L),St(J=>J.map(Y=>{var de,Z,xe,le,ne,te,$e;if(Y.id===l){let rt=Y.status,Oe=Y.errorMsg,He=F;if(C==="SUCCESS"||C==="FINISHED"){if(rt="completed",He=100,Oe=null,M&&((Z=(de=Y.apiConfig)==null?void 0:de.modelId)!=null&&Z.includes("mj"))&&((xe=Y.apiConfig)==null?void 0:xe.modelId)!=="mj-zoom"){let xt="1:1";if(Y.prompt&&Y.prompt.includes("--ar ")){const Kt=Y.prompt.match(/--ar\s+([\d:]+)/);Kt&&Kt[1]&&(xt=Kt[1])}St(Kt=>Kt.map(Zt=>Zt.id===l?{...Zt,url:M,mjRatio:xt,mjOriginalUrl:M,mjNeedsSplit:!0}:Zt));const Ct=Y.sourceNodeId;Ct?setTimeout(()=>{ei(l,M,"image",Ct)},0):console.warn("[Tapnow] Midjourney:  sourceNodeId",{taskId:l,hItem:Y}),setTimeout(()=>{rm(M,xt).then(Kt=>{const Zt=Kt.map(pe=>typeof pe=="string"?pe:pe.url),un=Kt[0],B=typeof un=="string"?un:un.url;St(pe=>pe.map(Ue=>Ue.id===l?{...Ue,mjImages:Zt,url:B,selectedMjImageIndex:0,mjRatio:xt,mjOriginalUrl:M,mjNeedsSplit:!1,mjImageInfo:Kt.map(ot=>typeof ot=="string"?null:{width:ot.width,height:ot.height,ratio:ot.ratio})}:Ue))}).catch(Kt=>{console.error("Midjourney: Failed to split image:",Kt),St(Zt=>Zt.map(un=>un.id===l?{...un,url:M,mjRatio:xt,mjOriginalUrl:M,mjNeedsSplit:!0}:un))})},300);const bt=Date.now(),Jt=bt-(Y.startTime||bt);return{...Y,status:rt,progress:He,errorMsg:Oe,url:M,width:h,height:g,mjButtons:V,mjOriginalUrl:M,durationMs:Jt}}}else C==="FAILURE"||C==="ERROR"||C==="CANCELLED"?(rt="failed",Oe=U||`: ${C}`):C==="NOT_START"||C==="SUBMITTED"||C==="IN_PROGRESS"||C==="MODAL"?(rt="generating",Oe=null,He===0&&(He=5)):(rt="generating",Oe=null,He=Math.min(95,(Y.progress||5)+2));const gt={...Y,status:rt,progress:He,errorMsg:Oe,url:M||Y.url,width:h,height:g,mjButtons:V};if((C==="SUCCESS"||C==="FINISHED")&&M&&(!((ne=(le=Y.apiConfig)==null?void 0:le.modelId)!=null&&ne.includes("mj"))||((te=Y.apiConfig)==null?void 0:te.modelId)==="mj-zoom")){Y.sourceNodeId?(($e=Y.apiConfig)==null?void 0:$e.modelId)==="mj-zoom"?c(bt=>bt.map(Jt=>Jt.id===Y.sourceNodeId&&Jt.type==="expand-image"?{...Jt,content:M}:Jt)):ei(l,M,"image",Y.sourceNodeId):console.warn("[Tapnow] :  sourceNodeId",{taskId:l,hItem:Y});const xt=Date.now(),Ct=xt-(Y.startTime||xt);gt.durationMs=Ct}return gt}return Y})),!(C==="SUCCESS"||C==="FINISHED")&&(C==="FAILURE"||C==="ERROR"||C==="CANCELLED"||setTimeout(()=>ou(n,l,d,f,u,h,g,v+1),5e3))}).catch(S=>{console.error(`[Tapnow] Midjourney Poll Fetch Error for task ${l}:`,S),St(j=>j.map(C=>C.id===l?{...C,status:"failed",errorMsg:`: ${S.message}`}:C)),v<3&&setTimeout(()=>ou(n,l,d,f,u,h,g,v+1),5e3)})},P1=async n=>{if(!n)return null;try{const l=new Image;l.crossOrigin="anonymous",await new Promise((u,h)=>{l.onload=u,l.onerror=h,l.src=n});const d=document.createElement("canvas");d.width=l.width,d.height=l.height;const f=d.getContext("2d");return f.fillStyle="#000000",f.fillRect(0,0,d.width,d.height),f.globalCompositeOperation="destination-out",f.drawImage(l,0,0),new Promise((u,h)=>{d.toBlob(g=>{g?u(g):h(new Error(""))},"image/png")})}catch(l){return console.error("[Inpainting] :",l),null}},No=async(n,l,d,f,u={})=>{var He,gt,xt,Ct,bt,Jt,Kt,Zt,un,B,pe,Ue,ot,kt,Ht,vt,Vt,pt,ft,wt,at,At,Wt,Bt,zt,yn,Tn,q;let h=[];const g=Array.isArray(d)?d:d?[d]:[];if(g.length>0)try{h=await Promise.all(g.map(async re=>{if(wi.isImageId(re)){const Ie=await wi.getImage(re);return Ie||(console.warn(`[startGeneration] Failed to resolve IDB image: ${re}`),re)}return re}))}catch(re){console.error("[startGeneration] Error resolving images:",re),h=g}const v=h,x=v.length>0?v[0]:void 0;if(!n&&!x){alert("");return}let _=null;f&&f.startsWith("storyboard-")&&f.includes("-shot-")?_=null:_=a.find(re=>re.id===f);let S=null,j=_==null?void 0:_.maskContent;if(!j){let re=p.find(Ie=>Ie.to===f&&(!Ie.inputType||Ie.inputType==="default"));if(re||(re=p.find(Ie=>Ie.to===f)),re){const Ie=Dt.get(re.from);Ie&&Ie.maskContent&&(j=Ie.maskContent)}}j&&(S=await P1(j),S||console.warn("[Inpainting] "));const C=u.model||((He=_==null?void 0:_.settings)==null?void 0:He.model)||(l==="image"?"nano-banana":"sora-2"),L=as(C);let M=L.key,U=M;if(M&&M.includes(",")){const re=M.split(",").map(ie=>ie.trim()).filter(ie=>ie),Ie=dt.current||{},lt=re.filter(ie=>!Ie[ie]);lt.length>0?U=lt[Math.floor(Math.random()*lt.length)]:re.length>0&&(U=re[Math.floor(Math.random()*re.length)],console.warn(` [Load Balancing] All ${re.length} keys are blacklisted, using random selection`))}U&&console.log(`[API Select] Using Key ending in ...${U.slice(-4)}`);let V=L.url,F=V;if(V.includes(",")){const re=V.split(",").map(Ie=>Ie.trim()).filter(Ie=>Ie);re.length>0&&(F=re[Math.floor(Math.random()*re.length)])}if(!U){alert(" API Key"),ss(!0);return}n&&(C.includes("sora")||C==="sora-2"||C==="sora-2-pro")&&(n=n.replace(/@([a-zA-Z0-9_\.]+)(?![a-zA-Z0-9_\.])/g,(re,Ie)=>`@{${Ie}}`),n=n.replace(/@\{([^\}]+)\}/g,(re,Ie)=>` @{${Ie}} `).replace(/\s{2,}/g," ").trim());let J=u.ratio||((gt=_==null?void 0:_.settings)==null?void 0:gt.ratio)||(C.includes("grok")?"3:2":"1:1"),Y=u.resolution||((xt=_==null?void 0:_.settings)==null?void 0:xt.resolution)||(l==="video"?"720P":"2K"),de=Y;l==="image"&&(Y=Ul(Y),de=Y),l==="video"&&(Y=Yl(Y),de=Y==="Auto"?"720P":Y);let{sizeStr:Z,w:xe,h:le}=Hz(C,J,de);if(Y==="Auto"&&J==="Auto"&&x)try{const re=await Br(x),Ie=Math.round(re.w/64)*64,lt=Math.round(re.h/64)*64;xe=Ie,le=lt,Z=`${Ie}x${lt}`}catch(re){console.error("Auto Res Error",re)}else if(!xe||!le){const re=Jy(J,Y);xe=re.w,le=re.h,Z=re.str}if(x&&J==="Auto"&&["1K","2K","4K"].includes(Y))try{const re=await Br(x),Ie=Y==="4K"?4096:Y==="2K"?2048:1024,lt=Math.max(re.w,re.h)||1,ie=Ie/lt;let Te=Math.round(re.w*ie/16)*16,yt=Math.round(re.h*ie/16)*16;Te=Math.max(16,Te),yt=Math.max(16,yt),xe=Te,le=yt,Z=`${Te}x${yt}`}catch(re){console.error("Auto+K Upscale Error",re)}let ne=u.duration?String(u.duration).replace("s",""):((bt=(Ct=_==null?void 0:_.settings)==null?void 0:Ct.duration)==null?void 0:bt.replace("s",""))||"5";C.includes("veo")&&(ne="8"),C.includes("jimeng")&&!["5","10"].includes(String(ne))&&(ne="5");const te=u._existingTaskId||`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,$e=()=>{const re=mn.get(C);return C.includes("jimeng")?C:(re==null?void 0:re.displayName)||L.provider||C},rt=Date.now(),Oe=(_==null?void 0:_.id)||f||null;if(u._isRetry||St(re=>[{id:te,type:l,url:"",prompt:n||(x?`Img2${l==="image"?"Img":"Vid"}`:"Untitled"),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),status:"generating",progress:5,modelName:$e(),width:xe,height:le,remoteTaskId:null,apiConfig:{modelId:C,baseUrl:F,apiKey:U},provider:L.provider,sourceNodeId:Oe,startTime:rt,durationMs:null,ratio:J,resolution:Y,duration:l==="video"?ne:null,hasInputImages:v.length>0},...re]),Oe&&Oe.startsWith("storyboard-")&&Oe.includes("-shot-")){const re=Oe.split("-shot-");if(re.length===2){const Ie=re[1],lt=re[0].startsWith("storyboard-img-"),ie=lt?re[0].replace("storyboard-img-",""):re[0].replace("storyboard-","");Dn.current.set(te,{nodeId:ie,shotId:Ie,isImageMode:lt})}}u._isRetry||requestAnimationFrame(()=>{setTimeout(()=>{Lc(!0)},0)});try{if(l==="image"){let re=`${F}/v1/images/generations`,Ie,lt=!1;const ie=mn.get(C),Te=(C.includes("banana")||C.includes("edit")||C.includes("qwen"))&&!(C.includes("nano-banana-2")||((ie==null?void 0:ie.modelName)??"").includes("nano-banana-2")),yt=C.includes("gpt")||((ie==null?void 0:ie.modelName)??"").includes("gpt-image")||((ie==null?void 0:ie.provider)??"").toLowerCase().includes("gpt-4o image"),sn=C.includes("flux")||((ie==null?void 0:ie.modelName)??"").includes("flux-kontext"),ut=((ie==null?void 0:ie.modelName)??"").includes("nano-banana-2")||C.includes("nano-banana-2"),vn=C.includes("mj")||((ie==null?void 0:ie.provider)??"").toLowerCase().includes("midjourney"),qt=C.includes("jimeng")||((ie==null?void 0:ie.modelName)??"").includes("jimeng")||(ie==null?void 0:ie.provider)==="jimeng",pn=()=>{var Ee;return C.includes("jimeng-4.5")?"jimeng-4.5":C.includes("jimeng-4.1")?"jimeng-4.1":C.includes("jimeng-4.0")?"jimeng-4.0":C.includes("jimeng-3.1")?"jimeng-3.1":C.includes("jimeng-3.0")?"jimeng-3.0":(Ee=ie==null?void 0:ie.modelName)!=null&&Ee.includes("jimeng")?ie.modelName:"jimeng-4.5"},Ot=(()=>{if(ut)return Y==="4K"?"4K":Y==="2K"?"2K":"1K"})(),Lt=J==="Auto"?void 0:J;if(v.length>0&&Te){re=`${F}/v1/images/edits`,lt=!0;const Ee=new FormData;Ee.append("model",(ie==null?void 0:ie.modelName)||"nano-banana"),Ee.append("prompt",n||"enhance"),Ee.append("n","1"),Ee.append("size",Z),Lt&&Ee.append("aspect_ratio",Lt),Ot&&Ee.append("image_size",Ot);const Ae=v.map(Tt=>Os(Tt));(await Promise.all(Ae)).forEach((Tt,Ut)=>{Ee.append("image",Tt,`input_${Ut}.png`)}),S&&Ee.append("mask",S,"mask.png"),Ie=Ee}else if(sn){re=`${F}/v1/images/edits`,lt=!0;const Ee=new FormData;Ee.append("model",(ie==null?void 0:ie.modelName)||"flux-kontext-pro"),Ee.append("prompt",n||""),Lt&&Ee.append("aspect_ratio",Lt),Z&&Ee.append("size",Z);const Ae=v.length>0?v:x?[x]:[];if(Ae.length>0){const It=Ae.map(Ut=>Os(Ut));(await Promise.all(It)).forEach((Ut,jt)=>Ee.append("image",Ut,`flux_ref_${jt}.png`))}S&&Ee.append("mask",S,"mask.png"),Ie=Ee}else if(yt){let Ee=n||"";const Ae={model:(ie==null?void 0:ie.modelName)||"gpt-4o-image",prompt:Ee,n:1,size:Z,aspect_ratio:J,response_format:"url"};if(v.length>0){const It=v.map(Ut=>Kn(Ut)),Tt=await Promise.all(It);Ae.image=Tt.map(Ut=>`data:image/png;base64,${Ut}`)}Ie=Ae}else if(ut)if(v.length>0){re=`${F}/v1/images/edits?async=true`,lt=!0;const Ae=new FormData;Ae.append("model",(ie==null?void 0:ie.modelName)||"nano-banana-2"),Ae.append("prompt",n||""),Ae.append("response_format","url"),Lt&&Ae.append("aspect_ratio",Lt),Ot&&Ae.append("image_size",Ot);const It=v.map(Ut=>Os(Ut));(await Promise.all(It)).forEach((Ut,jt)=>{Ae.append("image",Ut,`input_${jt}.png`)}),S&&Ae.append("mask",S,"mask.png"),Ie=Ae}else{re=`${F}/v1/images/generations?async=true`;const Ae={model:(ie==null?void 0:ie.modelName)||"nano-banana-2",prompt:n||"",response_format:"url",...Lt?{aspect_ratio:Lt}:{},...Ot?{image_size:Ot}:{}};if(x){const It=x.trim();if(It.startsWith("http"))Ae.image=[It];else if(It.startsWith("data:"))Ae.image=[It];else{const Tt=await Kn(It);Ae.image=[`data:image/png;base64,${Tt}`]}}Ie=Ae}else if(vn){const Ee=((Jt=_==null?void 0:_.settings)==null?void 0:Jt.mjMode)||"fast",Ae=((Kt=_==null?void 0:_.settings)==null?void 0:Kt.mjVersion)||"--v 7";let It=n||"";J&&J!=="Auto"&&(It.includes("--ar ")||(It=`${It} --ar ${J}`.trim()));const Tt=su(f,"oref"),Ut=su(f,"sref"),jt=[],mt=new Map;let Yt=null,tn=null,en=[];const lr=Tt||((Zt=_==null?void 0:_.settings)==null?void 0:Zt.mjOref)&&_.settings.mjOref.trim();if(lr&&lr.trim()){let wn=lr.trim();wn.startsWith("http")?Yt=wn:wn.startsWith("data:")?(jt.push(wn),mt.set("oref",jt.length-1)):Yt=wn}const xr=Ut||((un=_==null?void 0:_.settings)==null?void 0:un.mjSref)&&_.settings.mjSref.trim();if(xr&&xr.trim()){let wn=xr.trim();wn.startsWith("http")?tn=wn:wn.startsWith("data:")?(jt.push(wn),mt.set("sref",jt.length-1)):tn=wn}if(v.length>0)for(const wn of v)!(Tt&&wn===Tt)&&!(Ut&&wn===Ut)&&(wn.startsWith("http")?en.push(wn):wn.startsWith("data:")?(jt.push(wn),mt.set(`default_${en.length}`,jt.length-1),en.push(null)):en.push(wn));if(jt.length>0)try{const wn=await $1(jt,F,U);mt.has("oref")&&(Yt=wn[mt.get("oref")]),mt.has("sref")&&(tn=wn[mt.get("sref")]);for(let ks=0;ks<en.length;ks++)if(en[ks]===null){const Io=`default_${ks}`;mt.has(Io)&&(en[ks]=wn[mt.get(Io)])}}catch(wn){St(ks=>ks.map(Io=>Io.id===te?{...Io,status:"failed",progress:0,errorMsg:`: ${wn.message}`}:Io));return}en=en.filter(wn=>wn!==null);let _n="";en.length>0&&(_n=en.join(" ")+" "),_n+=It.trim(),!_n.includes("--v ")&&!_n.includes("--niji ")&&(_n=`${_n} ${Ae}`.trim()),J&&J!=="Auto"&&!_n.includes("--ar ")&&(_n=`${_n} --ar ${J}`.trim()),Yt&&!_n.includes("--oref ")&&(_n=`${_n} --oref ${Yt}`.trim()),(B=_==null?void 0:_.settings)!=null&&B.mjOw&&_.settings.mjOw>0&&!_n.includes("--ow ")&&(_n=`${_n} --ow ${Math.min(1e3,Math.max(1,_.settings.mjOw))}`.trim()),tn&&!_n.includes("--sref ")&&(_n=`${_n} --sref ${tn}`.trim()),re=`${F}/${Ee}/mj/submit/imagine`,Ie={prompt:_n,base64Array:[]};const ga=await fetch(re,{method:"POST",headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json"},body:JSON.stringify(Ie)}),vm=await ga.text();if(!ga.ok)throw new Error(vm||`Midjourney API error: ${ga.status}`);let kl=JSON.parse(vm);if(kl.code!==1&&kl.code!==22)throw new Error(kl.description||`Midjourney: code ${kl.code}`);const _p=kl.result;if(!_p)throw new Error("ID");St(wn=>wn.map(ks=>ks.id===te?{...ks,remoteTaskId:_p,status:"generating",progress:5}:ks)),ou(_p,te,F,U,Ee,xe,le);return}else if(qt)if(v.length>0){if(re=`${F}/v1/images/compositions`,!n||n.trim()==="")throw new Error("");let Ee=J,Ae="2k";if(J==="Auto"&&x)try{const jt=await Br(x),mt=[{name:"1:1",value:1},{name:"4:3",value:4/3},{name:"3:4",value:3/4},{name:"16:9",value:16/9},{name:"9:16",value:9/16},{name:"3:2",value:3/2},{name:"2:3",value:2/3},{name:"21:9",value:21/9}],Yt=jt.w/jt.h;let tn=mt[0],en=Math.abs(Yt-tn.value);for(const lr of mt){const xr=Math.abs(Yt-lr.value);xr<en&&(en=xr,tn=lr)}if(Ee=tn.name,Y==="Auto"){const lr=Math.max(jt.w,jt.h);Ae=lr<=1024?"1k":lr<=2048?"2k":"4k"}}catch{Ee="1:1"}else Ee=J==="Auto"?"1:1":J;Y!=="Auto"&&(Ae=Y==="1K"?"1k":Y==="2K"?"2k":"4k");const It=v.map(async jt=>{if(jt.startsWith("blob:"))try{const mt=await fetch(jt);if(mt.ok){const Yt=await mt.blob();return await new Promise(tn=>{const en=new FileReader;en.onloadend=()=>{tn(en.result)},en.readAsDataURL(Yt)})}else throw new Error("Blob ")}catch(mt){throw console.error(" Blob URL :",mt),new Error("Blob URL")}if(jt.startsWith("http"))try{const mt=await fetch(jt);if(!mt.ok)throw new Error(`HTTP ${mt.status}: URL`);const Yt=await mt.blob();return await new Promise(tn=>{const en=new FileReader;en.onloadend=()=>tn(en.result),en.readAsDataURL(Yt)})}catch(mt){throw new Error(`: ${mt.message}`)}return jt}),Tt=await Promise.all(It);Ie={model:pn(),prompt:n.trim(),images:Tt,ratio:Ee,resolution:Ae,response_format:"url"}}else{re=`${F}/v1/images/generations`;const Ee=J==="Auto"?"1:1":J;let Ae="2k";if(Y==="1K"?Ae="1k":Y==="2K"?Ae="2k":Y==="4K"&&(Ae="4k"),!n||n.trim()==="")throw new Error("");Ie={model:pn(),prompt:n.trim(),ratio:Ee,resolution:Ae,response_format:"url"}}else Ie={model:(ie==null?void 0:ie.modelName)||C,prompt:n,n:1,size:Z,response_format:"url"};const O=async(Ee,Ae)=>{const It=lt?{Authorization:`Bearer ${Ee} `}:{Authorization:`Bearer ${Ee} `,"Content-Type":"application/json"};let Tt;re.startsWith("http")?Ae!==F&&re.includes(F)?Tt=re.replace(F,Ae):Tt=re:Tt=`${Ae.replace(/\/+$/,"")}${re.startsWith("/")?re:"/"+re} `;const Ut=lt?Ie:JSON.stringify(Ie);return await fetch(Tt,{method:"POST",headers:It,body:Ut})},Pe=M&&M.includes(",")?M.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee):[M||Me],We=V.includes(",")?V.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee):[(V||zr).replace(/\/+$/,"")],Ge=Ee=>{for(let Ae=Ee.length-1;Ae>0;Ae--){const It=Math.floor(Math.random()*(Ae+1));[Ee[Ae],Ee[It]]=[Ee[It],Ee[Ae]]}return Ee};Pe.length>1&&Ge(Pe),We.length>1&&Ge(We);let ze,he,ge,et,st=!1;const Ve=dt.current||{},nt=[];for(const Ee of Pe)if(!Ve[Ee]&&!Gs(Ee))for(const Ae of We)nt.push({key:Ee,url:Ae});if(nt.length===0&&Pe.length>0){console.warn("[Blacklist] All specified keys are blacklisted. Trying anyway with all available keys to avoid total failure.");for(const Ee of Pe)for(const Ae of We)nt.push({key:Ee,url:Ae})}nt.length>1&&Ge(nt);for(const Ee of nt)try{if(ze=await O(Ee.key,Ee.url),ze.status===401||ze.status===402||ze.status===403){const It=ze.status===402?" (402)":ze.status===401?" (401)":" (403)";console.warn(`[API Failover] Key ending in ...${Ee.key.slice(-4)} failed with status ${ze.status}. Trying next...`),Ye(Ee.key,It),et=new Error(`API returned ${ze.status}: ${It}`);continue}ge=await ze.text();try{he=JSON.parse(ge)}catch{}let Ae=he==null?void 0:he.code;if(he!=null&&he.message&&typeof he.message=="string"){const It=he.message.match(/:\s*(\d+)/);It&&(Ae=parseInt(It[1],10))}if(qt&&he&&he.code,qt&&(Ae===1e3||he!=null&&he.message&&he.message.toLowerCase().includes("invalid parameter")))throw console.error(` [API Fatal]  (1000): ${he.message}`),new Error(`: ${he.message||"Invalid parameter"} ( 1000)`);if(qt&&(Ae===34010105||he!=null&&he.message&&he.message.includes("34010105"))){console.warn(` [API Suspend] Key ending in ...${Ee.key.slice(-4)}  (34010105) 60 `),vr(Ee.key," (34010105)",60*60*1e3),et=new Error(":  session ( 34010105)");continue}if(qt&&Ae===1006){if(Pr(),$s())throw new Error(" : ");const It=" (1006)";console.warn(` [API Blacklist] Key ending in ...${Ee.key.slice(-4)}  (1006)`),Ye(Ee.key,It),et=new Error(`Jimeng Error: ${he.message||"Not enough credits"}`);continue}st=!0;break}catch(Ae){if(Ae.message.includes("")||Ae.message.includes(""))throw Ae;console.warn(`[API Failover] Network/Parse request failed for ...${Ee.key.slice(-4)}. Error: ${Ae.message}`),et=Ae}if(!st||!ze&&!ge){const Ee=et?et.message:"All API combinations failed.";throw new Error(Ee)}if(!he&&ge)try{he=JSON.parse(ge)}catch{throw new Error(`: ${ge.substring(0,100)}`)}if(!ze.ok){let Ee=(he==null?void 0:he.message)||((pe=he==null?void 0:he.error)==null?void 0:pe.message)||ge;throw yt&&ze.status===500&&(Ee=`GPT - 4o (500): ${((Ue=he==null?void 0:he.error)==null?void 0:Ue.message)||(he==null?void 0:he.error)||(he==null?void 0:he.message)||ge} 


1.API Key 
2.(${(ie==null?void 0:ie.modelName)||"gpt-4o-image"}) 
3.
4.`,St(It=>It.map(Tt=>Tt.id===te?{...Tt,status:"failed",progress:0,errorMsg:Ee}:Tt))),new Error(Ee)}if(qt&&(he==null?void 0:he.code)!==void 0&&he.code!==0&&he.code!==1&&he.code!==200)throw new Error(he.message||`API: ${he.code} `);if(ut&&(he!=null&&he.task_id||typeof(he==null?void 0:he.data)=="string"&&he.data.startsWith("task-"))){const Ee=he.task_id||he.data;St(Ae=>Ae.map(It=>It.id===te?{...It,status:"generating",progress:10,remoteTaskId:Ee}:It)),iu(te,Ee,F,U,xe,le,Oe,0,!0);return}let Q=[];if(he!=null&&he.data&&Array.isArray(he.data)?Q=he.data.map(Ee=>Ee.url||Ee.image_url||Ee).filter(Ee=>typeof Ee=="string"):(ot=he==null?void 0:he.data)!=null&&ot.data&&Array.isArray(he.data.data)&&(Q=he.data.data.map(Ee=>Ee.url).filter(Boolean)),Q.length===0)throw new Error("URL");const De=Q[0],Je=Date.now()-rt,Rt=Dn.current.get(te);Rt&&(Rt.isImageMode?Gt(Rt.nodeId,Rt.shotId,{output_images:Q,output_url:Q[0],selectedImageIndex:0,outputEnabled:!1,status:"done"}):console.warn("[V3.7.30 Debug] "),Dn.current.delete(te)),St(Ee=>Ee.map(It=>{if(It.id===te){const Tt={...It,status:"completed",progress:100,url:De,width:xe,height:le,durationMs:Je,mjImages:Q.length>1?Q:null,selectedMjImageIndex:0};return Tt.sourceNodeId&&!Rt&&setTimeout(()=>{ei(te,De,"image",Tt.sourceNodeId,Tt.mjImages)},0),Tt}return It}));return}if(l==="video"){const re=mn.get(C);if(C.includes("veo")){const ze=`${F} /v2/videos / generations`;let he=[];if(v&&v.length>0)he=await Promise.all(v.filter(Ve=>Ve&&typeof Ve=="string"&&Ve.trim().length>0).map(async Ve=>{const nt=Ve.trim();if(nt.startsWith("http://")||nt.startsWith("https://"))try{const Q=await Br(nt);return Q.w>1920||Q.h>1920?await vp(nt,1920,1920):nt}catch(Q){return console.warn("Veo: URL",Q),nt}try{const Q=await Br(nt);return Q.w>1920||Q.h>1920?await vp(nt,1920,1920):nt.startsWith("data:")?nt:nt.startsWith("blob:")?`data: image / png; base64, ${await Kn(nt)} `:nt.length>100&&!nt.includes("://")&&!nt.startsWith("data:")?`data: image / png; base64, ${nt} `:`data: image / png; base64, ${await Kn(nt)} `}catch(Q){throw console.error("Veo: Failed to process image:",Q),new Error(`: ${nt.substring(0,50)}...`)}}));else if(x){const Ve=x.trim();try{const nt=await Br(Ve);nt.w>1920||nt.h>1920?he=[await vp(Ve,1920,1920)]:Ve.startsWith("http://")||Ve.startsWith("https://")?he=[Ve]:Ve.startsWith("data:")?he=[Ve]:Ve.startsWith("blob:")?he=[`data: image / png; base64, ${await Kn(Ve)} `]:Ve.length>100&&!Ve.includes("://")&&!Ve.startsWith("data:")?he=[`data: image / png; base64, ${Ve} `]:he=[`data: image / png; base64, ${await Kn(Ve)} `]}catch(nt){throw console.error("Veo: Failed to process source image:",nt),new Error(`: ${nt.message} `)}}if(he.length===0&&((v==null?void 0:v.length)>0||x))throw console.error("Veo: images ",{connectedImages:v,sourceImage:x}),new Error("");const ge=he.filter((Ve,nt)=>!Ve||typeof Ve!="string"?(console.warn(`Veo:  ${nt}: `),!1):Ve==="base64_data"||Ve.trim()==="base64_data"?(console.warn(`Veo:  ${nt}: base64_data`),!1):!0);if(ge.length===0&&((v==null?void 0:v.length)>0||x))throw console.error("Veo: ",{images:he,connectedImages:v,sourceImage:x}),new Error("");let et=null;if(J&&J!=="Auto")if(J==="16:9"||J==="9:16")et=J;else{const Ve=xe/le;Math.abs(Ve-16/9)<Math.abs(Ve-9/16)?et="16:9":et="9:16"}const st={model:(re==null?void 0:re.modelName)||"veo3.1",prompt:n,enhance_prompt:!1,images:ge.length>0?ge:[],...et?{aspect_ratio:et}:{}};console.log("Veo: ",{endpoint:ze,model:st.model,prompt:((kt=st.prompt)==null?void 0:kt.substring(0,50))+"...",imagesCount:st.images.length,firstImageType:st.images[0]?st.images[0].startsWith("http")?"HTTP URL":st.images[0].startsWith("data:")?"Data URL":"Unknown":"empty",firstImagePreview:st.images[0]?st.images[0].startsWith("http")?st.images[0].substring(0,80):st.images[0].substring(0,100):"empty",aspect_ratio:st.aspect_ratio,payloadSize:JSON.stringify(st).length});try{const Ve=await fetch(ze,{method:"POST",headers:{Authorization:`Bearer ${U} `,"Content-Type":"application/json"},body:JSON.stringify(st)}),nt=await Ve.text();if(!Ve.ok)throw console.error("Veo: ",{status:Ve.status,text:nt}),new Error(nt||`Veo error: ${Ve.status} `);const Q=JSON.parse(nt),De=((Ht=Q==null?void 0:Q.data)==null?void 0:Ht.id)||(Q==null?void 0:Q.id)||(Q==null?void 0:Q.task_id)||((vt=Q==null?void 0:Q.data)==null?void 0:vt.task_id);if(!De)throw console.error("Veo:  JobId",Q),new Error("Veo No JobId");St(tt=>tt.map(Je=>Je.id===te?{...Je,status:"generating",progress:10}:Je)),Yi(De,te,F,U,xe,le);return}catch(Ve){throw console.error("Veo: ",Ve),St(nt=>nt.map(Q=>Q.id===te?{...Q,status:"failed",errorMsg:Ve.message||""}:Q)),Ve}}let Ie="",lt;const ie={Authorization:`Bearer ${U} `},Te=(()=>{if(ne==null)return 8;const ze=String(ne).trim().replace(/[^\d]/g,""),he=parseInt(ze,10);return Number.isFinite(he)&&he>0?he:8})();if(C.includes("grok")){const ze=`${F} /v2/videos / generations`,he=parseInt(ne,10),ge=J&&J!=="Auto"?J:"3:2",et=Y&&Y!=="Auto"?Y:"1080P",st={model:(re==null?void 0:re.modelName)||"grok-video-3",prompt:n,ratio:ge,resolution:et};if(Number.isFinite(he)&&he>0&&(st.duration=he),x)try{let tt="";if(x.startsWith("data:"))tt=x;else{const Je=await Os(x);tt=await new Promise((Rt,Ee)=>{const Ae=new FileReader;Ae.onloadend=()=>Rt(Ae.result),Ae.onerror=Ee,Ae.readAsDataURL(Je)})}st.images=[tt]}catch(tt){console.error("Grok Image Conversion Failed:",tt),alert("");return}const Ve=await fetch(ze,{method:"POST",headers:{Authorization:`Bearer ${U} `,"Content-Type":"application/json"},body:JSON.stringify(st)}),nt=await Ve.text();if(!Ve.ok)throw console.error("[Grok API Error]",nt),new Error(nt||`Grok API error: ${Ve.status} `);let Q;try{Q=JSON.parse(nt)}catch{throw new Error("API  JSON ")}const De=((Vt=Q==null?void 0:Q.data)==null?void 0:Vt.id)||(Q==null?void 0:Q.id)||(Q==null?void 0:Q.task_id);if(!De)throw console.error("Grok No Task ID:",Q),new Error("API  Task ID");St(tt=>tt.map(Je=>Je.id===te?{...Je,status:"generating",progress:10,remoteTaskId:De}:Je)),jo(De,te,F,U,xe,le,C);return}if(x){const ze=new FormData,he=await Os(x);if(C.includes("sora")){Ie=`${F} /v1/videos`;let ge=n.replace(/@\{([^\}]+)\}/g,(et,st)=>`@${st} `);ze.append("model",(re==null?void 0:re.modelName)||"sora-2"),ze.append("prompt",ge),ze.append("seconds",ne),ze.append("size",Z),C==="sora-2"&&(u.isHD||(pt=_==null?void 0:_.settings)!=null&&pt.isHD)&&ze.append("quality","hd"),ze.append("input_reference",he,"ref.png"),ze.append("image",he,"ref.png")}else if(C.includes("jimeng")){Ie=`${F}/v1/videos/generations`,ze.append("model",(re==null?void 0:re.modelName)||C||"jimeng-video-3.0"),ze.append("prompt",n),ze.append("duration",parseInt(ne));const ge=J==="Auto"?"1:1":J;ze.append("ratio",ge);const et=Lu(Y);et&&ze.append("resolution",et);const st=v.filter(Boolean).slice(0,2),Ve=await Promise.all(st.map(nt=>Os(nt)));Ve[0]&&ze.append("image_file_1",Ve[0],"first.png"),Ve[1]&&ze.append("image_file_2",Ve[1],"last.png")}else C.includes("grok")?(Ie=`${F} /v1/videos`,ze.append("model",(re==null?void 0:re.modelName)||"grok-video-3"),ze.append("prompt",n),ze.append("aspect_ratio",J),ze.append("duration",Te),ze.append("image",he,"input.png")):(Ie=`${F} /v1/videos`,ze.append("model",re==null?void 0:re.modelName),ze.append("prompt",n),ze.append("image",he,"input.png"),ze.append("size",Z));lt=ze}else if(ie["Content-Type"]="application/json",C.includes("sora")){delete ie["Content-Type"],Ie=`${F} /v1/videos`;const ze=new FormData;let he=n.replace(/@\{([^\}]+)\}/g,(ge,et)=>`@${et} `);ze.append("model",(re==null?void 0:re.modelName)||"sora-2"),ze.append("prompt",he),ze.append("seconds",ne),ze.append("size",Z),C==="sora-2"&&(u.isHD||(ft=_==null?void 0:_.settings)!=null&&ft.isHD)&&ze.append("quality","hd"),lt=ze}else if(C.includes("jimeng")){Ie=`${F}/v1/videos/generations`;const ze=J==="Auto"?"1:1":J,he=Lu(Y),ge={model:(re==null?void 0:re.modelName)||C||"jimeng-video-3.0",prompt:n,duration:parseInt(ne),ratio:ze};he&&(ge.resolution=he),lt=JSON.stringify(ge)}else C.includes("grok")?(Ie=`${F} /v1/videos`,lt=JSON.stringify({model:(re==null?void 0:re.modelName)||"grok-video-3",prompt:n,aspect_ratio:J,duration:Te})):(Ie=`${F} /minimax/v1 / video_generation`,lt=JSON.stringify({model:re==null?void 0:re.modelName,prompt:n,resolution:Z}));const yt=await fetch(Ie,{method:"POST",headers:lt instanceof FormData?{Authorization:ie.Authorization}:ie,body:lt}),sn=await yt.text();if(!yt.ok)throw new Error(sn||`Video API error: ${yt.status} `);const ut=JSON.parse(sn),vn=(ut==null?void 0:ut.code)||((wt=ut==null?void 0:ut.data)==null?void 0:wt.code),qt=(ut==null?void 0:ut.message)||((at=ut==null?void 0:ut.data)==null?void 0:at.message)||"";let pn=vn;const Qe=qt.match(/[:]\s*(\d+)/);if(Qe&&(pn=parseInt(Qe[1],10)),pn===1e3)throw console.error(` [Video API]  (1000): ${qt}`),new Error(`: ${qt||"Invalid parameter"} ( 1000)`);const Lt=pn===1006,O=vn===-2001&&qt.includes("34010105");if(vn===-2008||qt.includes("2060")){let ze=" ";throw qt.includes(": 30")&&(ze+="\\n\\n \\n \\n \\n \\n "),qt.includes("2060")&&(ze+="\\n\\n: 2060 ()"),new Error(ze)}if(Lt||O){const ze=Lt?" (1006)":" (34010105)";console.warn(` [Video API] Key ending in ...${U.slice(-4)} failed: ${ze}. Adding to blacklist.`),Ye(U,ze);const he=new Error(`RETRY_WITH_NEW_KEY: ${qt}`);throw he.shouldRetry=!0,he}const We=(ut==null?void 0:ut.video_url)||(ut==null?void 0:ut.url)||((At=ut==null?void 0:ut.data)==null?void 0:At.video_url)||((Wt=ut==null?void 0:ut.data)==null?void 0:Wt.url)||Array.isArray(ut==null?void 0:ut.data)&&((Bt=ut.data[0])==null?void 0:Bt.url);if(We){const ze=Date.now(),he=zo.get(te),ge=he==null?void 0:he.sourceNodeId,et=ze-((he==null?void 0:he.startTime)||ze);St(st=>{const Ve=st.map(Q=>Q.id===te?{...Q,status:"completed",progress:100,url:We,width:xe,height:le,durationMs:et}:Q),nt=Dn.current.get(te);if(nt)Gt(nt.nodeId,nt.shotId,{video_url:We,status:"done",durationCost:et/1e3}),Dn.current.delete(te);else{const Q=Ve.find(De=>De.id===te);Q!=null&&Q.sourceNodeId?setTimeout(()=>{ei(te,We,"video",Q.sourceNodeId)},0):console.warn("[Tapnow] :  sourceNodeId",{taskId:te,updatedItem:Q})}return Ve});return}const Ge=((zt=ut==null?void 0:ut.data)==null?void 0:zt.id)||(ut==null?void 0:ut.id)||(ut==null?void 0:ut.task_id)||((yn=ut==null?void 0:ut.data)==null?void 0:yn.task_id)||(ut==null?void 0:ut.job_id)||((Tn=ut==null?void 0:ut.data)==null?void 0:Tn.job_id);if(!Ge)throw new Error(`No Task/Job ID returned. Response: ${JSON.stringify(ut).substring(0,200)}`);C.includes("veo")?Yi(Ge,te,F,U,xe,le):jo(Ge,te,F,U,xe,le,C)}}catch(re){if(re.shouldRetry)return No(n,l,d,f,{...u,_isRetry:!0,_existingTaskId:te});console.error("[CONSOLE_ERROR]",re);const Ie=Date.now(),lt=Pt.find(yt=>yt.id===te),ie=lt!=null&&lt.startTime?Ie-lt.startTime:0;let Te=(re==null?void 0:re.message)||"";try{if(typeof Te=="string"&&Te.trim().startsWith("{")){const yt=JSON.parse(Te);(q=yt==null?void 0:yt.error)!=null&&q.message?Te=yt.error.message:yt!=null&&yt.error?Te=typeof yt.error=="string"?yt.error:JSON.stringify(yt.error):yt!=null&&yt.message&&(Te=yt.message)}(Te.includes("Cannot find module")||Te.includes("octetstream")||Te.includes("MODULE_NOT_FOUND"))&&(!Te.includes("API")&&!Te.includes("")?Te=` API

${Te.replace(/[:].*?[:]/g,"").trim()} 

 
1.jimeng - api.exe
2.Dockerdocker pull ghcr.io / iptag / jimeng - api: latest`:Te.includes("")||(Te=Te+`

 
1. jimeng-api.exe
2. Dockerdocker pull ghcr.io/iptag/jimeng-api:latest`))}catch{(Te.includes("Cannot find module")||Te.includes("octetstream")||Te.includes("MODULE_NOT_FOUND"))&&!Te.includes("API")&&!Te.includes("")&&(Te=` API

 
1.jimeng - api.exe
2.Dockerdocker pull ghcr.io / iptag / jimeng - api: latest`)}St(yt=>yt.map(sn=>sn.id===te?{...sn,status:"failed",errorMsg:Te,durationMs:ie}:sn))}},A1=()=>{t(n=>n==="dark"?"light":"dark")},R1=async()=>{const n=Jr.current,l=Wi.current,d=qs.current,f=n.filter(u=>(l===u.id||d&&d.has(u.id))&&(u.type==="input-image"||u.type==="video-input"||u.type==="preview")&&u.content);if(f.length===0){alert("");return}for(const u of f)try{const h=u.content;if(!h||typeof h!="string"&&!h.startsWith("data:")){console.warn(` ${u.id} URL: `,h);continue}const g=await fetch(h);if(!g.ok)throw new Error(`HTTP ${g.status}: ${g.statusText} `);const v=await g.blob(),x=URL.createObjectURL(v),_=document.createElement("a");_.href=x;let S=".png";u.type==="preview"?u.previewType==="video"?S=".mp4":S=Hn(h)?".mp4":".png":u.type==="video-input"?S=".mp4":S=Hn(h)?".mp4":".png";const j=`${u.id}${S} `;_.download=j,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(x),await new Promise(C=>setTimeout(C,100))}catch(h){console.error(` ${u.id} : `,h)}},au=()=>{const n=new Date;return new Date(n.getTime()+8*60*60*1e3).toISOString()},lu=()=>{const n=new Date,l=new Date(n.getTime()+8*60*60*1e3),d=l.getUTCFullYear(),f=String(l.getUTCMonth()+1).padStart(2,"0"),u=String(l.getUTCDate()).padStart(2,"0"),h=String(l.getUTCHours()).padStart(2,"0"),g=String(l.getUTCMinutes()).padStart(2,"0"),v=String(l.getUTCSeconds()).padStart(2,"0");return`${d} -${f} -${u}T${h} -${g} -${v} `},D1=async()=>{try{if(!window.showSaveFilePicker){if(!confirm(`

/>500MB Chrome  Edge 

`))return;const x=(Z,xe)=>xe===void 0?null:xe,_=JSON.parse(JSON.stringify(a,x)),S=async Z=>{if(Z==null)return Z;if(typeof Z=="string"&&Z.startsWith("blob:"))try{const xe=await Os(Z);return await yp(xe)}catch(xe){return console.error(" Blob URL :",xe),Z}if(Array.isArray(Z))return await Promise.all(Z.map(xe=>S(xe)));if(typeof Z=="object"){const xe={};for(const le in Z)Z.hasOwnProperty(le)&&(xe[le]=await S(Z[le]));return xe}return Z},j=await S(_),C=JSON.parse(JSON.stringify(Wn,x)),L=await S(C),M={version:"2.5.7",projectName:pr,nodes:j,connections:p,view:$t,history:Pt,chatSessions:an,characterLibrary:L,timestamp:au()},U=JSON.stringify(M,x,2),V=new Blob([U],{type:"application/json"}),F=URL.createObjectURL(V),J=document.createElement("a");J.href=F;const Y=lu(),de=`${pr||""}_${Y}.json`;J.download=de,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(F),alert("");return}const n=lu(),d=await(await window.showSaveFilePicker({suggestedName:`${pr||""}_${n}.json`,types:[{description:"JSON File",accept:{"application/json":[".json"]}}]})).createWritable(),f=(v,x)=>x===void 0?null:x,u=async v=>{const x={...v};if(x.content&&typeof x.content=="string"&&x.content.startsWith("blob:"))try{const _=await Kn(x.content),S=Hn(x.content)?"video/mp4":"image/png";x.content=`data:${S}; base64, ${_} `}catch(_){console.error(" content :",_)}if(x.maskContent&&typeof x.maskContent=="string"&&x.maskContent.startsWith("blob:"))try{const _=await Kn(x.maskContent);x.maskContent=`data: image / png; base64, ${_} `}catch(_){console.error(" maskContent :",_)}if(Array.isArray(x.selectedKeyframes))for(let _=0;_<x.selectedKeyframes.length;_++){const S=x.selectedKeyframes[_];if(S&&S.url&&typeof S.url=="string"&&S.url.startsWith("blob:"))try{const j=await Kn(S.url);S.url=`data: image / png; base64, ${j} `}catch(j){console.error(":",j)}}if(Array.isArray(x.frames))for(let _=0;_<x.frames.length;_++){const S=x.frames[_];if(S&&S.url&&typeof S.url=="string"&&S.url.startsWith("blob:"))try{const j=await Kn(S.url);S.url=`data: image / png; base64, ${j} `}catch(j){console.error(":",j)}}if(Array.isArray(x.previewMjImages))for(let _=0;_<x.previewMjImages.length;_++){const S=x.previewMjImages[_];if(S&&typeof S=="string"&&S.startsWith("blob:"))try{const j=await Kn(S);x.previewMjImages[_]=`data:image/png;base64,${j}`}catch(j){console.error(" previewMjImages :",j)}}return x},h=async v=>{const x={...v};if(x.url&&typeof x.url=="string"&&x.url.startsWith("blob:"))try{const _=await Kn(x.url),S=x.type==="video"?"video/mp4":"image/png";x.url=`data:${S}; base64, ${_} `}catch(_){console.error(" url :",_)}if(x.mjOriginalUrl&&typeof x.mjOriginalUrl=="string"&&x.mjOriginalUrl.startsWith("blob:"))try{const _=await Kn(x.mjOriginalUrl);x.mjOriginalUrl=`data: image / png; base64, ${_} `}catch(_){console.error(" mjOriginalUrl :",_)}if(Array.isArray(x.mjImages))for(let _=0;_<x.mjImages.length;_++){const S=x.mjImages[_];if(S&&typeof S=="string"&&S.startsWith("blob:"))try{const j=await Kn(S);x.mjImages[_]=`data: image / png; base64, ${j} `}catch(j){console.error(" mjImages :",j)}}return x},g=async v=>{const x={...v};if(x.avatar&&typeof x.avatar=="string"&&x.avatar.startsWith("blob:"))try{const _=await Kn(x.avatar);x.avatar=`data: image / png; base64, ${_} `}catch(_){console.error(" avatar :",_)}if(x.profile_picture_url&&typeof x.profile_picture_url=="string"&&x.profile_picture_url.startsWith("blob:"))try{const _=await Kn(x.profile_picture_url);x.profile_picture_url=`data: image / png; base64, ${_} `}catch(_){console.error(" profile_picture_url :",_)}return x};await d.write(`{
    
  "version": "2.5.7", 
  "projectName": ${JSON.stringify(pr||"")}, 
  "nodes": [
`);for(let v=0;v<a.length;v++){const x=a[v],_=await u(x),S=JSON.stringify(_,f,2),j=v===0?S.split(`
`).join(`
    `):"    "+S.split(`
`).join(`
    `);await d.write(j),v<a.length-1?await d.write(`,
`):await d.write(`
`)}await d.write(`  ], 
  "connections": ${JSON.stringify(p,f,2)}, 
  "view": ${JSON.stringify($t,f,2)}, 
  "history": [
`);for(let v=0;v<Pt.length;v++){const x=Pt[v],_=await h(x),S=JSON.stringify(_,f,2),j=v===0?S.split(`
`).join(`
    `):"    "+S.split(`
`).join(`
    `);await d.write(j),v<Pt.length-1?await d.write(`,
`):await d.write(`
`)}await d.write(`  ], 
  "chatSessions": ${JSON.stringify(an,f,2)}, 
  "characterLibrary": [
`);for(let v=0;v<Wn.length;v++){const x=Wn[v],_=await g(x),S=JSON.stringify(_,f,2),j=v===0?S.split(`
`).join(`
    `):"    "+S.split(`
`).join(`
    `);await d.write(j),v<Wn.length-1?await d.write(`,
`):await d.write(`
`)}await d.write(`  ], 
  "timestamp": ${JSON.stringify(au())} 

} `),await d.close(),alert("")}catch(n){if(console.error(":",n),n.name==="AbortError")return;alert(": "+(n.message||""))}},O1=async()=>{try{np({visible:!1,x:0,y:0});const n=Mn.size>0?Mn:k?new Set([k]):new Set;if(n.size===0){alert("");return}const l=a.filter(x=>n.has(x.id)),d=p.filter(x=>n.has(x.from)&&n.has(x.to));if(!window.showSaveFilePicker){if(!confirm(`

`))return;const _=(Y,de)=>de===void 0?null:de,S=JSON.parse(JSON.stringify(l,_)),j=async Y=>{if(Y==null)return Y;if(typeof Y=="string"&&Y.startsWith("blob:"))try{const de=await Os(Y);return await yp(de)}catch(de){return console.error(" Blob URL :",de),Y}if(Array.isArray(Y))return await Promise.all(Y.map(de=>j(de)));if(typeof Y=="object"){const de={};for(const Z in Y)Y.hasOwnProperty(Z)&&(de[Z]=await j(Y[Z]));return de}return Y},L={version:"3.7.36c",type:"workflow",nodes:await j(S),connections:d,timestamp:au()},M=JSON.stringify(L,_,2),U=new Blob([M],{type:"application/json"}),V=URL.createObjectURL(U),F=document.createElement("a");F.href=V;const J=lu();F.download=`_${J}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(V),alert("");return}const f=lu(),h=await(await window.showSaveFilePicker({suggestedName:`_${f}.json`,types:[{description:"JSON File",accept:{"application/json":[".json"]}}]})).createWritable(),g=(x,_)=>_===void 0?null:_,v=async x=>{const _={...x};if(_.content&&typeof _.content=="string"&&_.content.startsWith("blob:"))try{const S=await Kn(_.content),j=Hn(_.content)?"video/mp4":"image/png";_.content=`data:${j};base64,${S}`}catch(S){console.error(" content :",S)}if(_.maskContent&&typeof _.maskContent=="string"&&_.maskContent.startsWith("blob:"))try{const S=await Kn(_.maskContent);_.maskContent=`data:image/png;base64,${S}`}catch(S){console.error(" maskContent :",S)}if(Array.isArray(_.selectedKeyframes))for(let S=0;S<_.selectedKeyframes.length;S++){const j=_.selectedKeyframes[S];if(j&&j.url&&typeof j.url=="string"&&j.url.startsWith("blob:"))try{const C=await Kn(j.url);j.url=`data:image/png;base64,${C}`}catch(C){console.error(":",C)}}if(Array.isArray(_.frames))for(let S=0;S<_.frames.length;S++){const j=_.frames[S];if(j&&j.url&&typeof j.url=="string"&&j.url.startsWith("blob:"))try{const C=await Kn(j.url);j.url=`data:image/png;base64,${C}`}catch(C){console.error(":",C)}}if(Array.isArray(_.previewMjImages))for(let S=0;S<_.previewMjImages.length;S++){const j=_.previewMjImages[S];if(j&&typeof j=="string"&&j.startsWith("blob:"))try{const C=await Kn(j);_.previewMjImages[S]=`data:image/png;base64,${C}`}catch(C){console.error(":",C)}}return _};await h.write(`{
  "version": "3.7.36c",
  "type": "workflow",
  "nodes": [
`);for(let x=0;x<l.length;x++){const _=await v(l[x]),j=JSON.stringify(_,g,4).split(`
`).map(C=>"    "+C).join(`
`);await h.write(j),x<l.length-1?await h.write(`,
`):await h.write(`
`)}await h.write(`  ],
  "connections": ${JSON.stringify(d,g,2)},
  "timestamp": ${JSON.stringify(au())}
}`),await h.close(),alert("")}catch(n){if(console.error(":",n),n.name==="AbortError")return;alert(": "+(n.message||""))}},L1=async()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async l=>{const d=l.target.files[0];if(d)try{const f=await d.text(),u=JSON.parse(f);if(u.type!=="workflow"){alert(`

""`);return}if(!u.nodes||u.nodes.length===0){alert("");return}let h=[];const g=(In||"http://127.0.0.1:9527").replace(/\/+$/,"");try{if(g){const F=await fetch(`${g}/list-files`);if(F.ok){const J=await F.json();J.success&&J.files&&(h=J.files,console.log(`[]  ${h.length} `))}}}catch{console.log("[] ")}const v=F=>{if(!h.length||!F)return null;try{const J=F.split(",")[1];if(!J)return null;const Y=Math.floor(J.length*.75),de=Y*.05,Z=h.find(xe=>Math.abs(xe.size-Y)<de);if(Z)return`${g}/file/${encodeURIComponent(Z.rel_path)}`}catch{}return null},x=async F=>{const J=[F];for(;J.length>0;){const Y=J.pop();if(!(!Y||typeof Y!="object"))for(const de in Y){const Z=Y[de];if(typeof Z=="string"&&(Z.startsWith("data:image/")||Z.startsWith("data:video/")))try{const xe=v(Z);if(xe&&(await fetch(xe,{method:"HEAD"})).ok){Y[de]=xe;continue}const ne=await(await fetch(Z)).blob();Y[de]=URL.createObjectURL(ne)}catch{}else typeof Z=="object"&&Z!==null&&J.push(Z)}}return F},_=new Map;u.nodes.forEach(F=>{_.set(F.id,`node-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)});const S=Zs.current;let j=100,C=100;if(S){const F=S.getBoundingClientRect(),J=F.width/2,Y=F.height/2,de=xn(J+F.left,Y+F.top);j=de.x,C=de.y}let L=1/0,M=1/0;u.nodes.forEach(F=>{F.x<L&&(L=F.x),F.y<M&&(M=F.y)});const U=[];for(const F of u.nodes){const J=await x({...F});J.id=_.get(F.id),J.x=F.x-L+j,J.y=F.y-M+C,U.push(J)}const V=(u.connections||[]).map(F=>({...F,from:_.get(F.from),to:_.get(F.to)})).filter(F=>F.from&&F.to);c(F=>[...F,...U]),m(F=>[...F,...V]),Or(new Set(U.map(F=>F.id))),alert(`

 ${U.length}  ${V.length} `)}catch(f){console.error(":",f),alert(": "+(f.message||"JSON"))}},n.click()},U1=()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async l=>{const d=l.target.files[0];if(!d)return;bo({visible:!0,progress:0,status:"INITIALIZING...",type:"import"});let f=[];const u=(In||"http://127.0.0.1:9527").replace(/\/+$/,"");try{if(u){const U=await fetch(`${u}/list-files`);if(U.ok){const V=await U.json();V.success&&V.files&&(f=V.files,console.log(`[]  ${f.length} `))}}}catch{console.log("[] ")}const h=U=>{if(!f.length||!U)return null;try{const V=U.split(",")[1];if(!V)return null;const F=Math.floor(V.length*.75),J=F*.05,Y=f.find(de=>Math.abs(de.size-F)<J);if(Y)return`${u}/file/${encodeURIComponent(Y.rel_path)}`}catch{}return null},g={nodes:[],history:[],connections:[],chatSessions:[],characterLibrary:[],projectName:"",view:null};let v=null,x="",_="",S=0,j=!1,C=0;const L=d.size,M=async U=>{const V=[U];for(;V.length>0;){const F=V.pop();if(!(!F||typeof F!="object"))for(const J in F){const Y=F[J];if(typeof Y=="string"&&(Y.startsWith("data:image/")||Y.startsWith("data:video/")))try{const de=h(Y);if(de&&(await fetch(de,{method:"HEAD"})).ok){F[J]=de;continue}const xe=await(await fetch(Y)).blob();F[J]=URL.createObjectURL(xe)}catch{}else typeof Y=="object"&&Y!==null&&V.push(Y)}}return U};try{const V=d.stream().pipeThrough(new TextDecoderStream).getReader();for(;;){const{value:F,done:J}=await V.read();if(J)break;if(C+=F.length,Math.random()>.95){const Y=Math.min(99,C/L*100);bo(de=>({...de,progress:Y,status:`PROCESSING ${(C/1024/1024).toFixed(0)} MB`}))}for(x+=F;;){const Y=x.indexOf(`
`);if(Y===-1)break;const de=x.substring(0,Y);x=x.substring(Y+1);const Z=de.trim();if(Z){if(Z.includes('"nodes": [')){v="nodes";continue}if(Z.includes('"history": [')){v="history";continue}if(Z.includes('"connections": [')){v="connections";continue}if(Z.includes('"chatSessions": [')){v="chatSessions";continue}if(Z.includes('"characterLibrary": [')){v="characterLibrary";continue}if((Z==="],"||Z==="]")&&S===0){v=null,_="",j=!1;continue}if(!v){if(Z.startsWith('"projectName":'))try{const xe=Z.match(/"projectName":\s*(.+)/);xe&&(g.projectName=JSON.parse(xe[1].replace(/,$/,"")))}catch{}if(Z.startsWith('"view":'))try{const xe=Z.match(/"view":\s*(.+)/);xe&&xe[1].endsWith("}")&&(g.view=JSON.parse(xe[1].replace(/,$/,"")))}catch{}continue}if(v){for(let xe of de)xe==="{"&&(S++,j=!0),xe==="}"&&S--;if(_+=de+`
`,j&&S===0){let xe=_.trim();xe.endsWith(",")&&(xe=xe.slice(0,-1));try{const le=JSON.parse(xe);(v==="nodes"||v==="history"||v==="characterLibrary")&&await M(le),v==="nodes"&&le.id?(le.settings||(le.settings={}),g.nodes.push(le)):v==="history"?g.history.push(le):v==="connections"?g.connections.push(le):v==="chatSessions"?g.chatSessions.push(le):v==="characterLibrary"&&g.characterLibrary.push(le)}catch{}_="",j=!1}}}}}bo(F=>({...F,progress:100,status:"FINALIZING..."})),setTimeout(()=>{xo(g.projectName||""),g.view&&dr(g.view),g.connections.length>0&&m(g.connections),g.chatSessions.length>0&&Fn(g.chatSessions),g.characterLibrary.length>0&&sa(g.characterLibrary),g.nodes.length>0&&c(g.nodes),g.history.length>0&&St(g.history),bo(F=>({...F,visible:!1})),alert(`
${g.nodes.length} `)},200)}catch(U){console.error(":",U),bo(V=>({...V,visible:!1})),alert(`: ${U.message} `)}},n.click()},Lr=(n,l,d,f,u=void 0,h=void 0,g=void 0,v=void 0)=>{Re();const x=n==="gen-video"?{w:380,h:420}:n==="gen-image"?{w:440,h:340}:n==="video-input"?{w:580,h:460}:n==="video-analyze"?{w:480,h:500}:n==="storyboard-node"?{w:720,h:500}:n==="image-compare"?{w:400,h:300}:n==="preview"?{w:320,h:260}:n==="text-node"?{w:280,h:200}:n==="novel-input"?{w:400,h:500}:n==="extract-characters-scenes"?{w:400,h:500}:n==="character-description"||n==="scene-description"?{w:400,h:400}:n==="create-character"||n==="create-scene"?{w:350,h:300}:n==="generate-character-video"||n==="generate-scene-video"?{w:400,h:450}:n==="generate-character-image"||n==="generate-scene-image"?{w:400,h:450}:n==="local-save"?{w:320,h:380}:{w:260,h:260},_={id:`node - ${Date.now()} `,type:n,x:l-x.w/2,y:d-x.h/2,width:x.w,height:x.h,content:u,...h?{dimensions:h}:{},settings:n==="gen-image"?{model:Ui,ratio:hi,resolution:ko,prompt:""}:n==="gen-video"?{model:wo,duration:"5s",ratio:hi,resolution:da,videoPrompt:""}:n==="video-analyze"?{model:h1,segmentDuration:parseInt(p1),analysisMode:"manual",voiceoverResults:[],analysisResults:[]}:n==="storyboard-node"?{projectTitle:"",shots:[]}:n==="text-node"?{text:u||""}:n==="novel-input"?{content:""}:n==="extract-characters-scenes"?{model:Fi||"",analysisResults:null,lastAnalyzed:null,isAnalyzing:!1,progress:0,errorMsg:null}:n==="character-description"||n==="scene-description"?{characterId:"",characterName:"",role:"",age:"",gender:"",sceneId:"",sceneName:"",description:"",prompt:"",mode:"video",style:"none",imageModel:Ui,imageRatio:hi||"16:9",imageResolution:ko,referenceImages:[],chatModel:Fi||"",isEnhancing:!1}:n==="create-character"||n==="create-scene"?{name:"",startSecond:1,endSecond:3,isCreating:!1,createProgress:0,createError:null}:n==="generate-character-video"||n==="generate-scene-video"?{model:wo,duration:"15s",ratio:hi||"16:9",resolution:da,videoPrompt:"",referenceImages:[],sourceType:"",sourceId:"",isGenerating:!1,progress:0,error:null}:n==="generate-character-image"||n==="generate-scene-image"?{model:Ui,ratio:hi||"16:9",resolution:ko,prompt:"",referenceImages:[],chatModel:Fi||"",imageUrls:[],selectedImageIndex:null,isGenerating:!1,progress:0,error:null}:n==="local-save"?{serverUrl:In,savePath:"",subfolder:"",autoSave:!1,serverStatus:fn?"connected":"disconnected",lastSaved:null,savedFiles:[],lastSavedUrls:[]}:{}};return c(S=>[...S,_]),f&&m(S=>[...S,{id:`conn - ${Date.now()} `,from:f,to:_.id}]),g&&m(S=>v&&v!=="default"?[...S.filter(C=>!(C.to===g&&(C.inputType||"default")===v)),{id:`conn - ${Date.now()} `,from:_.id,to:g,inputType:v!=="default"?v:void 0}]:[...S,{id:`conn - ${Date.now()} `,from:_.id,to:g}]),na(S=>({...S,visible:!1})),Di(!1),ea(null),bs(null),vs(null),_},F1=n=>{if(!n)return"";if(typeof n=="number")return`${n}`;const l=String(n).trim();return l?l.includes("")||l.includes("")?l:`${l}`:""},B1=[{value:"none",label:""},{value:"2d-anime",label:"2D"},{value:"3d-anime",label:"3D"},{value:"realistic",label:""},{value:"selfie",label:""},{value:"news",label:""},{value:"manga",label:""}],W1=R.useCallback(n=>{switch(n){case"2d-anime":return"2D";case"3d-anime":return"3D";case"realistic":return"";case"selfie":return"";case"news":return"";case"manga":return"";default:return""}},[]),sm=n=>{if(!n)return"";let l=n.replace(/360/g,"");return["",""].forEach(f=>{const u=l.indexOf(f);u!==-1&&(l=l.slice(0,u))}),l},im=n=>n&&(n.includes("360")?n:`${n}360`),_o=R.useCallback((n,l="video")=>{const d=(n==null?void 0:n.name)||(n==null?void 0:n.characterName)||"",f=((n==null?void 0:n.role)||(n==null?void 0:n.identity)||(n==null?void 0:n.profession)||"").trim(),u=((n==null?void 0:n.description)||(n==null?void 0:n.appearance)||"").trim(),h=F1(n==null?void 0:n.age),g=n!=null&&n.gender?String(n.gender).trim():"",v=`${h}${g}`.trim()||"",x=[f,u].filter(Boolean).join(""),_=x?`${x}`:"",S=f||u?`${f||u}`:"",j=`${d}${v}${_}`,C=`${j}${d}${S}`;return l==="video"?`${C}360`:j},[]),yl=R.useCallback(n=>{const l=(n==null?void 0:n.location)||(n==null?void 0:n.name)||(n==null?void 0:n.sceneName)||"",d=(n==null?void 0:n.description)||"";return l?`${l}${d}`:d},[]),om=async(n,l)=>{var U,V,F,J,Y,de;const d=Dt.get(n);if(!d||d.type!=="character-description"&&d.type!=="scene-description")return;const f=((U=d.settings)==null?void 0:U.chatModel)||Fi||"";if(!f){o("","warning",3e3),nn({nodeId:n,type:"desc-model"});return}const u=as(f);if(!u.key){o(" API Key","error",4e3),ss(!0);return}const h=(((V=d.settings)==null?void 0:V.prompt)||"").trim();if(!h){o("","warning",3e3);return}const g=mn.get(f),v=(u.url||zr).replace(/\/+$/,""),x=(g==null?void 0:g.modelName)||f,_=d.type==="character-description",S='"[]"',j="";let C="",L=h,M=.7;_&&l==="filter"?(C=S,M=.3):!_&&l==="enhance"?(C=j,M=.3):C=l==="enhance"?"JSON":"//JSON",Le(n,{isEnhancing:!0});try{const Z=await fetch(`${v}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${u.key}`,"Content-Type":"application/json"},body:JSON.stringify({model:x,messages:[{role:"system",content:C},{role:"user",content:L}],temperature:M})});if(!Z.ok){let te="";try{const $e=await Z.json();te=((F=$e==null?void 0:$e.error)==null?void 0:F.message)||($e==null?void 0:$e.message)||""}catch{}throw new Error(`API Error: ${Z.status}${te?` - ${te}`:""}`)}const xe=await Z.json(),ne=(((de=(Y=(J=xe.choices)==null?void 0:J[0])==null?void 0:Y.message)==null?void 0:de.content)||xe.content||"").replace(/```[\s\S]*?```/g,"").trim();ne?(Le(n,{prompt:ne}),o(l==="enhance"?"":"","success",2e3)):o("","warning",3e3)}catch(Z){console.error("[]",Z),o(`: ${Z.message||""}`,"error",4e3)}finally{Le(n,{isEnhancing:!1})}},H1=R.useCallback((n,l)=>{var F,J,Y,de;const d=Dt.get(n);if(!d)return;const f=Array.isArray(l==null?void 0:l.characters)?l.characters:[],u=Array.isArray(l==null?void 0:l.scenes)?l.scenes:[];if(f.length===0&&u.length===0)return;Re();const h=d.x+d.width+100,g=d.y,v=450,x=Date.now(),_=wo||((F=ue.find(Z=>Z.type==="Video"&&(Z.id==="sora-2"||Z.id==="sora-2-pro")))==null?void 0:F.id)||((J=ue.find(Z=>Z.type==="Video"))==null?void 0:J.id)||"",S=Ui||((Y=ue.find(Z=>Z.type==="Image"))==null?void 0:Y.id)||"",j=Fi||((de=ue.find(Z=>Z.type==="Chat"))==null?void 0:de.id)||"",C=hi||"16:9",L=da||"720p",M=ko||"2K",U=[],V=[];if(f.length>0&&f.forEach((Z,xe)=>{const le=`node - char-desc - ${x} - ${xe}`,ne=`node - char-video - ${x} - ${xe}`,te=`node - char-create - ${x} - ${xe}`,$e=_o(Z,"video");U.push({id:le,type:"character-description",x:h,y:g+xe*v,width:400,height:400,settings:{characterId:(Z==null?void 0:Z.id)||"",characterName:(Z==null?void 0:Z.name)||"",role:(Z==null?void 0:Z.role)||"",age:(Z==null?void 0:Z.age)||"",gender:(Z==null?void 0:Z.gender)||"",description:(Z==null?void 0:Z.description)||"",prompt:$e,mode:"video",imageModel:S,imageRatio:C,imageResolution:M,referenceImages:[],chatModel:j}}),U.push({id:ne,type:"generate-character-video",x:h+420,y:g+xe*v,width:400,height:450,settings:{model:_,duration:"15s",ratio:C,resolution:L,videoPrompt:$e,referenceImages:[],sourceType:"character-description",sourceId:le}}),U.push({id:te,type:"create-character",x:h+840,y:g+xe*v,width:350,height:300,settings:{name:(Z==null?void 0:Z.name)||"",startSecond:1,endSecond:3}}),V.push({id:`conn - char-desc - ${x} - ${xe}`,from:n,to:le},{id:`conn - char-video - ${x} - ${xe}`,from:le,to:ne},{id:`conn - char-create - ${x} - ${xe}`,from:ne,to:te})}),u.length>0){const Z=f.length;u.forEach((xe,le)=>{const ne=Z+le,te=`node - scene-desc - ${x} - ${le}`,$e=`node - scene-video - ${x} - ${le}`,rt=`node - scene-create - ${x} - ${le}`,Oe=yl(xe),He=(xe==null?void 0:xe.location)||(xe==null?void 0:xe.name)||(xe==null?void 0:xe.sceneName)||"";U.push({id:te,type:"scene-description",x:h,y:g+ne*v,width:400,height:400,settings:{sceneId:(xe==null?void 0:xe.id)||"",sceneName:He,description:(xe==null?void 0:xe.description)||"",prompt:Oe,mode:"video",style:(xe==null?void 0:xe.style)||"",imageModel:S,imageRatio:C,imageResolution:M,referenceImages:[],chatModel:j}}),U.push({id:$e,type:"generate-scene-video",x:h+420,y:g+ne*v,width:400,height:450,settings:{model:_,duration:"15s",ratio:C,resolution:L,videoPrompt:Oe,referenceImages:[],sourceType:"scene-description",sourceId:te}}),U.push({id:rt,type:"create-scene",x:h+840,y:g+ne*v,width:350,height:300,settings:{name:He,startSecond:1,endSecond:3}}),V.push({id:`conn - scene-desc - ${x} - ${le}`,from:n,to:te},{id:`conn - scene-video - ${x} - ${le}`,from:te,to:$e},{id:`conn - scene-create - ${x} - ${le}`,from:$e,to:rt})})}U.length>0&&c(Z=>[...Z,...U]),V.length>0&&m(Z=>[...Z,...V])},[Dt,ue,wo,Ui,Fi,hi,da,ko,_o,yl]),V1=n=>{var F,J,Y,de,Z,xe,le,ne,te,$e,rt,Oe,He,gt,xt,Ct,bt,Jt;const l=Dt.get(n);if(!l)return;const d=l.type==="character-description",f=d?"generate-character-image":"generate-scene-image";if(p.find(Kt=>{var Zt;return Kt.from===n&&((Zt=Dt.get(Kt.to))==null?void 0:Zt.type)===f}))return;const h={name:((F=l.settings)==null?void 0:F.characterName)||((J=l.settings)==null?void 0:J.name)||"",role:((Y=l.settings)==null?void 0:Y.role)||"",description:((de=l.settings)==null?void 0:de.description)||"",age:((Z=l.settings)==null?void 0:Z.age)||"",gender:((xe=l.settings)==null?void 0:xe.gender)||""},g={name:((le=l.settings)==null?void 0:le.sceneName)||((ne=l.settings)==null?void 0:ne.location)||"",location:((te=l.settings)==null?void 0:te.sceneName)||(($e=l.settings)==null?void 0:$e.location)||"",description:((rt=l.settings)==null?void 0:rt.description)||""},v=d?_o(h,"image"):yl(g),x=l.x+l.width+200,_=l.y+l.height/2,S=Lr(f,x,_,n);if(!(S!=null&&S.id))return;const j=((Oe=l.settings)==null?void 0:Oe.imageModel)||Ui||((He=ue.find(Kt=>Kt.type==="Image"))==null?void 0:He.id)||"",C=((gt=l.settings)==null?void 0:gt.imageRatio)||hi||"16:9",L=((xt=l.settings)==null?void 0:xt.imageResolution)||ko||"2K",M=((Ct=l.settings)==null?void 0:Ct.chatModel)||Fi||"",U=((bt=l.settings)==null?void 0:bt.prompt)||v,V=d?sm(U):U;Le(S.id,{model:j,ratio:C,resolution:L,prompt:V,referenceImages:((Jt=l.settings)==null?void 0:Jt.referenceImages)||[],chatModel:M,sourceType:l.type,sourceId:l.id})},K1=n=>{var V,F,J,Y,de,Z,xe,le,ne,te,$e,rt,Oe,He,gt,xt;const l=Dt.get(n);if(!l)return;const d=l.type==="character-description",f=d?"generate-character-video":"generate-scene-video";if(p.find(Ct=>{var bt;return Ct.from===n&&((bt=Dt.get(Ct.to))==null?void 0:bt.type)===f}))return;const h={name:((V=l.settings)==null?void 0:V.characterName)||((F=l.settings)==null?void 0:F.name)||"",role:((J=l.settings)==null?void 0:J.role)||"",description:((Y=l.settings)==null?void 0:Y.description)||"",age:((de=l.settings)==null?void 0:de.age)||"",gender:((Z=l.settings)==null?void 0:Z.gender)||""},g={name:((xe=l.settings)==null?void 0:xe.sceneName)||((le=l.settings)==null?void 0:le.location)||"",location:((ne=l.settings)==null?void 0:ne.sceneName)||((te=l.settings)==null?void 0:te.location)||"",description:(($e=l.settings)==null?void 0:$e.description)||""},v=d?_o(h,"video"):yl(g),x=((rt=l.settings)==null?void 0:rt.prompt)||v,_=d?im(x):x,S=l.x+l.width+200,j=l.y+l.height/2,C=Lr(f,S,j,n);if(!(C!=null&&C.id))return;const L=wo||((Oe=ue.find(Ct=>Ct.type==="Video"&&(Ct.id==="sora-2"||Ct.id==="sora-2-pro")))==null?void 0:Oe.id)||((He=ue.find(Ct=>Ct.type==="Video"))==null?void 0:He.id)||"",M=((gt=l.settings)==null?void 0:gt.imageRatio)||hi||"16:9",U=da||"720p";Le(C.id,{model:L,duration:"15s",ratio:M,resolution:U,videoPrompt:_,referenceImages:((xt=l.settings)==null?void 0:xt.referenceImages)||[],sourceType:l.type,sourceId:l.id})},Y1=R.useCallback(n=>{const l=[];for(const d of p)if(d.from===n){const f=Dt.get(d.to);f&&(f.type==="gen-image"||f.type==="gen-video")&&l.push(f)}return l},[p,Dt]),So=n=>n?n==="sora-2-pro"||n.includes("sora-2")||n==="sora-2"?"15s":n.includes("veo")||n==="google-veo3"||n.includes("grok")||n==="grok-3"?"8s":"5s":"5s",cu=n=>n?n==="sora-2-pro"?["15s","25s"]:n.includes("sora-2")||n==="sora-2"?["5s","10s","15s"]:n.includes("veo")||n==="google-veo3"?["8s"]:n.includes("grok")||n==="grok-3"?["8s","5s"]:n.includes("jimeng")?["5s","10s"]:["5s","10s"]:["5s","10s"],G1=n=>{var v,x,_,S,j,C;const l=Dt.get(n);if(!l||l.type!=="storyboard-node")return;const d=((v=l.settings)==null?void 0:v.mode)||"video";let f,u,h;d==="image"?(f=localStorage.getItem("tapnow_last_image_model")||((x=ue.find(L=>L.type==="Image"))==null?void 0:x.id)||"",u="1:1",h=void 0):(f=wo||localStorage.getItem("tapnow_last_video_model")||((_=ue.find(L=>L.type==="Video"))==null?void 0:_.id)||"",u="16:9",h=So(f));const g={id:`shot-${Date.now()}`,scene_index:(((j=(S=l.settings)==null?void 0:S.shots)==null?void 0:j.length)||0)+1,time_range:"",image_url:"",description:"",prompt:"",camera:"",tags:[],status:"draft",model:f,ratio:u,duration:h,outputEnabled:!1,selectedImageIndex:-1};Le(n,{shots:[...((C=l.settings)==null?void 0:C.shots)||[],g]})},X1=(n,l)=>{var u;const d=Dt.get(n);if(!d||d.type!=="storyboard-node")return;const f=(((u=d.settings)==null?void 0:u.shots)||[]).filter(h=>h.id!==l);f.forEach((h,g)=>{h.scene_index=g+1}),Le(n,{shots:f})},Gt=(n,l,d,f={})=>{let u=!1,h=d.status;if(c(g=>{var L,M,U;const v=g.find(V=>V.id===n);if(!v||v.type!=="storyboard-node")return console.warn("[updateShot] :",{nodeId:n,found:!!v,type:v==null?void 0:v.type}),g;if(f.onlyIfStatus){const V=(((L=v.settings)==null?void 0:L.shots)||[]).find(F=>F.id===l);if(V&&V.status!==f.onlyIfStatus)return console.warn(`[updateShot] : ${l},  ${V.status} !==  ${f.onlyIfStatus}`),g}const x=(((M=v.settings)==null?void 0:M.shots)||[]).find(V=>V.id===l),_={...d},S=Object.prototype.hasOwnProperty.call(_,"durationCost"),j=new Set(["done","completed","failed","error"]);if(_.status==="generating"&&!S&&(_.durationCost=0),_.status&&j.has(_.status)&&!S&&x!=null&&x.generationStartTime){const V=(Date.now()-x.generationStartTime)/1e3;_.durationCost=Number(V.toFixed(1))}u=!0,h=_.status;const C=(((U=v.settings)==null?void 0:U.shots)||[]).map(V=>V.id===l?{...V,..._}:V);return g.map(V=>V.id===n?{...V,settings:{...V.settings,shots:C}}:V)}),u&&h){const g=`${n}-${l}`;qd(h==="generating"?v=>({...v,[g]:"0.0s"}):v=>{if(!v[g])return v;const x={...v};return delete x[g],x})}if(d.video_url||d.output_url||d.output_images||d.image_url||d.lastFrame){const g=d.video_url||d.output_url||d.output_images&&d.output_images[0]||d.image_url||d.lastFrame,v=d.video_url?"video":"image",x=d.image_filename||"";setTimeout(()=>{ei(`temp-${Date.now()}`,g,v,n,null,x)},50)}},J1=(n,l)=>{const d=Dt.get(n);if(!d||!l||l.length===0){console.warn("[] ");return}const f=l.map((x,_)=>{var V,F,J,Y,de,Z,xe,le,ne,te;const S=((V=x.keyframes)==null?void 0:V.find($e=>$e.type==="current"))||((F=x.keyframes)==null?void 0:F[0]),j=(S==null?void 0:S.mj_prompt)||"",C=(S==null?void 0:S.jimeng_prompt)||"",L=(S==null?void 0:S.description)||((Y=(J=x.keyframes)==null?void 0:J[0])==null?void 0:Y.description)||"",M=[];(Z=(de=x.global_tags)==null?void 0:de.style)!=null&&Z[0]&&M.push(x.global_tags.style[0]),(le=(xe=x.global_tags)==null?void 0:xe.camera)!=null&&le[0]&&M.push(x.global_tags.camera[0]),S!=null&&S.description&&["","","","","","","","Dolly","Pan","Tilt","Zoom"].forEach(rt=>{L.includes(rt)&&M.push(rt)});const U=((te=(ne=x.global_tags)==null?void 0:ne.camera)==null?void 0:te[0])||M.find($e=>["","","","","","Dolly","Pan","Tilt","Zoom"].some(rt=>$e.includes(rt)))||"";return{id:`shot - ${Date.now()} -${_} `,scene_index:_+1,time_range:x.time_range||"",image_url:"",description:L,prompt:j||C,camera:U,tags:M,status:"draft"}}),u=d.x+d.width+100,h=d.y,g=`node - storyboard - ${Date.now()} `,v={id:g,type:"storyboard-node",x:u,y:h,width:600,height:500,settings:{projectTitle:"AI ",shots:f}};c(x=>[...x,v]),m(x=>[...x,{id:`conn - ${Date.now()} `,from:n,to:g}])},Dn=R.useRef(new Map);R.useRef(null);const am=async(n,l,d,f=null,u=null)=>{var h;try{const g=ue.find(M=>M.type==="Video"&&(M.id==="sora-2"||M.id==="sora-2-pro"));if(!g){alert(" Sora 2  Sora 2  Sora 2 Pro"),ca(!1);return}const x=as(g.id).key;if(!x){alert(" API Key"),ca(!1);return}if(d-l<1||d-l>3){alert(" 1-3 "),ca(!1);return}const _=`${l},${d} `;let S;u&&u.trim()?S=u.trim():S=`${(g.url||zr).replace(/\/+$/,"")} /sora/v1 / characters`;const j=f?{from_task:f,timestamps:_}:{url:n,timestamps:_};console.log("[Create Character] Request Details:",{endpoint:S,apiKey:x?`${x.substring(0,8)}...${x.substring(x.length-4)} `:"EMPTY",payload:j,fromTaskId:f,videoUrl:f?"N/A (using from_task)":n,customEndpoint:u||"N/A (using default)"});const C=await fetch(S,{method:"POST",headers:{Authorization:`Bearer ${x} `,"Content-Type":"application/json"},body:JSON.stringify(j)});if(!C.ok){const M=await C.text();console.error("[Create Character] API Error:",{status:C.status,statusText:C.statusText,errorText:M,endpoint:S});let U=null;try{U=JSON.parse(M)}catch{}throw C.status===500||U&&(U.code==="get_origin_task_failed"||(h=U.message)!=null&&h.includes("get_origin_task_failed"))?new Error("TASK_NOT_FOUND"):new Error(`API(${C.status}): ${M||C.statusText} `)}const L=await C.json();if(L.id&&L.username){const M={id:L.id,username:L.username,profile_picture_url:L.profile_picture_url||"",permalink:L.permalink||""},U=[...Wn,M];sa(U),alert(` "${L.username}" `),rl(!1),Uc("url"),Fc(""),Bc(""),_h(1),Sh(3),il("")}else throw new Error(" id  username")}catch(g){console.error("[Create Character] Failed:",g);let v=g.message;if(v==="TASK_NOT_FOUND"){alert(`

" URL"`);return}(v.includes("Failed to fetch")||g.name==="TypeError"||g.message.includes("NetworkError"))&&(v=`

1. API 
   -  API  "/sora" 
   -  Sora 

2.  (CORS)
   -  Allow CORS 

3. 
   - `),alert(`: ${v} `)}finally{ca(!1)}},lm=(n,l)=>{var j,C;let d=l.prompt||"";if(!d&&l.description&&(d=l.description),l.tags&&l.tags.length>0){const L=l.tags.join(", ");d+=`, ${L} `}if(l.camera&&(d+=`, ${l.camera} camera movement`),!d){alert("");return}const f=l.model||((j=ue.find(L=>L.type==="Video"&&L.id==="sora-2"))==null?void 0:j.id)||((C=ue.find(L=>L.type==="Video"))==null?void 0:C.id)||"",u=mn.get(f);if(!u||u.type!=="Video"){alert("");return}const h=[];l.image_url&&h.push(l.image_url),l.lastFrame&&h.push(l.lastFrame),Gt(n,l.id,{status:"generating",generationStartTime:Date.now()});let g=l.duration||So(f);const v=cu(f);v.includes(g)||(console.warn(`[V3.5.5] Duration "${g}" not valid for model "${f}", using "${v[0]}"`),g=v[0]);const x=String(g).endsWith("s")?g:`${g}s`,_={model:f,ratio:l.ratio||"16:9",duration:x,resolution:Lu(l.resolution||"720p")},S=`storyboard-${n}-shot-${l.id}`;No(d,"video",h,S,_)},cm=(n,l)=>{var _;let d=l.prompt||"";if(!d&&l.description&&(d=l.description),l.tags&&l.tags.length>0){const S=l.tags.join(", ");d+=`, ${S} `}if(!d){alert("");return}const f=l.model||localStorage.getItem("tapnow_last_image_model")||((_=ue.find(S=>S.type==="Image"))==null?void 0:_.id)||"",u=mn.get(f);if(!u||u.type!=="Image"){alert("");return}if(!as(f).key){alert(` "${f}"  API Key `),Gt(n,l.id,{status:"failed",errorMsg:"API Key "}),ss(!0);return}const g=[];l.image_url&&g.push(l.image_url),l.referenceImages&&l.referenceImages.length>0&&g.push(...l.referenceImages),Gt(n,l.id,{status:"generating",generationStartTime:Date.now()});const v={model:f,ratio:l.ratio||"1:1",resolution:Ul(l.resolution||"2K")},x=`storyboard-img-${n}-shot-${l.id}`;No(d,"image",g,x,v)},um=async(n,l={})=>{var C,L,M,U,V,F,J,Y;const d=Dt.get(n),f=l.inputText||"",u=l.modelId||"";let h=f||((C=d==null?void 0:d.settings)==null?void 0:C.content)||"";if(!h){const de=p.find(Z=>Z.to===n);if(de){const Z=Dt.get(de.from);Z&&(Z.type==="novel-input"||Z.type==="text-node")&&(h=((L=Z.settings)==null?void 0:L.content)||Z.content||"")}}if(!h||h.trim().length===0){o("","error");return}const g=u||((M=d==null?void 0:d.settings)==null?void 0:M.model)||"";if(!g){o("","error");return}const v=mn.get(g);if(!v){o("","error");return}const x=as(g),_=x.key;if(!_){o(" API Key","error"),ss(!0);return}((U=d==null?void 0:d.settings)==null?void 0:U.model)!==g&&Le(n,{model:g}),fp(g);try{localStorage.setItem("tapnow_last_extract_model",g)}catch{}Le(n,{isAnalyzing:!0,progress:5,errorMsg:null,analysisResults:null});let S=setInterval(()=>{c(de=>de.map(Z=>{var ne;if(Z.id!==n)return Z;const xe=((ne=Z.settings)==null?void 0:ne.progress)||0,le=Math.min(xe+7,92);return{...Z,settings:{...Z.settings,progress:le}}}))},500);const j=`


${h.substring(0,15e3)} ... ()

 JSON 
{
    "characters": [
        { "name": "", "role": "//", "age": "", "gender": "", "description": "", "appearance": "" }
    ],
    "scenes": [
        { "location": "", "description": "", "mood": "", "style": "" }
    ]
}
 JSON markdown `;try{const de=(x.url||zr).replace(/\/+$/,""),Z=await fetch(`${de}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${_}`,"Content-Type":"application/json"},body:JSON.stringify({model:v.modelName||v.id||"gemini-1.5-pro-latest",messages:[{role:"system",content:"You are a helpful assistant that analyzes novels."},{role:"user",content:j}],temperature:.7})});if(!Z.ok){let rt="";try{const Oe=await Z.json();rt=((V=Oe==null?void 0:Oe.error)==null?void 0:V.message)||(Oe==null?void 0:Oe.message)||""}catch{}throw Z.status===401&&(o("API Key 401","error",5e3),ss(!0)),new Error(`API Error: ${Z.status}${rt?` - ${rt}`:""}`)}const xe=await Z.json(),le=((Y=(J=(F=xe.choices)==null?void 0:F[0])==null?void 0:J.message)==null?void 0:Y.content)||xe.content||"";let ne=null;try{const rt=le.replace(/```json/g,"").replace(/```/g,"").trim();ne=JSON.parse(rt)}catch(rt){console.warn("JSON Parse Error",rt)}const te=Array.isArray(ne==null?void 0:ne.characters)?ne.characters:[],$e=Array.isArray(ne==null?void 0:ne.scenes)?ne.scenes:[];ne&&(te.length>0||$e.length>0)?(Le(n,{analysisResults:{characters:te,scenes:$e},lastAnalyzed:Date.now(),errorMsg:null}),setTimeout(()=>{H1(n,{characters:te,scenes:$e})},200)):(Le(n,{analysisResults:null,lastAnalyzed:Date.now(),errorMsg:""}),o("/","warning"))}catch(de){console.error("Extraction Failed",de);let Z=(de==null?void 0:de.message)||"";((de==null?void 0:de.name)==="TypeError"||/Failed to fetch|NetworkError/i.test(Z))&&(Z="CORS API http/https CORS "),Le(n,{errorMsg:Z}),o(`: ${Z}`,"error",5e3)}finally{S&&clearInterval(S),c(de=>de.map(Z=>Z.id===n?{...Z,settings:{...Z.settings,isAnalyzing:!1,progress:100}}:Z)),setTimeout(()=>Le(n,{progress:0}),800)}},Z1=n=>{var x,_,S,j;const l=Dt.get(n);if(!l)return;const d=((x=l.settings)==null?void 0:x.content)||"";if(!d||d.trim().length===0){o("","error");return}const f=p.find(C=>{var L;return C.from===n&&((L=Dt.get(C.to))==null?void 0:L.type)==="extract-characters-scenes"});let u=f==null?void 0:f.to,h=u?Dt.get(u):null;if(!u){const L=l.x+l.width+50+200,M=l.y+l.height/2,U=Lr("extract-characters-scenes",L,M,n);u=U==null?void 0:U.id,h=U||null}if(!u)return;const g=((_=h==null?void 0:h.settings)==null?void 0:_.model)||((j=(S=Dt.get(u))==null?void 0:S.settings)==null?void 0:j.model)||Fi||"";if(!g){o("","warning",4e3),nn({nodeId:u,type:"extract-model"});return}if(!as(g).key){o(" API Key","error"),ss(!0);return}Le(u,{model:g}),requestAnimationFrame(()=>{um(u,{inputText:d,modelId:g})})},dm=(n,l)=>{var f;const d=(f=l.target.files)==null?void 0:f[0];if(d){const u=new FileReader;u.onload=async h=>{const g=h.target.result;let v={w:0,h:0};try{v=await Br(g)}catch{}Re(),c(x=>x.map(_=>_.id===n?{..._,content:g,dimensions:v}:_))},u.readAsDataURL(d)}},q1=(n,l)=>{if(!n||n.length===0)return[];const d=[...n].sort((g,v)=>g.time-v.time),f=[];let u=[],h=d[0].time;return d.forEach((g,v)=>{g.time-h>=l&&u.length>0?(f.push([...u]),u=[g],h=g.time):u.push(g)}),u.length>0&&f.push(u),f},Q1=async n=>{var L,M,U,V,F,J,Y,de,Z,xe,le,ne,te,$e,rt;const l=Dt.get(n);if(!l||l.type!=="video-analyze")return;const d=xl(n);if(!d){alert("");return}const f=d.selectedKeyframes||[];if(f.length===0){alert("");return}const u=((L=l.settings)==null?void 0:L.model)||"gemini-3-pro",{key:h,url:g}=as(u),v=ue.find(Oe=>Oe.id===u);if(!h){alert(" API  Key"),ss(!0);return}const x=((M=l.settings)==null?void 0:M.segmentDuration)||3,_=q1(f,x);if(_.length===0){alert("");return}c(Oe=>Oe.map(He=>He.id===n?{...He,isGenerating:!0,analysisResults:[]}:He));const S=[],j=d.videoFileName||"video.mp4";(U=d.videoMeta)!=null&&U.duration;const C=((V=l.settings)==null?void 0:V.analysisMode)||"manual";try{for(let Oe=0;Oe<_.length;Oe++){const He=_[Oe],gt=`${He[0].time.toFixed(1)}s-${He[He.length-1].time.toFixed(1)}s`,xt=`AI

 JSON 
{
  "video_id": "${j}",
  "scene_index": ${Oe+1},
  "time_range": "${gt}",
  "keyframes": [
    {
      "type": "prev",
      "time": 5.2,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    },
    {
      "type": "current",
      "time": 6.8,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    },
    {
      "type": "next",
      "time": 8.7,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    }
  ],
  "global_tags": {
    "style": ["", ""],
    "camera": ["", ""],
    "color": [""]
  }
}


1.  prev/current/next 
2. mj_prompt  Midjourney
3. jimeng_prompt AI
4. global_tags `,Ct=[{type:"text",text:` ${Oe+1}${gt}`}],bt=15,Jt=He.length>bt?He.slice(0,bt):He;Jt.forEach((vt,Vt)=>{Ct.push({type:"image_url",image_url:{url:vt.url}}),Vt<Jt.length-1&&Ct.push({type:"text",text:` ${Vt+1}${vt.time.toFixed(2)}s`})}),He.length>bt&&Ct.push({type:"text",text:` ${He.length} API ${bt} `});const Kt=[{role:"system",content:xt},{role:"user",content:Ct}],Zt=new AbortController,un=setTimeout(()=>Zt.abort(),6e4);let B;try{B=await fetch(`${g}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({model:(v==null?void 0:v.id)||"gemini-3-pro",messages:Kt,stream:!1}),signal:Zt.signal})}catch(vt){throw clearTimeout(un),vt.name==="AbortError"?new Error(""):vt.message&&vt.message.includes("Failed to fetch")?new Error(` API  (${g})
1. API 
2. 
3. API `):new Error(`: ${vt.message}`)}finally{clearTimeout(un)}if(!B.ok){let vt="";try{vt=await B.text()}catch{vt=`HTTP ${B.status}: ${B.statusText}`}throw new Error(vt||`API Error: ${B.status}`)}const pe=await B.json();console.log("[] API :",{hasData:!!pe,hasChoices:!!pe.choices,choicesLength:(F=pe.choices)==null?void 0:F.length,dataKeys:Object.keys(pe||{}),model:(v==null?void 0:v.modelName)||(v==null?void 0:v.id)});let Ue=null;if(pe.choices&&pe.choices.length>0?Ue=(Y=(J=pe.choices[0])==null?void 0:J.message)==null?void 0:Y.content:(de=pe.data)!=null&&de.choices&&pe.data.choices.length>0?Ue=(xe=(Z=pe.data.choices[0])==null?void 0:Z.message)==null?void 0:xe.content:pe.content?Ue=pe.content:(le=pe.data)!=null&&le.content?Ue=pe.data.content:pe.text?Ue=pe.text:(ne=pe.data)!=null&&ne.text?Ue=pe.data.text:pe.message?Ue=typeof pe.message=="string"?pe.message:pe.message.content:(te=pe.data)!=null&&te.message?Ue=typeof pe.data.message=="string"?pe.data.message:pe.data.message.content:pe.result?Ue=typeof pe.result=="string"?pe.result:pe.result.content:($e=pe.data)!=null&&$e.result&&(Ue=typeof pe.data.result=="string"?pe.data.result:pe.data.result.content),!Ue||Ue.trim()===""||Ue==="{}")throw console.error("[] API :",pe),new Error(`API : ${JSON.stringify(pe).substring(0,200)}`);let ot=Ue.trim();ot.startsWith("```")&&(ot=ot.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let kt;try{kt=JSON.parse(ot)}catch(vt){console.error("[]  JSON :",vt,"500:",ot.substring(0,500));try{ot=ot.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,""),ot=ot.replace(/,(\s*[}\]])/g,"$1"),kt=JSON.parse(ot)}catch(Vt){console.error("[] JSON:",Vt,":",ot),kt={video_id:j,scene_index:Oe+1,time_range:gt,keyframes:He.map((pt,ft)=>({type:ft===0?"prev":ft===1?"current":"next",time:pt.time,description:` ${pt.time.toFixed(1)}s`,mj_prompt:"A detailed scene from the video",jimeng_prompt:""})),global_tags:{style:[],camera:[],color:[]}},console.warn("[] :",ot.substring(0,200))}}if(S.push(kt),c(vt=>vt.map(Vt=>{if(Vt.id===n){const ft=[...Vt.analysisResults||[],kt];return{...Vt,analysisResults:ft}}return Vt})),!(C==="manual")){const Vt={id:`analyze-${n}-${Oe}-${Date.now()}`,type:"analyze",prompt:` -  ${Oe+1}`,url:((rt=He[0])==null?void 0:rt.url)||"",status:"completed",progress:100,modelName:(v==null?void 0:v.provider)||"Gemini 3 Pro",time:new Date().toLocaleString("zh-CN"),sourceNodeId:n,analysisResult:kt,videoFileName:j,sceneIndex:Oe+1,timeRange:gt};St(pt=>[Vt,...pt])}}c(Oe=>Oe.map(He=>{if(He.id===n){const gt=S.length>0?S:He.analysisResults||[];return{...He,isGenerating:!1,analysisResults:gt}}return He}))}catch(Oe){console.error(":",Oe);const He=Oe.message||"";c(gt=>gt.map(xt=>xt.id===n?{...xt,isGenerating:!1,errorMsg:He}:xt))}},ev=async n=>{var v,x,_,S,j,C,L,M,U,V;const l=Dt.get(n);if(!l||l.type!=="video-analyze")return;const d=xl(n);if(!d||!d.content){alert("");return}let f=d.content;if(f.startsWith("blob:"))try{const F=await fetch(f).then(J=>J.blob());f=await new Promise((J,Y)=>{const de=new FileReader;de.onerror=()=>Y(new Error("FileReader failed")),de.onloadend=()=>J(de.result),de.readAsDataURL(F)})}catch(F){console.error("Blob conversion failed",F),alert(" AI");return}let u=ue.find(F=>F.id==="gemini-3-pro"&&F.type==="Chat");u||(u=ue.find(F=>{var Y;return(((Y=F.id)==null?void 0:Y.toLowerCase())||"").includes("gemini")&&F.type==="Chat"})),u||(u=ue.find(F=>F.type==="Chat"));const{key:h,url:g}=as((u==null?void 0:u.id)||"gemini-3-pro");if(!h){alert(" API  Key"),ss(!0);return}c(F=>F.map(J=>J.id===n?{...J,isGenerating:!0,settings:{...J.settings,voiceoverResults:[],analysisResults:[]}}:J));try{const Y=[{role:"system",content:`******AI**

1. ****

2. ****Voiceover

 **JSON **Markdown

{
  "voiceover_script": [
    { "time_range": "0s-3s", "text": "..." }
  ],
  "scenes": [
    {
      "scene_id": 1,
      "time_range": "0s-2.5s",
      "visual_analysis": {
        "camera_movement": "(Dolly Zoom Out) (Orbit)",
        "subject_dynamics": "",
        "atmosphere": ""
      },
      "prompts": {
        "jimeng_prompt": "()+++()...",
        "mj_prompt": "Midjourney Prompt: English description, include camera directives like 'dynamic angle', 'fast zoom out', 'cinematic lighting'..."
      }
    }
  ]
}

****
- ****
- ****""
- ****`},{role:"user",content:[{type:"text",text:"JSON"},{type:"image_url",image_url:{url:f}}]}],de=new AbortController,Z=setTimeout(()=>de.abort(),12e4);let xe;try{xe=await fetch(`${g}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({model:(u==null?void 0:u.id)||"gemini-3-pro",messages:Y,stream:!1}),signal:de.signal})}catch(He){throw clearTimeout(Z),He.name==="AbortError"?new Error("120"):He.message&&He.message.includes("Failed to fetch")?new Error(` API  (${g})
1. API 
2. 
3. API 
4.  API Key`):new Error(`: ${He.message}`)}finally{clearTimeout(Z)}if(!xe.ok){let He="";try{He=await xe.text()}catch{He=`HTTP ${xe.status}: ${xe.statusText}`}throw new Error(He||`API Error: ${xe.status}`)}const le=await xe.json();console.log("[AI] API :",{hasData:!!le,hasChoices:!!le.choices,choicesLength:(v=le.choices)==null?void 0:v.length,dataKeys:Object.keys(le||{}),model:(u==null?void 0:u.modelName)||(u==null?void 0:u.id)});let ne=null;if(le.choices&&le.choices.length>0?ne=(_=(x=le.choices[0])==null?void 0:x.message)==null?void 0:_.content:(S=le.data)!=null&&S.choices&&le.data.choices.length>0?ne=(C=(j=le.data.choices[0])==null?void 0:j.message)==null?void 0:C.content:le.content?ne=le.content:(L=le.data)!=null&&L.content?ne=le.data.content:le.text?ne=le.text:(M=le.data)!=null&&M.text?ne=le.data.text:le.message?ne=typeof le.message=="string"?le.message:le.message.content:(U=le.data)!=null&&U.message?ne=typeof le.data.message=="string"?le.data.message:le.data.message.content:le.result?ne=typeof le.result=="string"?le.result:le.result.content:(V=le.data)!=null&&V.result&&(ne=typeof le.data.result=="string"?le.data.result:le.data.result.content),!ne||ne.trim()===""||ne==="{}")throw console.error("[AI] API :",le),new Error(`API : ${JSON.stringify(le).substring(0,200)}`);let te=ne.trim();te.startsWith("```")&&(te=te.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let $e;try{$e=JSON.parse(te)}catch(He){console.error("[AI]  JSON :",He,"500:",te.substring(0,500));try{te=te.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,""),te=te.replace(/,(\s*[}\]])/g,"$1"),$e=JSON.parse(te)}catch(gt){throw console.error("[AI] JSON:",gt,":",te.substring(0,500)),new Error(` JSON : ${te.substring(0,200)}`)}}const rt=($e.voiceover_script||[]).map((He,gt)=>({time:gt,text:He.text||""})),Oe=($e.scenes||[]).map((He,gt)=>{var xt,Ct,bt,Jt,Kt,Zt;return{scene_index:He.scene_id||gt+1,time_range:He.time_range||"",keyframes:[{type:"current",time:0,description:`${((xt=He.visual_analysis)==null?void 0:xt.camera_movement)||""} ${((Ct=He.visual_analysis)==null?void 0:Ct.subject_dynamics)||""}`.trim(),mj_prompt:((bt=He.prompts)==null?void 0:bt.mj_prompt)||"",jimeng_prompt:((Jt=He.prompts)==null?void 0:Jt.jimeng_prompt)||""}],global_tags:{style:(Kt=He.visual_analysis)!=null&&Kt.atmosphere?[He.visual_analysis.atmosphere]:[],camera:(Zt=He.visual_analysis)!=null&&Zt.camera_movement?[He.visual_analysis.camera_movement]:[],color:[]}}});c(He=>He.map(gt=>gt.id===n?{...gt,isGenerating:!1,settings:{...gt.settings,voiceoverResults:rt,analysisResults:Oe}}:gt)),Oe.length>0&&setTimeout(()=>{J1(n,Oe)},100)}catch(F){console.error("AI:",F);const J=F.message||"AI";c(Y=>Y.map(de=>de.id===n?{...de,isGenerating:!1,errorMsg:J}:de))}},tv=()=>{const n=Rc.name.trim(),l=Rc.prompt.trim();if(!n||!l){alert("");return}xh(d=>[{id:`custom-${Date.now()}`,name:n,prompt:l},...d]),Gd({name:"",prompt:""})},nv=n=>{xh(l=>l.filter(d=>d.id!==n))},rv=(n,l)=>{!n||!l||Le(n,{prompt:l})},sv=async n=>new Promise((l,d)=>{const f=new Image;f.crossOrigin="anonymous";const u=setTimeout(()=>{d(new Error(""))},3e4);f.onload=()=>{clearTimeout(u);try{const g=document.createElement("canvas").getContext("2d"),v=Math.floor(f.width/3),x=Math.floor(f.height/3),_=[],S=[];for(let j=0;j<3;j++)for(let C=0;C<3;C++){const L=Math.max(0,Math.min(C*v,f.width-v)),M=Math.max(0,Math.min(j*x,f.height-x)),U=Math.min(v,f.width-L),V=Math.min(x,f.height-M),F=document.createElement("canvas");F.width=U,F.height=V;const J=F.getContext("2d");J.fillStyle="#ffffff",J.fillRect(0,0,U,V),J.drawImage(f,L,M,U,V,0,0,U,V);try{const Y=F.toDataURL("image/png");S.push(Promise.resolve({url:Y,width:U,height:V}))}catch(Y){console.error("Canvas toDataURL :",Y)}}Promise.all(S).then(j=>{l(j)}).catch(j=>{d(j)})}catch(h){d(h)}},f.onerror=()=>{clearTimeout(u),d(new Error(""))},f.src=n}),vl=async(n,l={})=>{if(!n)return;const{originX:d,originY:f,cols:u=3,spacing:h=20,nodeWidth:g=260,nodeHeight:v=260,replaceSelected:x=!1}=l;try{const _=await sv(n);if(_.length!==9){alert("9");return}const S=qs.current;if(x&&S&&S.size===9){const U=Array.from(S);c(V=>V.map(F=>{const J=U.indexOf(F.id);return J!==-1&&J<_.length?{...F,content:_[J].url,dimensions:{w:_[J].width,h:_[J].height}}:F}));return}const j=xn(window.innerWidth/2,window.innerHeight/2),C=d!==void 0?d:j.x,L=f!==void 0?f:j.y,M=[];for(let U=0;U<_.length;U++){const V=Math.floor(U/u),F=U%u,J=C+F*(g+h),Y=L+V*(v+h);M.push({id:`node-${Date.now()}-${U}`,type:"input-image",x:J,y:Y,width:g,height:v,content:_[U].url,dimensions:{w:_[U].width,h:_[U].height}})}c(U=>[...U,...M])}catch(_){alert(": "+_.message)}},iv=()=>{const n=Wi.current,l=qs.current;let d=[];if(n){const V=Jr.current.find(F=>F.id===n);V&&(d=[V])}else l&&l.size>0&&(d=Jr.current.filter(V=>l.has(V.id)));if(d.length<2){alert("");return}const f=new Set(d.map(V=>V.id)),u={};d.forEach(V=>{u[V.id]={id:V.id,node:V,parents:[],children:[],level:0,rank:0}}),dl.current.forEach(V=>{f.has(V.from)&&f.has(V.to)&&(u[V.from].children.push(V.to),u[V.to].parents.push(V.from))});let h=Object.values(u).filter(V=>V.parents.length===0);h.length===0&&d.length>0&&(h=[Object.values(u)[0]]),(()=>{const V=h.map(F=>({node:F,lvl:0}));for(;V.length>0;){const{node:F,lvl:J}=V.shift();J>=F.level&&(F.level=J,F.children.forEach(Y=>{const de=u[Y];de&&J<20&&V.push({node:de,lvl:J+1})}))}})();const v=Math.max(...Object.values(u).map(V=>V.level)),x=Array.from({length:v+1},()=>[]);Object.values(u).forEach(V=>{x[V.level].push(V)}),x.forEach(V=>{V.sort((F,J)=>F.node.y-J.node.y)});const _=3;for(let V=0;V<_;V++){for(let F=1;F<x.length;F++){const J=x[F];J.forEach(Y=>{if(Y.parents.length>0){let de=0;Y.parents.forEach(Z=>{const xe=u[Z],le=x[F-1].indexOf(xe);le!==-1&&(de+=le)}),Y.barycenter=de/Y.parents.length}else Y.barycenter=x[F].indexOf(Y)}),J.sort((Y,de)=>(Y.barycenter||0)-(de.barycenter||0))}for(let F=x.length-2;F>=0;F--){const J=x[F];J.forEach(Y=>{if(Y.children.length>0){let de=0;Y.children.forEach(Z=>{const xe=u[Z],le=x[F+1].indexOf(xe);le!==-1&&(de+=le)}),Y.barycenter=de/Y.children.length}else Y.barycenter=x[F].indexOf(Y)}),J.sort((Y,de)=>(Y.barycenter||0)-(de.barycenter||0))}}const S=Math.min(...d.map(V=>V.x)),j=Math.min(...d.map(V=>V.y)),C=150,L=40;let M=S;const U=new Map;x.forEach((V,F)=>{if(V.length===0)return;const J=Math.max(...V.map(de=>de.node.width||260));V.reduce((de,Z)=>de+(Z.node.height||200),0)+(V.length-1)*L;let Y=j;V.forEach(de=>{U.set(de.id,{...de.node,x:M,y:Y}),Y+=(de.node.height||200)+L}),M+=J+C}),c(V=>V.map(F=>U.has(F.id)?U.get(F.id):F))},pm=(n,l)=>{l.preventDefault(),l.stopPropagation(),l.currentTarget.classList.remove("drag-over");const d=Array.from(l.dataTransfer.files),f=d.find(h=>h.type.startsWith("video/"));if(f){fl(n,f);return}const u=d.filter(h=>h.type.startsWith("image/"));if(u.sort((h,g)=>h.name.localeCompare(g.name,void 0,{numeric:!0,sensitivity:"base"})),u.length>0){const h=Dt.get(n),g=(h==null?void 0:h.frames)||[],v=(h==null?void 0:h.selectedKeyframes)||[];let x=0;const _=[];u.forEach((S,j)=>{const C=new FileReader;C.onload=async L=>{const M=L.target.result,U=await wi.saveImage(M);if(_[j]={time:g.length+j,url:U,filename:S.name},x++,x===u.length){const V=_.filter(Boolean);c(F=>F.map(J=>J.id===n?{...J,frames:[...g,...V],selectedKeyframes:[...v,...V]}:J))}},C.readAsDataURL(S)})}},ov=(n,l,d)=>{n.preventDefault(),n.stopPropagation();const f=n.currentTarget.getBoundingClientRect(),h=n.clientX-f.left>f.width/2?d+1:d;(z!==h||D!==l)&&(P(h),b(l))},av=(n,l,d)=>{n.preventDefault(),n.stopPropagation(),n.target===n.currentTarget&&(z!==d||D!==l)&&(P(d),b(l))},lv=(n,l)=>{var _;l.preventDefault(),l.stopPropagation();const d=Array.from(l.dataTransfer.files).filter(S=>S.type.startsWith("image/"));if(d.length===0)return;let f=D===n&&z!==null?z:(((_=Dt.get(n))==null?void 0:_.frames)||[]).length;b(null),P(null),d.sort((S,j)=>S.name.localeCompare(j.name,void 0,{numeric:!0,sensitivity:"base"}));const u=Dt.get(n),h=(u==null?void 0:u.frames)||[],g=(u==null?void 0:u.selectedKeyframes)||[];let v=0;const x=[];d.forEach((S,j)=>{const C=new FileReader;C.onload=async L=>{const M=L.target.result,U=await wi.saveImage(M);let V=M;try{const F=await wi.getImage(U);F&&(V=URL.createObjectURL(F))}catch(F){console.warn("[KeyframeOrganizer] Failed to create blob URL, using base64:",F)}if(x[j]={time:Date.now()+j,url:V,imgId:U,filename:S.name},v++,v===d.length){const F=x.filter(Boolean),J=[...h.slice(0,f),...F,...h.slice(f)],Y=new Set([...g,...F]),de=J.map((xe,le)=>({...xe,time:le})),Z=de.filter((xe,le)=>Y.has(J[le]));c(xe=>xe.map(le=>le.id===n?{...le,frames:de,selectedKeyframes:Z}:le))}},C.readAsDataURL(S)})},cv=async(n,l=30)=>new Promise((d,f)=>{const u=document.createElement("video");u.crossOrigin="anonymous",u.src=n,u.muted=!0;const h=document.createElement("canvas"),g=h.getContext("2d",{willReadFrequently:!0}),v=[];let x=null;u.onloadeddata=async()=>{h.width=320,h.height=Math.floor(320*(u.videoHeight/u.videoWidth));const _=u.duration,S=2;u.currentTime=0;const j=async()=>{const C=u.currentTime;if(C>=_||Math.abs(C-_)<.01){if(v.length===0||parseFloat(v[v.length-1].time)<_-.5){const U=document.createElement("canvas");U.width=u.videoWidth,U.height=u.videoHeight;const V=U.getContext("2d");u.currentTime=Math.max(0,_-.1),await new Promise(F=>{const J=setTimeout(()=>F(),200);u.onseeked=()=>{clearTimeout(J),V.drawImage(u,0,0);const Y=Math.max(0,_-.1);v.push({time:Y.toFixed(2),image:U.toDataURL("image/jpeg",.8)}),F()}})}d(v.map(U=>({time:parseFloat(U.time),url:U.image})));return}g.drawImage(u,0,0,h.width,h.height);const L=g.getImageData(0,0,h.width,h.height).data;if(x){let U=0;for(let F=0;F<L.length;F+=4)U+=Math.abs(L[F]-x[F])+Math.abs(L[F+1]-x[F+1])+Math.abs(L[F+2]-x[F+2]);if(U/(L.length/4*3)>l){const F=document.createElement("canvas");F.width=u.videoWidth,F.height=u.videoHeight,F.getContext("2d").drawImage(u,0,0);const J=F.toDataURL("image/jpeg",.8),Y=u.currentTime;v.push({time:Y.toFixed(2),image:J}),x=null}else x=L}else{x=L;const U=u.currentTime,V=document.createElement("canvas");V.width=u.videoWidth,V.height=u.videoHeight,V.getContext("2d").drawImage(u,0,0),v.push({time:U.toFixed(2),image:V.toDataURL("image/jpeg",.8)})}const M=u.currentTime+1/S;if(M>=_){if(v.length===0||parseFloat(v[v.length-1].time)<_-.5){const U=document.createElement("canvas");U.width=u.videoWidth,U.height=u.videoHeight;const V=U.getContext("2d");u.currentTime=Math.max(0,_-.1),await new Promise(F=>{const J=setTimeout(()=>F(),200);u.onseeked=()=>{clearTimeout(J),V.drawImage(u,0,0);const Y=Math.max(0,_-.1);v.push({time:Y.toFixed(2),image:U.toDataURL("image/jpeg",.8)}),F()}})}d(v.map(U=>({time:parseFloat(U.time),url:U.image})));return}u.currentTime=M,await new Promise(U=>{const V=setTimeout(()=>U(),200);u.onseeked=()=>{clearTimeout(V),U()}}),j()};j()},u.onerror=_=>f(new Error(""))}),uv=async(n,l=2)=>{const d=Dt.get(n);if(d!=null&&d.content){c(f=>f.map(u=>u.id===n?{...u,extractingFrames:!0}:u));try{const f=await Vz(d.content,{fps:l});c(u=>u.map(h=>h.id===n?{...h,frames:f,selectedKeyframes:[],extractingFrames:!1}:h))}catch(f){console.error("",f),c(u=>u.map(h=>h.id===n?{...h,extractingFrames:!1}:h))}}},dv=async(n,l=30)=>{const d=Dt.get(n);if(d!=null&&d.content){c(f=>f.map(u=>u.id===n?{...u,extractingFrames:!0}:u));try{const f=await cv(d.content,l);c(u=>u.map(h=>h.id===n?{...h,frames:f,selectedKeyframes:[],extractingFrames:!1}:h))}catch(f){console.error("",f),alert(`: ${f.message}`),c(u=>u.map(h=>h.id===n?{...h,extractingFrames:!1}:h))}}},pv=(n,l,d=0,f=null)=>{const u=!!(f!=null&&f.shiftKey);c(h=>h.map(g=>{if(g.id!==n)return g;const v=g.frames||[],x=C=>`${C.time}-${C.url}`,_=new Map(v.map(C=>[x(C),C]));let j=[...g.selectedKeyframes||[]];if(u&&Gc.current[n]!==void 0&&Gc.current[n]!==null&&v.length>0){const C=Gc.current[n],L=Math.min(C,d),M=Math.max(C,d),U=v.slice(L,M+1),V=new Set(j.map(x));U.forEach(F=>V.add(x(F))),j=Array.from(V).map(F=>_.get(F)).filter(Boolean)}else j=j.some(L=>x(L)===x(l))?j.filter(L=>x(L)!==x(l)):[...j,l];return Gc.current[n]=d,{...g,selectedKeyframes:j}}))},fv=(n,l,d)=>{n.preventDefault(),n.stopPropagation(),rp({visible:!0,x:n.clientX,y:n.clientY,nodeId:l,frame:d})},uu=()=>{rp({visible:!1,x:0,y:0,nodeId:null,frame:null})},hv=()=>{const{frame:n}=Oi;if(!(n!=null&&n.url))return;const l={name:`Frame-${(n.time??0).toFixed(2)}s.png`,type:"image/png",content:n.url,isImage:!0,isVideo:!1,isAudio:!1,fromHistory:!0,fileExt:"png"};Ti(d=>[...d,l]),An(!0),uu()},mv=async()=>{const{frame:n}=Oi;if(!(n!=null&&n.url))return;let l=n.url;if(l.startsWith("blob:"))try{l=`data:image/png;base64,${await Kn(l)}`}catch(S){console.error(" Blob URL  URL:",S)}let d;try{const S=await Br(l);S!=null&&S.w&&(S!=null&&S.h)&&(d={w:S.w,h:S.h})}catch{}const f=a.filter(S=>S.type==="input-image");let u,h;if(f.length>0){const S=f[f.length-1];u=S.x-40,h=S.y+35}else{const S=xn(window.innerWidth/2,window.innerHeight/2);u=S.x+50,h=S.y+50}let g=u,v=h;const x=(S,j)=>a.some(C=>Math.abs(C.x-S)<80&&Math.abs(C.y-j)<80);let _=0;for(;x(g,v)&&_<50;)g-=40,v+=35,_++;Lr("input-image",g,v,null,l,d),uu()},gv=()=>{const{frame:n}=Oi;n!=null&&n.url&&(c(l=>{const d=Wi.current,f=qs.current,u=l.filter(g=>g.type==="preview");if(!u.length)return l;let h=null;if(d){const g=u.find(v=>v.id===d);g&&(h=g.id)}if(!h&&f&&f.size>0){const g=u.find(v=>f.has(v.id));g&&(h=g.id)}return h||(h=u[u.length-1].id),l.map(g=>g.id===h?{...g,content:n.url,previewType:"image"}:g)}),uu())},xv=()=>{const{frame:n}=Oi;if(!(n!=null&&n.url))return;const l=k,d=Dt.get(l);d&&d.type==="input-image"?c(f=>f.map(u=>u.id===l?{...u,content:n.url}:u)):alert('""'),uu()},du=(n,l,d=null,f=null)=>{n.preventDefault(),n.stopPropagation();const u=d?Rn(l,d):Rn(l),h=f!==null?f:l.selectedMjImageIndex!==void 0?l.selectedMjImageIndex:null,g={...l,url:u,selectedMjImageIndex:h},v=xn(n.clientX,n.clientY);As({visible:!0,x:n.clientX,y:n.clientY,worldX:v.x,worldY:v.y,item:g})},bv=()=>{const n=Cr.item,l=k,d=Dt.get(l),f=Rn(n);d&&d.type==="input-image"&&f?c(u=>u.map(h=>h.id===l?{...h,content:f}:h)):alert('""'),As({visible:!1,x:0,y:0,item:null})},yv=async()=>{const n=Cr.item,l=Rn(n);if(!l)return;let d=l;n.type==="video"&&!Hn(d)&&(d+=(d.includes("?")?"&":"?")+"force_video_display=true");let f;if(n.type==="image")try{const j=await Br(d);j!=null&&j.w&&(j!=null&&j.h)&&(f={w:j.w,h:j.h})}catch(j){console.error("SendHistoryToCanvas getImageDimensions error",j)}const u=a.filter(j=>j.type==="input-image");let h,g;if(u.length>0){const j=u[u.length-1];h=j.x-40,g=j.y+35}else{const j=xn(window.innerWidth/2,window.innerHeight/2);h=j.x+50,g=j.y+50}let v=h,x=g;const _=(j,C)=>a.some(L=>Math.abs(L.x-j)<80&&Math.abs(L.y-C)<80);let S=0;for(;_(v,x)&&S<50;)v-=40,x+=35,S++;Lr("input-image",v,x,null,d,f),As({visible:!1,x:0,y:0,item:null})},vv=()=>{const n=Cr.item,l=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);if(!n||!l)return;const d=n.type==="image",f=n.type==="video",u=d?"png":f?"mp4":"file",h=d?"image/png":f?"video/mp4":"application/octet-stream",g={name:`Generated-${n.id}.${u}`,type:h,content:l,isImage:d,isVideo:f,isAudio:!1,fromHistory:!0,fileExt:u};Ti(v=>[...v,g]),An(!0),As({visible:!1,x:0,y:0,item:null})},jp=async n=>{if(!n||n.length===0){console.warn("[V3.5.1 Debug] No items to download");return}const l=h=>(h==null?void 0:h.localCacheUrl)||(h==null?void 0:h.url)||(h==null?void 0:h.originalUrl)||(h==null?void 0:h.mjOriginalUrl);if(n.length===1){const h=n[0],g=l(h);if(!(h!=null&&h.mjImages)&&g){fr({active:!0,current:0,total:1});try{const x=g;let _="mp4";if(x.startsWith("data:image"))_="png";else if(x.startsWith("data:video"))_="mp4";else if(h.type==="video"||x.includes("/video/")||x.includes("video_mp4"))_="mp4";else if(h.type==="image")_="png";else{const L=x.split("?")[0].split("/").pop();if(L&&L.includes(".")){const M=L.split(".").pop();M&&M.length<=5&&/^[a-z0-9]+$/i.test(M)&&(_=M)}}const j=`${(h.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}.${_}`;if(x.startsWith("data:")){const C=document.createElement("a");C.href=x,C.download=j,C.click()}else{const L=await(await fetch(x)).blob(),M=document.createElement("a");M.href=URL.createObjectURL(L),M.download=j,M.click()}fr({active:!1,current:1,total:1})}catch(x){console.error(":",x),fr({active:!1,current:0,total:0}),alert(": "+x.message)}return}}const d=new sx;let f=0;const u=n.length;fr({active:!0,current:0,total:u});try{for(const x of n){if(!x)continue;const _=[];if(x.mjImages&&x.mjImages.length>0)x.mjImages.forEach((S,j)=>{_.push({url:S,suffix:`_${j+1}`})});else{const S=l(x);S&&_.push({url:S,suffix:""})}for(const S of _)try{let j;if(S.url.startsWith("data:")){const F=S.url.split(","),J=F[0].match(/:(.*?);/)[1],Y=atob(F[1]);let de=Y.length;const Z=new Uint8Array(de);for(;de--;)Z[de]=Y.charCodeAt(de);j=new Blob([Z],{type:J})}else j=await(await fetch(S.url)).blob();let C=j.type.split("/")[1]||"png";const L=l(x);if(L&&!L.startsWith("data:")){const F=L.split(".").pop().split("?")[0];F&&F.length<5&&(C=F)}const M=(x.prompt||"untitled").replace(/[\\/:*?"<>|]/g,"_").slice(0,40),U=x.id?`_${x.id.slice(-4)}`:"",V=`${M}${U}${S.suffix}.${C}`;d.file(V,j),f++}catch(j){console.error(` [${x.id}]:`,j)}fr(S=>({...S,current:S.current+1}))}if(f===0){fr({active:!1,current:0,total:0}),alert("");return}const h=await d.generateAsync({type:"blob"}),g=new Date,v=`${g.getFullYear().toString().slice(2)}${(g.getMonth()+1).toString().padStart(2,"0")}${g.getDate().toString().padStart(2,"0")}-${g.getHours().toString().padStart(2,"0")}${g.getMinutes().toString().padStart(2,"0")}`;ix.saveAs(h,`tapnow-assets-${v}.zip`),fr({active:!1,current:0,total:0})}catch(h){console.error(":",h),fr({active:!1,current:0,total:0}),alert(": "+h.message)}},wv=(n,l="all")=>{var j,C,L;const d=((j=n.settings)==null?void 0:j.mode)||"video",f=((C=n.settings)==null?void 0:C.shots)||[],u=((L=n.settings)==null?void 0:L.projectTitle)||"",h=is(u)||"",g=[],v=M=>{const U=(M.description||M.prompt||"").trim();return is(U)||""},x=(M,U,V,F)=>{if(!V)return;const J=V.startsWith("data:")?Bi(V,".png")||".png":pa(V,".png")||".png",Y=v(M),de=`${h}-${Y}-${U}-${F}${J}`;g.push({url:V,filename:de})},_=(M,U,V)=>{if(!V)return;const F=V.startsWith("data:")?Bi(V,".mp4")||".mp4":pa(V,".mp4")||".mp4",J=v(M),Y=`${h}-${J}-${U}${F}`;g.push({url:V,filename:Y})},S=l!=="all"&&f.some(M=>M.outputEnabled);return f.forEach((M,U)=>{var F;const V=M.scene_index||U+1;if(d==="image"){const J=(F=M.output_images)!=null&&F.length?M.output_images:M.output_url?[M.output_url]:[];if(J.length===0)return;if(l==="all"){J.forEach((Z,xe)=>x(M,V,Z,xe+1));return}const Y=Number.isInteger(M.selectedImageIndex)?M.selectedImageIndex:-1,de=!!M.outputEnabled;if(S){if(!de)return;if(Y>=0&&J[Y]){x(M,V,J[Y],Y+1);return}J.forEach((Z,xe)=>x(M,V,Z,xe+1));return}Y>=0&&J[Y]&&x(M,V,J[Y],Y+1)}else{const J=M.video_url||M.output_url;if(!J)return;if(l==="all"){_(M,V,J);return}M.outputEnabled&&_(M,V,J)}}),g},fm=async(n,l="all")=>{var j;const d=wv(n,l);if(!d.length){alert("");return}const f=new Date,u=`${f.getFullYear().toString().slice(2)}${String(f.getMonth()+1).padStart(2,"0")}${String(f.getDate()).padStart(2,"0")}-${String(f.getHours()).padStart(2,"0")}${String(f.getMinutes()).padStart(2,"0")}`,h=((j=n.settings)==null?void 0:j.projectTitle)||"",g=`${is(h)||""}-batch-${u}.zip`,v=async C=>{var M;if(C.startsWith("data:")){const U=C.split(","),V=((M=U[0].match(/:(.*?);/i))==null?void 0:M[1])||"application/octet-stream",F=atob(U[1]||""),J=new Uint8Array(F.length);for(let Y=0;Y<F.length;Y++)J[Y]=F.charCodeAt(Y);return new Blob([J],{type:V})}const L=await fetch(C);if(!L.ok)throw new Error(`HTTP ${L.status}`);return await L.blob()};if(d.length===1){try{fr({active:!0,current:0,total:1});const C=await v(d[0].url),L=document.createElement("a");L.href=URL.createObjectURL(C),L.download=d[0].filename,L.click(),URL.revokeObjectURL(L.href),fr({active:!1,current:1,total:1})}catch(C){fr({active:!1,current:0,total:0}),alert(": "+C.message)}return}const x=new sx;fr({active:!0,current:0,total:d.length});let _=0;for(const C of d){try{const L=await v(C.url);x.file(C.filename,L),_+=1}catch(L){console.error(":",C.filename,L)}fr(L=>({...L,current:L.current+1}))}if(_===0){fr({active:!1,current:0,total:0}),alert("");return}const S=await x.generateAsync({type:"blob"});ix.saveAs(S,g),fr({active:!1,current:0,total:0})},wl=(n,l)=>{l!=null&&l.url&&(n.preventDefault(),n.stopPropagation(),wh({visible:!0,x:n.clientX,y:n.clientY,item:l}))},Co=()=>wh({visible:!1,x:0,y:0,item:null}),kv=()=>{const n=Li.item;if(!(n!=null&&n.url))return;const l=n.type!=="video",d=n.type==="video",f=l?"png":"mp4",u=l?"image/png":"video/mp4",h={name:`Preview-${Date.now()}.${f}`,type:u,content:n.url,isImage:l,isVideo:d,isAudio:!1,fileExt:f};Ti(g=>[...g,h]),An(!0),Co()},zv=async()=>{const n=Li.item;if(!(n!=null&&n.url))return;const l=xn(window.innerWidth/2,window.innerHeight/2);let d={w:512,h:512};try{d=await Br(n.url)}catch(f){console.warn("Preview dims fail",f)}Lr("input-image",l.x+50,l.y+50,null,n.url,d),Co()},jv=(n,l)=>{n.preventDefault(),n.stopPropagation();const d=Dt.get(l);!d||!d.content||kh({visible:!0,x:n.clientX,y:n.clientY,nodeId:l})},Np=()=>{kh({visible:!1,x:0,y:0,nodeId:null})},Nv=()=>{const n=nl.nodeId,l=Dt.get(n);if(!l||!l.content)return;const d=!Hn(l.content),f=Hn(l.content),u=d?"png":"mp4",h=d?"image/png":"video/mp4",g={name:`InputImage-${Date.now()}.${u}`,type:h,content:l.content,isImage:d,isVideo:f,isAudio:!1,fileExt:u};Ti(v=>[...v,g]),An(!0),Np()},hm=R.memo(({connections:n,nodesMap:l,connectionsByNode:d,connectingSource:f,connectingTarget:u,connectingInputType:h,mousePos:g,apiConfigsMap:v,selectedNodeId:x,onDisconnectConnection:_,visibleNodes:S})=>{const j=R.useMemo(()=>new Set(S.map(L=>L.id)),[S]),C=R.useMemo(()=>n.filter(L=>j.has(L.from)||j.has(L.to)),[n,j]);return s.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-visible w-full h-full",children:s.jsxs("svg",{className:"absolute inset-0 overflow-visible w-full h-full pointer-events-none",children:[C.map(L=>{var rt;const M=l.get(L.from),U=l.get(L.to);if(!M||!U)return null;const V=x&&(M.id===x||U.id===x),F=V?1:.35,J=M.x+M.width-4,Y=M.y+M.height/2,de=U.x+4;let Z=U.y+U.height/2;if(U.type==="image-compare"){const He=(d.to.get(U.id)||[]).findIndex(gt=>gt.id===L.id);He===0?Z=U.y+U.height*.33:He>=1&&(Z=U.y+U.height*.66)}if(U.type==="gen-image"&&(L.inputType==="oref"||L.inputType==="sref")){const Oe=v.get((rt=U.settings)==null?void 0:rt.model);if(Oe&&(Oe.id.includes("mj")||Oe.provider.toLowerCase().includes("midjourney"))){const ot=(d.to.get(U.id)||[]).some(Ht=>!Ht.inputType||Ht.inputType==="default");let kt=12;kt+=24,ot&&(kt+=68),kt+=108,L.inputType==="oref"?Z=U.y+kt+16*.5:L.inputType==="sref"&&(Z=U.y+kt+16+6+28+6+16*.5)}}const xe=Math.abs(de-J),le=J+xe*.5,ne=de-xe*.5,te=(J+de)/2,$e=(Y+Z)/2;return s.jsxs("g",{className:"connection-group",style:{opacity:F},children:[s.jsx("path",{d:`M ${J} ${Y} C ${le} ${Y}, ${ne} ${Z}, ${de} ${Z}`,stroke:"transparent",strokeWidth:"20",fill:"none",style:{pointerEvents:"stroke"}}),s.jsx("path",{d:`M ${J} ${Y} C ${le} ${Y}, ${ne} ${Z}, ${de} ${Z}`,stroke:"#18181b",strokeWidth:"4",fill:"none"}),s.jsx("path",{d:`M ${J} ${Y} C ${le} ${Y}, ${ne} ${Z}, ${de} ${Z}`,stroke:"#71717a",strokeWidth:"2",fill:"none"}),s.jsx("circle",{cx:J,cy:Y,r:"2",fill:"#71717a"}),s.jsx("circle",{cx:de,cy:Z,r:"2",fill:"#71717a"}),s.jsxs("g",{className:"connection-delete cursor-pointer",style:{opacity:V?1:.35,pointerEvents:"auto",cursor:"pointer"},onClick:Oe=>{Oe.stopPropagation(),Oe.preventDefault(),_(L.id)},onMouseDown:Oe=>{Oe.stopPropagation(),Oe.preventDefault(),_(L.id)},children:[s.jsx("circle",{cx:te,cy:$e,r:"25",fill:"transparent",style:{pointerEvents:"auto",cursor:"pointer"},onClick:Oe=>{Oe.stopPropagation(),Oe.preventDefault(),_(L.id)},onMouseDown:Oe=>{Oe.stopPropagation(),Oe.preventDefault(),_(L.id)}}),s.jsx("circle",{cx:te,cy:$e,r:"12",fill:"#ef4444",opacity:"0.8",style:{pointerEvents:"none"}}),s.jsx("circle",{cx:te,cy:$e,r:"8",fill:"#ef4444",style:{pointerEvents:"none"}}),s.jsx(Mz,{size:10,className:"text-white",x:te-5,y:$e-5,style:{pointerEvents:"none"}})]})]},L.id)}),f&&(()=>{const L=l.get(f);return L?s.jsx("path",{d:`M ${L.x+L.width-4} ${L.y+L.height/2} C ${L.x+L.width+100} ${L.y+L.height/2}, ${g.x-100} ${g.y}, ${g.x} ${g.y}`,stroke:"#60a5fa",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"}):null})(),u&&(()=>{var V;const L=l.get(u);if(!L)return null;const M=L.x+4;let U=L.y+L.height/2;if(L.type==="gen-image"&&h){const F=v.get((V=L.settings)==null?void 0:V.model);if(F&&(F.id.includes("mj")||F.provider.toLowerCase().includes("midjourney"))){const gt=(d.to.get(L.id)||[]).some(Ct=>!Ct.inputType||Ct.inputType==="default");let xt=12;xt+=24,gt&&(xt+=68),xt+=108,h==="oref"?U=L.y+xt+16*.5:h==="sref"&&(U=L.y+xt+16+6+28+6+16*.5)}}else L.type==="image-compare"&&(U=L.y+L.height/2);return s.jsx("path",{d:`M ${M} ${U} C ${M-100} ${U}, ${g.x+100} ${g.y}, ${g.x} ${g.y}`,stroke:"#60a5fa",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"})})()]})})},(n,l)=>n.connections===l.connections&&n.visibleNodes===l.visibleNodes&&n.selectedNodeId===l.selectedNodeId&&n.connectingSource===l.connectingSource&&n.connectingTarget===l.connectingTarget&&n.connectingInputType===l.connectingInputType&&n.mousePos.x===l.mousePos.x&&n.mousePos.y===l.mousePos.y);R.useCallback(()=>s.jsx(hm,{connections:p,nodesMap:Dt,connectionsByNode:Vi,connectingSource:Bn,connectingTarget:gn,connectingInputType:ys,mousePos:Zd,apiConfigsMap:mn,selectedNodeId:k,onDisconnectConnection:wp,visibleNodes:Jc}),[p,Dt,Vi,Bn,gn,ys,Zd,mn,k,wp,Jc]);const mm=R.useMemo(()=>{const n=new Map;return p.forEach(l=>{(!l.inputType||l.inputType==="default")&&n.set(l.to,!0)}),n},[p]),gm=R.useCallback(n=>{const l=new Set,d=Vi.from.get(n)||[],f=Vi.to.get(n)||[];return d.forEach(u=>l.add(u.to)),f.forEach(u=>l.add(u.from)),l},[Vi]),xm=R.useMemo(()=>{const n=new Map;if(k||Mn.size>0){const l=k||(Mn.size===1?Array.from(Mn)[0]:null);l&&n.set(l,gm(l))}return n},[k,Mn,gm]),_v=R.useCallback(n=>{var L,M,U,V,F,J,Y,de,Z,xe,le,ne,te,$e,rt,Oe,He,gt,xt,Ct,bt,Jt,Kt,Zt,un;const d=$t.zoom<.4,f=k===n.id||Mn.has(n.id),u=Gh(n.id),h=ta===n.id,g=mm.get(n.id)||!1,v=Xr===n.id||Xr&&Mn.has(n.id),x=k||(Mn.size===1?Array.from(Mn)[0]:null),_=x?xm.get(x):null,S=x&&x!==n.id&&_&&_.has(n.id),j=mn.get((L=n.settings)==null?void 0:L.model),C=j?(j.modelName||j.id||"").includes("nano-banana-2"):(((M=n.settings)==null?void 0:M.model)||"").includes("nano-banana-2");return d?s.jsxs("div",{"data-node-id":n.id,className:`absolute node-wrapper flex flex-col ${f?"ring-1 ring-blue-500":e==="dark"?"border border-zinc-800":"border border-zinc-200"} ${e==="dark"?"bg-[#18181b]":"bg-white"}`,style:{left:n.x,top:n.y,width:n.width,height:n.height,cursor:Xr===n.id||Xr&&Mn.has(n.id)?"grabbing":"default",zIndex:v?50:10,border:`1px solid ${e==="dark"?"#3f3f46":"#e4e4e7"}`,background:e==="dark"?"#18181b":"#fff",boxShadow:"none",borderRadius:"0",transform:"translateZ(0)",backfaceVisibility:"hidden"},onMouseDown:B=>{B.button===0&&(B.stopPropagation(),B.ctrlKey||B.metaKey?Or(pe=>{const Ue=new Set(pe);return Ue.has(n.id)?Ue.delete(n.id):Ue.add(n.id),Ue.size===1?Ne(Array.from(Ue)[0]):Ne(null),Ue}):Mn.has(n.id)&&Mn.size>1?Ne(n.id):(Ne(n.id),Or(new Set([n.id]))),el(n.id))},onMouseEnter:()=>{(Bn||gn)&&Ai(n.id)},onMouseLeave:()=>{(Bn||gn)&&ta===n.id&&Ai(null)},onMouseUp:B=>Rs(n.id,B),children:[n.type==="input-image"&&n.content&&s.jsx("div",{className:"w-full h-full relative",children:Hn(n.content)?s.jsx("video",{src:n.content,className:"w-full h-full object-cover opacity-80",muted:!0,playsInline:!0}):s.jsx(Yn,{src:n.content,className:"w-full h-full object-cover opacity-80",alt:""})}),n.type==="video-input"&&n.content&&s.jsx("video",{src:n.content,className:"w-full h-full object-cover opacity-80",muted:!0,playsInline:!0}),!n.content&&s.jsx("div",{className:`p-2 font-bold text-sm truncate ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:n.type==="input-image"?"":n.type==="video-input"?"":n.type==="gen-image"||n.type==="gen-image"?"":n.type==="gen-video"?"":n.type==="text-node"?"":n.type==="preview"?"":n.type==="novel-input"?"":n.type==="extract-characters-scenes"?"":n.type==="character-description"?"":n.type==="scene-description"?"":n.type==="generate-character-video"?"":n.type==="generate-scene-video"?"":n.type==="generate-character-image"?"":n.type==="generate-scene-image"?"":n.type==="create-character"?"":n.type==="create-scene"?"":n.type==="save-to-local"||n.type==="local-save"?"":n.type||""}),n.type!=="input-image"&&n.type!=="video-input"&&n.type!=="video-analyze"&&n.type!=="preview"&&(n.type==="image-compare"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"input-point",style:{top:"33%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:g?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),bs(n.id),vs("default")},onMouseUp:B=>Rs(n.id,B,"default")}),s.jsx("div",{className:"input-point",style:{top:"66%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:g?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),bs(n.id),vs("default")},onMouseUp:B=>Rs(n.id,B,"default")})]}):s.jsx("div",{className:"input-point",style:{top:"50%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:g?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),bs(n.id),vs("default")},onMouseUp:B=>Rs(n.id,B,"default")})),n.type!=="preview"&&s.jsx("div",{className:"connector connector-right",style:{position:"absolute",top:"50%",right:"-0.45rem",width:"0.9rem",height:"0.9rem",backgroundColor:Bn===n.id?"#d4d4d8":"#27272a",border:"1px solid #71717a",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"crosshair",zIndex:30,opacity:Bn===n.id?1:.5,pointerEvents:"auto"},onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),ea(n.id)},children:s.jsx(Ji,{size:10})})]},n.id):s.jsxs("div",{"data-node-id":n.id,className:`absolute rounded-xl shadow-xl transition-shadow duration-150 group flex flex-col node-wrapper ${f?"ring-1 ring-blue-500 shadow-blue-500/20":S?"ring-2 ring-blue-300/60 shadow-blue-300/30":e==="dark"?"border border-zinc-800 shadow-black/40":"border border-zinc-200 shadow-black/10"} ${h&&(Bn&&Bn!==n.id||gn&&gn!==n.id)?"ring-2 ring-green-500/50":""} ${e==="dark"?"bg-[#18181b]":"bg-white"}`,style:{left:n.x,top:n.y,width:n.width,height:n.height,cursor:Xr===n.id||Xr&&Mn.has(n.id)?"grabbing":"default",zIndex:v?50:10,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transform:"translateZ(0)",backfaceVisibility:"hidden"},onMouseDown:B=>{B.button===0&&(B.stopPropagation(),B.ctrlKey||B.metaKey?Or(pe=>{const Ue=new Set(pe);return Ue.has(n.id)?Ue.delete(n.id):Ue.add(n.id),Ue.size===1?Ne(Array.from(Ue)[0]):Ne(null),Ue}):Mn.has(n.id)&&Mn.size>1?Ne(n.id):(Ne(n.id),Or(new Set([n.id]))),el(n.id),nn(null))},onMouseEnter:()=>{(Bn||gn)&&Ai(n.id)},onMouseLeave:()=>{(Bn||gn)&&ta===n.id&&Ai(null)},onMouseUp:B=>Rs(n.id,B),onDoubleClick:B=>{B.stopPropagation(),(n.type==="input-image"||n.type==="video-input")&&n.content&&$n({url:n.content,type:Hn(n.content)?"video":"image"})},children:[s.jsx("button",{onClick:B=>{B.stopPropagation(),hp(n.id)},className:`absolute -top-2.5 -right-2.5 z-50 p-1 rounded-full shadow border opacity-0 group-hover:opacity-100 transition-opacity scale-90 hover:scale-100 ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:text-red-500 hover:bg-zinc-700 border-zinc-700":"bg-zinc-100 text-zinc-500 hover:text-red-500 hover:bg-zinc-200 border-zinc-300"}`,onMouseDown:B=>B.stopPropagation(),children:s.jsx(cs,{size:12})}),s.jsx("div",{className:"absolute bottom-1 right-1 w-4 h-4 z-[100] resize-handle flex items-end justify-end p-0.5",onMouseDown:B=>{B.stopPropagation(),B.preventDefault(),Dc(n.id)},children:s.jsx("svg",{width:"6",height:"6",viewBox:"0 0 8 8",fill:"none",className:"text-zinc-600",children:s.jsx("path",{d:"M8 0L8 8L0 8",stroke:"currentColor",strokeWidth:"2"})})}),n.type!=="input-image"&&n.type!=="video-input"&&n.type!=="video-analyze"&&n.type!=="preview"&&(n.type==="image-compare"?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`input-point ${gn===n.id&&!ys?"active":""}`,style:{top:"33%"},title:" 1 ",onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),bs(n.id),vs("default")},onMouseUp:B=>Rs(n.id,B,"default")}),s.jsx("div",{className:`input-point ${gn===n.id&&!ys?"active":""}`,style:{top:"66%"},title:" 2 ",onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),bs(n.id),vs("default")},onMouseUp:B=>Rs(n.id,B,"default")})]}):s.jsx("div",{className:`input-point ${g?"connected":""} ${gn===n.id&&!ys?"active":""}`,title:"",onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),bs(n.id),vs("default")},onMouseUp:B=>Rs(n.id,B,"default")})),n.type!=="preview"&&s.jsx("div",{className:`connector connector-right ${Bn===n.id?"active":""} ${gn&&ta===n.id?"ring-2 ring-green-500/50":""}`,title:"",onMouseDown:B=>{B.stopPropagation(),B.preventDefault();const pe=xn(B.clientX,B.clientY);Ts(pe),ea(n.id)},onMouseEnter:()=>{gn&&Ai(n.id)},onMouseLeave:()=>{gn&&ta===n.id&&Ai(null)},children:s.jsx(Ji,{size:10})}),s.jsxs("div",{className:`overflow-hidden rounded-xl flex-1 flex flex-col pointer-events-none h-full w-full relative ${e==="dark"?"bg-[#18181b]":"bg-white"}`,children:[n.type==="novel-input"&&s.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0",children:[s.jsx(ls,{size:12,className:"text-blue-500"}),s.jsx("span",{children:""})]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-2 p-3 overflow-hidden min-h-0",children:[s.jsx("textarea",{value:((U=n.settings)==null?void 0:U.content)||"",onChange:B=>{const pe=B.target.value;pe.length<=1e4&&Le(n.id,{content:pe})},placeholder:"10,000...",maxLength:1e4,className:`w-full flex-1 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:B=>B.stopPropagation()}),s.jsxs("div",{className:"text-right text-[10px] text-zinc-500 shrink-0",children:[(((V=n.settings)==null?void 0:V.content)||"").length,"/10,000"]}),s.jsxs("button",{className:"w-full py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-1.5 bg-blue-600 hover:bg-blue-500 text-white shrink-0",onMouseDown:B=>B.stopPropagation(),onClick:B=>{B.stopPropagation(),Z1(n.id)},children:[s.jsx(Ll,{size:12})," "]})]})]}),n.type==="extract-characters-scenes"&&s.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[s.jsx(Au,{size:12,className:"text-purple-500"}),s.jsx("span",{children:""})]}),((F=n.settings)==null?void 0:F.analysisResults)&&s.jsx("span",{className:"text-[10px] opacity-70",children:(((J=n.settings.analysisResults.characters)==null?void 0:J.length)||0)+(((Y=n.settings.analysisResults.scenes)==null?void 0:Y.length)||0)})]}),s.jsxs("div",{className:"flex-1 flex flex-col p-3 overflow-hidden min-h-0",children:[s.jsx("div",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:B=>{B.stopPropagation(),nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="extract-model"?null:{nodeId:n.id,type:"extract-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:B=>B.stopPropagation(),children:[s.jsx("span",{className:"truncate font-mono",children:Xc((de=n.settings)==null?void 0:de.model)}),s.jsx(zs,{size:12,className:"opacity-50 shrink-0"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="extract-model"&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:B=>B.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,B])=>B.models.some(pe=>pe.type==="Chat")).map(([B,pe])=>s.jsx("button",{onMouseEnter:()=>tr(B),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Nn===B?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:pe.name||B},B))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[Nn&&((Z=gr[Nn])==null?void 0:Z.models.filter(B=>B.type==="Chat").map(B=>{var pe;return s.jsxs("button",{onClick:()=>{Le(n.id,{model:B.id}),fp(B.id);try{localStorage.setItem("tapnow_last_extract_model",B.id)}catch{}nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((pe=n.settings)==null?void 0:pe.model)===B.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:B.displayName||B.modelName||B.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(B.id)}`})]},B.id)})),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar mt-2",children:[(()=>{var ot;const B=(ot=n.settings)==null?void 0:ot.analysisResults;if(!B)return s.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-[11px] opacity-70",children:[s.jsx(rx,{size:18,className:"mb-1 opacity-70"}),s.jsx("span",{children:""})]});const pe=Array.isArray(B.characters)?B.characters:[],Ue=Array.isArray(B.scenes)?B.scenes:[];return s.jsxs("div",{className:"flex flex-col gap-3",children:[pe.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-[10px] font-medium mb-1 opacity-70",children:[" (",pe.length,")"]}),pe.map((kt,Ht)=>s.jsxs("div",{className:`p-2 rounded mb-1 ${e==="dark"?"bg-zinc-800":"bg-white border border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-1 text-[11px]",children:[s.jsx("span",{className:`w-2 h-2 rounded-full shrink-0 ${Ht===0?"bg-red-500":Ht===1?"bg-purple-500":Ht===2?"bg-blue-500":"bg-zinc-400"}`}),s.jsx("span",{className:"font-medium",children:kt.name||""})]}),kt.description&&s.jsx("div",{className:"mt-1 text-[10px] opacity-70 leading-snug",children:kt.description})]},`${kt.name||"char"}-${Ht}`))]}),Ue.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"text-[10px] font-medium mb-1 opacity-70",children:[" (",Ue.length,")"]}),Ue.map((kt,Ht)=>s.jsxs("div",{className:`p-2 rounded mb-1 ${e==="dark"?"bg-zinc-800":"bg-white border border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-1 text-[11px]",children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 shrink-0"}),s.jsx("span",{className:"font-medium",children:kt.location||kt.name||""})]}),kt.description&&s.jsx("div",{className:"mt-1 text-[10px] opacity-70 leading-snug",children:kt.description})]},`${kt.location||"scene"}-${Ht}`))]}),pe.length===0&&Ue.length===0&&s.jsx("div",{className:"text-[11px] text-zinc-500",children:"/"})]})})(),((xe=n.settings)==null?void 0:xe.errorMsg)&&s.jsx("div",{className:"mt-2 text-[10px] text-red-500 break-words",children:n.settings.errorMsg})]}),((le=n.settings)==null?void 0:le.isAnalyzing)&&s.jsxs("div",{className:"mt-2",children:[s.jsx("div",{className:"text-[10px] mb-1 opacity-70",children:"..."}),s.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${((ne=n.settings)==null?void 0:ne.progress)||0}%`}})}),s.jsxs("div",{className:"text-[10px] mt-1 opacity-70",children:[((te=n.settings)==null?void 0:te.progress)||0,"%"]})]}),s.jsx("button",{className:`mt-2 w-full py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-1.5 ${($e=n.settings)!=null&&$e.isAnalyzing?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500 text-white"}`,onMouseDown:B=>B.stopPropagation(),onClick:B=>{B.stopPropagation(),um(n.id)},children:(rt=n.settings)!=null&&rt.isAnalyzing?s.jsxs(s.Fragment,{children:[s.jsx(xi,{size:12,className:"animate-spin"}),"..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ll,{size:12}),""]})})]})]}),(n.type==="character-description"||n.type==="scene-description")&&s.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var Vt,pt,ft,wt,at,At,Wt,Bt,zt,yn,Tn,q,re,Ie,lt,ie,Te,yt,sn,ut,vn,qt,pn;const B=n.type==="character-description",pe=B?"":"",Ue=((Vt=n.settings)==null?void 0:Vt.mode)||"video",ot={name:((pt=n.settings)==null?void 0:pt.characterName)||((ft=n.settings)==null?void 0:ft.name)||"",role:((wt=n.settings)==null?void 0:wt.role)||"",description:((at=n.settings)==null?void 0:at.description)||"",age:((At=n.settings)==null?void 0:At.age)||"",gender:((Wt=n.settings)==null?void 0:Wt.gender)||""},kt={name:((Bt=n.settings)==null?void 0:Bt.sceneName)||((zt=n.settings)==null?void 0:zt.location)||"",location:((yn=n.settings)==null?void 0:yn.sceneName)||((Tn=n.settings)==null?void 0:Tn.location)||"",description:((q=n.settings)==null?void 0:q.description)||""},Ht=B?_o(ot,Ue):yl(kt),vt=((re=n.settings)==null?void 0:re.prompt)||Ht;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ls,{size:12,className:B?"text-red-500":"text-green-500"}),s.jsx("span",{children:pe})]}),B?ot.name?s.jsxs("div",{className:"text-[10px] text-zinc-500",children:[": ",ot.name]}):null:kt.name?s.jsxs("div",{className:"text-[10px] text-zinc-500",children:[": ",kt.name]}):null]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto custom-scrollbar min-h-0",children:[s.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[s.jsx("button",{className:`px-2 py-1 rounded text-[10px] transition-colors ${Ue==="video"?"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,onMouseDown:Qe=>Qe.stopPropagation(),onClick:()=>{var Lt;const Qe=((Lt=n.settings)==null?void 0:Lt.prompt)||(B?_o(ot,"image"):Ht),Ot=B?im(Qe):Qe;Le(n.id,{mode:"video",prompt:Ot}),setTimeout(()=>K1(n.id),0)},children:""}),s.jsx("button",{className:`px-2 py-1 rounded text-[10px] transition-colors ${Ue==="image"?"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,onMouseDown:Qe=>Qe.stopPropagation(),onClick:()=>{var Lt;const Qe=((Lt=n.settings)==null?void 0:Lt.prompt)||(B?_o(ot,"video"):Ht),Ot=B?sm(Qe):Qe;Le(n.id,{mode:"image",prompt:Ot}),setTimeout(()=>V1(n.id),0)},children:""}),s.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[s.jsx("button",{onClick:()=>om(n.id,"enhance"),disabled:(Ie=n.settings)==null?void 0:Ie.isEnhancing,className:`px-2 py-1 rounded text-[10px] transition-colors ${(lt=n.settings)!=null&&lt.isEnhancing?e==="dark"?"bg-zinc-700 text-zinc-500 cursor-not-allowed":"bg-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-purple-600/80 text-white hover:bg-purple-500":"bg-purple-600 text-white hover:bg-purple-500"}`,children:B?"":""}),s.jsx("button",{onClick:()=>om(n.id,"filter"),disabled:(ie=n.settings)==null?void 0:ie.isEnhancing,className:`px-2 py-1 rounded text-[10px] transition-colors ${(Te=n.settings)!=null&&Te.isEnhancing?e==="dark"?"bg-zinc-700 text-zinc-500 cursor-not-allowed":"bg-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-200 text-zinc-700 hover:bg-zinc-300"}`,children:""})]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsxs("div",{className:"flex items-center justify-between text-[10px] text-zinc-500",children:[s.jsx("span",{children:""}),((yt=n.settings)==null?void 0:yt.isEnhancing)&&s.jsxs("span",{className:"flex items-center gap-1 text-blue-400",children:[s.jsx(xi,{size:10,className:"animate-spin"}),""]})]}),s.jsx("textarea",{value:vt,onChange:Qe=>Le(n.id,{prompt:Qe.target.value}),placeholder:"/...",className:`w-full h-28 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:Qe=>Qe.stopPropagation()})]}),s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:"/"}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:Qe=>{Qe.stopPropagation(),nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="desc-model"?null:{nodeId:n.id,type:"desc-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:Qe=>Qe.stopPropagation(),children:[s.jsx("span",{className:"truncate font-mono",children:Xc((sn=n.settings)==null?void 0:sn.chatModel)}),s.jsx(zs,{size:12,className:"opacity-50 shrink-0"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="desc-model"&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Qe=>Qe.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,Qe])=>Qe.models.some(Ot=>Ot.type==="Chat")).map(([Qe,Ot])=>s.jsx("button",{onMouseEnter:()=>tr(Qe),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Nn===Qe?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:Ot.name||Qe},Qe))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[Nn&&((ut=gr[Nn])==null?void 0:ut.models.filter(Qe=>Qe.type==="Chat").map(Qe=>{var Ot;return s.jsxs("button",{onClick:()=>{Le(n.id,{chatModel:Qe.id}),fp(Qe.id);try{localStorage.setItem("tapnow_last_extract_model",Qe.id)}catch{}nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((Ot=n.settings)==null?void 0:Ot.chatModel)===Qe.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:Qe.displayName||Qe.modelName||Qe.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(Qe.id)}`})]},Qe.id)})),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),s.jsx("select",{value:((vn=n.settings)==null?void 0:vn.style)||"none",onChange:Qe=>{var We;const Ot=Qe.target.value,Lt=W1(Ot),O=((We=n.settings)==null?void 0:We.prompt)||Ht,Pe=O.includes("")?O.replace(/^[^]+/,`${Lt}`):`${Lt}${O}`;Le(n.id,{style:Ot,prompt:Pe})},className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Qe=>Qe.stopPropagation(),children:B1.map(Qe=>s.jsx("option",{value:Qe.value,children:Qe.label},Qe.value))})]}),s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),s.jsx("div",{className:`rounded-lg border-2 border-dashed p-2 transition-colors drop-zone ${e==="dark"?"border-zinc-700 bg-zinc-800/60":"border-zinc-300 bg-white"}`,onDrop:Qe=>T1(n.id,Qe),onDragOver:kp,onDragLeave:zp,onMouseDown:Qe=>Qe.stopPropagation(),children:((pn=(qt=n.settings)==null?void 0:qt.referenceImages)==null?void 0:pn.length)>0?s.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[n.settings.referenceImages.map((Qe,Ot)=>s.jsxs("div",{className:"relative aspect-square rounded overflow-hidden",children:[s.jsx(Yn,{src:Qe,className:"w-full h-full object-cover"}),s.jsx("button",{onClick:Lt=>{Lt.stopPropagation();const O=[...n.settings.referenceImages];O.splice(Ot,1),Le(n.id,{referenceImages:O})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500",title:"",children:s.jsx(cs,{size:10})})]},`${n.id}-ref-${Ot}`)),s.jsxs("label",{className:"aspect-square rounded border border-dashed border-zinc-500/60 flex items-center justify-center text-[10px] text-zinc-400 cursor-pointer hover:border-blue-400 hover:text-blue-400",children:["+ ",s.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:Qe=>nm(n.id,Qe)})]})]}):s.jsxs("label",{className:"flex flex-col items-center justify-center gap-1 text-[10px] text-zinc-500 cursor-pointer",children:[s.jsx(Xi,{size:16}),"",s.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:Qe=>nm(n.id,Qe)})]})})]})]})]})})()}),(n.type==="generate-character-video"||n.type==="generate-scene-video")&&s.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var vn,qt,pn,Qe,Ot,Lt,O,Pe,We,Ge,ze,he;const B=n.type==="generate-character-video",pe=B?"character-description":"scene-description",Ue=B?"generate-character-image":"generate-scene-image",ot=p.filter(ge=>ge.to===n.id).map(ge=>Dt.get(ge.from)).find(ge=>(ge==null?void 0:ge.type)===pe),kt=p.filter(ge=>ge.to===n.id).map(ge=>Dt.get(ge.from)).find(ge=>(ge==null?void 0:ge.type)===Ue),Ht=Pt.find(ge=>ge.sourceNodeId===n.id&&ge.status==="completed"),vt=Pt.find(ge=>ge.sourceNodeId===n.id&&ge.status==="generating"),Vt=Pt.find(ge=>ge.sourceNodeId===n.id&&ge.status==="failed"),pt=Rn(Ht),ft=kt?Pt.find(ge=>ge.sourceNodeId===kt.id&&ge.status==="completed"):null,wt=(vn=ft==null?void 0:ft.output_images)!=null&&vn.length?ft.output_images:(qt=ft==null?void 0:ft.mjImages)!=null&&qt.length?ft.mjImages:[],at=Rn(ft),At=wt.length>0?wt:at?[at]:[],Wt=(pn=kt==null?void 0:kt.settings)==null?void 0:pn.selectedImageIndex,Bt=Wt!=null&&At[Wt]?At[Wt]:null,zt=((Qe=n.settings)==null?void 0:Qe.videoPrompt)||((Ot=ot==null?void 0:ot.settings)==null?void 0:Ot.prompt)||"",yn=Mh[n.id]||0,Tn=Ht!=null&&Ht.durationMs?(Ht.durationMs/1e3).toFixed(1):null,q=!!vt,re=wo||((Lt=ue.find(ge=>ge.type==="Video"&&(ge.id==="sora-2"||ge.id==="sora-2-pro")))==null?void 0:Lt.id)||((O=ue.find(ge=>ge.type==="Video"))==null?void 0:O.id)||"",Ie=((Pe=n.settings)==null?void 0:Pe.model)||re,lt=cu(Ie),ie=(We=n.settings)==null?void 0:We.duration,Te=lt.includes(ie)?ie:lt[0]||"5s";lt.length>0&&ie&&!lt.includes(ie)&&setTimeout(()=>{Le(n.id,{duration:lt[0]||"5s"})},0);const yt=Wz,sn=Yl(((Ge=n.settings)==null?void 0:Ge.resolution)||da||"720P"),ut=yt.includes(sn)?sn:"720P";return ut!==sn&&setTimeout(()=>{Le(n.id,{resolution:ut})},0),s.jsxs(s.Fragment,{children:[(q||Tn)&&s.jsx("div",{className:`m-3 mb-0 px-2 py-1 rounded text-[10px] font-mono text-center ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:q?s.jsxs("span",{children:["? ",yn.toFixed(1),"s"]}):s.jsxs("span",{children:["?  ",Tn,"s"]})}),s.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.jsx(gz,{size:12,className:"text-green-500"}),s.jsx("span",{children:B?"":""})]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto min-h-0",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:ge=>{ge.stopPropagation(),nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="role-video-model"?null:{nodeId:n.id,type:"role-video-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:ge=>ge.stopPropagation(),children:[s.jsx("span",{className:"truncate font-mono",children:Xc(Ie)}),s.jsx(zs,{size:12,className:"opacity-50 shrink-0"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="role-video-model"&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:ge=>ge.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,ge])=>ge.models.some(et=>et.type==="Video")).map(([ge,et])=>s.jsx("button",{onMouseEnter:()=>tr(ge),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Nn===ge?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:et.name||ge},ge))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[Nn&&((ze=gr[Nn])==null?void 0:ze.models.filter(ge=>ge.type==="Video").map(ge=>{var et;return s.jsxs("button",{onClick:()=>{Le(n.id,{model:ge.id}),pp(ge.id);try{localStorage.setItem("tapnow_last_video_model",ge.id)}catch{}nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((et=n.settings)==null?void 0:et.model)===ge.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:ge.displayName||ge.modelName||ge.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(ge.id)}`})]},ge.id)})),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsx("select",{value:Te,onChange:ge=>Le(n.id,{duration:ge.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:ge=>ge.stopPropagation(),children:(lt.length>0?lt:["5s","10s","15s"]).map(ge=>s.jsx("option",{value:ge,children:ge},ge))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("select",{value:((he=n.settings)==null?void 0:he.ratio)||"16:9",onChange:ge=>Le(n.id,{ratio:ge.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:ge=>ge.stopPropagation(),children:[s.jsx("option",{value:"16:9",children:"16:9"}),s.jsx("option",{value:"9:16",children:"9:16"}),s.jsx("option",{value:"1:1",children:"1:1"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsx("select",{value:ut,onChange:ge=>{const et=ge.target.value;if(Le(n.id,{resolution:et}),et!=="Auto"){Th(et);try{localStorage.setItem("tapnow_last_video_res",et)}catch{}}},className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:ge=>ge.stopPropagation(),children:yt.map(ge=>s.jsx("option",{value:ge,children:ge==="Auto"?"":ge},ge))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsx("textarea",{value:zt,onChange:ge=>Le(n.id,{videoPrompt:ge.target.value}),placeholder:"...",className:`w-full h-20 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:ge=>ge.stopPropagation()})]}),pt?s.jsx("div",{className:"relative w-full aspect-video bg-black rounded-lg overflow-hidden cursor-pointer",onDoubleClick:ge=>{ge.preventDefault(),ge.stopPropagation(),$n({id:`preview-video-${n.id}`,url:pt,type:"video"}),setLightboxOpen(!0)},onContextMenu:ge=>{ge.preventDefault(),ge.stopPropagation();const et=xn(ge.clientX,ge.clientY);Lr("video-input",et.x,et.y,null,pt,{w:400,h:300})},onMouseDown:ge=>ge.stopPropagation(),children:s.jsx("video",{src:pt,controls:!0,className:"w-full h-full object-contain",onMouseDown:ge=>ge.stopPropagation()})}):s.jsx("div",{className:`w-full aspect-video rounded border-2 border-dashed flex items-center justify-center ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:s.jsx("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""})}),vt&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-[10px] mb-1 text-zinc-500",children:"..."}),s.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${vt.progress||0}%`}})}),s.jsxs("div",{className:"text-[10px] text-zinc-500 mt-1",children:[vt.progress||0,"%"]})]}),(Vt==null?void 0:Vt.errorMsg)&&s.jsx("div",{className:"text-[10px] text-red-500",children:Vt.errorMsg})]}),s.jsx("div",{className:"px-3 py-2 border-t shrink-0",children:s.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${vt?"bg-zinc-400 cursor-not-allowed text-white":e==="dark"?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white":"bg-green-600 hover:bg-green-500 text-white"}`,disabled:!!vt,onMouseDown:ge=>ge.stopPropagation(),onClick:()=>{var Ve,nt,Q;const ge=zt,et=((Ve=n.settings)==null?void 0:Ve.referenceImages)||((nt=ot==null?void 0:ot.settings)==null?void 0:nt.referenceImages)||[],st=Bt?[Bt]:et;if(!ge&&st.length===0){alert("");return}if(!Ie){alert("");return}No(ge||"","video",st,n.id,{model:Ie,ratio:((Q=n.settings)==null?void 0:Q.ratio)||"16:9",duration:Te,resolution:ut})},children:vt?"...":""})})]})})()}),(n.type==="generate-character-image"||n.type==="generate-scene-image")&&s.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var ft,wt,at,At,Wt,Bt,zt,yn,Tn;const B=n.type==="generate-scene-image",pe=Pt.find(q=>q.sourceNodeId===n.id&&q.status==="completed"),Ue=Pt.find(q=>q.sourceNodeId===n.id&&q.status==="generating"),ot=Pt.find(q=>q.sourceNodeId===n.id&&q.status==="failed"),kt=Rn(pe),Ht=(ft=pe==null?void 0:pe.output_images)!=null&&ft.length?pe.output_images:(wt=pe==null?void 0:pe.mjImages)!=null&&wt.length?pe.mjImages:kt?[kt]:[],vt=((at=n.settings)==null?void 0:at.selectedImageIndex)??null,Vt=Ui||((At=ue.find(q=>q.type==="Image"))==null?void 0:At.id)||"",pt=((Wt=n.settings)==null?void 0:Wt.model)||Vt;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.jsx(ls,{size:12,className:"text-blue-500"}),s.jsx("span",{children:B?"":""})]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto min-h-0",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:q=>{q.stopPropagation(),nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="role-image-model"?null:{nodeId:n.id,type:"role-image-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:q=>q.stopPropagation(),children:[s.jsx("span",{className:"truncate font-mono",children:Xc(pt)}),s.jsx(zs,{size:12,className:"opacity-50 shrink-0"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="role-image-model"&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:q=>q.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,q])=>q.models.some(re=>re.type==="Image")).map(([q,re])=>s.jsx("button",{onMouseEnter:()=>tr(q),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Nn===q?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:re.name||q},q))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[Nn&&((Bt=gr[Nn])==null?void 0:Bt.models.filter(q=>q.type==="Image").map(q=>{var re;return s.jsxs("button",{onClick:()=>{Le(n.id,{model:q.id}),dp(q.id);try{localStorage.setItem("tapnow_last_image_model",q.id)}catch{}nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((re=n.settings)==null?void 0:re.model)===q.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:q.displayName||q.modelName||q.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(q.id)}`})]},q.id)})),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("select",{value:((zt=n.settings)==null?void 0:zt.ratio)||"16:9",onChange:q=>Le(n.id,{ratio:q.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:q=>q.stopPropagation(),children:[s.jsx("option",{value:"16:9",children:"16:9"}),s.jsx("option",{value:"9:16",children:"9:16"}),s.jsx("option",{value:"1:1",children:"1:1"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("select",{value:((yn=n.settings)==null?void 0:yn.resolution)||"2K",onChange:q=>Le(n.id,{resolution:q.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:q=>q.stopPropagation(),children:[s.jsx("option",{value:"1K",children:"1K"}),s.jsx("option",{value:"2K",children:"2K"}),s.jsx("option",{value:"4K",children:"4K"}),s.jsx("option",{value:"Auto",children:"Auto"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsx("textarea",{value:((Tn=n.settings)==null?void 0:Tn.prompt)||"",onChange:q=>Le(n.id,{prompt:q.target.value}),placeholder:"...",className:`w-full h-20 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:q=>q.stopPropagation()})]}),Ht.length>0?s.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ht.map((q,re)=>s.jsxs("div",{className:`relative aspect-square bg-black rounded-lg overflow-hidden cursor-pointer transition-all ${vt===re?"ring-2 ring-blue-500 ring-offset-2":"hover:ring-1 hover:ring-zinc-400"}`,onClick:Ie=>{Ie.stopPropagation();const lt=vt===re?null:re;Le(n.id,{selectedImageIndex:lt})},onDoubleClick:Ie=>{Ie.preventDefault(),Ie.stopPropagation(),$n({id:`preview-${n.id}-${re}`,url:q,type:"image",mjImages:Ht,selectedMjImageIndex:re}),setLightboxOpen(!0)},onContextMenu:Ie=>{Ie.preventDefault(),Ie.stopPropagation();const lt=xn(Ie.clientX,Ie.clientY);Lr("input-image",lt.x,lt.y,null,q,{w:400,h:300})},onMouseDown:Ie=>Ie.stopPropagation(),children:[s.jsx(Yn,{src:q,className:"w-full h-full object-contain"}),s.jsxs("div",{className:"absolute top-1 left-1 bg-black/50 text-white text-[10px] px-1 py-0.5 rounded",children:[re+1,"/",Ht.length]}),vt===re&&s.jsx("div",{className:"absolute top-1 right-1 bg-blue-500 text-white text-[10px] px-1 py-0.5 rounded",children:""})]},`${q}-${re}`))}):s.jsx("div",{className:`w-full h-28 rounded border-2 border-dashed flex items-center justify-center ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:s.jsx("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""})}),Ue&&s.jsxs("div",{className:"mb-2",children:[s.jsx("div",{className:"text-[10px] mb-1 text-zinc-500",children:"..."}),s.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${Ue.progress||0}%`}})}),s.jsxs("div",{className:"text-[10px] text-zinc-500 mt-1",children:[Ue.progress||0,"%"]})]}),(ot==null?void 0:ot.errorMsg)&&s.jsx("div",{className:"text-[10px] text-red-500",children:ot.errorMsg})]}),s.jsx("div",{className:"px-3 py-2 border-t shrink-0",children:s.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${Ue?"bg-zinc-400 cursor-not-allowed text-white":e==="dark"?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,disabled:!!Ue,onMouseDown:q=>q.stopPropagation(),onClick:()=>{var Ie,lt,ie,Te,yt,sn,ut;const q=((Ie=n.settings)==null?void 0:Ie.prompt)||"",re=((lt=n.settings)==null?void 0:lt.model)||Ui||((ie=ue.find(vn=>vn.type==="Image"))==null?void 0:ie.id)||"";if(!q&&(!((Te=n.settings)!=null&&Te.referenceImages)||n.settings.referenceImages.length===0)){alert("");return}if(!re){alert("");return}No(q,"image",((yt=n.settings)==null?void 0:yt.referenceImages)||[],n.id,{model:re,ratio:((sn=n.settings)==null?void 0:sn.ratio)||"16:9",resolution:((ut=n.settings)==null?void 0:ut.resolution)||ko||"2K"})},children:Ue?"...":""})})]})})()}),(n.type==="create-character"||n.type==="create-scene")&&s.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var kt,Ht,vt,Vt,pt,ft,wt,at,At;const B=n.type==="create-character",pe=B?"":"",Ue=Number.isFinite((kt=n.settings)==null?void 0:kt.startSecond)?n.settings.startSecond:1,ot=Number.isFinite((Ht=n.settings)==null?void 0:Ht.endSecond)?n.settings.endSecond:3;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.jsx(cf,{size:12,className:B?"text-blue-500":"text-green-500"}),s.jsx("span",{children:pe})]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto min-h-0",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:B?"":""}),s.jsx("input",{type:"text",value:((vt=n.settings)==null?void 0:vt.name)||"",onChange:Wt=>Le(n.id,{name:Wt.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,placeholder:B?"...":"...",onMouseDown:Wt=>Wt.stopPropagation()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:" 1-3 "}),s.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[s.jsx("input",{type:"number",min:"0",step:"0.1",value:Ue,onChange:Wt=>Le(n.id,{startSecond:parseFloat(Wt.target.value)||0}),className:`w-20 px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Wt=>Wt.stopPropagation()}),s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),s.jsx("input",{type:"number",min:"0",step:"0.1",value:ot,onChange:Wt=>Le(n.id,{endSecond:parseFloat(Wt.target.value)||0}),className:`w-20 px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Wt=>Wt.stopPropagation()}),s.jsxs("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[": ",(ot-Ue).toFixed(1),"s"]})]})]})]}),((Vt=n.settings)==null?void 0:Vt.isCreating)&&s.jsxs("div",{className:"px-3 py-2 border-t shrink-0",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("span",{className:"text-[10px] text-zinc-500",children:[pe,"..."]}),s.jsxs("span",{className:"text-[10px] text-zinc-500",children:[((pt=n.settings)==null?void 0:pt.createProgress)||0,"%"]})]}),s.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${((ft=n.settings)==null?void 0:ft.createProgress)||0}%`}})})]})}),((wt=n.settings)==null?void 0:wt.createError)&&s.jsx("div",{className:"text-[10px] text-red-500 mt-1",children:n.settings.createError})]}),s.jsx("div",{className:"px-3 py-2 border-t shrink-0",children:s.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${(at=n.settings)!=null&&at.isCreating?"bg-zinc-400 cursor-not-allowed text-white":e==="dark"?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,onMouseDown:Wt=>Wt.stopPropagation(),type:"button",disabled:(At=n.settings)==null?void 0:At.isCreating,onClick:async()=>{var lt,ie;const Wt=((lt=n.settings)==null?void 0:lt.name)||"";if(!Wt||Wt.trim().length===0){alert(`${B?"":""}`);return}const Bt=Ue??1,zt=ot??3;if(zt-Bt<1||zt-Bt>3){alert(" 1-3 ");return}const yn=B?"generate-character-video":"generate-scene-video",Tn=p.filter(Te=>Te.to===n.id).map(Te=>Dt.get(Te.from)).find(Te=>(Te==null?void 0:Te.type)===yn);if(!Tn){alert("");return}const q=Pt.find(Te=>Te.sourceNodeId===Tn.id&&Te.status==="completed"),re=(q==null?void 0:q.localCacheUrl)||(q==null?void 0:q.url)||(q==null?void 0:q.originalUrl)||Tn.content||"";if(!re){alert("URL");return}const Ie=(q==null?void 0:q.remoteTaskId)||null;Le(n.id,{isCreating:!0,createProgress:10,createError:null});try{const Te=ue.find(O=>O.type==="Video"&&(O.id==="sora-2"||O.id==="sora-2-pro"));if(!Te){Le(n.id,{isCreating:!1,createError:" Sora 2 "}),alert(" Sora 2  Sora 2  Sora 2 Pro");return}const yt=as(Te.id),sn=yt.key;if(!sn){Le(n.id,{isCreating:!1,createError:" API Key"}),alert(" API Key"),ss(!0);return}Le(n.id,{createProgress:40});const ut=(yt.url||zr).replace(/\/+$/,""),vn=sl&&sl.trim()?sl.trim():`${ut}/sora/v1/characters`,qt=`${Bt},${zt}`,pn=Ie?{from_task:Ie,timestamps:qt}:{url:re,timestamps:qt};Le(n.id,{createProgress:70});const Qe=await fetch(vn,{method:"POST",headers:{Authorization:`Bearer ${sn}`,"Content-Type":"application/json"},body:JSON.stringify(pn)});if(Le(n.id,{createProgress:90}),!Qe.ok){const O=await Qe.text();let Pe=null;try{Pe=JSON.parse(O)}catch{}throw Qe.status===500||Pe&&(Pe.code==="get_origin_task_failed"||(ie=Pe.message)!=null&&ie.includes("get_origin_task_failed"))?new Error("TASK_NOT_FOUND"):new Error(`API (${Qe.status}): ${O||Qe.statusText}`)}const Ot=await Qe.json();if(!(Ot!=null&&Ot.id)||!(Ot!=null&&Ot.username))throw new Error(" id  username");const Lt={id:Ot.id,username:Ot.username,profile_picture_url:Ot.profile_picture_url||"",permalink:Ot.permalink||""};sa(O=>[...O,Lt]),setTimeout(()=>{Le(n.id,{isCreating:!1,createProgress:0,createError:null,characterId:Ot.id,characterUsername:Ot.username}),alert(`${B?"":""} "${Ot.username}" `)},300)}catch(Te){let yt=Te.message||"";yt==="TASK_NOT_FOUND"?yt="":(yt.includes("Failed to fetch")||Te.name==="TypeError"||Te.message.includes("NetworkError"))&&(yt=`

1. API 
   -  API  "/sora" 
   -  Sora 

2.  (CORS)
   -  Allow CORS 

3. 
   - `),Le(n.id,{isCreating:!1,createProgress:0,createError:yt}),alert(`${B?"":""}: ${yt}`)}},children:B?"":""})})]})})()}),n.type==="local-save"&&(()=>{var Ht,vt,Vt,pt,ft,wt,at,At,Wt,Bt;const B=mp(n.id),pe=B.length,Ue=!!((Ht=n.settings)!=null&&Ht.isSaving),kt=(((vt=n.settings)==null?void 0:vt.serverUrl)||"").trim()?((Vt=n.settings)==null?void 0:Vt.serverStatus)==="connected":fn;return s.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[s.jsx(xz,{size:12,className:"text-green-500"}),s.jsx("span",{children:""})]}),s.jsx("div",{className:`w-2 h-2 rounded-full ${kt?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500"}`,title:kt?"":""})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar flex flex-col gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:((pt=n.settings)==null?void 0:pt.serverUrl)??"",onChange:zt=>Le(n.id,{serverUrl:zt.target.value}),placeholder:In||"http://127.0.0.1:9527",className:`flex-1 text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:zt=>zt.stopPropagation()}),s.jsx("button",{className:`px-2 py-1 text-[10px] rounded border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-blue-500":"bg-white border-zinc-300 text-zinc-700 hover:border-blue-500"}`,onMouseDown:zt=>zt.stopPropagation(),onClick:()=>{var zt;return x1(n.id,((zt=n.settings)==null?void 0:zt.serverUrl)||"")},children:""})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),s.jsx("input",{type:"text",value:((ft=n.settings)==null?void 0:ft.subfolder)||"",onChange:zt=>Le(n.id,{subfolder:zt.target.value}),placeholder:"v1_characters",className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:zt=>zt.stopPropagation()})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-[10px] font-medium opacity-70",children:" ()"}),s.jsx("button",{className:`w-10 h-5 rounded-full relative transition-colors ${(wt=n.settings)!=null&&wt.autoSave?"bg-green-600":"bg-zinc-600"}`,onClick:()=>{var zt;return Le(n.id,{autoSave:!((zt=n.settings)!=null&&zt.autoSave)})},onMouseDown:zt=>zt.stopPropagation(),children:s.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white transition-all ${(at=n.settings)!=null&&at.autoSave?"left-6":"left-1"}`})})]}),s.jsxs("div",{className:"flex items-center justify-between text-[10px] text-zinc-500 mt-1",children:[s.jsx("span",{children:""}),s.jsx("span",{children:pe})]}),pe>0?s.jsx("div",{className:"grid grid-cols-4 gap-2",children:B.slice(0,4).map((zt,yn)=>{const Tn=zt.type==="video"||Hn(zt.url)||zt.url.startsWith("data:video");return s.jsx("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-black/40 border border-zinc-700/40",children:Tn?s.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-zinc-300",children:s.jsx(Ru,{size:14,className:"text-purple-300"})}):s.jsx(Yn,{src:zt.url,className:"w-full h-full object-cover"})},`${zt.url}-${yn}`)})}):s.jsx("div",{className:"text-[10px] text-zinc-500",children:""}),s.jsxs("div",{className:"mt-auto border-t pt-2 border-zinc-700/50",children:[s.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between",children:[s.jsx("span",{children:":"}),s.jsx("span",{children:(At=n.settings)!=null&&At.lastSaved?n.settings.lastSaved.split(" ")[1]:""})]}),s.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between mt-1",children:[s.jsx("span",{children:":"}),s.jsxs("span",{children:[((Bt=(Wt=n.settings)==null?void 0:Wt.savedFiles)==null?void 0:Bt.length)||0," "]})]})]}),s.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${Ue?"bg-zinc-600 cursor-not-allowed text-white":"bg-green-600 hover:bg-green-500 text-white"}`,disabled:Ue||pe===0,onMouseDown:zt=>zt.stopPropagation(),onClick:async()=>{if(pe===0){o("","warning");return}Le(n.id,{isSaving:!0});try{await gp(n,B)}catch(zt){o(`: ${zt.message||""}`,"error")}finally{Le(n.id,{isSaving:!1})}},children:Ue?"...":""})]})]})})(),n.type==="input-image"&&s.jsx("div",{className:`relative w-full h-full flex flex-col items-center justify-center transition-colors pointer-events-auto drop-zone ${e==="dark"?"bg-zinc-900 group-hover:bg-zinc-800":"bg-zinc-100 group-hover:bg-zinc-200"}`,onDrop:B=>M1(n.id,B),onDragOver:kp,onDragLeave:zp,onContextMenu:B=>jv(B,n.id),children:n.content?s.jsxs("div",{className:"relative w-full h-full",children:[Hn(n.content)?s.jsx("video",{src:n.content,controls:!0,className:"w-full h-full object-contain bg-black/50",draggable:!1,style:{imageRendering:$t.zoom>=1?"auto":"crisp-edges",WebkitFontSmoothing:"antialiased",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}}):s.jsx("img",{src:n.content,className:"w-full h-full object-contain bg-black/50",draggable:!1,loading:"lazy",style:{imageRendering:$t.zoom>=1?"auto":"crisp-edges",WebkitFontSmoothing:"antialiased",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}}),n.dimensions&&s.jsxs("div",{className:`absolute bottom-2 right-2 text-[10px] px-1.5 py-0.5 rounded backdrop-blur-sm border ${e==="dark"?"bg-black/70 text-white border-white/10":"bg-white/80 text-zinc-800 border-zinc-200"}`,children:[n.dimensions.w,"x",n.dimensions.h]}),!n.isMasking&&s.jsxs("div",{className:"absolute inset-0 bg-black/40 transition-opacity gap-2 opacity-0 group-hover:opacity-100 flex flex-col items-center justify-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:`cursor-pointer px-3 py-1.5 rounded-lg text-xs backdrop-blur-sm border transition-colors ${e==="dark"?"bg-white/10 hover:bg-white/20 text-white border-white/10":"bg-white hover:bg-zinc-100 text-zinc-800 border-zinc-300"}`,onMouseDown:B=>B.stopPropagation(),children:[" ",s.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:B=>dm(n.id,B)})]}),!Hn(n.content)&&s.jsxs("button",{onClick:B=>{B.stopPropagation(),c(pe=>pe.map(Ue=>Ue.id===n.id?{...Ue,isMasking:!Ue.isMasking}:Ue))},className:`px-3 py-1.5 rounded-lg text-xs backdrop-blur-sm border transition-colors flex items-center gap-1 ${e==="dark"?n.isMasking?"bg-red-500/80 hover:bg-red-500 text-white border-red-400":"bg-white/10 hover:bg-white/20 text-white border-white/10":n.isMasking?"bg-red-500 hover:bg-red-600 text-white border-red-400":"bg-white hover:bg-zinc-100 text-zinc-800 border-zinc-300"}`,onMouseDown:B=>B.stopPropagation(),children:[s.jsx(cz,{size:12}),""]})]}),s.jsxs("div",{className:`text-[10px] text-center px-2 ${e==="dark"?"text-zinc-300":"text-zinc-500"}`,children:["",s.jsx("br",{})," Ctrl+V "]})]}),!n.isMasking&&n.maskContent&&s.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",style:{background:"rgba(255, 0, 0, 0.3)",mixBlendMode:"multiply",WebkitMaskImage:`url(${n.maskContent})`,maskImage:`url(${n.maskContent})`,WebkitMaskSize:"100% 100%",maskSize:"100% 100%",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}}),n.isMasking&&!Hn(n.content)&&s.jsx(Dz,{nodeId:n.id,imageUrl:n.content,imageDimensions:n.dimensions,isActive:n.isMasking,onClose:()=>{c(B=>B.map(pe=>pe.id===n.id?{...pe,isMasking:!1}:pe))},onSave:B=>{},onUpdateNode:(B,pe)=>{c(Ue=>Ue.map(ot=>ot.id===B?{...ot,...pe}:ot))},theme:e,view:$t,maskContent:n.maskContent})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full",children:[s.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center mb-3 border ${e==="dark"?"bg-zinc-800 border-zinc-700/50":"bg-zinc-100 border-zinc-300"}`,children:s.jsx(ya,{className:`w-6 h-6 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`})}),s.jsxs("label",{className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-xs font-medium transition-colors cursor-pointer pointer-events-auto",onMouseDown:B=>B.stopPropagation(),children:["",s.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:B=>dm(n.id,B)})]}),s.jsxs("div",{className:"text-[10px] text-center mt-2 pointer-events-none text-zinc-500",children:["",s.jsx("br",{})," Ctrl+V "]})]})}),n.type==="video-input"&&s.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto drop-zone video-input-container ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,onDragOver:kp,onDragLeave:zp,children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Ru,{size:13,className:"text-blue-500"}),s.jsx("span",{children:" / "}),s.jsx("button",{onClick:B=>{var At;B.stopPropagation();const pe=((At=n.settings)==null?void 0:At.videoExpanded)===!1,Ue=(n.frames||[]).length,ot=pe?Math.max(1,Math.floor(n.width/290)):1,kt=Math.max(1,Math.ceil(Ue/ot)),Ht=72,vt=pe?n.content?230:190:0,Vt=n.content&&pe?48:0,pt=36,ft=30,wt=pe?158:106,at=Ht+vt+Vt+pt+kt*wt+ft;c(Wt=>Wt.map(Bt=>Bt.id===n.id?{...Bt,height:Math.max(pe?500:220,at),settings:{...Bt.settings,videoExpanded:pe}}:Bt))},className:`p-1 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded transition-colors ml-1 ${((Oe=n.settings)==null?void 0:Oe.videoExpanded)===!1?"bg-zinc-200 dark:bg-zinc-700":""}`,title:((He=n.settings)==null?void 0:He.videoExpanded)===!1?"":"",children:((gt=n.settings)==null?void 0:gt.videoExpanded)===!1?s.jsx(zs,{size:12}):s.jsx(of,{size:12})})]}),s.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-500",children:[(xt=n.videoMeta)!=null&&xt.duration?s.jsxs("span",{children:[" ",n.videoMeta.duration.toFixed(1),"s"]}):null,(Ct=n.videoMeta)!=null&&Ct.w?s.jsxs("span",{children:[n.videoMeta.w,"x",n.videoMeta.h]}):null,(bt=n.selectedKeyframes)!=null&&bt.length?s.jsxs("span",{className:"text-blue-500",children:[" ",n.selectedKeyframes.length," "]}):null]})]}),s.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-hidden min-h-0",children:[n.content?s.jsxs("div",{className:"space-y-2",children:[((Jt=n.settings)==null?void 0:Jt.videoExpanded)!==!1&&s.jsx("div",{className:"relative w-full max-w-[360px] aspect-video bg-black rounded-lg overflow-hidden flex items-center justify-center mx-auto",onDrop:B=>pm(n.id,B),children:s.jsx("video",{src:n.content,controls:!0,className:"w-full h-full object-contain",draggable:!1})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("label",{className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded text-xs font-medium transition-colors cursor-pointer",onMouseDown:B=>B.stopPropagation(),children:["",s.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:B=>{var pe;return fl(n.id,(pe=B.target.files)==null?void 0:pe[0])}})]}),s.jsx("button",{className:`px-3 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"border-zinc-700 bg-zinc-800 text-zinc-300 hover:border-blue-500 hover:text-blue-400":"border-zinc-300 hover:border-blue-500 hover:text-blue-600"}`,onMouseDown:B=>B.stopPropagation(),onClick:()=>uv(n.id,2),children:s.jsx("span",{className:"whitespace-nowrap",children:"2fps"})}),s.jsx("button",{className:`px-3 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-green-600/40 border-green-500 text-green-200 hover:bg-green-600/60 hover:border-green-400":"bg-green-50 border-green-300 hover:border-green-500 hover:text-green-600"}`,onMouseDown:B=>B.stopPropagation(),onClick:()=>dv(n.id,30),children:s.jsx("span",{className:"whitespace-nowrap",children:""})}),n.extractingFrames&&s.jsx("span",{className:"text-[11px] text-blue-500",children:"..."})]})]}):((Kt=n.settings)==null?void 0:Kt.videoExpanded)!==!1&&s.jsx("div",{className:"flex flex-col items-center justify-center gap-3 w-full px-4 mx-auto shrink-0 transition-colors border-2 border-transparent hover:border-blue-500/30 rounded-lg p-4",onDrop:B=>pm(n.id,B),children:s.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center shrink-0 w-full",children:[s.jsx("div",{className:`relative w-full h-64 flex flex-col items-center justify-center border-2 border-dashed rounded-lg transition-colors ${W===n.id&&!D?"border-blue-500 bg-blue-500/10":e==="dark"?"border-zinc-700 hover:border-zinc-500":"border-zinc-300 hover:border-zinc-400"}`,children:s.jsxs("label",{className:"cursor-pointer flex flex-col items-center justify-center w-full h-full",children:[s.jsx(Tz,{size:48,className:`mb-2 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`}),s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),s.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:B=>{var pe;return fl(n.id,(pe=B.target.files)==null?void 0:pe[0])}})]})}),s.jsx("div",{className:"text-[10px] text-center text-zinc-500 pointer-events-none",children:" MP4/WEBM Ctrl+V "})]})}),s.jsxs("div",{className:"flex items-center justify-between text-[11px] text-zinc-500",children:[s.jsx("span",{children:""}),s.jsxs("div",{className:"flex items-center gap-2 flex-nowrap shrink-0 whitespace-nowrap",children:[s.jsxs("span",{children:[(n.frames||[]).length," "]}),(n.frames||[]).length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{const B=n.frames||[],pe=n.selectedKeyframes||[];let Ue=[];pe.length===0?Ue=B.map(ot=>({url:ot.url,time:ot.time,filename:ot.filename})):Ue=[],c(ot=>ot.map(kt=>kt.id===n.id?{...kt,selectedKeyframes:Ue}:kt))},className:`text-[10px] px-1.5 py-0.5 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-blue-600/30 text-blue-300 hover:bg-blue-600/50":"bg-blue-100 text-blue-600 hover:bg-blue-200"}`,onMouseDown:B=>B.stopPropagation(),title:(n.selectedKeyframes||[]).length>0?"":"",children:[(n.selectedKeyframes||[]).length>0?s.jsx(nx,{size:10}):s.jsx(uz,{size:10}),(n.selectedKeyframes||[]).length>0?"":""]}),s.jsxs("button",{onClick:()=>{confirm("")&&c(B=>B.map(pe=>pe.id===n.id?{...pe,frames:[],selectedKeyframes:[]}:pe))},className:`text-[10px] px-1.5 py-0.5 rounded transition-colors flex items-center gap-1 flex-nowrap ${e==="dark"?"bg-red-600/30 text-red-300 hover:bg-red-600/50":"bg-red-100 text-red-600 hover:bg-red-200"}`,onMouseDown:B=>B.stopPropagation(),title:"",children:[s.jsx(Fr,{size:10}),""]})]})]})]}),s.jsx("div",{className:"grid gap-3 w-full overflow-y-auto custom-scrollbar flex-1 min-h-0 relative p-1 content-start items-start",style:{gridTemplateColumns:((Zt=n.settings)==null?void 0:Zt.videoExpanded)===!1?"1fr":"repeat(auto-fill, minmax(260px, 1fr))",gridAutoRows:"auto"},onDrop:B=>lv(n.id,B),onDragOver:B=>av(B,n.id,(n.frames||[]).length),onDragLeave:B=>{B.currentTarget.contains(B.relatedTarget)||(b(null),P(null))},children:(n.frames||[]).length===0?s.jsxs("div",{className:`col-span-full text-[11px] text-zinc-500 text-center py-4 border rounded ${e==="dark"?"bg-zinc-800/40 border-zinc-700":"bg-white/40 border-zinc-300"}`,children:["",s.jsx("div",{className:"mt-1 opacity-50 text-[9px]",children:""})]}):(n.frames||[]).map((B,pe)=>{var Ht;const Ue=(n.selectedKeyframes||[]).some(vt=>vt.url===B.url&&vt.time===B.time),ot=D===n.id&&z===pe,kt=D===n.id&&z===(n.frames||[]).length&&pe===(n.frames||[]).length-1;return s.jsxs("div",{className:"relative",children:[ot&&s.jsx("div",{className:"absolute -top-1.5 left-0 right-0 h-1 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)] z-50"}),s.jsxs("button",{className:`relative w-full rounded overflow-hidden group transition-all ${Ue?"ring-2 ring-blue-500 border-2 border-blue-500 bg-blue-900/30":e==="dark"?"border border-zinc-700 hover:border-zinc-500":"border border-zinc-300 hover:border-zinc-400"}`,onMouseDown:vt=>vt.stopPropagation(),onClick:vt=>pv(n.id,B,pe,vt),onContextMenu:vt=>fv(vt,n.id,B),onDragOver:vt=>ov(vt,n.id,pe),children:[s.jsx(Yn,{src:B.url,className:`w-full bg-black ${((Ht=n.settings)==null?void 0:Ht.videoExpanded)===!1?"h-[90px] object-cover":"aspect-video object-contain max-h-[140px]"}`,alt:`frame-${pe}`}),s.jsxs("div",{className:"absolute left-1 top-1 text-[10px] px-1 py-0.5 rounded bg-black/60 text-white",children:[typeof B.time=="number"?B.time.toFixed(2):B.time,"s"]}),B.filename&&s.jsx("div",{className:"absolute left-0 bottom-0 right-0 bg-black/80 text-white text-[9px] px-1 py-0.5 opacity-0 group-hover:opacity-100 transition-opacity truncate",title:B.filename,children:B.filename}),s.jsxs("div",{className:"absolute top-1 bottom-1 right-1 flex flex-col justify-between items-center z-20 pointer-events-none",children:[s.jsx("div",{className:"pointer-events-auto w-5 h-5 rounded-full border border-white/80 bg-black/40 flex items-center justify-center shrink-0 mb-auto",children:Ue?s.jsx(Vl,{size:12,className:"text-white"}):null}),s.jsx("button",{onClick:vt=>{vt.stopPropagation(),c(Vt=>Vt.map(pt=>{if(pt.id!==n.id)return pt;const ft=(pt.frames||[]).filter((at,At)=>At!==pe),wt=(pt.selectedKeyframes||[]).filter(at=>at.url!==B.url);return{...pt,frames:ft,selectedKeyframes:wt}}))},className:"pointer-events-auto w-5 h-5 rounded bg-red-600/80 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500 my-1 shrink-0",title:"",children:s.jsx(cs,{size:12})}),s.jsxs("div",{className:"pointer-events-auto flex flex-col gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity shrink-0 mt-auto",children:[pe>0&&s.jsx("button",{onClick:vt=>{vt.stopPropagation(),c(Vt=>Vt.map(pt=>{if(pt.id!==n.id)return pt;const ft=[...pt.frames||[]];[ft[pe-1],ft[pe]]=[ft[pe],ft[pe-1]];const wt=[...pt.selectedKeyframes||[]],at=wt.findIndex(At=>At.url===B.url);return at>0&&([wt[at-1],wt[at]]=[wt[at],wt[at-1]]),{...pt,frames:ft,selectedKeyframes:wt}}))},className:"w-5 h-5 rounded bg-black/70 text-white flex items-center justify-center hover:bg-blue-600",title:"",children:s.jsx(of,{size:12})}),pe<(n.frames||[]).length-1&&s.jsx("button",{onClick:vt=>{vt.stopPropagation(),c(Vt=>Vt.map(pt=>{if(pt.id!==n.id)return pt;const ft=[...pt.frames||[]];[ft[pe],ft[pe+1]]=[ft[pe+1],ft[pe]];const wt=[...pt.selectedKeyframes||[]],at=wt.findIndex(At=>At.url===B.url);return at>=0&&at<wt.length-1&&([wt[at],wt[at+1]]=[wt[at+1],wt[at]]),{...pt,frames:ft,selectedKeyframes:wt}}))},className:"w-5 h-5 rounded bg-black/70 text-white flex items-center justify-center hover:bg-blue-600",title:"",children:s.jsx(zs,{size:12})})]})]})]}),kt&&s.jsx("div",{className:"absolute -bottom-1.5 left-0 right-0 h-1 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)] z-50"})]},`${B.url}-${pe}`)})})]})]}),n.type==="text-node"&&s.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[s.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(ls,{size:13,className:"text-blue-500"}),s.jsx("span",{children:""})]})}),s.jsx("div",{className:"flex-1 p-3",children:s.jsx("textarea",{"data-node-type":"text-node","data-node-id":n.id,value:((un=n.settings)==null?void 0:un.text)||"",onChange:B=>{Le(n.id,{text:B.target.value})},placeholder:"...",className:`w-full h-full resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:B=>B.stopPropagation()})})]}),n.type==="video-analyze"&&s.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto video-analyze-container ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,onClick:B=>{const pe=window.getSelection();if(pe&&pe.toString().length>0)return;const Ue=B.target;Ue&&(Ue.tagName==="INPUT"||Ue.tagName==="TEXTAREA"||Ue.tagName==="SELECT"||Ue.tagName==="BUTTON"||Ue.isContentEditable||Ue.closest('input, textarea, select, button, [contenteditable="true"]'))||B.stopPropagation()},children:[s.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(mz,{size:13,className:"text-blue-500"}),s.jsx("span",{children:" / "})]})}),s.jsx("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-hidden min-h-0",children:(()=>{var kt,Ht,vt,Vt,pt,ft,wt,at,At,Wt,Bt,zt,yn,Tn,q,re,Ie,lt;const B=xl(n.id);if(!B)return s.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 gap-2 text-[11px] text-zinc-500",children:[s.jsx(Ol,{size:24,className:"text-zinc-400"}),s.jsx("span",{children:""})]});const pe=B.videoFileName||"",Ue=((kt=B.videoMeta)==null?void 0:kt.duration)||0,ot=B.selectedKeyframes||[];return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:`text-[11px] px-2 py-1.5 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-50 border-zinc-300"}`,children:[s.jsx("div",{className:"flex items-center justify-between mb-1",children:s.jsx("span",{className:"text-zinc-500",children:B.isImageInput?"":""})}),s.jsxs("div",{className:"text-zinc-700 dark:text-zinc-300",children:[s.jsxs("div",{children:[": ",B.isImageInput?"":pe]}),!B.isImageInput&&s.jsxs("div",{children:[": ",Ue.toFixed(1),"s"]}),s.jsxs("div",{children:[": ",ot.length," "]})]})]}),s.jsxs("div",{className:`flex items-center gap-2 p-1 rounded-lg border shadow-inner ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-100 border-zinc-200"}`,children:[s.jsxs("button",{onClick:()=>Le(n.id,{analysisMode:"manual"}),className:`flex-1 py-1 px-2 text-[11px] rounded transition-all flex justify-center items-center gap-1 ${(((Ht=n.settings)==null?void 0:Ht.analysisMode)||"manual")==="manual"?e==="dark"?"bg-zinc-600 shadow-md text-blue-300 font-bold":"bg-white shadow-md text-blue-600 font-bold":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:ie=>ie.stopPropagation(),children:[s.jsx(Kg,{size:12})," "]}),s.jsxs("button",{onClick:()=>Le(n.id,{analysisMode:"auto"}),className:`flex-1 py-1 px-2 text-[11px] rounded transition-all flex justify-center items-center gap-1 ${((vt=n.settings)==null?void 0:vt.analysisMode)==="auto"?e==="dark"?"bg-zinc-600 shadow-md text-purple-300 font-bold":"bg-white shadow-md text-purple-600 font-bold":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:ie=>ie.stopPropagation(),children:[s.jsx(Ll,{size:12})," AI "]})]}),(((Vt=n.settings)==null?void 0:Vt.analysisMode)||"manual")==="manual"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-[11px] text-zinc-500",children:":"}),s.jsx("input",{type:"number",min:"1",max:"30",value:((pt=n.settings)==null?void 0:pt.segmentDuration)||3,onChange:ie=>{const Te=parseInt(ie.target.value)||3;Le(n.id,{segmentDuration:Te}),f1(Te.toString());try{localStorage.setItem("tapnow_last_segment_duration",Te.toString())}catch{}},className:`w-16 px-2 py-1 text-[11px] rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:ie=>ie.stopPropagation()}),s.jsx("span",{className:"text-[11px] text-zinc-500",children:""})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{className:"text-[11px] text-zinc-500",children:":"}),s.jsxs("div",{className:"relative flex-1",children:[s.jsxs("button",{onClick:ie=>{ie.stopPropagation(),nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="analyze-model"?null:{nodeId:n.id,type:"analyze-model"})},className:`w-full flex items-center justify-between px-2 py-1 rounded text-[11px] border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-zinc-50 border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:ie=>ie.stopPropagation(),children:[s.jsx("span",{className:"truncate font-mono",children:((wt=mn.get((ft=n.settings)==null?void 0:ft.model))==null?void 0:wt.id)||((at=n.settings)==null?void 0:at.model)||"gemini-3-pro"}),s.jsx(zs,{size:10,className:"opacity-50 shrink-0 ml-1"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="analyze-model"&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:ie=>ie.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,ie])=>ie.models.some(Te=>Te.type==="Chat")).map(([ie,Te])=>s.jsx("button",{onMouseEnter:()=>tr(ie),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Nn===ie?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:Te.name||ie},ie))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[Nn&&((At=gr[Nn])==null?void 0:At.models.filter(ie=>ie.type==="Chat").map(ie=>{var Te;return s.jsxs("button",{onClick:()=>{Le(n.id,{model:ie.id}),m1(ie.id);try{localStorage.setItem("tapnow_last_analyze_model",ie.id)}catch{}nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((Te=n.settings)==null?void 0:Te.model)===ie.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:ie.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(ie.id)}`})]},ie.id)})),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]})]}),s.jsx("button",{onClick:()=>{var ie;return((ie=n.settings)==null?void 0:ie.analysisMode)==="auto"?ev(n.id):Q1(n.id)},disabled:n.isGenerating||(((Wt=n.settings)==null?void 0:Wt.analysisMode)||"manual")==="manual"&&ot.length===0,className:`w-full px-3 py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-2 ${n.isGenerating?"bg-zinc-600 text-zinc-400 cursor-not-allowed":((Bt=n.settings)==null?void 0:Bt.analysisMode)==="auto"?"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white shadow-lg":"bg-blue-600 hover:bg-blue-500 text-white"}`,onMouseDown:ie=>ie.stopPropagation(),children:n.isGenerating?s.jsxs(s.Fragment,{children:[s.jsx(xi,{size:14,className:"animate-spin"}),s.jsx("span",{children:((zt=n.settings)==null?void 0:zt.analysisMode)==="auto"?"AI ...":"..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ll,{size:14}),s.jsx("span",{children:((yn=n.settings)==null?void 0:yn.analysisMode)==="auto"?"":""})]})}),n.errorMsg&&s.jsx("div",{className:"text-[10px] text-red-500 px-2 py-1 rounded bg-red-500/10",children:n.errorMsg})]}),((Tn=n.settings)==null?void 0:Tn.analysisMode)==="auto"&&((re=(q=n.settings)==null?void 0:q.analysisResults)==null?void 0:re.length)>0&&s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar pt-2",children:[((Ie=n.settings.voiceoverResults)==null?void 0:Ie.length)>0&&s.jsxs("div",{className:`p-2 rounded-lg mb-4 ${e==="dark"?"bg-zinc-700/50 border border-zinc-700":"bg-zinc-50 border border-blue-200"}`,children:[s.jsxs("h4",{className:`text-xs font-semibold mb-2 flex items-center gap-1 ${e==="dark"?"text-white":"text-blue-700"}`,children:[s.jsx(bz,{size:12})," "]}),s.jsx("div",{className:"space-y-1",children:n.settings.voiceoverResults.map((ie,Te)=>s.jsxs("p",{className:`text-[10px] select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:yt=>yt.stopPropagation(),children:[s.jsxs("span",{className:"font-mono text-xs mr-2 opacity-70",children:["[",ie.time_range||`${ie.time}s`,"]"]}),ie.text||s.jsx("span",{className:"text-zinc-400 italic",children:""})]},Te))})]}),s.jsxs("h4",{className:`text-xs font-semibold mb-3 flex items-center gap-1 ${e==="dark"?"text-white":"text-zinc-800"}`,children:[s.jsx(Kg,{size:12}),"  (",n.settings.analysisResults.length," )"]}),s.jsx("div",{className:"space-y-4",children:n.settings.analysisResults.map((ie,Te)=>{var yt,sn,ut,vn,qt,pn,Qe,Ot;return s.jsxs("div",{className:`p-3 rounded-lg ${e==="dark"?"bg-zinc-800 border border-zinc-700":"bg-zinc-50 border border-zinc-200"}`,children:[s.jsxs("h5",{className:`text-sm font-bold mb-2 ${e==="dark"?"text-purple-400":"text-purple-700"}`,children:[" ",ie.scene_index||ie.scene_id||Te+1," ",s.jsxs("span",{className:"text-xs font-normal opacity-70 ml-2",children:["(",ie.time_range,")"]})]}),s.jsxs("div",{className:"text-[11px] space-y-1 mb-3",children:[((sn=(yt=ie.keyframes)==null?void 0:yt[0])==null?void 0:sn.description)&&s.jsxs("p",{className:`select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Lt=>Lt.stopPropagation(),children:[s.jsx("span",{className:"font-semibold mr-1",children:"/:"})," ",ie.keyframes[0].description]}),((vn=(ut=ie.global_tags)==null?void 0:ut.style)==null?void 0:vn[0])&&s.jsxs("p",{className:`select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Lt=>Lt.stopPropagation(),children:[s.jsx("span",{className:"font-semibold mr-1",children:"/:"})," ",ie.global_tags.style[0]]})]}),s.jsxs("div",{className:"space-y-2",children:[((pn=(qt=ie.keyframes)==null?void 0:qt[0])==null?void 0:pn.jimeng_prompt)&&s.jsxs("div",{className:`p-2 rounded ${e==="dark"?"bg-zinc-700 border border-zinc-600":"bg-zinc-50 border border-gray-300"}`,children:[s.jsxs("h6",{className:`text-[10px] font-semibold mb-1 flex items-center gap-1 ${e==="dark"?"text-yellow-300":"text-yellow-700"}`,children:[s.jsx(Xg,{size:10}),"  Prompt"]}),s.jsx("p",{className:`text-[10px] whitespace-pre-wrap select-text cursor-text ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,onMouseDown:Lt=>Lt.stopPropagation(),children:ie.keyframes[0].jimeng_prompt}),s.jsxs("button",{onClick:()=>navigator.clipboard.writeText(ie.keyframes[0].jimeng_prompt),className:"mt-1 flex items-center text-[9px] text-blue-400 hover:text-blue-300",onMouseDown:Lt=>Lt.stopPropagation(),children:[s.jsx(Yg,{size:10,className:"mr-1"})," "]})]}),((Ot=(Qe=ie.keyframes)==null?void 0:Qe[0])==null?void 0:Ot.mj_prompt)&&s.jsxs("div",{className:`p-2 rounded ${e==="dark"?"bg-zinc-700 border border-zinc-600":"bg-zinc-50 border border-gray-300"}`,children:[s.jsxs("h6",{className:`text-[10px] font-semibold mb-1 flex items-center gap-1 ${e==="dark"?"text-green-300":"text-green-700"}`,children:[s.jsx(Xg,{size:10})," MJ Prompt"]}),s.jsx("p",{className:`text-[10px] whitespace-pre-wrap select-text cursor-text ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,onMouseDown:Lt=>Lt.stopPropagation(),children:ie.keyframes[0].mj_prompt}),s.jsxs("button",{onClick:()=>navigator.clipboard.writeText(ie.keyframes[0].mj_prompt),className:"mt-1 flex items-center text-[9px] text-blue-400 hover:text-blue-300",onMouseDown:Lt=>Lt.stopPropagation(),children:[s.jsx(Yg,{size:10,className:"mr-1"})," "]})]})]})]},Te)})})]}),(((lt=n.settings)==null?void 0:lt.analysisMode)||"manual")==="manual"&&n.analysisResults&&n.analysisResults.length>0?s.jsxs("div",{className:"space-y-3 flex-1 flex flex-col min-h-0",children:[s.jsxs("div",{className:"text-[11px] font-medium text-zinc-700 dark:text-zinc-300 shrink-0",children:[" (",n.analysisResults.length," )"]}),s.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto custom-scrollbar min-h-0",children:n.analysisResults.map((ie,Te)=>{var pn,Qe,Ot,Lt,O,Pe,We;const yt=Ge=>{var ge,et;const ze=(ge=B.selectedKeyframes)==null?void 0:ge.find(st=>Math.abs(st.time-Ge)<.1);if(ze)return ze.url;const he=(et=B.frames)==null?void 0:et.find(st=>Math.abs(st.time-Ge)<.1);return(he==null?void 0:he.url)||null},sn=((pn=ie.keyframes)==null?void 0:pn.find(Ge=>Ge.type==="current"))||((Qe=ie.keyframes)==null?void 0:Qe[0]),ut=(Ot=ie.keyframes)==null?void 0:Ot.find(Ge=>Ge.type==="prev"),vn=(Lt=ie.keyframes)==null?void 0:Lt.find(Ge=>Ge.type==="next"),qt=(sn==null?void 0:sn.description)||((Pe=(O=ie.keyframes)==null?void 0:O[0])==null?void 0:Pe.description)||"";return s.jsxs("div",{className:`p-3 rounded-lg border ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-white border-zinc-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"font-medium text-[11px] text-zinc-800 dark:text-zinc-200",children:[" ",ie.scene_index||Te+1]}),s.jsx("div",{className:"text-[10px] text-zinc-500",children:ie.time_range})]}),s.jsx("div",{className:"text-[10px] text-zinc-600 dark:text-zinc-400 mb-3 line-clamp-2 select-text cursor-text",onMouseDown:Ge=>Ge.stopPropagation(),children:qt}),s.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[ut,sn,vn].map((Ge,ze)=>{if(!Ge)return s.jsx("div",{className:"aspect-video bg-zinc-200 dark:bg-zinc-700 rounded"},ze);const he=yt(Ge.time);return s.jsxs("div",{className:"relative aspect-video bg-black rounded overflow-hidden",children:[he?s.jsx("img",{src:he,className:"w-full h-full object-cover",alt:` ${ze+1}`,loading:"lazy"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-[8px] text-zinc-500",children:Ge.type==="prev"?"":Ge.type==="current"?"":""}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 text-center",children:[Ge.time.toFixed(1),"s"]})]},ze)})}),s.jsx("div",{className:"space-y-2",children:(We=ie.keyframes)==null?void 0:We.map((Ge,ze)=>s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"text-[9px] text-zinc-500",children:[Ge.type==="prev"?"":Ge.type==="current"?"":""," (",Ge.time.toFixed(1),"s)"]}),Ge.mj_prompt&&s.jsx("div",{className:`p-2 rounded border ${e==="dark"?"bg-zinc-900 border-zinc-600":"bg-zinc-50 border-zinc-200"}`,children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:"Midjourney "}),s.jsx("div",{className:"text-[10px] text-zinc-700 dark:text-zinc-300 break-words select-text cursor-text",onMouseDown:he=>he.stopPropagation(),children:Ge.mj_prompt})]}),s.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[s.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(Ge.mj_prompt),alert("")}catch{alert("")}},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:he=>he.stopPropagation(),title:"",children:s.jsx(ba,{size:12})}),s.jsx("button",{onClick:()=>{const he=xn(n.x+n.width+100,n.y+n.height/2),ge=`node-${Date.now()}`,et={id:ge,type:"gen-image",x:he.x-180,y:he.y-170,width:360,height:340,settings:{model:"mj-v6",prompt:Ge.mj_prompt,ratio:"Auto",resolution:"2K"}};c(st=>[...st,et]),setTimeout(()=>{const st=xn(n.x+n.width+200,n.y+n.height/2),Ve=`node-${Date.now()+1}`,nt={id:Ve,type:"preview",x:st.x-160,y:st.y-130,width:320,height:260};c(Q=>[...Q,nt]),m(Q=>[...Q,{id:`conn-${Date.now()}`,from:ge,to:Ve}])},50)},className:"p-1 rounded hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors text-blue-600 dark:text-blue-400",onMouseDown:he=>he.stopPropagation(),title:"",children:s.jsx(Qg,{size:12})})]})]})}),Ge.jimeng_prompt&&s.jsx("div",{className:`p-2 rounded border ${e==="dark"?"bg-zinc-900 border-zinc-600":"bg-zinc-50 border-zinc-200"}`,children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:""}),s.jsx("div",{className:"text-[10px] text-zinc-700 dark:text-zinc-300 break-words select-text cursor-text",onMouseDown:he=>he.stopPropagation(),children:Ge.jimeng_prompt})]}),s.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(Ge.jimeng_prompt),alert("")}catch{alert("")}},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:he=>he.stopPropagation(),title:"",children:s.jsx(ba,{size:12})})]})})]},ze))}),ie.global_tags&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-zinc-300 dark:border-zinc-700",children:[s.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:""}),s.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(ie.global_tags).map(([Ge,ze])=>Array.isArray(ze)&&ze.map((he,ge)=>s.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:he},`${Ge}-${ge}`)))})]})]},Te)})})]}):null]})})()})]}),n.type==="storyboard-node"&&(()=>{var Ht,vt,Vt,pt,ft,wt,at,At,Wt,Bt,zt,yn,Tn,q,re,Ie,lt,ie,Te,yt,sn,ut,vn,qt,pn,Qe,Ot,Lt;const B=(O,Pe)=>{const We=O.clipboardData.items;for(let Ge=0;Ge<We.length;Ge++)if(We[Ge].type.indexOf("image")!==-1){O.preventDefault(),O.stopPropagation();const ze=We[Ge].getAsFile(),he=new FileReader;he.onload=ge=>Gt(n.id,Pe,{image_url:ge.target.result}),he.readAsDataURL(ze);return}},pe=(O,Pe)=>{var nt,Q;O.preventDefault(),O.stopPropagation();const We=(((nt=n.settings)==null?void 0:nt.shots)||[]).find(De=>De.id===Pe),Ge=((Q=n.settings)==null?void 0:Q.mode)||"video",ze=De=>{if(!De)return!1;if(Ge==="video"){const Je=(We==null?void 0:We.useFirstLastFrame)&&(We==null?void 0:We.activeInput)==="last"?"lastFrame":"image_url";return Gt(n.id,Pe,{[Je]:De,image_filename:""}),!0}if(We!=null&&We.useMultiRef){const Je=(We.referenceImages&&We.referenceImages.length>0?We.referenceImages:We.image_url?[We.image_url]:[]).slice(0,4);return Je.length<4?Je.push(De):Je[0]=De,Gt(n.id,Pe,{referenceImages:Je,image_url:Je[0]||De}),!0}return Gt(n.id,Pe,{image_url:De,image_filename:"",referenceImages:[]}),!0};if(O.dataTransfer.files&&O.dataTransfer.files.length>0){const De=O.dataTransfer.files[0];if(De.type.startsWith("image/")){const tt=new FileReader;tt.onload=Je=>ze(Je.target.result),tt.readAsDataURL(De);return}}const he=O.dataTransfer.getData("application/x-tapnow-history");if(he)try{const De=JSON.parse(he),tt=(De==null?void 0:De.url)||(De==null?void 0:De.originalUrl)||(De==null?void 0:De.previewUrl)||"";if(ze(tt))return}catch(De){console.warn("[StoryboardDrop] Failed to parse payload",De)}const et=(O.dataTransfer.getData("text/uri-list")||"").split(`
`).find(De=>De&&!De.startsWith("#"))||"",st=O.dataTransfer.getData("text/plain")||"",Ve=(et||st).trim();Ve&&/^(https?:|data:image\/|blob:|file:)/i.test(Ve)&&ze(Ve)},ot=Cn.filter(O=>O.nodeId===n.id),kt=Xt.filter(O=>O.nodeId===n.id);return s.jsx("div",{className:"flex h-full",children:s.jsxs("div",{className:`flex flex-col h-full rounded-xl overflow-hidden pointer-events-auto transition-colors flex-1 ${e==="dark"?"bg-zinc-950 border border-zinc-800":"bg-white border border-zinc-300 shadow-sm"}`,onMouseEnter:()=>yh(!0),onMouseLeave:()=>yh(!1),children:[s.jsxs("div",{className:`px-4 py-3 border-b flex items-center shrink-0 flex-nowrap overflow-x-auto no-scrollbar ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[s.jsx(Dl,{size:16,className:"text-purple-500"}),s.jsx("span",{className:`font-bold text-xs ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,children:""}),s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"/"}),(Ht=n.settings)!=null&&Ht.isEditingTitle?s.jsx("input",{type:"text",value:((vt=n.settings)==null?void 0:vt.projectTitle)||"",onChange:O=>Le(n.id,{projectTitle:O.target.value}),placeholder:"",className:`font-bold text-xs bg-transparent border-b border-blue-500 outline-none w-32 transition-colors ${e==="dark"?"text-zinc-200 placeholder-zinc-500":"text-zinc-800 placeholder-zinc-400"}`,onMouseDown:O=>O.stopPropagation(),onClick:O=>O.stopPropagation(),onKeyDown:O=>{O.stopPropagation(),(O.key==="Enter"||O.key==="Escape")&&Le(n.id,{isEditingTitle:!1})},onBlur:()=>Le(n.id,{isEditingTitle:!1}),autoFocus:!0}):s.jsx("span",{className:`font-bold text-xs cursor-move ${e==="dark"?"text-zinc-200":"text-zinc-800"} ${(Vt=n.settings)!=null&&Vt.projectTitle?"":e==="dark"?"text-zinc-500":"text-zinc-400"}`,title:"",children:((pt=n.settings)==null?void 0:pt.projectTitle)||""}),s.jsx("button",{onClick:O=>{var Pe;O.stopPropagation(),Le(n.id,{isEditingTitle:!((Pe=n.settings)!=null&&Pe.isEditingTitle)})},onMouseDown:O=>O.stopPropagation(),className:`p-0.5 rounded transition-colors ${(ft=n.settings)!=null&&ft.isEditingTitle?"text-blue-500":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-400 hover:text-zinc-600"}`,title:"",children:s.jsx(Nz,{size:12})}),s.jsxs("div",{className:`flex items-center ml-2 p-0.5 rounded-full ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:[s.jsx("button",{onClick:O=>{var he,ge;O.stopPropagation();const Pe="image",We=localStorage.getItem("tapnow_last_image_model")||((he=ue.find(et=>et.type==="Image"))==null?void 0:he.id)||"",ze=(((ge=n.settings)==null?void 0:ge.shots)||[]).map(et=>{const st=ue.find(Ve=>Ve.id===et.model);return!st||st.type==="Video"?{...et,model:We,duration:void 0}:et});Le(n.id,{mode:Pe,shots:ze})},className:`text-[10px] px-2 py-0.5 rounded-full transition-all ${(((wt=n.settings)==null?void 0:wt.mode)||"video")==="image"?"bg-blue-500 text-white shadow-sm":e==="dark"?"text-zinc-400 hover:text-zinc-200":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:O=>O.stopPropagation(),title:"",children:""}),s.jsx("button",{onClick:O=>{var he,ge;O.stopPropagation();const Pe="video",We=localStorage.getItem("tapnow_last_video_model")||((he=ue.find(et=>et.type==="Video"))==null?void 0:he.id)||"",ze=(((ge=n.settings)==null?void 0:ge.shots)||[]).map(et=>{const st=ue.find(Ve=>Ve.id===et.model);return!st||st.type==="Image"?{...et,model:We,duration:So(We)}:et});Le(n.id,{mode:Pe,shots:ze})},className:`text-[10px] px-2 py-0.5 rounded-full transition-all ${(((at=n.settings)==null?void 0:at.mode)||"video")==="video"?"bg-green-500 text-white shadow-sm":e==="dark"?"text-zinc-400 hover:text-zinc-200":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:O=>O.stopPropagation(),title:"",children:""})]})]}),s.jsxs("div",{className:"flex items-center gap-2 ml-auto relative z-10 shrink-0",children:[s.jsx("button",{onClick:O=>{O.stopPropagation(),confirm("")&&Le(n.id,{shots:[]})},className:"p-1 hover:bg-red-100 hover:text-red-500 rounded text-zinc-400 transition-colors",title:"",children:s.jsx(Fr,{size:14})}),s.jsxs("button",{onClick:()=>{var Pe,We;const O=bl(n.id);if(O.length>0){const Ge=O.join(`
`),ze=/#\s*(\d+)\s*([^#]*)|\s*(\d+)\s*\s*([^#]*)/g,he=[];let ge;for(;(ge=ze.exec(Ge))!==null;){const et=parseInt(ge[1]||ge[3]),st=(ge[2]||ge[4]||"").trim();st&&he.push({num:et,text:st})}if(he.length===0&&Ge.split(`
`).filter(st=>st.trim()).forEach((st,Ve)=>{const nt=st.match(/^(\d+)[.\s]+(.*)/);nt?he.push({num:parseInt(nt[1]),text:nt[2].trim()}):he.push({num:Ve+1,text:st.trim()})}),he.length>0){const et=((Pe=n.settings)==null?void 0:Pe.shots)||[],st=[...et];he.forEach((Ve,nt)=>{nt<et.length?st[nt]={...st[nt],prompt:Ve.text,description:Ve.text}:st.push({id:Date.now()+Math.random()+nt,prompt:Ve.text,description:Ve.text,model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0})}),Le(n.id,{shots:st})}else alert(" (: #1 )")}else Le(n.id,{scriptExpanded:!((We=n.settings)!=null&&We.scriptExpanded)})},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-400 text-white"}`,onMouseDown:O=>O.stopPropagation(),title:bl(n.id).length>0?"":"",children:[s.jsx(ls,{size:12}),s.jsx("span",{className:"whitespace-nowrap",children:""})]}),(()=>{var We;const O=xl(n.id),Pe=((We=O==null?void 0:O.selectedKeyframes)==null?void 0:We.length)||0;return s.jsxs("button",{onClick:async()=>{var et;if(!O||Pe===0){alert("");return}const Ge=O.selectedKeyframes,ze=((et=n.settings)==null?void 0:et.shots)||[],he=Math.max(ze.length,Ge.length),ge=Array.from({length:he},(st,Ve)=>{var nt,Q,De,tt,Je,Rt,Ee,Ae,It;return{id:((nt=ze[Ve])==null?void 0:nt.id)||`shot-${Date.now()}-${Ve}`,...ze[Ve],prompt:((Q=ze[Ve])==null?void 0:Q.prompt)??"",description:((De=ze[Ve])==null?void 0:De.description)??"",model:((tt=ze[Ve])==null?void 0:tt.model)||localStorage.getItem("tapnow_last_video_model")||"",image_url:((Je=Ge[Ve])==null?void 0:Je.url)??((Rt=ze[Ve])==null?void 0:Rt.image_url)??"",image_filename:((Ee=Ge[Ve])==null?void 0:Ee.filename)||((Ae=ze[Ve])==null?void 0:Ae.image_filename)||"",status:((It=ze[Ve])==null?void 0:It.status)||"draft"}});if(Re(),window.LocalImageManager){for(let st of ge)if(st.image_url&&(st.image_url.startsWith("file://")||st.image_url.startsWith("img_"))){const nt=st.image_url.startsWith("img_")?st.image_url:st.imgId||st.image_filename;if(nt)try{const Q=await window.LocalImageManager.getImage(nt);Q&&(st.image_url=URL.createObjectURL(Q))}catch(Q){console.error("[KeyframeImport] Failed to load local image:",nt,Q)}}}Le(n.id,{shots:ge})},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${Pe>0?"bg-blue-600 hover:bg-blue-500 text-white":e==="dark"?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-zinc-200 text-zinc-500 cursor-not-allowed"}`,onMouseDown:Ge=>Ge.stopPropagation(),disabled:Pe===0,title:Pe>0?` ${Pe} `:"",children:[s.jsx(ya,{size:12}),s.jsxs("span",{className:"whitespace-nowrap",children:["",Pe>0?` (${Pe})`:""]})]})})(),(()=>{var Ge;const O=((Ge=n.settings)==null?void 0:Ge.mode)||"video",Pe=p.filter(ze=>ze.to===n.id).map(ze=>Dt.get(ze.from)).find(ze=>ze&&(O==="image"&&ze.type==="gen-image"||O==="video"&&ze.type==="gen-video"));if(!Pe)return null;const We=Pe.settings||{};return s.jsxs("button",{onClick:()=>{var ge;const ze=((ge=n.settings)==null?void 0:ge.shots)||[];if(ze.length===0){Le(n.id,{errorMsg:""});return}Re();const he=ze.map(et=>({...et,model:We.model||et.model,ratio:We.ratio||et.ratio,resolution:We.resolution||et.resolution,duration:We.duration||et.duration}));Le(n.id,{shots:he}),o(`  ${he.length}  | ${We.model||"?"} / ${We.ratio||"?"}`,"success",5e3)},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-green-600 hover:bg-green-500 text-white":"bg-green-500 hover:bg-green-400 text-white"}`,onMouseDown:ze=>ze.stopPropagation(),title:` ${O==="image"?"":""}: ${We.model||"?"} / ${We.ratio||"?"} / ${We.resolution||"?"}${O==="video"?` / ${We.duration||"?"}`:""}`,children:[s.jsx(ic,{size:12}),s.jsx("span",{className:"whitespace-nowrap",children:""})]})})(),s.jsxs("div",{className:`flex items-center gap-1 border-l pl-2 ml-1 ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:[s.jsx("input",{type:"number",min:"0",max:"20",value:ht,onChange:O=>ke(Math.max(0,parseInt(O.target.value)||0)),className:`w-8 text-center text-xs rounded border outline-none py-0.5 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`,title:" (0=)"}),s.jsx("button",{onClick:()=>{var Q,De;const O=((Q=n.settings)==null?void 0:Q.mode)||"video",Pe=((De=n.settings)==null?void 0:De.shots)||[],We=Pe.filter(tt=>tt.status==="generating");if(We.length>0){const tt=prompt(` ${We.length} 




  "1"  "ok" = 
  "2"  "skip" = 
  = `,"");if(tt===null||tt.trim()==="")return;const Je=tt.trim().toLowerCase();(Je==="1"||Je==="ok"||Je==="")&&We.forEach(Rt=>{Gt(n.id,Rt.id,{status:"pending",errorMsg:""}),Rt.status="pending"})}let Ge=Pe.filter(tt=>tt.status!=="done"&&tt.status!=="generating"&&!tt.outputEnabled),ze=!1;if(Ge.length===0){if(Ge=Pe.filter(tt=>!tt.outputEnabled&&tt.status==="done"),Ge.length===0){const tt=Pe.every(Rt=>Rt.outputEnabled);Pe.some(Rt=>Rt.status==="generating")?alert(""):tt&&Pe.length>0?alert(`
`):alert("");return}ze=!0}if(ze){const tt=`

 ${Ge.length} 

 
 

`;if(!confirm(tt))return}const he=Ge.length,ge=ht===0?he:Math.max(1,ht),et=(Se.current.get(n.id)||0)+1;Se.current.set(n.id,et);const st=`batch-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,Ve=Ge.map(tt=>tt.id);Ve.forEach((tt,Je)=>{Ke.current.set(`${n.id}:${tt}`,{batchId:st,batchOrder:Je,taskIndex:et})}),we(tt=>{var Je;return[...tt,{id:st,nodeId:n.id,projectTitle:((Je=n.settings)==null?void 0:Je.projectTitle)||"",total:he,concurrency:ge,createdAt:Date.now(),mode:O,taskIndex:et,shotIds:Ve}]});const nt=Ge.map((tt,Je)=>({nodeId:n.id,shotId:tt.id,retryCount:0,mode:O,batchId:st,batchOrder:Je,batchConcurrency:ge,taskIndex:et}));se(tt=>[...tt,...nt]),me.current!=="running"&&(me.current="idle"),je(tt=>tt+1),o(`  ${nt.length} ${O==="image"?"":""} | : ${ht===0?"":ht}${ze?" ()":""}`,"success",5e3)},className:`p-1 rounded transition-colors ${(((At=n.settings)==null?void 0:At.mode)||"video")==="image"?e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-400 text-white":e==="dark"?"bg-yellow-600 hover:bg-yellow-500 text-white":"bg-yellow-500 hover:bg-yellow-400 text-white"}`,title:`${(((Wt=n.settings)==null?void 0:Wt.mode)||"video")==="image"?"":""}`,children:s.jsxs("div",{className:"flex items-center gap-1",children:[(((Bt=n.settings)==null?void 0:Bt.mode)||"video")==="image"?s.jsx(ya,{size:12}):s.jsx(Du,{size:12,fill:"currentColor"}),s.jsx("span",{className:"text-[10px] font-medium whitespace-nowrap",children:""})]})}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:O=>{O.stopPropagation();const Pe=O.currentTarget.getBoundingClientRect();nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="storyboard-download"?null:{nodeId:n.id,type:"storyboard-download",anchor:{top:Pe.top,left:Pe.left,right:Pe.right,bottom:Pe.bottom,width:Pe.width,height:Pe.height}})},className:`p-1 rounded transition-colors flex items-center gap-0.5 ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,title:"",onMouseDown:O=>O.stopPropagation(),children:[s.jsx(Eo,{size:12}),s.jsx(zs,{size:10})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="storyboard-download"&&Ce.anchor&&Nd.createPortal(s.jsxs("div",{className:`fixed mt-1 w-32 rounded-lg shadow-xl py-1 z-[9999] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{top:Ce.anchor.bottom+6,left:Ce.anchor.right,transform:"translateX(-100%)"},onMouseLeave:()=>nn(null),onMouseDown:O=>O.stopPropagation(),children:[s.jsx("button",{onClick:()=>{nn(null),fm(n,"all")},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:""}),s.jsx("button",{onClick:()=>{nn(null),fm(n,"selected")},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:""})]}),document.body)]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:O=>{O.stopPropagation();const Pe=O.currentTarget.getBoundingClientRect();nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="batch-queue"?null:{nodeId:n.id,type:"batch-queue",anchor:{top:Pe.top,left:Pe.left,right:Pe.right,bottom:Pe.bottom,width:Pe.width,height:Pe.height}})},className:`p-1 rounded transition-colors relative ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,title:` ${kt.length} |  ${ot.length}`,onMouseDown:O=>O.stopPropagation(),children:[s.jsx(af,{size:12}),ot.length>0&&s.jsx("span",{className:`absolute -top-1 -right-1 text-[8px] px-1 rounded-full ${e==="dark"?"bg-blue-500 text-white":"bg-blue-600 text-white"}`,children:ot.length})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="batch-queue"&&Ce.anchor&&Nd.createPortal(s.jsxs("div",{className:`fixed mt-1 w-64 rounded-lg shadow-xl py-2 z-[9999] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{top:Ce.anchor.bottom+6,left:Ce.anchor.right,transform:"translateX(-100%)"},onMouseLeave:()=>nn(null),onMouseDown:O=>O.stopPropagation(),children:[s.jsxs("div",{className:`px-3 pb-2 text-[10px] ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[" ",kt.length,"   ",ot.length]}),s.jsxs("div",{className:"px-3 pb-2 flex gap-2",children:[s.jsx("button",{onClick:()=>{nn(null),ot.length!==0&&confirm("")&&on(n.id,!1)},className:`text-[10px] px-2 py-1 rounded ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:""}),s.jsx("button",{onClick:()=>{nn(null),!(kt.length===0&&ot.length===0)&&confirm("")&&on(n.id,!0)},className:`text-[10px] px-2 py-1 rounded ${e==="dark"?"bg-red-900/40 text-red-300 hover:bg-red-900/60":"bg-red-50 text-red-600 hover:bg-red-100"}`,children:""})]}),kt.length>0&&s.jsxs("div",{className:"px-3 pb-2",children:[s.jsx("div",{className:"text-[10px] mb-1 text-zinc-500",children:""}),s.jsxs("div",{className:"space-y-1",children:[kt.slice(0,6).map((O,Pe)=>s.jsxs("div",{className:`text-[10px] flex items-center justify-between gap-2 ${e==="dark"?"text-zinc-300":"text-zinc-600"}`,children:[s.jsxs("span",{className:"truncate max-w-[150px]",children:[O.projectTitle,"  ",O.sceneIndex]}),s.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[s.jsx("span",{className:"text-green-500",children:""}),s.jsx("button",{onClick:()=>{confirm("")&&it(O.nodeId,O.shotId)},className:`p-0.5 rounded ${e==="dark"?"text-zinc-500 hover:text-red-300":"text-zinc-400 hover:text-red-500"}`,title:"",children:s.jsx(Fr,{size:10})})]})]},`${O.nodeId}-${O.shotId}-${Pe}`)),kt.length>6&&s.jsx("div",{className:`text-[9px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:" 6 "})]})]}),s.jsxs("div",{className:"px-3",children:[s.jsx("div",{className:"text-[10px] mb-1 text-zinc-500",children:""}),ot.length===0?s.jsx("div",{className:`text-[10px] ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:""}):s.jsxs("div",{className:"space-y-1 max-h-40 overflow-y-auto pr-1",children:[ot.slice(0,12).map(O=>s.jsxs("div",{className:`text-[10px] flex items-center justify-between gap-2 ${e==="dark"?"text-zinc-300":"text-zinc-600"}`,children:[s.jsxs("span",{className:"truncate max-w-[150px]",children:["#",O.order," ",O.projectTitle,"  ",O.sceneIndex]}),s.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[s.jsx("span",{className:"text-blue-400",children:O.mode==="image"?"":""}),s.jsx("button",{onClick:()=>{confirm("")&&ct(O.nodeId,O.shotId)},className:`p-0.5 rounded ${e==="dark"?"text-zinc-500 hover:text-red-300":"text-zinc-400 hover:text-red-500"}`,title:"",children:s.jsx(Fr,{size:10})})]})]},`${O.nodeId}-${O.shotId}-${O.order}`)),ot.length>12&&s.jsx("div",{className:`text-[9px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:" 12 "})]})]})]}),document.body)]}),s.jsx("button",{onClick:O=>{O.stopPropagation(),c(Pe=>Pe.map(We=>{var Ge;if(We.id===n.id){const ze=(Ge=We.settings)==null?void 0:Ge.showOutputPreview,he=ze?Math.max(380,We.width-220):We.width+220;return{...We,width:he,settings:{...We.settings,showOutputPreview:!ze}}}return We}))},className:`p-1 rounded transition-colors ${(zt=n.settings)!=null&&zt.showOutputPreview?"bg-blue-500 text-white":e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-400":"bg-zinc-200 hover:bg-zinc-300 text-zinc-500"}`,title:(yn=n.settings)!=null&&yn.showOutputPreview?"":"",onMouseDown:O=>O.stopPropagation(),children:s.jsx(wa,{size:12,className:`transition-transform ${(Tn=n.settings)!=null&&Tn.showOutputPreview?"rotate-90":""}`})})]}),((q=n.settings)==null?void 0:q.showOutputPreview)&&s.jsx("div",{className:"shrink-0 flex items-center justify-center gap-2 ml-1 ",style:{width:220},children:(((re=n.settings)==null?void 0:re.mode)||"video")==="image"?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:O=>{var Ge;O.stopPropagation();const Pe=((Ge=n.settings)==null?void 0:Ge.shots)||[],We=Pe.length>0&&Pe.every(ze=>ze.outputEnabled);Le(n.id,{shots:Pe.map(ze=>({...ze,outputEnabled:!We}))})},className:`text-[10px] px-2 py-1 rounded transition-colors whitespace-nowrap ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,onMouseDown:O=>O.stopPropagation(),title:"/",children:(((Ie=n.settings)==null?void 0:Ie.shots)||[]).every(O=>O.outputEnabled)?"":""}),s.jsxs("button",{onClick:O=>{var Ge;O.stopPropagation();const Pe=((Ge=n.settings)==null?void 0:Ge.shots)||[],We=Pe.some(ze=>ze.selectedImageIndex>=0);Le(n.id,{shots:Pe.map(ze=>({...ze,selectedImageIndex:ze.outputEnabled?ze.selectedImageIndex:We?-1:0}))})},className:`text-[10px] px-2 py-1 rounded transition-colors flex items-center gap-1 whitespace-nowrap ${e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-400 text-white"}`,onMouseDown:O=>O.stopPropagation(),title:"==",children:[s.jsx(ya,{size:10}),s.jsx("span",{children:(((lt=n.settings)==null?void 0:lt.shots)||[]).some(O=>O.selectedImageIndex>=0)?"":""})]})]}):s.jsx("button",{onClick:O=>{var Ge;O.stopPropagation();const Pe=((Ge=n.settings)==null?void 0:Ge.shots)||[],We=Pe.length>0&&Pe.every(ze=>ze.outputEnabled);Le(n.id,{shots:Pe.map(ze=>({...ze,outputEnabled:!We}))})},className:`text-[10px] px-2 py-1 rounded transition-colors whitespace-nowrap ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,onMouseDown:O=>O.stopPropagation(),title:"/",children:(((ie=n.settings)==null?void 0:ie.shots)||[]).every(O=>O.outputEnabled)?"":""})})]})]}),((Te=n.settings)==null?void 0:Te.scriptExpanded)&&s.jsxs("div",{className:`border-b shrink-0 p-3 space-y-2 ${e==="dark"?"bg-zinc-900/30 border-zinc-800":"bg-zinc-50/50 border-zinc-200"}`,children:[s.jsx("textarea",{value:((yt=n.settings)==null?void 0:yt.scriptText)||"",onChange:O=>Le(n.id,{scriptText:O.target.value}),placeholder:": #1  #2  ...",className:`w-full h-24 p-2 text-xs rounded border resize-none overflow-y-auto custom-scrollbar ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:O=>O.stopPropagation(),onWheel:O=>{O.stopPropagation()}}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[s.jsx("button",{onClick:()=>{var Ve,nt;const Pe=bl(n.id).join(`
`),We=((Ve=n.settings)==null?void 0:Ve.scriptText)||"",Ge=Pe||We,ze=[],he=/#\s*(\d+)\s*([^#]*)|\s*(\d+)\s*\s*([^#]*)/g;let ge;for(;(ge=he.exec(Ge))!==null;){const Q=parseInt(ge[1]||ge[3]),De=(ge[2]||ge[4]||"").trim();De&&ze.push({num:Q,text:De})}if(ze.length===0&&Ge.split(`
`).filter(De=>De.trim()).forEach((De,tt)=>{const Je=De.match(/^(\d+)[.\s]+(.*)/);Je?ze.push({num:parseInt(Je[1]),text:Je[2].trim()}):ze.push({num:tt+1,text:De.trim()})}),ze.length===0){alert(": #1  #2 ");return}ze.sort((Q,De)=>Q.num-De.num);const et=((nt=n.settings)==null?void 0:nt.shots)||[],st=[...et];ze.forEach((Q,De)=>{De<et.length?st[De]={...st[De],prompt:Q.text,description:Q.text}:st.push({id:Date.now()+Math.random()+De,prompt:Q.text,description:Q.text,model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0})}),Le(n.id,{shots:st,scriptExpanded:!1})},className:"px-3 py-1.5 text-xs bg-purple-600 text-white rounded hover:bg-purple-500 transition-colors",onMouseDown:O=>O.stopPropagation(),children:""}),s.jsxs("button",{onClick:async()=>{var ze,he,ge,et,st,Ve,nt,Q,De,tt;const O=((ze=n.settings)==null?void 0:ze.scriptText)||"";if(!O.trim()){Le(n.id,{errorMsg:""});return}(((he=n.settings)==null?void 0:he.shots)||[]).length>0&&window.confirm(`
""""`);const{key:We,url:Ge}=as(xs);if(!We){Le(n.id,{errorMsg:" Chat  Key"});return}try{Re(),Le(n.id,{isGenerating:!0,errorMsg:""});const Je=((ge=n.settings)==null?void 0:ge.llmSplitPrompt)||`
 JSON : [{"prompt": "1"}, {"prompt": "2"}, ...]
 JSON`,It=(((Ve=(st=(et=(await(await fetch(`${Ge}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${We}`,"Content-Type":"application/json"},body:JSON.stringify({model:xs,messages:[{role:"system",content:Je},{role:"user",content:O}],stream:!1})})).json()).choices)==null?void 0:et[0])==null?void 0:st.message)==null?void 0:Ve.content)||"").match(/\[[\s\S]*\]/);if(It){const Tt=JSON.parse(It[0]),Ut=((nt=n.settings)==null?void 0:nt.mode)||"video",jt=Ut==="image"?localStorage.getItem("tapnow_last_image_model")||((Q=ue.find(_n=>_n.type==="Image"))==null?void 0:Q.id)||"":localStorage.getItem("tapnow_last_video_model")||((De=ue.find(_n=>_n.type==="Video"))==null?void 0:De.id)||"",mt=Ut==="image"?"1:1":"16:9",Yt=Ut==="video"?So(jt):void 0,tn=Tt.map((_n,ga)=>({id:`shot-${Date.now()}-${ga}`,scene_index:ga+1,prompt:_n.prompt||_n.description||"",description:_n.description||_n.prompt||"",image_url:"",video_url:"",output_url:"",model:jt,ratio:mt,duration:Yt,status:"draft",outputEnabled:!1,selectedImageIndex:-1})),en=((tt=n.settings)==null?void 0:tt.shots)||[],xr=en.length>0&&!window.lastLlmSplitOverwrite?[...en,...tn]:tn;Le(n.id,{shots:xr,scriptExpanded:!1,isGenerating:!1})}else throw new Error("AI ")}catch(Je){console.error("[LLM Split] Error:",Je),Le(n.id,{isGenerating:!1,errorMsg:Je.message})}},className:"px-2 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-500 transition-colors flex items-center gap-1",onMouseDown:O=>O.stopPropagation(),disabled:(sn=n.settings)==null?void 0:sn.isGenerating,title:" AI ",children:[s.jsx(Ll,{size:12}),(ut=n.settings)!=null&&ut.isGenerating?"...":"LLM"]}),s.jsx("button",{onClick:()=>{var O;return Le(n.id,{showLlmPromptEditor:!((O=n.settings)!=null&&O.showLlmPromptEditor)})},className:`p-1.5 text-xs rounded transition-colors ${(vn=n.settings)!=null&&vn.showLlmPromptEditor?"bg-blue-500 text-white":e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-700"}`,onMouseDown:O=>O.stopPropagation(),title:" LLM  Prompt",children:s.jsx(zz,{size:12})}),!((qt=n.settings)!=null&&qt.showLlmPromptEditor)&&s.jsxs("div",{className:`flex flex-col text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:[s.jsx("span",{children:": #1 #2 "}),s.jsx("span",{children:"LLM: "})]})]}),((pn=n.settings)==null?void 0:pn.showLlmPromptEditor)&&s.jsxs("div",{className:"flex items-start gap-2 mt-2",children:[s.jsx("span",{className:`text-[10px] shrink-0 pt-1 ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"LLM Prompt:"}),s.jsx("textarea",{value:((Qe=n.settings)==null?void 0:Qe.llmSplitPrompt)||`
 JSON : [{"prompt": "1"}, {"prompt": "2"}, ...]
 JSON`,onChange:O=>Le(n.id,{llmSplitPrompt:O.target.value}),className:`flex-1 text-xs p-2 rounded resize-none overflow-y-auto custom-scrollbar ${e==="dark"?"bg-zinc-800 text-zinc-200 border-zinc-700":"bg-white text-zinc-800 border-zinc-300"} border`,rows:3,placeholder:" LLM  Prompt...",onMouseDown:O=>O.stopPropagation(),onClick:O=>O.stopPropagation(),onKeyDown:O=>O.stopPropagation(),onWheel:O=>{O.stopPropagation()}})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-3 min-h-0 bg-opacity-50",onWheel:O=>{O.stopPropagation()},children:((Lt=(Ot=n.settings)==null?void 0:Ot.shots)==null?void 0:Lt.length)>0?n.settings.shots.map((O,Pe)=>{var Ge,ze,he,ge,et,st,Ve,nt;const We=(rs==null?void 0:rs.nodeId)===n.id&&(rs==null?void 0:rs.shotId)===O.id;return s.jsxs(Ed.Fragment,{children:[s.jsxs("div",{className:"relative h-2 -mt-1 -mb-1 z-10 group/insert flex items-center justify-center cursor-pointer hover:h-6 transition-all",onClick:Q=>{Q.stopPropagation();const De=[...n.settings.shots||[]];De.splice(Pe,0,{id:Date.now()+Math.random(),prompt:"",description:"",model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0}),Le(n.id,{shots:De})},title:"",children:[s.jsx("div",{className:"w-full h-[2px] bg-blue-500 opacity-0 group-hover/insert:opacity-100 transition-opacity"}),s.jsx("div",{className:"absolute w-5 h-5 rounded-full bg-blue-600 text-white flex items-center justify-center opacity-0 group-hover/insert:opacity-100 transition-opacity shadow-sm scale-75 group-hover/insert:scale-100",children:s.jsx(Ji,{size:12})})]}),s.jsxs("div",{className:"flex items-stretch gap-2 w-full",children:[s.jsxs("div",{tabIndex:0,onClick:Q=>{Q.stopPropagation(),tl({nodeId:n.id,shotId:O.id}),Q.currentTarget.focus()},onPaste:Q=>B(Q,O.id),className:`relative flex-1 flex gap-3 p-3 rounded-lg border transition-all group/shot cursor-pointer outline-none focus:ring-2 focus:ring-blue-500/50 ${We?"border-blue-500 ring-1 ring-blue-500 bg-blue-500/5 z-10":e==="dark"?"bg-zinc-900/50 border-zinc-800 hover:border-zinc-600":"bg-white border-zinc-200 hover:border-blue-300 hover:shadow-md"}`,children:[s.jsx("div",{className:`font-mono text-sm w-6 shrink-0 flex items-start pt-1 font-bold ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:Pe+1}),s.jsx("div",{className:"flex flex-col gap-2 shrink-0 mr-2 h-full min-h-[14rem] w-52",onDragOver:Q=>{Q.preventDefault()},onDrop:Q=>pe(Q,O.id),children:(()=>{var Tt;const De=(((Tt=n.settings)==null?void 0:Tt.mode)||"video")==="video",tt=O.useFirstLastFrame,Je=O.activeInput||"first",Rt=O.useMultiRef,Ee=e==="dark"?"border-zinc-800":"border-zinc-300",Ae=e==="dark"?"bg-black":"bg-zinc-50",It=(Ut,jt)=>{var tn;const mt=(tn=Ut.target.files)==null?void 0:tn[0];if(!mt)return;const Yt=new FileReader;Yt.onload=en=>{Gt(n.id,O.id,{[jt]:en.target.result})},Yt.readAsDataURL(mt),Ut.target.value=""};if(De){const Ut=(jt,mt)=>{const Yt=jt==="first"?"image_url":"lastFrame",tn=O[Yt],en=jt==="first"?"":"",lr=mt?"flex-1 h-full":"w-14 h-full shrink-0";return s.jsxs("div",{className:`relative rounded-lg border overflow-hidden group ${lr} ${Ae} ${Ee} flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 transition-all`,onClick:xr=>{xr.stopPropagation(),mt||Gt(n.id,O.id,{activeInput:jt})},children:[tn?s.jsx(Yn,{src:tn,className:`w-full h-full object-cover ${mt?"":"opacity-60 hover:opacity-100"}`}):s.jsxs("div",{className:"flex flex-col items-center gap-1 text-zinc-500",children:[s.jsx(Xi,{size:mt?20:14}),mt&&s.jsxs("span",{className:"text-[10px]",children:["",en]})]}),s.jsx("div",{className:"absolute top-0 left-0 bg-black/60 text-white text-[9px] px-1.5 py-0.5 rounded-br z-20 backdrop-blur-md pointer-events-none",children:en}),tn&&s.jsx("button",{onClick:xr=>{xr.stopPropagation(),$n({url:tn,type:"image"})},className:"absolute bottom-1 left-1 p-1 rounded-full bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:s.jsx(Us,{size:10})}),mt&&s.jsxs(s.Fragment,{children:[tn&&s.jsx("button",{onClick:xr=>{xr.stopPropagation(),Gt(n.id,O.id,{[Yt]:""})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",children:s.jsx(cs,{size:12})}),s.jsxs("label",{className:"absolute inset-0 z-10 flex items-center justify-center cursor-pointer opacity-0 hover:opacity-100",children:[s.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:xr=>It(xr,Yt)}),s.jsx("div",{className:"p-2 rounded-full bg-black/50 text-white",children:s.jsx(Xi,{size:16})})]}),s.jsx("div",{className:"absolute bottom-1 right-1 p-1 rounded bg-black/40 hover:bg-blue-500 text-white transition-colors cursor-pointer z-30",onClick:xr=>{xr.stopPropagation(),Gt(n.id,O.id,{useFirstLastFrame:!tt,activeInput:tt?"first":"last"})},title:"",children:s.jsx(d0,{size:12})}),tn&&O.image_filename&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[9px] pl-8 pr-8 py-0.5 truncate opacity-0 group-hover:opacity-100 transition-opacity z-20",title:O.image_filename,children:O.image_filename})]})]},jt)};return tt?s.jsxs("div",{className:"flex flex-row gap-2 h-full w-full",children:[Ut("first",Je==="first"),Ut("last",Je==="last")]}):Ut("first",!0)}else{const Ut=O.referenceImages&&O.referenceImages.length>0?O.referenceImages:O.image_url?[O.image_url]:[],jt=Ut[0]||"";return s.jsxs("div",{className:"flex flex-col gap-2 h-full w-full",children:[s.jsxs("div",{className:`relative flex-1 rounded-lg border overflow-hidden group ${Ae} ${Ee} flex flex-col items-center justify-center`,children:[jt?s.jsxs(s.Fragment,{children:[s.jsx(Yn,{src:jt,className:"w-full h-full object-cover"}),s.jsx("button",{onClick:mt=>{mt.stopPropagation(),$n({url:jt,type:"image"})},className:"absolute bottom-1 left-1 p-1 rounded-full bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:s.jsx(Us,{size:12})}),O.image_filename&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[9px] px-8 py-0.5 truncate opacity-0 group-hover:opacity-100 transition-opacity z-20",title:O.image_filename,children:O.image_filename}),s.jsx("button",{onClick:mt=>{mt.stopPropagation(),Gt(n.id,O.id,{image_url:"",image_filename:"",referenceImages:[]})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:s.jsx(cs,{size:12})})]}):s.jsxs("div",{className:"flex flex-col items-center gap-1 text-zinc-500",children:[s.jsx(Xi,{size:20}),s.jsx("span",{className:"text-[10px]",children:""})]}),s.jsxs("label",{className:`absolute inset-0 z-10 flex items-center justify-center cursor-pointer ${jt?"opacity-0 hover:opacity-100":"opacity-100"}`,children:[s.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:mt=>{var tn;const Yt=(tn=mt.target.files)==null?void 0:tn[0];if(Yt){const en=new FileReader;en.onload=lr=>{Gt(n.id,O.id,{image_url:lr.target.result,image_filename:Yt.name})},en.readAsDataURL(Yt)}}}),jt&&s.jsx("div",{className:"p-2 rounded-full bg-black/50 text-white",children:s.jsx(Xi,{size:16})})]}),s.jsx("div",{className:`absolute bottom-1 right-1 p-1 rounded bg-black/40 hover:bg-blue-500 text-white transition-colors cursor-pointer z-30 ${Rt?"text-blue-400 bg-blue-500/30":"text-zinc-400"}`,onClick:mt=>{mt.stopPropagation(),Gt(n.id,O.id,{useMultiRef:!Rt})},title:"",children:s.jsx(Dl,{size:12})})]}),Rt&&s.jsxs("div",{className:"flex gap-2 h-14 shrink-0 overflow-x-auto no-scrollbar items-center",children:[Ut.slice(1).map((mt,Yt)=>s.jsxs("div",{className:`relative w-12 h-14 shrink-0 rounded border overflow-hidden cursor-pointer hover:border-blue-500 transition-all ${Ee} ${Ae}`,onClick:tn=>{tn.stopPropagation();const en=[...Ut],lr=Yt+1;[en[0],en[lr]]=[en[lr],en[0]],Gt(n.id,O.id,{referenceImages:en,image_url:en[0]})},children:[s.jsx(Yn,{src:mt,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute top-0 left-0 bg-black/50 text-white text-[8px] px-1 backdrop-blur-sm",children:Yt+2})]},Yt+1)),Ut.length<4&&s.jsxs("label",{className:`w-12 h-14 shrink-0 rounded border border-dashed flex items-center justify-center cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 ${Ee} text-zinc-400 hover:text-blue-500 hover:border-blue-500 transition-colors`,children:[s.jsx(Ji,{size:16}),s.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:mt=>{var tn;const Yt=(tn=mt.target.files)==null?void 0:tn[0];if(Yt){const en=new FileReader;en.onload=lr=>{Gt(n.id,O.id,{referenceImages:[...Ut,lr.target.result]})},en.readAsDataURL(Yt)}}})]})]})]})}})()}),s.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-2",children:[s.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:Q=>{Q.stopPropagation(),nn((Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="shot-model"&&Ce.shotId===O.id?null:{nodeId:n.id,type:"shot-model",shotId:O.id})},onMouseDown:Q=>Q.stopPropagation(),className:`flex items-center justify-between gap-1 px-2 py-1 rounded border text-xs transition-colors min-w-[100px] ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:[s.jsx("span",{className:"truncate font-mono text-[10px]",children:(()=>{var Q,De;return(Q=n.settings)!=null&&Q.mode,((De=mn.get(O.model))==null?void 0:De.id)||O.model||""})()}),s.jsx(zs,{size:10,className:"opacity-50 shrink-0"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="shot-model"&&Ce.shotId===O.id&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Q=>Q.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:(()=>{var tt;const De=(((tt=n.settings)==null?void 0:tt.mode)||"video")==="image"?"Image":"Video";return Object.entries(gr).filter(([,Je])=>Je.models.some(Rt=>Rt.type===De)).map(([Je,Rt])=>s.jsx("button",{onMouseEnter:()=>tr(Je),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Nn===Je?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:Rt.name||Je},Je))})()}),s.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[(()=>{var tt,Je;const De=(((tt=n.settings)==null?void 0:tt.mode)||"video")==="image"?"Image":"Video";return Nn&&((Je=gr[Nn])==null?void 0:Je.models.filter(Rt=>Rt.type===De).map(Rt=>s.jsxs("button",{onClick:()=>{var Tt;const Ee=((Tt=n.settings)==null?void 0:Tt.mode)||"video",Ae=So(Rt.id);Gt(n.id,O.id,{model:Rt.id,duration:O.duration||Ae});const It=Ee==="image"?"tapnow_last_image_model":"tapnow_last_video_model";localStorage.setItem(It,Rt.id),Ee==="image"?dp(Rt.id):pp(Rt.id),nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${O.model===Rt.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:Rt.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(Rt.id)}`})]},Rt.id)))})(),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]}),(()=>{var tt;const Q=((tt=n.settings)==null?void 0:tt.mode)||"video",De=Q==="video"?mx(O.model):p0;return s.jsx("select",{value:O.ratio||(Q==="video"?"16:9":"1:1"),onChange:Je=>Gt(n.id,O.id,{ratio:Je.target.value}),onClick:Je=>Je.stopPropagation(),onMouseDown:Je=>Je.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:De.map(Je=>s.jsx("option",{value:Je,children:Je},Je))})})(),(()=>{var De,tt,Je,Rt;if((((De=n.settings)==null?void 0:De.mode)||"video")==="video")return(tt=O.model)!=null&&tt.includes("jimeng")||(Rt=(Je=mn.get(O.model))==null?void 0:Je.modelName)!=null&&Rt.includes("jimeng")?s.jsxs("select",{value:Lu(O.resolution||"720p"),onChange:Ee=>Gt(n.id,O.id,{resolution:Ee.target.value}),onClick:Ee=>Ee.stopPropagation(),onMouseDown:Ee=>Ee.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,title:"",children:[s.jsx("option",{value:"720p",children:"720p"}),s.jsx("option",{value:"1080p",children:"1080p"})]}):null;{const Ee=df(O.model);return s.jsx("select",{value:Ul(O.resolution||"2K"),onChange:Ae=>Gt(n.id,O.id,{resolution:Ae.target.value}),onClick:Ae=>Ae.stopPropagation(),onMouseDown:Ae=>Ae.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,title:"",children:Ee.map(Ae=>s.jsx("option",{value:Ae,children:Ae},Ae))})}})(),(((Ge=n.settings)==null?void 0:Ge.mode)||"video")==="video"&&(()=>{var Rt,Ee;const Q=O.model||((Rt=ue.find(Ae=>Ae.type==="Video"&&Ae.id==="sora-2"))==null?void 0:Rt.id)||((Ee=ue.find(Ae=>Ae.type==="Video"))==null?void 0:Ee.id)||"",De=ue.find(Ae=>Ae.id===Q),tt=(De==null?void 0:De.durations)||cu(Q),Je=So(Q);return s.jsx("select",{value:O.duration||Je,onChange:Ae=>Gt(n.id,O.id,{duration:Ae.target.value}),onClick:Ae=>Ae.stopPropagation(),onMouseDown:Ae=>Ae.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:tt.map(Ae=>s.jsx("option",{value:Ae,children:Ae},Ae))})})()]}),s.jsx("textarea",{className:`text-sm outline-none resize-none bg-transparent transition-all ${e==="dark"?"text-zinc-200 placeholder:text-zinc-700":"text-zinc-800 placeholder:text-zinc-400"}`,value:O.description||"",placeholder:"...",title:O.description||"",onChange:Q=>Gt(n.id,O.id,{description:Q.target.value}),onClick:Q=>{Q.stopPropagation(),We||tl({nodeId:n.id,shotId:O.id})},onMouseDown:Q=>Q.stopPropagation(),onFocus:Q=>{Q.stopPropagation(),We||tl({nodeId:n.id,shotId:O.id})},onInput:Q=>{We&&(Q.currentTarget.style.height="auto",Q.currentTarget.style.height=Q.currentTarget.scrollHeight+"px")},ref:Q=>{Q&&We&&(Q.style.height="auto",Q.style.height=Q.scrollHeight+"px")},style:{minHeight:We?"8rem":"2.5rem",height:We?"auto":"2.5rem",transition:"all 0.2s ease-in-out"}}),s.jsxs("div",{className:`p-2 rounded text-xs font-mono border transition-all relative ${e==="dark"?"bg-zinc-950 border-zinc-800 text-zinc-400":"bg-zinc-50 border-zinc-200 text-zinc-600"}`,style:{minHeight:We?"8rem":"2rem",transition:"all 0.2s ease-in-out"},children:[s.jsx("textarea",{className:"w-full bg-transparent outline-none resize-none placeholder:text-opacity-50 transition-all pr-8",value:O.prompt||"",placeholder:"...",onChange:Q=>Gt(n.id,O.id,{prompt:Q.target.value}),onClick:Q=>{Q.stopPropagation(),We||tl({nodeId:n.id,shotId:O.id})},onMouseDown:Q=>Q.stopPropagation(),onFocus:Q=>{Q.stopPropagation(),We||tl({nodeId:n.id,shotId:O.id})},onInput:Q=>{We&&(Q.currentTarget.style.height="auto",Q.currentTarget.style.height=Q.currentTarget.scrollHeight+"px")},ref:Q=>{Q&&We&&(Q.style.height="auto",Q.style.height=Q.scrollHeight+"px")},style:{minHeight:We?"8rem":"2rem",height:We?"auto":"2rem",transition:"all 0.2s ease-in-out"}}),(O.model==="sora-2"||O.model==="sora-2-pro")&&Wn.length>0&&s.jsx("button",{onClick:Q=>{Q.stopPropagation(),ra(!0)},className:`absolute top-2 right-2 p-1 rounded transition-colors ${e==="dark"?"text-zinc-500 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-400 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:s.jsx(Au,{size:12})})]}),(()=>{const Q=O.model||"";if(!(Q&&(Q.includes("sora")||Q==="sora-2"||Q==="sora-2-pro"))||Wn.length===0)return null;const tt=O.prompt||"",Je=`${n.id}-${O.id}`,Rt=Ih[Je]||!1,Ee=5,Ae=Wn.length>Ee;return s.jsx("div",{className:"border-t border-dashed mt-1",style:{borderColor:e==="dark"?"rgba(63, 63, 70, 0.5)":"rgba(161, 161, 170, 0.5)"},children:s.jsxs("div",{className:"flex items-center justify-between py-1 px-1",children:[s.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 flex-1 custom-scrollbar",children:(Rt?Wn:Wn.slice(0,Ee)).map(It=>{const Tt=`@${It.username}`,Ut=tt.includes(Tt);return s.jsxs("button",{onClick:jt=>{jt.stopPropagation();let mt=tt||"";Ut?mt=mt.replace(Tt,"").replace(/\s{2,}/g," ").trim():(mt=mt.trim(),mt=mt?`${mt} ${Tt} `:`${Tt} `),Gt(n.id,O.id,{prompt:mt})},className:`relative shrink-0 transition-all ${Ut?"scale-110":"opacity-70 hover:opacity-100"}`,title:It.username,children:[s.jsx("img",{src:It.localCacheUrl||It.profile_picture_url||"",alt:It.username,className:`w-8 h-8 rounded-full object-cover border-2 ${Ut?"border-blue-500 ring-2 ring-blue-500":"border-transparent"}`,onError:jt=>{jt.target.style.display="none"}}),s.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-black/50 rounded-full p-0.5",children:s.jsx(Ol,{size:8,className:"text-green-400"})})]},It.id)})}),Ae&&s.jsx("button",{onClick:It=>{It.stopPropagation(),Rt?Wc(Tt=>{const Ut={...Tt};return delete Ut[Je],Ut}):(ra(!0),Wc(Tt=>({...Tt,[Je]:!0})))},className:`shrink-0 px-2 py-1 text-[10px] rounded transition-colors ml-2 ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,title:Rt?"":"",children:Rt?"":`+${Wn.length-Ee}`})]})})})(),s.jsxs("div",{className:"flex gap-1 flex-wrap items-center mt-1",children:[(ze=O.tags)==null?void 0:ze.map((Q,De)=>s.jsx("span",{className:`px-1.5 py-0.5 text-[10px] rounded border ${e==="dark"?"bg-blue-900/30 text-blue-300 border-blue-800":"bg-blue-50 text-blue-600 border-blue-200"}`,children:Q},De)),O.camera&&s.jsxs("span",{className:`px-1.5 py-0.5 text-[10px] rounded border flex items-center gap-1 ${e==="dark"?"bg-purple-900/30 text-purple-300 border-purple-800":"bg-purple-50 text-purple-600 border-purple-200"}`,children:[s.jsx(Ru,{size:8})," ",O.camera]}),O.time_range&&s.jsx("span",{className:`text-[10px] ml-auto font-mono ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:O.time_range})]})]}),s.jsxs("div",{className:`flex flex-col items-center gap-3 justify-between border-l pl-2 pr-1 shrink-0 w-14 ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[(O.status==="generating"||O.status==="done"||O.status==="completed"||O.status==="failed"||O.status==="error")&&s.jsxs("div",{className:`px-1.5 py-0.5 rounded text-[11px] font-mono flex items-center justify-center gap-1 ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:[s.jsx(Gg,{size:12}),s.jsx("span",{children:O.status==="generating"?vh[`${n.id}-${O.id}`]?vh[`${n.id}-${O.id}`].replace(" ",""):"0.0s":`${(O.durationCost||0).toFixed(1)}s`})]}),s.jsx("button",{onClick:()=>{confirm("")&&X1(n.id,O.id)},className:`p-1.5 transition-colors ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-600"}`,title:"",onMouseDown:Q=>Q.stopPropagation(),children:s.jsx(Fr,{size:16})})]}),(()=>{var Je;const Q=((Je=n.settings)==null?void 0:Je.mode)||"video",De=Q==="image"?O.output_url:O.video_url,tt=O.status==="done"&&De;return s.jsx("button",{onClick:Rt=>{Rt.stopPropagation(),O.status==="generating"?Gt(n.id,O.id,{status:"draft",errorMsg:null}):Q==="image"?cm(n.id,O):lm(n.id,O)},className:`p-3 rounded text-white shadow-sm transition-all active:scale-95 ${O.status==="generating"?"bg-zinc-500 hover:bg-red-500":tt?"bg-blue-500 hover:bg-green-600":Q==="image"?"bg-blue-600 hover:bg-blue-500":"bg-green-600 hover:bg-green-500"}`,title:O.status==="generating"?"":tt?"":`${Q==="image"?"":""}`,onMouseDown:Rt=>Rt.stopPropagation(),children:O.status==="generating"?s.jsxs("div",{className:"relative w-4 h-4 flex items-center justify-center",children:[s.jsx(xi,{size:18,className:"animate-spin absolute"}),s.jsx(nx,{size:14,fill:"currentColor",className:"opacity-0 hover:opacity-100 absolute z-10 transition-opacity"})]}):tt?s.jsx(Vl,{size:18}):Q==="image"?s.jsx(ya,{size:18}):s.jsx(ex,{size:18,fill:"currentColor"})})})(),s.jsxs("div",{className:"flex flex-col items-center gap-1.5",children:[s.jsx("button",{onClick:()=>{var tt;const Q=[...((tt=n.settings)==null?void 0:tt.shots)||[]],De=Q.findIndex(Je=>Je.id===O.id);De>0&&([Q[De-1],Q[De]]=[Q[De],Q[De-1]],Le(n.id,{shots:Q}))},disabled:Pe===0,className:`p-1.5 rounded transition-colors ${Pe===0?"opacity-30 cursor-not-allowed":""} ${e==="dark"?"text-zinc-500 hover:text-blue-400 hover:bg-zinc-800":"text-zinc-400 hover:text-blue-500 hover:bg-zinc-100"}`,title:"",onMouseDown:Q=>Q.stopPropagation(),children:s.jsx(of,{size:16})}),s.jsx("button",{onClick:()=>{var tt;const Q=[...((tt=n.settings)==null?void 0:tt.shots)||[]],De=Q.findIndex(Je=>Je.id===O.id);De<Q.length-1&&([Q[De],Q[De+1]]=[Q[De+1],Q[De]],Le(n.id,{shots:Q}))},disabled:Pe===(((ge=(he=n.settings)==null?void 0:he.shots)==null?void 0:ge.length)||0)-1,className:`p-1.5 rounded transition-colors ${Pe===(((st=(et=n.settings)==null?void 0:et.shots)==null?void 0:st.length)||0)-1?"opacity-30 cursor-not-allowed":""} ${e==="dark"?"text-zinc-500 hover:text-blue-400 hover:bg-zinc-800":"text-zinc-400 hover:text-blue-500 hover:bg-zinc-100"}`,title:"",onMouseDown:Q=>Q.stopPropagation(),children:s.jsx(zs,{size:16})})]})]})]}),((Ve=n.settings)==null?void 0:Ve.showOutputPreview)&&s.jsxs("div",{className:`shrink-0 p-2 ml-1 flex flex-col gap-2 rounded-lg border transition-all ${e==="dark"?"bg-zinc-900/50 border-zinc-800":"bg-white border-zinc-200"} ${O.outputEnabled?e==="dark"?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-300":""}`,style:{width:220},children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:`w-4 h-4 rounded border cursor-pointer flex items-center justify-center transition-colors ${O.outputEnabled?"bg-blue-500 border-blue-500 text-white":e==="dark"?"border-zinc-600 hover:border-blue-400":"border-zinc-400 hover:border-blue-400"}`,onClick:Q=>{Q.stopPropagation(),Gt(n.id,O.id,{outputEnabled:!O.outputEnabled})},title:O.outputEnabled?"":"",children:O.outputEnabled&&s.jsx(Kl,{size:10})}),s.jsx("span",{className:`text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:((nt=O.output_images)==null?void 0:nt.length)>0?"":""})]}),(()=>{var It;const Q=O.output_images||[],De=O.selectedImageIndex??0;if((((It=n.settings)==null?void 0:It.mode)||"video")==="video")return s.jsxs("div",{className:`flex-1 min-h-[80px] rounded overflow-hidden relative group/preview cursor-pointer border ${e==="dark"?"border-zinc-800 bg-black":"border-zinc-200 bg-zinc-50"}`,onClick:Tt=>{Tt.stopPropagation(),O.video_url&&$n({url:O.video_url,type:"video",prompt:O.prompt})},children:[O.video_url?s.jsx("video",{src:O.video_url,className:"w-full h-full object-cover",muted:!0}):s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30",children:s.jsx(Jg,{size:16})}),O.video_url&&s.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/preview:opacity-100 flex items-center justify-center transition-opacity",children:s.jsx(Us,{size:16,className:"text-white drop-shadow-md"})}),O.video_filename&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity",title:O.video_filename,children:O.video_filename})]});const Je=O.outputEnabled,Rt=De>=0,Ee=Rt?De:0;if(Q.length>=2)if(We){const Tt=Q[Ee]||Q[0],Ut=Q.slice(0,4).map((jt,mt)=>({img:jt,idx:mt})).filter(jt=>jt.idx!==Ee);return s.jsxs("div",{className:"flex flex-col gap-1 flex-1 min-h-[100px]",children:[s.jsxs("div",{className:`relative flex-1 rounded border overflow-hidden transition-all group/main ${Rt?"border-blue-500 ring-1 ring-blue-500/50":e==="dark"?"border-zinc-700":"border-zinc-300"} ${Je?"cursor-not-allowed opacity-80":"cursor-pointer"}`,onClick:jt=>{jt.stopPropagation(),Je||Gt(n.id,O.id,{selectedImageIndex:Rt?-1:Ee})},onDoubleClick:jt=>{var mt,Yt;jt.stopPropagation(),$n({url:Tt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:Ee,storyboardContext:{nodeId:n.id,shotId:O.id,shotIndex:(((mt=n.settings)==null?void 0:mt.shots)||[]).findIndex(tn=>tn.id===O.id),allShots:((Yt=n.settings)==null?void 0:Yt.shots)||[]}})},onContextMenu:jt=>{wl(jt,{url:Tt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:Ee,sourceNode:n})},children:[s.jsx(Yn,{src:Tt,className:"w-full h-full object-cover"}),s.jsx("div",{className:`absolute top-0 left-0 text-[8px] px-1 py-0.5 rounded-br ${Rt?"bg-blue-500 text-white":"bg-black/50 text-white"}`,children:Ee+1}),Rt&&s.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white p-0.5 rounded-bl",children:s.jsx(Kl,{size:10})}),Je&&s.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500 text-black p-0.5 rounded text-[8px]",children:""}),s.jsx("button",{onClick:jt=>{var mt,Yt;jt.stopPropagation(),$n({url:Tt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:Ee,storyboardContext:{nodeId:n.id,shotId:O.id,shotIndex:(((mt=n.settings)==null?void 0:mt.shots)||[]).findIndex(tn=>tn.id===O.id),allShots:((Yt=n.settings)==null?void 0:Yt.shots)||[]}})},className:"absolute bottom-0 left-0 p-0.5 rounded-tr bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover/main:opacity-100 transition-opacity z-10",title:"",children:s.jsx(Us,{size:10})})]}),s.jsx("div",{className:"flex gap-1 h-10 shrink-0",children:Ut.map(({img:jt,idx:mt})=>s.jsxs("div",{className:`relative flex-1 rounded border overflow-hidden transition-all group/thumb ${e==="dark"?"border-zinc-700":"border-zinc-300"} ${Je?"cursor-not-allowed opacity-60":"cursor-pointer hover:border-blue-400"}`,onClick:Yt=>{Yt.stopPropagation(),Je||Gt(n.id,O.id,{selectedImageIndex:mt})},onContextMenu:Yt=>{wl(Yt,{url:jt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:mt,sourceNode:n})},children:[s.jsx(Yn,{src:jt,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute top-0 left-0 bg-black/50 text-white text-[7px] px-0.5",children:mt+1})]},mt))})]})}else return s.jsx("div",{className:"grid grid-cols-2 gap-1 flex-1 min-h-[100px]",children:Q.slice(0,4).map((Tt,Ut)=>s.jsxs("div",{className:`relative rounded border overflow-hidden transition-all group/cell ${De===Ut?"border-blue-500 ring-1 ring-blue-500/50":e==="dark"?"border-zinc-700":"border-zinc-300"} ${Je?"cursor-not-allowed opacity-80":"cursor-pointer hover:border-blue-400"}`,onClick:jt=>{jt.stopPropagation(),Je||Gt(n.id,O.id,{selectedImageIndex:De===Ut?-1:Ut})},onDoubleClick:jt=>{var mt,Yt;jt.stopPropagation(),$n({url:Tt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:Ut,storyboardContext:{nodeId:n.id,shotId:O.id,shotIndex:(((mt=n.settings)==null?void 0:mt.shots)||[]).findIndex(tn=>tn.id===O.id),allShots:((Yt=n.settings)==null?void 0:Yt.shots)||[]}})},onContextMenu:jt=>{wl(jt,{url:Tt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:Ut,sourceNode:n})},children:[s.jsx(Yn,{src:Tt,className:"w-full h-full object-cover"}),s.jsx("div",{className:`absolute top-0 left-0 text-[7px] px-0.5 rounded-br ${De===Ut?"bg-blue-500 text-white":"bg-black/50 text-white"}`,children:Ut+1}),De===Ut&&s.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white p-0.5 rounded-bl",children:s.jsx(Kl,{size:8})}),s.jsx("button",{onClick:jt=>{var mt,Yt;jt.stopPropagation(),$n({url:Tt,type:"image",prompt:O.prompt,mjImages:Q,selectedMjImageIndex:Ut,storyboardContext:{nodeId:n.id,shotId:O.id,shotIndex:(((mt=n.settings)==null?void 0:mt.shots)||[]).findIndex(tn=>tn.id===O.id),allShots:((Yt=n.settings)==null?void 0:Yt.shots)||[]}})},className:"absolute bottom-0 left-0 p-0.5 rounded-tr bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover/cell:opacity-100 transition-opacity z-10",title:"",children:s.jsx(Us,{size:8})})]},Ut))});const Ae=Q[0]||O.output_url;return s.jsxs("div",{className:`flex-1 min-h-[80px] rounded overflow-hidden relative group/preview cursor-pointer border ${e==="dark"?"border-zinc-800 bg-black":"border-zinc-200 bg-zinc-50"}`,onClick:Tt=>{Tt.stopPropagation(),Ae&&$n({url:Ae,type:"image",prompt:O.prompt})},onContextMenu:Tt=>{Ae&&wl(Tt,{url:Ae,type:"image",prompt:O.prompt,sourceNode:n})},children:[Ae?s.jsx(Yn,{src:Ae,className:"w-full h-full object-cover"}):s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30",children:s.jsx(Jg,{size:16})}),Ae&&s.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/preview:opacity-100 flex items-center justify-center transition-opacity",children:s.jsx(Us,{size:16,className:"text-white drop-shadow-md"})}),O.image_filename&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity",title:O.image_filename,children:O.image_filename})]})})()]})]})]},O.id)}):s.jsxs("div",{className:`flex flex-col items-center justify-center h-40 gap-3 rounded-lg border-2 border-dashed ${e==="dark"?"border-zinc-800 text-zinc-600":"border-zinc-300 text-zinc-400"}`,children:[s.jsx(Dl,{size:32,className:"opacity-50"}),s.jsx("span",{className:"text-xs",children:""})]})}),s.jsx("div",{className:`p-3 border-t shrink-0 ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:s.jsxs("button",{onClick:()=>G1(n.id),className:`w-full py-2 border border-dashed text-xs rounded transition-colors flex items-center justify-center gap-2 ${e==="dark"?"border-zinc-700 text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200":"border-zinc-300 text-zinc-500 hover:bg-white hover:text-blue-600 hover:border-blue-400"}`,onMouseDown:O=>O.stopPropagation(),children:[s.jsx(Ji,{size:14})," "]})})]})})})(),n.type==="image-compare"&&s.jsx("div",{className:"w-full h-full pointer-events-auto",children:s.jsx(Kz,{img1:u[0],img2:u[1]})}),n.type==="preview"&&s.jsxs("div",{className:"flex flex-col h-full pointer-events-auto",children:[s.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b text-xs font-semibold ${e==="dark"?"border-zinc-800 text-zinc-200":"border-zinc-200 text-zinc-700"}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Us,{size:13,className:"text-blue-500"}),s.jsx("span",{children:""})]}),s.jsx("span",{className:"text-[10px] text-zinc-500",children:n.previewType==="video"?"":""})]}),s.jsxs("div",{className:"flex-1 flex flex-col p-2 gap-2 min-h-0",children:[s.jsx("div",{className:`relative flex-1 rounded-lg overflow-hidden flex items-center justify-center min-h-0 ${e==="dark"?"bg-zinc-900":"bg-zinc-100"}`,onContextMenu:B=>{const pe=n.content||n.previewMjImages&&n.previewMjImages[0];pe&&wl(B,{url:pe,type:n.previewType||(Hn(pe)?"video":"image"),sourceNode:n})},onDoubleClick:B=>{B.stopPropagation(),B.preventDefault();const pe=n.content||n.previewMjImages&&n.previewMjImages[0];pe&&$n({url:pe,type:n.previewType||(Hn(pe)?"video":"image")})},children:n.content||n.previewMjImages&&n.previewMjImages.length>0?Hn(n.content)||n.previewType==="video"?s.jsx("video",{src:n.content,className:"w-full h-full object-contain bg-black",controls:!0,draggable:!1}):n.previewMjImages&&(n.previewMjImages.length===4||n.previewMjImages.length>1)?s.jsx("div",{className:`w-full h-full grid gap-0.5 p-0.5 ${n.previewMjImages.length===4?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:n.previewMjImages.map((B,pe)=>s.jsx("div",{className:"relative w-full h-full overflow-hidden bg-black flex items-center justify-center group",children:s.jsx("img",{src:B,className:"max-w-full max-h-full w-auto h-auto object-contain",alt:` ${pe+1}`,draggable:!1,onError:Ue=>{console.error(` ${pe+1} `),Ue.target.style.display="none"}})},pe))}):s.jsxs("div",{className:"w-full h-full relative group/preview",children:[s.jsx(Yn,{src:n.content||n.previewMjImages&&n.previewMjImages[0],className:"w-full h-full object-contain bg-black",draggable:!1,onError:B=>{console.warn("[Preview] Image load error")}}),n.previewFilename&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] px-2 py-1 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity backdrop-blur-sm",title:n.previewFilename,children:n.previewFilename})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center text-[11px] text-zinc-500",children:[s.jsx(ya,{className:"w-6 h-6 mb-1 text-zinc-400"}),s.jsx("span",{children:" AI  / AI  "}),s.jsx("span",{children:""})]})}),s.jsxs("div",{className:"flex items-center justify-between gap-2 text-[11px]",children:[s.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:B=>B.stopPropagation(),onClick:async()=>{if(n.content)try{await navigator.clipboard.writeText(n.content)}catch{}},children:[s.jsx(ba,{size:13}),""]}),s.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:B=>B.stopPropagation(),onClick:async()=>{if(!n.content)return;const B=xn(n.x+n.width+100,n.y+n.height/2);let pe;if(!Hn(n.content))try{const Ue=await Br(n.content);Ue!=null&&Ue.w&&(Ue!=null&&Ue.h)&&(pe={w:Ue.w,h:Ue.h})}catch{}Lr("input-image",B.x,B.y,null,n.content,pe)},children:[s.jsx(Pu,{size:13}),""]}),s.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:B=>B.stopPropagation(),onClick:()=>{if(!n.content)return;const B={name:n.previewType==="video"?"Preview.mp4":"Preview.png",type:n.previewType==="video"?"video/mp4":"image/png",content:n.content,isImage:n.previewType!=="video",isVideo:n.previewType==="video",isAudio:!1,fromPreview:!0};Ti(pe=>[...pe,B]),An(!0)},children:[s.jsx(va,{size:13}),""]})]})]})]}),(n.type==="gen-image"||n.type==="gen-video")&&(()=>{var kt,Ht,vt,Vt,pt,ft,wt,at,At,Wt,Bt,zt,yn,Tn;const B=Pt.find(q=>q.sourceNodeId===n.id&&(q.status==="generating"||q.status==="completed")),pe=B&&B.status==="generating",Ue=B!=null&&B.durationMs?(B.durationMs/1e3).toFixed(1):null,ot=Mh[n.id]||0;return s.jsxs("div",{className:"p-3 flex flex-col h-full pointer-events-auto",children:[(pe||Ue)&&s.jsx("div",{className:`mb-2 px-2 py-1 rounded text-[10px] font-mono text-center ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:pe?s.jsxs("span",{children:[" ",ot.toFixed(1),"s"]}):s.jsxs("span",{children:["  ",Ue,"s"]})}),s.jsxs("div",{className:`flex items-center gap-1.5 mb-2 text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[n.type==="gen-image"?s.jsx(rx,{size:12,className:"text-blue-400"}):s.jsx(Ru,{size:12,className:"text-purple-400"}),s.jsx("span",{children:n.type==="gen-image"?"AI ":"AI "})]}),u.length>0&&s.jsxs("div",{className:`mb-2 rounded-lg border p-2 relative group/ref ${e==="dark"?"bg-zinc-900/50 border-purple-500/20":"bg-violet-50 border-violet-200"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[s.jsxs("span",{className:`text-[10px] font-medium flex items-center gap-1 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[s.jsx(Qg,{size:10}),""]}),s.jsxs("span",{className:"text-[9px] font-mono text-zinc-500",children:[u.length,"/10"]})]}),s.jsx("div",{className:"flex -space-x-2 overflow-visible pb-1 items-center custom-scrollbar pl-1",children:u.map((q,re)=>s.jsx("div",{className:"relative shrink-0 flex flex-col items-center gap-0 ",children:s.jsxs("div",{className:"relative",children:[s.jsx("span",{className:"absolute -top-1 -left-1 w-4 h-4 text-[9px] font-semibold rounded-full bg-zinc-700 text-white select-none flex items-center justify-center border border-white/70 shadow-sm leading-none pointer-events-none",style:{zIndex:30},children:re+1}),s.jsx("div",{className:`relative w-8 h-8 rounded-full border-2 thumb-stack-item cursor-pointer overflow-hidden ${e==="dark"?"border-[#18181b] bg-zinc-800":"border-white bg-zinc-200"}`,style:{zIndex:10-re},children:s.jsx(Yn,{src:q,className:"w-full h-full object-cover"})})]})},re))})]}),s.jsxs("div",{className:`rounded-lg p-3 mb-2 border focus-within:border-blue-500/30 transition-colors flex-1 flex flex-col ${e==="dark"?"bg-zinc-950/50 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[n.type==="gen-image"&&(()=>{const q=n==null?void 0:n.maskContent;let re=p.find(Te=>Te.to===n.id&&(!Te.inputType||Te.inputType==="default"));re||(re=p.find(Te=>Te.to===n.id));const Ie=re?Dt.get(re.from):null,lt=Ie&&Ie.maskContent;return q||lt?s.jsxs("div",{className:`flex items-center gap-1.5 mb-2 px-2 py-1 rounded text-[10px] font-medium ${e==="dark"?"bg-purple-900/30 text-purple-300 border border-purple-800":"bg-purple-50 text-purple-600 border border-purple-200"}`,children:[s.jsx(Ky,{size:12}),s.jsx("span",{children:lt?"":""})]}):null})(),s.jsxs("div",{className:"flex items-start gap-2 mb-1 flex-1 h-full min-h-0",children:[s.jsx("textarea",{className:`flex-1 h-full bg-transparent text-xs outline-none resize-none custom-scrollbar ${e==="dark"?"text-zinc-300 placeholder-zinc-600":"text-zinc-800 placeholder-zinc-400"}`,placeholder:"...",value:n.type==="gen-image"?((kt=n.settings)==null?void 0:kt.prompt)||"":((Ht=n.settings)==null?void 0:Ht.videoPrompt)||"",onChange:q=>Le(n.id,n.type==="gen-image"?{prompt:q.target.value}:{videoPrompt:q.target.value}),onMouseDown:q=>q.stopPropagation()}),n.type==="gen-video"&&(((vt=n.settings)==null?void 0:vt.model)==="sora-2"||((Vt=n.settings)==null?void 0:Vt.model)==="sora-2-pro")&&Wn.length>0&&s.jsx("div",{className:"relative shrink-0",children:s.jsx("button",{onClick:q=>{q.stopPropagation(),ra(!0)},className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:s.jsx(Au,{size:14})})})]})]}),n.type==="gen-video"&&(()=>{var ut,vn;const q=((ut=n.settings)==null?void 0:ut.model)||"",re=mn.get(q),Ie=(re==null?void 0:re.modelName)||(re==null?void 0:re.id)||q;if(!(Ie&&(Ie.includes("sora")||q.includes("sora")))||Wn.length===0)return null;const ie=((vn=n.settings)==null?void 0:vn.videoPrompt)||"",Te=Ih[n.id]||!1,yt=5,sn=Wn.length>yt;return s.jsx("div",{className:"border-t border-dashed mt-1",style:{borderColor:e==="dark"?"rgba(63, 63, 70, 0.5)":"rgba(161, 161, 170, 0.5)"},children:s.jsxs("div",{className:"flex items-center justify-between py-1 px-1",children:[s.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 flex-1 custom-scrollbar",children:(Te?Wn:Wn.slice(0,yt)).map(qt=>{const pn=`@${qt.username}`,Qe=ie.includes(pn);return s.jsxs("button",{onClick:Ot=>{Ot.stopPropagation();let Lt=ie||"";Qe?Lt=Lt.replace(pn,"").replace(/\s{2,}/g," ").trim():(Lt=Lt.trim(),Lt=Lt?`${Lt} ${pn} `:`${pn} `),Le(n.id,{videoPrompt:Lt})},className:`relative shrink-0 transition-all ${Qe?"scale-110":"opacity-70 hover:opacity-100"}`,title:qt.username,children:[s.jsx(Yn,{src:qt.localCacheUrl||qt.profile_picture_url||"",alt:qt.username,className:`w-8 h-8 rounded-full object-cover border-2 ${Qe?"border-blue-500 ring-2 ring-blue-500":"border-transparent"}`,onError:Ot=>{Ot.target.style.display="none"}}),s.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-black/50 rounded-full p-0.5",children:s.jsx(Ol,{size:8,className:"text-green-400"})})]},qt.id)})}),sn&&s.jsx("button",{onClick:qt=>{qt.stopPropagation(),Te?Wc(pn=>{const Qe={...pn};return delete Qe[n.id],Qe}):(ra(!0),Wc(pn=>({...pn,[n.id]:!0})))},className:`shrink-0 px-2 py-1 text-[10px] rounded transition-colors ml-2 ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,title:Te?"":"",children:Te?"":`+${Wn.length-yt}`})]})})})(),n.type==="gen-image"&&(()=>{var Ie;const q=mn.get((Ie=n.settings)==null?void 0:Ie.model);return q&&(q.id.includes("mj")||q.provider.toLowerCase().includes("midjourney"))})()&&(()=>{var Ie,lt;const q=su(n.id,"oref"),re=su(n.id,"sref");return s.jsxs("div",{className:"flex flex-col gap-1.5 mb-2 relative","data-mj-instructions":"true",children:[s.jsxs("div",{className:"relative flex items-center gap-1.5","data-mj-oref":"true",children:[s.jsx("div",{className:`input-point ${q?"connected":""} ${gn===n.id&&ys==="oref"?"active":""}`,title:"oref",onMouseDown:ie=>{ie.stopPropagation(),ie.preventDefault();const Te=xn(ie.clientX,ie.clientY);Ts(Te),bs(n.id),vs("oref")},onMouseUp:ie=>Rs(n.id,ie,"oref"),"data-input-type":"oref",style:{position:"absolute",top:"50%",left:"-0.25rem",transform:"translateY(-50%)",width:"0.5rem",height:"0.5rem",marginRight:"0.25rem",zIndex:20,cursor:"crosshair"}}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-1 ml-2",children:[s.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"oref"}),q&&s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]})]}),s.jsxs("div",{className:"relative flex items-center gap-1.5",children:[s.jsx("div",{className:"w-0.5rem h-0.5rem mr-0.25rem ml-2"}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-1",children:[s.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"ow"}),((Ie=n.settings)==null?void 0:Ie.mjOw)&&n.settings.mjOw>0&&s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]}),s.jsx("input",{type:"number",min:"1",max:"1000",placeholder:"1-1000",value:((lt=n.settings)==null?void 0:lt.mjOw)||"",onChange:ie=>{const Te=parseInt(ie.target.value,10);isNaN(Te)||Te<1?Le(n.id,{mjOw:""}):Te>1e3?Le(n.id,{mjOw:1e3}):Le(n.id,{mjOw:Te})},onMouseDown:ie=>ie.stopPropagation(),className:`flex-1 px-2 py-1 rounded text-[10px] border outline-none focus:border-blue-500/50 ${e==="dark"?"bg-zinc-900/50 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`})]}),s.jsxs("div",{className:"relative flex items-center gap-1.5","data-mj-sref":"true",children:[s.jsx("div",{className:`input-point ${re?"connected":""} ${gn===n.id&&ys==="sref"?"active":""}`,title:"sref",onMouseDown:ie=>{ie.stopPropagation(),ie.preventDefault();const Te=xn(ie.clientX,ie.clientY);Ts(Te),bs(n.id),vs("sref")},onMouseUp:ie=>Rs(n.id,ie,"sref"),"data-input-type":"sref",style:{position:"absolute",top:"50%",left:"-0.25rem",transform:"translateY(-50%)",width:"0.5rem",height:"0.5rem",marginRight:"0.25rem",zIndex:20,cursor:"crosshair"}}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-1 ml-2",children:[s.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"sref"}),re&&s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]})]})]})})(),n.type==="gen-image"&&C&&s.jsxs("div",{className:`mb-2 rounded-lg border p-3 space-y-2 ${e==="dark"?"bg-zinc-900/50 border-zinc-800":"bg-white border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("button",{className:"flex items-center gap-1 text-[11px] font-semibold",onClick:()=>qy(q=>!q),onMouseDown:q=>q.stopPropagation(),children:[s.jsx("span",{className:e==="dark"?"text-zinc-200":"text-zinc-700",children:""}),s.jsx(wa,{size:12,className:`transition-transform ${bh?"":"rotate-90"} ${e==="dark"?"text-zinc-400":"text-zinc-500"}`})]}),s.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[s.jsxs("span",{className:"text-zinc-500",children:[Za.length," "]}),s.jsx("button",{className:`px-2 py-0.5 rounded text-[10px] border ${e==="dark"?"border-zinc-700 text-zinc-300 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>Qy(q=>!q),onMouseDown:q=>q.stopPropagation(),children:Xd?"":""})]})]}),!bh&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"max-h-36 overflow-y-auto custom-scrollbar flex flex-wrap gap-2",children:[Za.map(q=>s.jsxs("div",{className:`border rounded-lg px-2 py-1.5 flex items-center gap-2 text-[11px] ${e==="dark"?"border-zinc-700 bg-zinc-950/50 text-zinc-200":"border-zinc-200 bg-zinc-50 text-zinc-700"}`,children:[s.jsx("span",{className:"font-medium whitespace-nowrap",children:q.name}),s.jsx("button",{onClick:()=>rv(n.id,q.prompt),className:"px-2 py-0.5 rounded text-[10px] bg-blue-600 text-white hover:bg-blue-500 transition-colors",onMouseDown:re=>re.stopPropagation(),children:""}),Xd&&s.jsx("button",{onClick:()=>nv(q.id),className:`px-2 py-0.5 rounded text-[10px] border ${e==="dark"?"border-red-500/50 text-red-400 hover:bg-red-500/10":"border-red-200 text-red-600 hover:bg-red-50"}`,onMouseDown:re=>re.stopPropagation(),children:""})]},q.id)),Za.length===0&&s.jsx("div",{className:`text-[11px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""})]}),Xd&&s.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[s.jsx("input",{type:"text",value:Rc.name,onChange:q=>Gd(re=>({...re,name:q.target.value})),placeholder:"",className:`w-full px-2 py-1 text-[11px] rounded border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder:text-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder:text-zinc-400"}`,onMouseDown:q=>q.stopPropagation()}),s.jsx("textarea",{value:Rc.prompt,onChange:q=>Gd(re=>({...re,prompt:q.target.value})),placeholder:"...",className:`w-full min-h-[70px] px-2 py-1 text-[11px] rounded border resize-none custom-scrollbar ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder:text-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder:text-zinc-400"}`,onMouseDown:q=>q.stopPropagation()}),s.jsx("button",{onClick:tv,className:"w-full py-1.5 rounded text-[11px] font-medium bg-blue-600 hover:bg-blue-500 text-white transition-colors",onMouseDown:q=>q.stopPropagation(),children:""})]})]})]}),s.jsxs("div",{className:`mt-auto pt-2 flex items-center justify-between shrink-0 relative gap-2 border-t ${e==="dark"?"border-zinc-800/50":"border-zinc-200"}`,children:[s.jsxs("div",{className:"relative flex-1 min-w-0",children:[s.jsxs("button",{title:(ft=mn.get((pt=n.settings)==null?void 0:pt.model))==null?void 0:ft.provider,onClick:q=>{q.stopPropagation(),nn((Ce==null?void 0:Ce.type)==="model"?null:{nodeId:n.id,type:"model"})},className:`flex items-center gap-2 pl-1 pr-2 py-1 rounded text-[10px] transition-colors border w-full ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-300 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-700 border-zinc-300"}`,children:[s.jsx("span",{className:`w-2 h-2 rounded-full ${Ds((wt=n.settings)==null?void 0:wt.model)}`}),s.jsx("span",{className:"truncate font-mono",children:((At=mn.get((at=n.settings)==null?void 0:at.model))==null?void 0:At.id)||"Model"})]}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="model"&&s.jsxs("div",{className:`absolute bottom-full left-0 mb-1 w-96 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:q=>q.stopPropagation(),onMouseLeave:()=>tr(null),children:[s.jsx("div",{className:`w-36 border-r pr-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col justify-end ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,q])=>q.models.some(re=>re.type===(n.type==="gen-image"?"Image":"Video"))).map(([q,re])=>s.jsxs("button",{onMouseEnter:()=>tr(q),className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left text-[10px] transition-colors ${Nn===q?e==="dark"?"bg-zinc-700 text-zinc-100":"bg-zinc-200 text-zinc-900":e==="dark"?"hover:bg-zinc-800 text-zinc-400":"hover:bg-zinc-100 text-zinc-600"}`,children:[s.jsx("span",{className:"truncate font-medium",children:re.name}),s.jsx(wa,{size:10,className:"opacity-50"})]},q))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col justify-end",children:[Nn&&((Wt=gr[Nn])==null?void 0:Wt.models.filter(q=>q.type===(n.type==="gen-image"?"Image":"Video")).map(q=>{var re;return s.jsxs("button",{onClick:()=>{const Ie={model:q.id};if(q.id==="grok-3"&&(Ie.ratio="3:2",Ie.duration="8s",Ie.resolution="1080P"),Le(n.id,Ie),n.type==="gen-image"){dp(q.id);try{localStorage.setItem("tapnow_last_image_model",q.id)}catch{}}else if(n.type==="gen-video"){pp(q.id);try{localStorage.setItem("tapnow_last_video_model",q.id)}catch{}}nn(null),tr(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((re=n.settings)==null?void 0:re.model)===q.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:q.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(q.id)}`})]},q.id)})),!Nn&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]}),n.type==="gen-image"&&(()=>{var re;const q=mn.get((re=n.settings)==null?void 0:re.model);return q&&(q.id.includes("mj")||q.provider.toLowerCase().includes("midjourney"))})()&&s.jsxs("div",{className:"relative flex-1 min-w-0",children:[s.jsx("button",{title:((Bt=pf.find(q=>{var re;return q.value===((re=n.settings)==null?void 0:re.mjVersion)}))==null?void 0:Bt.label)||"MJ V7",onClick:q=>{q.stopPropagation(),nn((Ce==null?void 0:Ce.type)==="mjVersion"&&Ce.nodeId===n.id?null:{nodeId:n.id,type:"mjVersion"})},className:`flex items-center gap-2 pl-1 pr-2 py-1 rounded text-[10px] transition-colors border w-full ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-300 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-700 border-zinc-300"}`,children:s.jsx("span",{className:"truncate",children:((zt=pf.find(q=>{var re;return q.value===((re=n.settings)==null?void 0:re.mjVersion)}))==null?void 0:zt.label)||"MJ V7"})}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="mjVersion"&&s.jsx("div",{className:`absolute bottom-full left-0 mb-1 w-32 rounded-lg shadow-xl p-1 z-[60] border max-h-64 overflow-y-auto custom-scrollbar ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:q=>q.stopPropagation(),children:pf.map(q=>{var re,Ie;return s.jsxs("button",{onClick:()=>{Le(n.id,{mjVersion:q.value}),nn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"} ${((re=n.settings)==null?void 0:re.mjVersion)===q.value?e==="dark"?"bg-zinc-800":"bg-zinc-100":""}`,children:[s.jsx("span",{className:"text-xs font-medium",children:q.label}),((Ie=n.settings)==null?void 0:Ie.mjVersion)===q.value&&s.jsx("svg",{className:"w-3 h-3 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},q.value)})})]}),s.jsxs("div",{className:"flex gap-1 shrink-0",children:[s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:q=>{q.stopPropagation(),nn((Ce==null?void 0:Ce.type)==="ratio"&&Ce.nodeId===n.id?null:{nodeId:n.id,type:"ratio"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((yn=n.settings)==null?void 0:yn.ratio)||"Auto"}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="ratio"&&s.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-20 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:q=>q.stopPropagation(),children:mx((Tn=n.settings)==null?void 0:Tn.model).map(q=>s.jsx("button",{onClick:()=>{Le(n.id,{ratio:q}),u1(q);try{localStorage.setItem("tapnow_last_ratio",q)}catch{}nn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:q},q))})]}),n.type==="gen-video"&&(()=>{var lt,ie;const q=mn.get((lt=n.settings)==null?void 0:lt.model);return((q==null?void 0:q.id)||(q==null?void 0:q.modelName)||"").includes("grok")?s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:Te=>{Te.stopPropagation(),nn((Ce==null?void 0:Ce.type)==="vres"&&Ce.nodeId===n.id?null:{nodeId:n.id,type:"vres"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:Yl(((ie=n.settings)==null?void 0:ie.resolution)||"720P")}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="vres"&&s.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-24 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Te=>Te.stopPropagation(),children:Xy.map(Te=>s.jsx("button",{onClick:()=>{Le(n.id,{resolution:Te}),Th(Te);try{localStorage.setItem("tapnow_last_video_res",Te)}catch{}nn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:Te},Te))})]}):null})(),n.type==="gen-image"&&(()=>{var Ie;const q=mn.get((Ie=n.settings)==null?void 0:Ie.model);return!(q&&(q.id.includes("mj")||q.provider.toLowerCase().includes("midjourney")))})()?s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:q=>{q.stopPropagation(),nn((Ce==null?void 0:Ce.type)==="res"&&Ce.nodeId===n.id?null:{nodeId:n.id,type:"res"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:(()=>{var yt,sn;const q=mn.get((yt=n.settings)==null?void 0:yt.model),re=(q==null?void 0:q.id)||(q==null?void 0:q.modelName)||"",Ie=df(re),lt=((sn=n.settings)==null?void 0:sn.resolution)||"2K",ie=Ul(lt),Te=Ie.includes(ie)?ie:Ie[0]||"2K";return lt!==ie&&Ie.includes(ie)?setTimeout(()=>{Le(n.id,{resolution:ie})},0):!Ie.includes(ie)&&Ie.length>0&&setTimeout(()=>{Le(n.id,{resolution:Ie[0]})},0),Te})()}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="res"&&(()=>{var lt;const q=mn.get((lt=n.settings)==null?void 0:lt.model),re=(q==null?void 0:q.id)||(q==null?void 0:q.modelName)||"",Ie=df(re);return s.jsx("div",{className:`absolute bottom-full right-0 mb-1 w-24 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:ie=>ie.stopPropagation(),children:Ie.map(ie=>s.jsx("button",{onClick:()=>{Le(n.id,{resolution:ie}),d1(ie);try{localStorage.setItem("tapnow_last_image_res",ie)}catch{}nn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:ie},ie))})})()]}):(()=>{var Ie,lt,ie,Te,yt,sn,ut,vn,qt,pn,Qe,Ot,Lt,O;const q=mn.get((Ie=n.settings)==null?void 0:Ie.model);return q&&(q.id.includes("mj")||q.provider.toLowerCase().includes("midjourney"))?null:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:Pe=>{Pe.stopPropagation(),nn((Ce==null?void 0:Ce.type)==="duration"&&Ce.nodeId===n.id?null:{nodeId:n.id,type:"duration"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((lt=n.settings)==null?void 0:lt.duration)||"5s"}),(Ce==null?void 0:Ce.nodeId)===n.id&&Ce.type==="duration"&&s.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-20 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Pe=>Pe.stopPropagation(),children:(((ie=ue.find(Pe=>{var We;return Pe.id===((We=n.settings)==null?void 0:We.model)}))==null?void 0:ie.durations)||["5s","10s"]).map(Pe=>s.jsx("button",{onClick:()=>{Le(n.id,{duration:Pe}),nn(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:Pe},Pe))})]}),(((yt=(Te=n.settings)==null?void 0:Te.model)==null?void 0:yt.includes("jimeng"))||((vn=(ut=mn.get((sn=n.settings)==null?void 0:sn.model))==null?void 0:ut.modelName)==null?void 0:vn.includes("jimeng"))||((pn=(qt=n.settings)==null?void 0:qt.model)==null?void 0:pn.includes("grok")))&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("span",{className:"text-[10px] opacity-70",children:""}),s.jsx("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 rounded p-0.5 border dark:border-zinc-700",children:["720p","1080p"].map(Pe=>{var We;return s.jsx("button",{onClick:Ge=>{Ge.stopPropagation(),Le(n.id,{resolution:Pe})},onMouseDown:Ge=>Ge.stopPropagation(),className:`text-[10px] px-2 py-0.5 rounded transition-all ${(((We=n.settings)==null?void 0:We.resolution)||"720p")===Pe?"bg-white dark:bg-zinc-700 shadow-sm text-blue-600 dark:text-blue-400 font-medium":"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,children:Pe},Pe)})})]}),n.type==="gen-video"&&((Qe=n.settings)==null?void 0:Qe.model)==="sora-2"&&s.jsxs("label",{className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border cursor-pointer transition-colors ${e==="dark"?(Ot=n.settings)!=null&&Ot.isHD?"bg-blue-600/30 border-blue-500 text-blue-300":"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":(Lt=n.settings)!=null&&Lt.isHD?"bg-blue-500/30 border-blue-400 text-blue-700":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,onClick:Pe=>Pe.stopPropagation(),children:[s.jsx("input",{type:"checkbox",checked:((O=n.settings)==null?void 0:O.isHD)||!1,onChange:Pe=>{Pe.stopPropagation(),Le(n.id,{isHD:Pe.target.checked})},className:"w-3 h-3 cursor-pointer",onMouseDown:Pe=>Pe.stopPropagation()}),s.jsx("span",{children:"HD"})]})]})})()]}),s.jsx("button",{onClick:()=>{var lt,ie;const q=n.type==="gen-image"?((lt=n.settings)==null?void 0:lt.prompt)||"":((ie=n.settings)==null?void 0:ie.videoPrompt)||"",re=bl(n.id),Ie=re.length>0?re.join(" ")+(q?" "+q:""):q;No(Ie,n.type==="gen-image"?"image":"video",u,n.id)},className:"bg-blue-600 hover:bg-blue-500 text-white p-1.5 rounded-md shadow-lg active:scale-95 transition-transform shrink-0",title:"",children:s.jsx(ex,{size:12,fill:"currentColor"})})]})]})})()]})]},n.id)},[k,Mn,ta,mm,xm,mn,Gh,e,$t,Xr,Bn,gn,ys,hp,Rs,xn,el,Ne,Or,nn,Ai,ea,bs,vs,Dc,$n,Hn,Le,bl,No,So,cu,Y1,xl,z1]),Sv=a.length>50||wr!=="off",Cv=Jd||qo;return s.jsxs(s.Fragment,{children:[s.jsx(Rz,{visible:Ar.visible,progress:Ar.progress,status:Ar.status,type:Ar.type}),s.jsxs("div",{className:`w-full h-screen font-sans overflow-hidden select-none flex flex-col transition-colors duration-300 ${e==="dark"?"bg-[#09090b] text-white":"bg-zinc-100 text-zinc-900"} ${Sv?"perf-mode":""} ${Cv?"interacting":""}`,onClick:()=>{Cr.visible&&As(n=>({...n,visible:!1})),Oi.visible&&rp(n=>({...n,visible:!1}))},children:[s.jsxs("div",{className:`h-12 flex items-center justify-between px-4 z-50 shrink-0 border-b transition-colors duration-300 ${e==="dark"?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-md flex items-center justify-center",children:s.jsx(af,{size:16,className:"text-white"})}),s.jsx("span",{className:`font-bold text-sm tracking-wide ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,children:"Tapnow Studio"}),$i?s.jsx("input",{ref:Js,type:"text",value:pr,onChange:n=>xo(n.target.value),onBlur:()=>{Ms(!1);try{localStorage.setItem("tapnow_project_name",pr)}catch{}},onKeyDown:n=>{if(n.key==="Enter"){Ms(!1);try{localStorage.setItem("tapnow_project_name",pr)}catch{}}},className:`ml-2 px-2 py-0.5 text-xs border rounded outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,style:{minWidth:"100px",maxWidth:"200px"}}):s.jsx("span",{onClick:()=>{Ms(!0),setTimeout(()=>{var n;return(n=Js.current)==null?void 0:n.focus()},0)},className:`ml-2 text-xs cursor-pointer hover:underline ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,title:"",children:pr})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>{const n=["off","normal","ultra"],d=(n.indexOf(wr)+1)%n.length,f=n[d];Yd(f)},className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${wr!=="off"?e==="dark"?"bg-blue-600 border-blue-500 text-white hover:bg-blue-500":"bg-blue-500 border-blue-400 text-white hover:bg-blue-600":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:wr==="ultra"?"":wr==="normal"?"":"",children:[s.jsx(Du,{size:14,className:wr!=="off"?"fill-current":""}),s.jsx("span",{children:wr==="ultra"?"":""})]}),s.jsxs("button",{onClick:R1,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:"/",children:[s.jsx(Eo,{size:14}),s.jsx("span",{children:""})]}),s.jsx("button",{onClick:A1,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:"",children:e==="dark"?s.jsxs(s.Fragment,{children:[s.jsx(Ez,{size:14,className:"text-amber-400"}),s.jsx("span",{children:""})]}):s.jsxs(s.Fragment,{children:[s.jsx(yz,{size:14,className:"text-blue-500"}),s.jsx("span",{children:""})]})}),s.jsx("button",{onClick:cn,disabled:T.length===0,className:`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors border ${T.length===0?e==="dark"?"bg-zinc-900/50 border-zinc-800 text-zinc-600 cursor-not-allowed":"bg-zinc-50 border-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:" (Ctrl+Z)",children:s.jsx(_z,{size:14})}),s.jsx("button",{onClick:En,disabled:y.length===0,className:`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors border ${y.length===0?e==="dark"?"bg-zinc-900/50 border-zinc-800 text-zinc-600 cursor-not-allowed":"bg-zinc-50 border-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:" (Ctrl+Shift+Z)",children:s.jsx(Sz,{size:14})}),s.jsx(Uu,{variant:"ghost",onClick:()=>{Re(),c([]),m([]),xo(""),localStorage.removeItem("tapnow_project_name")},children:""}),s.jsx(Uu,{variant:"secondary",icon:Iz,onClick:()=>ss(!0),children:"API "})]})]}),s.jsxs("div",{className:`flex-1 relative overflow-hidden flex transition-colors duration-300 ${e==="dark"?"bg-[#09090b]":"bg-zinc-100"}`,children:[s.jsxs("div",{className:`w-14 border-r flex flex-col items-center py-3 gap-3 z-40 shrink-0 transition-colors duration-300 ${e==="dark"?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,children:[s.jsx("button",{onClick:iv,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:s.jsx(wz,{size:18})}),[{id:"select",icon:vz},{id:"history",icon:qg},{id:"characters",icon:Au}].map(n=>s.jsx("button",{onClick:()=>{a1(n.id),n.id==="history"&&Lc(!Oc),n.id==="characters"&&ra(!Nh)},className:`p-2.5 rounded-lg transition-all ${o1===n.id?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-200 text-zinc-900":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-800"}`,children:s.jsx(n.icon,{size:18})},n.id)),s.jsx("div",{className:"flex-1"}),s.jsx("button",{onClick:()=>An(!di),className:`p-2.5 rounded-lg transition-all mb-2 ${di?"bg-blue-600 text-white":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-800"}`,title:"AI ",children:s.jsx(va,{size:18})}),s.jsx("button",{onClick:D1,className:`p-2.5 rounded-lg transition-all ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:s.jsx(tx,{size:18})}),s.jsx("button",{onClick:U1,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:s.jsx(Xi,{size:18})}),s.jsx("button",{onClick:L1,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:s.jsx(Eo,{size:18})})]}),Oc&&s.jsxs("div",{className:`w-72 z-30 flex flex-col animate-in slide-in-from-left border-r transition-colors duration-300 ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[s.jsxs("div",{className:`p-3 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:`font-bold text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),Mi.active&&s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-16 h-1.5 bg-zinc-700 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200",style:{width:`${Mi.current/Mi.total*100}%`}})}),s.jsxs("span",{className:"text-[9px] text-zinc-500 font-mono",children:[Mi.current,"/",Mi.total]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{const n=["off","normal","ultra"],d=(n.indexOf(er)+1)%n.length;Zn(n[d])},className:`p-1.5 rounded transition-colors flex items-center gap-1 ${er==="ultra"?e==="dark"?"text-orange-400 bg-orange-500/20 hover:bg-orange-500/30":"text-orange-600 bg-orange-100 hover:bg-orange-200":er==="normal"?e==="dark"?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-green-600 bg-green-100 hover:bg-green-200":e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:er==="ultra"?"":er==="normal"?"":"",children:s.jsx(Du,{size:14})}),s.jsx("button",{onClick:()=>n1(n=>!n),className:`p-1.5 rounded transition-colors ${zh?e==="dark"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-blue-600 bg-blue-100 hover:bg-blue-200":e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:s.jsx(Xi,{size:14})}),s.jsx("button",{onClick:()=>r1(n=>!n),className:`p-1.5 rounded transition-colors ${jh?e==="dark"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-blue-600 bg-blue-100 hover:bg-blue-200":e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:s.jsx(af,{size:14})}),s.jsxs("button",{onClick:()=>{const l=Pt.filter(d=>d.status==="completed");hr.size>0?Jo(new Set):Jo(new Set(l.map(d=>d.id)))},className:`p-1.5 rounded transition-colors flex items-center gap-1 ${hr.size>0?e==="dark"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-blue-600 bg-blue-100 hover:bg-blue-200":e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:hr.size>0?` (${hr.size})`:"",children:[hr.size>0?s.jsx(Vl,{size:14}):s.jsx(fz,{size:14}),hr.size>0&&s.jsx("span",{className:"text-[9px] font-bold",children:hr.size})]}),s.jsx("button",{onClick:()=>Hc(!0),className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:s.jsx(Dl,{size:14})}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>{if(hr.size>0){const n=[...hr].map(l=>Pt.find(d=>d.id===l)).filter(Boolean);jp(n)}else nn((Ce==null?void 0:Ce.type)==="batch-download"?null:{type:"batch-download"})},className:`p-1.5 rounded transition-colors ${hr.size>0?"text-blue-400 bg-blue-500/20":e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:hr.size>0?` (${hr.size})`:"",children:s.jsx(Eo,{size:14})}),(Ce==null?void 0:Ce.type)==="batch-download"&&hr.size===0&&s.jsxs("div",{className:`absolute right-0 top-full mt-1 w-40 rounded-lg shadow-xl py-1 z-50 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>nn(null),children:[s.jsxs("button",{onClick:()=>{nn(null);const n=Pt.filter(l=>(l.startTime||0)>=yo);jp(n)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:[" (",Pt.filter(n=>(n.startTime||0)>=yo).length,")"]}),s.jsxs("button",{onClick:()=>{nn(null),jp(Pt)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:[" (",Pt.length,")"]})]})]}),s.jsx("button",{onClick:()=>Lc(!1),children:s.jsx(cs,{size:12,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]})]}),s.jsx("div",{className:"px-3 pt-2",children:s.jsxs("div",{className:`flex items-center gap-2 text-[10px] px-2 py-1 rounded ${fn?e==="dark"?"bg-blue-500/20 text-blue-300":"bg-blue-100 text-blue-600":e==="dark"?"bg-zinc-800 text-zinc-500":"bg-zinc-100 text-zinc-500"}`,children:[s.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${fn?"bg-green-500":"bg-red-500"}`}),s.jsx("span",{children:fn?" - ":""})]})}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-3",children:[jh&&s.jsxs("div",{className:`rounded-lg border p-3 space-y-3 ${e==="dark"?"bg-zinc-900/60 border-zinc-800":"bg-white border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("span",{className:`text-xs font-semibold ${e==="dark"?"text-zinc-200":"text-zinc-700"}`,children:""}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>_e("pipeline"),className:`text-[10px] px-2 py-1 rounded ${X==="pipeline"?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-600":e==="dark"?"bg-zinc-800 text-zinc-400 hover:text-zinc-200":"bg-zinc-100 text-zinc-500 hover:text-zinc-700"}`,children:""}),s.jsx("button",{onClick:()=>_e("parallel"),className:`text-[10px] px-2 py-1 rounded ${X==="parallel"?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-600":e==="dark"?"bg-zinc-800 text-zinc-400 hover:text-zinc-200":"bg-zinc-100 text-zinc-500 hover:text-zinc-700"}`,children:""})]})]}),(()=>{const n=new Map;ye.forEach(u=>{n.set(u.id,{...u,queued:[],running:[]})});const l=u=>{var x;const h=Dt.get(u.nodeId),g=((x=h==null?void 0:h.settings)==null?void 0:x.projectTitle)||"",v=u.batchId||`legacy-${u.nodeId}`;return n.has(v)||n.set(v,{id:v,nodeId:u.nodeId,projectTitle:g,total:0,concurrency:u.batchConcurrency||1,createdAt:Date.now(),mode:u.mode,taskIndex:u.taskIndex||0,shotIds:[]}),n.get(v)};oe.forEach(u=>{(u.batchId&&n.has(u.batchId)?n.get(u.batchId):l(u)).queued.push(u)}),Xt.forEach(u=>{(u.batchId&&n.has(u.batchId)?n.get(u.batchId):l(u)).running.push(u)});const d=[...n.values()].filter(u=>u.queued.length>0||u.running.length>0).sort((u,h)=>(h.createdAt||0)-(u.createdAt||0)),f=(u,h)=>{var x,_;const g=Dt.get(u),v=(_=(x=g==null?void 0:g.settings)==null?void 0:x.shots)==null?void 0:_.find(S=>S.id===h);return((v==null?void 0:v.description)||(v==null?void 0:v.prompt)||"").trim()};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`text-[10px] ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[" ",Xt.length,"   ",oe.length]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>{oe.length!==0&&confirm("")&&fe(!1)},className:`text-[10px] px-2 py-1 rounded ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:""}),s.jsx("button",{onClick:()=>{Xt.length===0&&oe.length===0||confirm("")&&fe(!0)},className:`text-[10px] px-2 py-1 rounded ${e==="dark"?"bg-red-900/40 text-red-300 hover:bg-red-900/60":"bg-red-50 text-red-600 hover:bg-red-100"}`,children:""})]}),d.length===0?s.jsx("div",{className:`text-xs text-center py-4 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""}):s.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto custom-scrollbar pr-1",children:d.map(u=>{const h=Math.max(1,u.concurrency||1),g=u.total||u.queued.length+u.running.length,v=Math.ceil(g/h),x=Math.ceil(u.queued.length/h),_=u.taskIndex?`Task ${u.taskIndex}`:"Task",S=[...u.running.map(j=>({...j,status:"running"})),...u.queued.map(j=>({...j,status:"queued"}))].sort((j,C)=>(j.batchOrder??0)-(C.batchOrder??0));return s.jsxs("div",{className:`rounded-lg border p-2 ${e==="dark"?"border-zinc-800 bg-zinc-900/60":"border-zinc-200 bg-zinc-50"}`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:`text-[11px] font-semibold ${e==="dark"?"text-zinc-200":"text-zinc-700"}`,children:["NODE - ",u.projectTitle,"  ",_]}),s.jsxs("div",{className:"text-[10px] mt-0.5 text-zinc-500",children:[g,"   ",h,"   ",v,"  ",x," "]})]}),u.queued.length>0&&s.jsx("button",{onClick:()=>{confirm("")&&Fe(u.id)},className:`p-1 rounded ${e==="dark"?"text-zinc-500 hover:text-red-300":"text-zinc-400 hover:text-red-500"}`,title:"",children:s.jsx(Fr,{size:12})})]}),s.jsx("div",{className:"mt-2 space-y-1",children:S.map((j,C)=>{const L=Math.floor((j.batchOrder??0)/h)+1,M=u.taskIndex?`T${u.taskIndex}B${L}`:`B${L}`,U=f(j.nodeId,j.shotId),V=j.status==="running"?"":"";return s.jsxs("div",{className:`text-[10px] flex items-center justify-between gap-2 ${e==="dark"?"text-zinc-300":"text-zinc-600"}`,children:[s.jsxs("span",{className:"truncate",children:[M,"  ",U||`${j.sceneIndex||""}`]}),s.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[s.jsx("span",{className:j.status==="running"?"text-green-500":"text-blue-400",children:V}),s.jsx("button",{onClick:()=>{j.status==="running"?confirm("")&&it(j.nodeId,j.shotId):confirm("")&&ct(j.nodeId,j.shotId)},className:`p-0.5 rounded ${e==="dark"?"text-zinc-500 hover:text-red-300":"text-zinc-400 hover:text-red-500"}`,title:j.status==="running"?"":"",children:s.jsx(Fr,{size:10})})]})]},`${u.id}-${j.nodeId}-${j.shotId}-${C}`)})})]},u.id)})})]})})()]}),zh&&s.jsx("div",{className:`rounded-lg border p-3 space-y-3 ${e==="dark"?"bg-zinc-900/60 border-zinc-800":"bg-white border-zinc-200"}`,children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:Rr.imageSavePath||"",onChange:n=>{const l=Ir(n.target.value);kr(d=>({...d,imageSavePath:l}))},onBlur:n=>cl({image_save_path:Ir(n.target.value||"")}),onKeyDown:n=>{n.key==="Enter"&&n.currentTarget.blur()},placeholder:" history",className:`flex-1 text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}),s.jsx("button",{onClick:()=>Dh("imageSavePath","image_save_path"),className:`px-2 py-1.5 text-[10px] rounded border ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 border-zinc-300 hover:bg-zinc-200"}`,children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:Rr.videoSavePath||"",onChange:n=>{const l=Ir(n.target.value);kr(d=>({...d,videoSavePath:l}))},onBlur:n=>cl({video_save_path:Ir(n.target.value||"")}),onKeyDown:n=>{n.key==="Enter"&&n.currentTarget.blur()},placeholder:" history",className:`flex-1 text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}),s.jsx("button",{onClick:()=>Dh("videoSavePath","video_save_path"),className:`px-2 py-1.5 text-[10px] rounded border ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 border-zinc-300 hover:bg-zinc-200"}`,children:""})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-[10px] text-zinc-500",children:"PNG  JPG"}),s.jsx("button",{className:`w-10 h-5 rounded-full relative transition-colors ${Rr.convertPngToJpg?"bg-green-600":"bg-zinc-600"} ${Rr.pilAvailable?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>{if(!Rr.pilAvailable)return;const n=!Rr.convertPngToJpg;kr(l=>({...l,convertPngToJpg:n})),cl({convert_png_to_jpg:n},{silent:!0})},disabled:!Rr.pilAvailable,children:s.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white transition-all ${Rr.convertPngToJpg?"left-6":"left-1"}`})})]}),!Rr.pilAvailable&&s.jsx("div",{className:"text-[9px] text-amber-400",children:"PIL PNG  JPG "}),s.jsx("button",{className:`w-full py-2 rounded text-[10px] font-medium transition-colors ${e==="dark"?"bg-orange-600/30 text-orange-200 hover:bg-orange-600/40":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,onClick:g1,children:""}),s.jsx("div",{className:"text-[9px] text-zinc-500",children:""})]})}),(()=>{const n=Pt.filter(d=>(d.startTime||0)>=yo),l=Pt.filter(d=>(d.startTime||0)<yo);return s.jsxs(s.Fragment,{children:[n.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center gap-2 text-[10px] ${e==="dark"?"text-blue-400":"text-blue-600"}`,children:[s.jsx("div",{className:"flex-1 h-px bg-blue-500/30"}),s.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-blue-500/10 font-medium",children:[" (",n.length,")"]}),s.jsx("div",{className:"flex-1 h-px bg-blue-500/30"})]}),n.map(d=>s.jsx(ox,{item:d,theme:e,lightboxItem:Pi,performanceMode:er,providers:H,defaultProviders:uf,localCacheServerConnected:fn,onCacheMissing:Ah,onDelete:Zh,isSelected:hr.has(d.id),onSelect:f=>{Jo(u=>{const h=new Set(u);return h.has(f)?h.delete(f):h.add(f),h})},onClick:()=>{const f=d.mjImages&&d.mjImages.length>1&&d.selectedMjImageIndex!==void 0?d.selectedMjImageIndex:0,u=d.mjImages&&d.mjImages.length>1?d.mjImages[f]:null,h=u?Rn(d,u):Rn(d);h&&$n({...d,url:h,selectedMjImageIndex:f,storyboardContext:null})},onContextMenu:f=>du(f,d),onImageClick:(f,u,h,g)=>{f.stopPropagation(),St(_=>_.map(S=>S.id===u.id?{...S,url:h,selectedMjImageIndex:g}:S));const v=Rn(u,h),x={...u,url:v,selectedMjImageIndex:g,storyboardContext:null};$n(x)},onImageContextMenu:(f,u,h,g)=>du(f,u,h,g),onRebuildThumbnail:Rh,onRefresh:f=>{f.apiConfig&&(St(u=>u.map(h=>h.id===f.id?{...h,status:"generating",errorMsg:null,progress:5}:h)),f.modelName.includes("veo")?Yi(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height):jo(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height,f.apiConfig.modelId||""))},Loader2:xi,Trash2:Fr,RefreshCw:ic},d.id))]}),l.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex items-center gap-2 text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:[s.jsx("div",{className:`flex-1 h-px ${e==="dark"?"bg-zinc-700":"bg-zinc-300"}`}),s.jsxs("span",{className:"px-2 py-0.5 font-medium",children:[" (",l.length,")"]}),s.jsx("div",{className:`flex-1 h-px ${e==="dark"?"bg-zinc-700":"bg-zinc-300"}`})]}),l.map(d=>s.jsx(ox,{item:d,theme:e,lightboxItem:Pi,performanceMode:er,providers:H,defaultProviders:uf,localCacheServerConnected:fn,onCacheMissing:Ah,onDelete:Zh,isSelected:hr.has(d.id),onSelect:f=>{Jo(u=>{const h=new Set(u);return h.has(f)?h.delete(f):h.add(f),h})},onClick:()=>{const f=d.mjImages&&d.mjImages.length>1&&d.selectedMjImageIndex!==void 0?d.selectedMjImageIndex:0,u=d.mjImages&&d.mjImages.length>1?d.mjImages[f]:null,h=u?Rn(d,u):Rn(d);h&&$n({...d,url:h,selectedMjImageIndex:f,storyboardContext:null})},onContextMenu:f=>du(f,d),onImageClick:(f,u,h,g)=>{f.stopPropagation(),St(_=>_.map(S=>S.id===u.id?{...S,url:h,selectedMjImageIndex:g}:S));const v=Rn(u,h),x={...u,url:v,selectedMjImageIndex:g,storyboardContext:null};$n(x)},onImageContextMenu:(f,u,h,g)=>du(f,u,h,g),onRebuildThumbnail:Rh,onRefresh:f=>{f.apiConfig&&(St(u=>u.map(h=>h.id===f.id?{...h,status:"generating",errorMsg:null,progress:5}:h)),f.modelName.includes("veo")?Yi(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height):jo(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height,f.apiConfig.modelId||""))},Loader2:xi,Trash2:Fr,RefreshCw:ic},d.id))]})]})})()]})]}),Nh&&s.jsxs("div",{className:`w-72 z-30 flex flex-col animate-in slide-in-from-left border-r transition-colors duration-300 ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[s.jsxs("div",{className:`p-3 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsx("h3",{className:`font-bold text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:"Sora "}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{const n=ue.find(l=>l.type==="Video"&&(l.id==="sora-2"||l.id==="sora-2-pro"));if(n){const l=(n.url||zr).replace(/\/+$/,"");il(`${l}/sora/v1/characters`)}else{const l=zr.replace(/\/+$/,"");il(`${l}/sora/v1/characters`)}rl(!0)},className:`px-2 py-1 text-[10px] rounded transition-colors ${e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:""}),s.jsx("button",{onClick:()=>ra(!1),children:s.jsx(cs,{size:12,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3",children:Wn.length===0?s.jsx("div",{className:`text-center py-8 text-sm ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:'""'}):s.jsx("div",{className:"grid grid-cols-2 gap-3",children:Wn.map(n=>s.jsxs("div",{className:`group rounded-lg overflow-hidden border cursor-pointer hover:border-blue-500/50 transition-colors ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-white border-zinc-200"}`,onClick:()=>{const l=` @${n.username} `,d=document.activeElement;if(d&&(d.tagName==="TEXTAREA"||d.tagName==="INPUT")){const f=d,u=f.selectionStart||0,h=f.selectionEnd||0,g=f.value,v=g.slice(0,u)+l+g.slice(h);f.value=v;const x=u+l.length;f.setSelectionRange(x,x),f.dispatchEvent(new Event("input",{bubbles:!0})),f.focus()}else navigator.clipboard.writeText(l.trim()).then(()=>{alert(`: ${l.trim()}`)})},children:[s.jsxs("div",{className:"aspect-square bg-zinc-800 relative group/char",children:[n.localCacheUrl||n.profile_picture_url?s.jsx(Yn,{src:n.localCacheUrl||n.profile_picture_url,alt:n.username,className:"w-full h-full object-cover",onError:l=>{l.target.style.display="none"}}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-zinc-500",children:s.jsx(cf,{size:24})}),s.jsx("button",{onClick:l=>{if(l.stopPropagation(),confirm(` "${n.username}" `)){const d=Wn.filter(f=>f.id!==n.id);sa(d);try{localStorage.setItem("tapnow_characters",JSON.stringify(d))}catch(f){console.error(":",f)}}},className:"absolute top-1 right-1 p-1.5 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10",title:"",children:s.jsx(Fr,{size:12})})]}),s.jsx("div",{className:"p-2 relative",children:s.jsxs("p",{className:`text-xs truncate flex items-center gap-1 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[n.username,s.jsx(Ol,{size:12,className:"text-green-500 shrink-0",title:"Sora 2 "})]})})]},n.id))})})]}),s1&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center",onClick:()=>rl(!1),children:s.jsxs("div",{className:`w-[500px] max-h-[90vh] overflow-y-auto rounded-lg shadow-2xl flex flex-col ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-white border-zinc-200"} border`,onClick:n=>n.stopPropagation(),children:[s.jsxs("div",{className:`p-4 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsx("h3",{className:`font-bold text-sm ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),s.jsx("button",{onClick:()=>rl(!1),children:s.jsx(cs,{size:16,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),s.jsxs("div",{className:"flex gap-2 mb-2",children:[s.jsx("button",{onClick:()=>{Uc("url"),Bc("")},className:`px-3 py-1.5 text-xs rounded transition-colors ${fi==="url"?e==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:" URL"}),s.jsx("button",{onClick:()=>{Uc("history"),Fc(""),ol(null)},className:`px-3 py-1.5 text-xs rounded transition-colors ${fi==="history"?e==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:""})]}),fi==="url"?s.jsx("input",{type:"text",value:ia,onChange:n=>Fc(n.target.value),placeholder:" URL...",className:`w-full px-3 py-2 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}):s.jsxs("select",{value:oa,onChange:n=>{const l=n.target.value;if(Bc(l),l){const d=zo.get(l),f=Rn(d);f&&(Uc("url"),Fc(f),Bc(""))}},className:`w-full px-3 py-2 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,children:[s.jsx("option",{value:"",children:"..."}),Pt.filter(n=>n.type==="video"&&n.status==="completed"&&(n.url||n.localCacheUrl||n.originalUrl)).map(n=>{var l;return s.jsxs("option",{value:n.id,children:[((l=n.prompt)==null?void 0:l.slice(0,50))||"Untitled"," - ",n.time]},n.id)})]}),(()=>{let n=null;if(fi==="url"&&ia.trim())n=ia.trim();else if(fi==="history"&&oa){const l=zo.get(oa),d=Rn(l);d&&(n=d)}return n?s.jsxs("div",{className:"mt-2 mb-2",children:[s.jsx("video",{controls:!0,crossOrigin:"anonymous",className:"w-full h-40 object-contain bg-black rounded-lg",src:n,onError:l=>{console.error(":",n,l),ol("")},onLoadStart:()=>{ol(null)},onLoadedData:()=>{ol(null)}},n),Ch&&s.jsx("div",{className:"text-red-500 text-xs mt-1 text-center",children:Ch})]}):null})()]}),s.jsxs("div",{children:[s.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:" 1-3 "}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"number",min:"0",step:"0.1",value:aa,onChange:n=>_h(parseFloat(n.target.value)||0),className:`w-20 px-2 py-1.5 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`}),s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),s.jsx("input",{type:"number",min:"0",step:"0.1",value:la,onChange:n=>Sh(parseFloat(n.target.value)||0),className:`w-20 px-2 py-1.5 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`}),s.jsxs("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[": ",(la-aa).toFixed(1),"s"]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:"API  (API Endpoint)"}),s.jsx("input",{type:"text",value:sl,onChange:n=>il(n.target.value),placeholder:": https://your-domain.com/sora/v1/characters",className:`w-full px-3 py-2 text-xs rounded border outline-none font-mono ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onFocus:n=>{if(!n.target.value){const l=ue.find(f=>f.type==="Video"&&(f.id==="sora-2"||f.id==="sora-2-pro")),d=l?(l.url||zr).replace(/\/+$/,""):zr.replace(/\/+$/,"");il(`${d}/sora/v1/characters`)}}}),s.jsx("p",{className:`text-[10px] mt-1 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[s.jsx("button",{onClick:()=>rl(!1),className:`px-4 py-2 text-xs rounded transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200"}`,children:""}),s.jsx("button",{onClick:async()=>{if(fi==="url"&&!ia.trim()){alert(" URL");return}if(fi==="history"&&!oa){alert("");return}if(la-aa<1||la-aa>3){alert(" 1-3 ");return}ca(!0);try{const n=sl.trim()||null;fi==="url"?await am(ia,aa,la,null,n):await am("",aa,la,oa,n)}finally{ca(!1)}},disabled:ip,className:`px-4 py-2 text-xs rounded transition-colors ${ip?"bg-zinc-400 text-zinc-200 cursor-not-allowed":e==="dark"?"bg-blue-600 text-white hover:bg-blue-500":"bg-blue-500 text-white hover:bg-blue-600"}`,children:ip?"...":""})]})]})]})}),s.jsxs("div",{className:"flex-1 relative overflow-hidden flex",children:[s.jsxs("div",{ref:Zs,id:"canvas-bg",className:"flex-1 h-full cursor-default relative",onMouseDown:y1,onClick:v1,onDoubleClick:w1,onContextMenu:k1,style:{backgroundImage:e==="dark"?"radial-gradient(#27272a 1px, transparent 1px)":"radial-gradient(rgba(0, 0, 0, 0.08) 0.5px, transparent 0.5px)",backgroundSize:`${20*$t.zoom}px ${20*$t.zoom}px`,backgroundPosition:`${$t.x}px ${$t.y}px`,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transform:"translateZ(0)",backfaceVisibility:"hidden"},children:[s.jsxs("div",{className:"absolute origin-top-left will-change-transform",style:{transform:`translate3d(${$t.x}px, ${$t.y}px, 0) scale(${$t.zoom})`,width:Lz,height:Uz,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transformOrigin:"top left",imageRendering:$t.zoom>=1?"auto":"crisp-edges"},children:[s.jsx(hm,{connections:p,nodesMap:Dt,connectionsByNode:Vi,connectingSource:Bn,connectingTarget:gn,connectingInputType:ys,mousePos:Zd,apiConfigsMap:mn,selectedNodeId:k,onDisconnectConnection:wp,visibleNodes:Jc}),Jc.map(n=>_v(n))]}),Ps&&s.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-500/10 pointer-events-none z-50",style:{left:Math.min(Ps.startX,Ps.endX),top:Math.min(Ps.startY,Ps.endY),width:Math.abs(Ps.endX-Ps.startX),height:Math.abs(Ps.endY-Ps.startY)}})]}),s.jsxs("div",{className:`fixed right-0 top-12 bottom-0 border-l shadow-2xl flex flex-col z-50 transition-transform duration-300 ease-in-out select-text ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-white border-zinc-200"} ${di?"translate-x-0":"translate-x-full"}`,style:{width:Ec,pointerEvents:di?"auto":"none"},children:[s.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 cursor-ew-resize transition-colors z-50 flex items-center justify-center group ${e==="dark"?"hover:bg-blue-600/50":"hover:bg-blue-400/30"}`,onMouseDown:b1,children:s.jsx("div",{className:`h-8 w-1 rounded transition-colors ${e==="dark"?"bg-zinc-700 group-hover:bg-blue-500":"bg-zinc-300 group-hover:bg-blue-500"}`})}),s.jsxs("div",{className:`h-12 flex items-center justify-between px-3 shrink-0 border-b ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"relative z-50",children:[s.jsxs("button",{onClick:n=>{n.stopPropagation(),mh(!hh),Tc(null)},className:`flex items-center gap-2 text-xs border rounded px-2 py-1 outline-none focus:border-blue-500 cursor-pointer max-w-[200px] ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:border-zinc-600":"bg-white text-zinc-800 border-zinc-300 hover:border-zinc-400"}`,children:[s.jsx("span",{className:"truncate font-mono",children:xs}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(xs)}`}),s.jsx(zs,{size:12,className:"shrink-0 opacity-50"})]}),hh&&s.jsxs("div",{className:`absolute top-full left-0 mt-1 w-72 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>Tc(null),children:[s.jsx("div",{className:`w-24 border-r pr-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(gr).filter(([,n])=>n.models.some(l=>l.type==="Chat")).map(([n,l])=>s.jsx("button",{onMouseEnter:()=>Tc(n),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${Mc===n?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:l.name||n},n))}),s.jsxs("div",{className:"flex-1 pl-1 max-h-64 overflow-y-auto custom-scrollbar",children:[Mc&&((bm=gr[Mc])==null?void 0:bm.models.filter(n=>n.type==="Chat").map(n=>s.jsxs("button",{onClick:()=>{Zy(n.id),mh(!1),Tc(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${xs===n.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[s.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:n.id}),s.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ds(n.id)}`})]},n.id))),!Mc&&s.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:S1,className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,title:"",children:s.jsx(Ji,{size:16})}),an.length>1&&s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>op(!Eh),className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,children:s.jsx(qg,{size:16})}),Eh&&s.jsx("div",{className:`absolute right-0 top-full mt-1 w-48 rounded-lg shadow-xl py-1 z-50 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>op(!1),children:an.map(n=>s.jsxs("div",{className:`flex items-center justify-between px-3 py-2 text-xs cursor-pointer ${bn===n.id?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:bg-zinc-800/50":"text-zinc-500 hover:bg-zinc-100"}`,onClick:()=>{rr(n.id),op(!1)},children:[s.jsx("span",{className:"truncate flex-1",children:n.title}),s.jsx("button",{onClick:l=>{l.stopPropagation(),C1(l,n.id)},className:`p-1 ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,children:s.jsx(cs,{size:10})})]},n.id))})]}),s.jsx("button",{onClick:()=>An(!1),className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,children:s.jsx(wa,{size:16})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 space-y-4 select-text",children:[ma==null?void 0:ma.messages.map(n=>s.jsxs("div",{className:`flex gap-3 select-text ${n.role==="user"?"flex-row-reverse":""}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 select-none ${n.role==="user"?"bg-blue-600":"bg-green-600"}`,children:n.role==="user"?s.jsx(cf,{size:16,className:"text-white"}):s.jsx(Vg,{size:16,className:"text-white"})}),s.jsxs("div",{className:`flex flex-col gap-1 max-w-[85%] select-text ${n.role==="user"?"items-end":"items-start"}`,children:[n.files&&n.files.length>0&&s.jsx("div",{className:`flex flex-wrap gap-2 mb-1 ${n.role==="user"?"justify-end":"justify-start"}`,children:n.files.map((l,d)=>s.jsx("div",{className:`rounded p-1 border flex items-center gap-1 ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-100 border-zinc-300"}`,children:l.isImage?s.jsx(Yn,{src:l.content,className:"w-16 h-16 object-cover rounded",alt:l.name}):l.isVideo?s.jsx("video",{src:l.content,controls:!0,className:`max-w-full rounded-lg bg-black max-h-[300px] border ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,playsInline:!0}):l.isAudio?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(Zg,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:""})]}):l.isPDF?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:"PDF"})]}):l.isDoc?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:"DOC"})]}):l.isExcel?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:"XLS"})]}):s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1 max-w-full truncate px-1",children:l.fileExt||l.name.split(".").pop()||""})]})},d))}),n.content&&n.content.trim()&&s.jsx("div",{className:`rounded-2xl px-4 py-2.5 text-sm select-text break-words ${n.role==="user"?e==="dark"?"bg-zinc-800 text-white rounded-tr-none":"bg-zinc-300 text-zinc-900 rounded-tr-none":e==="dark"?"bg-zinc-800/50 text-zinc-300 rounded-tl-none border border-zinc-800":"bg-zinc-100 text-zinc-800 rounded-tl-none border border-zinc-200"}`,style:{userSelect:"text",cursor:"text"},children:n.isError?s.jsx("span",{className:"text-red-500 select-text cursor-text",style:{userSelect:"text",cursor:"text"},children:n.content}):n.content?s.jsx("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:iz.sanitize(kn.parse(n.content))},style:{userSelect:"text",cursor:"text"}}):null})]})]},n.id||n.timestamp||`msg-${Math.random()}`)),Pc&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-green-600 flex items-center justify-center shrink-0",children:s.jsx(Vg,{size:16,className:"text-white"})}),s.jsx("div",{className:`rounded-2xl rounded-tl-none px-4 py-2 border flex items-center ${e==="dark"?"bg-zinc-800/50 border-zinc-800":"bg-zinc-100 border-zinc-200"}`,children:s.jsxs("div",{className:"flex gap-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0s"}}),s.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),s.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})]}),s.jsx("div",{ref:Oh})]}),s.jsxs("div",{className:`p-3 border-t ${e==="dark"?"border-zinc-800 bg-[#121214]":"border-zinc-200 bg-zinc-50"}`,children:[Zo.length>0&&s.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-2 custom-scrollbar",children:Zo.map((n,l)=>s.jsxs("div",{className:"relative group shrink-0",children:[n.isImage?s.jsx(Yn,{src:n.content,className:`w-12 h-12 object-cover rounded border ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,alt:n.name}):n.isVideo?s.jsx("video",{src:n.content,className:`w-16 h-12 object-cover rounded border bg-black ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,muted:!0,playsInline:!0}):n.isAudio?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(Zg,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:""})]}):n.isPDF?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:"PDF"})]}):n.isDoc?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:"DOC"})]}):n.isExcel?s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1",children:"XLS"})]}):s.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[s.jsx(ls,{size:16}),s.jsx("span",{className:"text-[8px] mt-1 max-w-full truncate px-1",children:n.fileExt||n.name.split(".").pop()||""})]}),s.jsx("button",{onClick:()=>E1(l),className:`absolute -top-1 -right-1 rounded-full p-0.5 border opacity-0 group-hover:opacity-100 transition-opacity ${e==="dark"?"bg-zinc-900 text-zinc-400 hover:text-white border-zinc-700":"bg-white text-zinc-500 hover:text-zinc-900 border-zinc-300"}`,children:s.jsx(cs,{size:10})})]},l))}),s.jsxs("div",{className:`relative rounded-xl flex items-end p-2 focus-within:border-blue-500/50 transition-colors border ${e==="dark"?"bg-zinc-800/50 border-zinc-700":"bg-white border-zinc-300"}`,children:[s.jsxs("label",{className:`p-2 cursor-pointer transition-colors ${e==="dark"?"text-zinc-400 hover:text-white":"text-zinc-500 hover:text-zinc-900"}`,title:"",children:[s.jsx(kz,{size:18}),s.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:I1,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.md,.js,.py,.html,.css,.json,.csv"})]}),s.jsx("textarea",{value:Sr,onChange:n=>ui(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),Qh())},placeholder:"...",className:`w-full bg-transparent text-sm resize-none outline-none max-h-32 py-2 px-1 custom-scrollbar ${e==="dark"?"text-white placeholder-zinc-500":"text-zinc-800 placeholder-zinc-400"}`,rows:1,style:{minHeight:"36px"}}),s.jsx("button",{onClick:Qh,disabled:!Sr.trim()&&Zo.length===0||Pc,className:`p-2 rounded-lg transition-all mb-0.5 ${!Sr.trim()&&Zo.length===0||Pc?"opacity-50 bg-transparent text-zinc-400":"bg-blue-600 text-white hover:bg-blue-500"}`,children:s.jsx(Cz,{size:16})})]}),s.jsx("div",{className:`text-[10px] text-center mt-2 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:" MP4/MP3/PDF/Doc/Excel/Code   Enter "})]})]}),mr.visible&&s.jsx("div",{className:`fixed z-50 w-40 rounded-lg shadow-xl border ${e==="dark"?"bg-[#18181b] border-zinc-800":"bg-white border-zinc-200"}`,style:{left:mr.x,top:mr.y,transform:"translate(-50%, -50%)"},onMouseLeave:()=>{na(n=>({...n,visible:!1})),Di(!1)},children:s.jsx("div",{className:"p-1",children:[{type:"input-image",label:""},{type:"text-node",label:""},{type:"novel-input",label:""},{type:"extract-characters-scenes",label:"",children:[{type:"character-description",label:""},{type:"scene-description",label:""},{type:"generate-character-image",label:""},{type:"generate-scene-image",label:""},{type:"generate-character-video",label:""},{type:"generate-scene-video",label:""},{type:"create-character",label:""},{type:"create-scene",label:""}]},{type:"video-input",label:" / "},{type:"video-analyze",label:" / "},{type:"storyboard-node",label:""},{type:"gen-image",label:"AI "},{type:"gen-video",label:"AI "},{type:"image-compare",label:""},{type:"preview",label:""},{type:"local-save",label:""}].map(n=>s.jsx("div",{children:n.children?s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center",onMouseEnter:()=>Di(!0),children:[s.jsx("button",{className:`flex-1 text-left px-3 py-2 text-xs rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>Lr(n.type,mr.worldX,mr.worldY,mr.sourceNodeId,void 0,void 0,mr.targetNodeId,mr.inputType),children:n.label}),s.jsx("button",{className:`px-2 py-2 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-100"}`,onClick:l=>{l.stopPropagation(),Di(d=>!d)},onMouseEnter:()=>Di(!0),title:"",children:s.jsx(wa,{size:12,className:"transition-transform"})})]}),e1&&s.jsx("div",{className:`absolute left-full top-0 ml-1 w-40 rounded-lg shadow-xl p-1 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,children:n.children.map(l=>s.jsx("button",{className:`w-full text-left px-3 py-2 text-[11px] rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>Lr(l.type,mr.worldX,mr.worldY,mr.sourceNodeId,void 0,void 0,mr.targetNodeId,mr.inputType),children:l.label},l.type))})]}):s.jsx("button",{className:`w-full text-left px-3 py-2 text-xs rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>Lr(n.type,mr.worldX,mr.worldY,mr.sourceNodeId,void 0,void 0,mr.targetNodeId,mr.inputType),children:n.label})},n.type))})}),Cr.visible&&s.jsxs("div",{className:`fixed z-[100] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Cr.x,top:Cr.y},children:[s.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:vv,children:[s.jsx(va,{size:14,className:"text-purple-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:yv,children:[s.jsx(ba,{size:14,className:"text-blue-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Cr.item,l=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);l&&(c(d=>{const f=d.filter(h=>h.type==="preview");if(!f.length)return d;const u=f[f.length-1].id;return d.map(h=>h.id===u?{...h,content:l,previewType:n.type==="video"?"video":"image"}:h)}),As({visible:!1,x:0,y:0,item:null}))},children:[s.jsx(Us,{size:14,className:"text-emerald-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:bv,children:[s.jsx(Pu,{size:14,className:k?"text-green-500":"text-zinc-400"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Cr.item,l=n.mjImages&&n.mjImages.length>0?n.mjImages[n.selectedMjImageIndex||0]||n.mjImages[0]:n.localCacheUrl||n.url||n.originalUrl||n.mjOriginalUrl;l&&(rs.nodeId&&rs.shotId?Gt(rs.nodeId,rs.shotId,{image_url:l}):alert(""),As({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null}))},children:[s.jsx(Dl,{size:14,className:rs.nodeId&&rs.shotId?"text-orange-500":"text-zinc-400"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Cr.item,l=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);if(l){const d=(Cr.worldX||0)+340,f=Cr.worldY||0;vl(l,{originX:d,originY:f})}As({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null})},children:[s.jsx(lf,{size:14,className:"text-blue-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:async()=>{const n=Cr.item,l=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);if(l){try{const f=n.type==="video"||l.includes("/video/")||l.includes("video_mp4")?"mp4":"png",h=`${(n.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}.${f}`,v=await(await fetch(l)).blob(),x=window.URL.createObjectURL(v),_=document.createElement("a");_.href=x,_.download=h,_.click(),window.URL.revokeObjectURL(x)}catch(d){console.error(":",d),alert("")}As({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null})}},children:[s.jsx(Eo,{size:14,className:"text-green-500"})," ",((ym=Cr.item)==null?void 0:ym.type)==="video"?"":""]})]}),tp.visible&&s.jsxs("div",{className:`fixed z-[120] w-52 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:tp.x,top:tp.y},onMouseLeave:()=>np({visible:!1,x:0,y:0}),children:[s.jsxs("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:[" ",Mn.size>0?Mn.size:k?1:0," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:O1,children:[s.jsx(tx,{size:14,className:"text-blue-500"})," "]})]}),Oi.visible&&s.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Oi.x,top:Oi.y},children:[s.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:hv,children:[s.jsx(va,{size:14,className:"text-purple-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:mv,children:[s.jsx(ba,{size:14,className:"text-blue-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:gv,children:[s.jsx(Us,{size:14,className:"text-emerald-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:xv,children:[s.jsx(Pu,{size:14,className:k?"text-green-500":"text-zinc-400"})," "]})]}),Li.visible&&s.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Li.x,top:Li.y},onMouseLeave:Co,children:[s.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:kv,children:[s.jsx(va,{size:14,className:"text-purple-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:zv,children:[s.jsx(ba,{size:14,className:"text-blue-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Li.item;n!=null&&n.url&&$n({url:n.url,type:n.type||"image",prompt:n.prompt||"",mjImages:n.mjImages,selectedMjImageIndex:n.selectedMjImageIndex||0}),Co()},children:[s.jsx(Us,{size:14,className:"text-green-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Li.item;if(n!=null&&n.url){const l=qs.current;if(l&&l.size===9)vl(n.url,{replaceSelected:!0});else{const f=n.sourceNode,u=f?f.x+f.width+20:void 0,h=f?f.y:void 0;vl(n.url,{originX:u,originY:h})}}Co()},children:[s.jsx(lf,{size:14,className:"text-blue-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:async()=>{const n=Li.item;if(!(n!=null&&n.url)){Co();return}try{const d=n.type==="video"||n.url.includes("/video/")||n.url.includes("video_mp4")?"mp4":"png",u=`${(n.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}_${Date.now()}.${d}`;if(n.url.startsWith("data:")){const h=document.createElement("a");h.href=n.url,h.download=u,document.body.appendChild(h),h.click(),document.body.removeChild(h)}else{const g=await(await fetch(n.url)).blob(),v=window.URL.createObjectURL(g),x=document.createElement("a");x.href=v,x.download=u,x.click(),window.URL.revokeObjectURL(v)}}catch(l){console.error(":",l),o("","error")}Co()},children:[s.jsx(Eo,{size:14,className:"text-cyan-500"})," "]})]}),nl.visible&&s.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:nl.x,top:nl.y},onMouseLeave:Np,children:[s.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:Nv,children:[s.jsx(va,{size:14,className:"text-purple-500"})," "]}),s.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=nl.nodeId,l=Dt.get(n);if(!l||!l.content)return;const d=qs.current;if(d&&d.size===9)vl(l.content,{replaceSelected:!0});else{const u=l.x+l.width+20,h=l.y;vl(l.content,{originX:u,originY:h})}Np()},children:[s.jsx(lf,{size:14,className:"text-blue-500"})," "]})]}),s.jsx(Gz,{item:Pi,onClose:()=>$n(null),onNavigate:n=>{const l=Ac.current;if(l&&l.mjImages&&l.mjImages.length>n&&n>=0){const d=Math.max(0,Math.min(n,l.mjImages.length-1)),f=l.mjImages[d],u=Rn(l,f);l.id&&!l.storyboardContext&&St(h=>h.map(g=>g.id===l.id?{...g,url:f,selectedMjImageIndex:d}:g)),$n({...l,url:u,selectedMjImageIndex:d})}},onShotNavigate:(n,l)=>{const d=Ac.current;if(!(d!=null&&d.storyboardContext)||!l)return;const f=d.storyboardContext.shotIndex,u=n>f?1:-1;let h=n,g=null;for(;h>=0&&h<l.length;){const _=l[h];if(((_==null?void 0:_.output_images)||[]).length>0){g=_;break}h+=u}if(!g)return;const v=g.output_images||[],x=0;$n({url:v[x],type:"image",mjImages:v,selectedMjImageIndex:x,prompt:g.prompt,storyboardContext:{...d.storyboardContext,shotId:g.id,shotIndex:h}})},onHistoryNavigate:n=>{const l=Ac.current;if(!l||l.storyboardContext)return;const d=Pt.findIndex(u=>u.id===l.id);if(d===-1)return;let f=d+n;for(;f>=0&&f<Pt.length;){const u=Pt[f];if(u.url&&u.status==="completed"){const g=u.mjImages&&u.mjImages.length>1?u.mjImages[0]:u.url,v=g?Rn(u,g):Rn(u);$n({...u,url:v,selectedMjImageIndex:0,storyboardContext:null});return}f+=n}}}),s.jsxs(Yz,{isOpen:t1,onClose:()=>ss(!1),title:"",theme:e,children:[s.jsx("div",{className:"p-4 space-y-3",children:s.jsxs("div",{className:"mb-2",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"Global API Key Key"}),s.jsx("div",{className:"mt-1 flex gap-2",children:s.jsx("input",{type:"password",value:Me,onChange:n=>Be(n.target.value),className:`flex-1 rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:" Key Key"})})]})}),s.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"V2.6.1 "}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),s.jsxs("select",{value:er,onChange:n=>{const l=n.target.value;Zn(l),localStorage.setItem("tapnow_performance_mode",l)},className:`text-xs rounded px-2 py-0.5 border outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`,children:[s.jsx("option",{value:"off",children:" ()"}),s.jsx("option",{value:"normal",children:" ()"}),s.jsx("option",{value:"ultra",children:" ()"})]})]}),s.jsx("p",{className:"text-[9px] text-zinc-500",children:""})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),s.jsx("input",{type:"text",value:In,onChange:n=>{const l=n.target.value;Ja(l),localStorage.setItem("tapnow_local_server_url",l)},placeholder:"http://127.0.0.1:9527",className:`w-full text-xs rounded px-2 py-1 border outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`}),s.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-zinc-500",children:[s.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${fn?"bg-green-500":"bg-red-500"}`}),s.jsx("span",{children:fn?"":""})]})]}),s.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:""})]})]})]}),s.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API "}),s.jsxs("div",{className:"flex gap-2 mt-2",children:[s.jsxs("button",{onClick:()=>{const n={version:"3.4.23",exportTime:new Date().toISOString(),globalApiKey:Me,providers:H,apiConfigs:ue.map(({key:S,url:j,...C})=>C)},l=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),d=URL.createObjectURL(l),f=document.createElement("a");f.href=d;const u=new Date,h=u.getFullYear().toString().slice(2),g=(u.getMonth()+1).toString().padStart(2,"0"),v=u.getDate().toString().padStart(2,"0"),x=u.getHours().toString().padStart(2,"0"),_=u.getMinutes().toString().padStart(2,"0");f.download=`tapnow-api-keys-${h}${g}${v}-${x}${_}.json`,f.click(),URL.revokeObjectURL(d)},className:`flex-1 px-3 py-2 text-xs rounded flex items-center justify-center gap-2 transition-colors ${e==="dark"?"bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border border-blue-500/30":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:[s.jsx(Eo,{size:14})," API Keys"]}),s.jsxs("button",{onClick:()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async l=>{const d=l.target.files[0];if(d)try{const f=await d.text(),u=JSON.parse(f);if(u.globalApiKey&&(Be(u.globalApiKey),localStorage.setItem("tapnow_global_key",u.globalApiKey)),u.providers&&ae(h=>({...h,...u.providers})),u.apiConfigs&&Array.isArray(u.apiConfigs)){const h=u.apiConfigs.map(g=>{if(g.modelName&&g.modelName!==g.id)return{id:g.modelName,provider:g.provider,type:g.type,_uid:g._uid||`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...g.durations?{durations:g.durations}:{}};const{displayName:v,modelName:x,isCustom:_,key:S,url:j,...C}=g;return{...C,_uid:C._uid||`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}});K(h)}alert("API ")}catch(f){alert(": "+f.message)}},n.click()},className:`flex-1 px-3 py-2 text-xs rounded flex items-center justify-center gap-2 transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700 border border-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200 border border-zinc-300"}`,children:[s.jsx(Xi,{size:14})," API Keys"]})]}),s.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:" KeyProvider  Key"})]}),s.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API "}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[s.jsxs("button",{onClick:()=>{Ze({}),dt.current={},alert("")},className:`px-2 py-1.5 text-[10px] rounded flex items-center justify-center gap-1 transition-colors ${e==="dark"?"bg-red-600/20 text-red-400 hover:bg-red-600/30 border border-red-500/30":"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200"}`,children:[s.jsx(lz,{size:12}),"",Object.keys(be).length>0&&s.jsx("span",{className:"ml-1 px-1 rounded bg-red-500/30 text-[9px]",children:Object.keys(be).length})]}),s.jsxs("button",{onClick:()=>{rn({}),alert("")},className:`px-2 py-1.5 text-[10px] rounded flex items-center justify-center gap-1 transition-colors ${e==="dark"?"bg-amber-600/20 text-amber-400 hover:bg-amber-600/30 border border-amber-500/30":"bg-amber-50 text-amber-600 hover:bg-amber-100 border border-amber-200"}`,children:[s.jsx(Gg,{size:12}),"",Object.keys(_t).length>0&&s.jsx("span",{className:"ml-1 px-1 rounded bg-amber-500/30 text-[9px]",children:Object.keys(_t).length})]}),s.jsxs("button",{onClick:()=>{ir.current=[],alert("")},className:`px-2 py-1.5 text-[10px] rounded flex items-center justify-center gap-1 transition-colors ${e==="dark"?"bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border border-blue-500/30":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:[s.jsx(Du,{size:12}),""]})]}),s.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:" =  = 60 = 1006"})]}),s.jsx("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"/"}),s.jsx("p",{className:`text-[10px] mt-0.5 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:" ()"})]}),s.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[s.jsx("input",{type:"range",min:"1",max:"30",value:w,onChange:n=>{const l=parseInt(n.target.value)||5;$(l),localStorage.setItem("tapnow_max_undo_steps",String(l))},className:"w-20",onMouseDown:n=>n.stopPropagation()}),s.jsx("span",{className:`text-xs font-mono w-6 text-center ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:w})]})]})}),s.jsx("div",{className:"mb-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:""}),s.jsx("p",{className:`text-[10px] mt-0.5 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:"FormDataURL"})]}),s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-3",children:[s.jsx("input",{type:"checkbox",checked:or,onChange:n=>{const l=n.target.checked;Ei(l),localStorage.setItem("tapnow_jimeng_use_local_file",String(l))},className:"sr-only peer"}),s.jsx("div",{className:`w-11 h-6 rounded-full peer peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-500/50 ${or?"bg-blue-600":e==="dark"?"bg-zinc-700":"bg-zinc-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all`})]})]})}),s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{const n=Object.values(al).some(d=>d),l={};n||Object.keys(gr).forEach(d=>l[d]=!0),ap(l)},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,title:Object.values(al).some(n=>n)?"":"",children:s.jsx(pz,{size:14,className:`transition-transform ${Object.values(al).some(n=>n)?"":"rotate-180"}`})}),s.jsxs(Uu,{className:"h-7 text-xs px-3 bg-blue-600 hover:bg-blue-500",onClick:()=>{const n=`custom-${Date.now()}`,l="New Provider";ae(d=>({...d,[n]:{name:l,key:"",url:"",enabled:!0}})),ap(d=>({...d,[n]:!0})),Vc({key:n,tempName:l})},children:[s.jsx(Ji,{size:14,className:"mr-1"})," "]})]})]}),s.jsx("div",{className:"space-y-2 max-h-[50vh] overflow-y-auto custom-scrollbar pr-1",children:Object.entries(gr).map(([n,l])=>{var d,f,u;return s.jsxs("div",{className:`group rounded-lg border ${e==="dark"?"bg-[#18181b] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[s.jsx("button",{onClick:()=>ap(h=>({...h,[n]:!h[n]})),className:`w-full flex items-center justify-between px-3 py-2.5 text-left transition-colors ${e==="dark"?"hover:bg-zinc-800/50":"hover:bg-zinc-100"}`,children:l1===n?s.jsxs("div",{className:"flex items-center justify-between w-full",children:[s.jsxs("span",{className:`text-sm font-semibold ${e==="dark"?"text-zinc-100":"text-zinc-800"}`,children:[" ",l.name,"?"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:h=>{h.stopPropagation(),ae(g=>{const v={...g};return delete v[n],v}),lp(null)},className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded",children:""}),s.jsx("button",{onClick:h=>{h.stopPropagation(),lp(null)},className:`text-xs px-2 py-1 rounded ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-700"}`,children:""})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${((d=H[n])==null?void 0:d.enabled)!==!1?"bg-green-500":"bg-zinc-500"}`}),(ua==null?void 0:ua.key)===n?s.jsx("input",{type:"text",value:ua.tempName,onChange:h=>Vc(g=>({...g,tempName:h.target.value})),onBlur:()=>{const h=ua.tempName.trim(),g=n;h&&h!==g&&(ae(v=>{const{[g]:x,..._}=v;return{..._,[h]:x}}),K(v=>v.map(x=>x.provider===g?{...x,provider:h}:x))),Vc(null)},onKeyDown:h=>{h.key==="Enter"&&h.target.blur(),h.stopPropagation()},onClick:h=>h.stopPropagation(),autoFocus:!0,className:`text-sm font-semibold bg-transparent border-b border-blue-500 outline-none w-full ${e==="dark"?"text-zinc-100":"text-zinc-800"}`}):s.jsx("span",{className:`text-sm font-semibold ${e==="dark"?"text-zinc-100":"text-zinc-800"}`,children:l.name}),s.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${e==="dark"?"bg-zinc-800 text-zinc-500":"bg-zinc-200 text-zinc-500"}`,children:[l.models.length," "]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[!ua&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:h=>{h.stopPropagation(),Vc({key:n,tempName:l.name})},className:"p-1 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors opacity-0 group-hover:opacity-100",title:"",children:s.jsx(jz,{size:12,className:e==="dark"?"text-zinc-400":"text-zinc-500"})}),s.jsx("button",{onClick:h=>{h.stopPropagation(),lp(n)},className:"p-1 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors opacity-0 group-hover:opacity-100",title:"",children:s.jsx(Fr,{size:12,className:e==="dark"?"text-zinc-400 hover:text-red-400":"text-zinc-500 hover:text-red-500"})})]}),s.jsx(zs,{size:16,className:`transition-transform ${al[n]?"rotate-180":""} ${e==="dark"?"text-zinc-500":"text-zinc-400"}`})]})]})}),al[n]&&s.jsxs("div",{className:`px-3 pb-3 border-t ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsxs("div",{className:"pt-3 pb-2 space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider text-right ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API Key"}),s.jsx("input",{type:"password",value:((f=H[n])==null?void 0:f.key)||"",onChange:h=>ae(g=>({...g,[n]:{...g[n],key:h.target.value}})),className:`col-span-3 w-full rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:"sk-..."})]}),s.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[s.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider text-right ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"Base URL"}),s.jsx("input",{type:"text",value:((u=H[n])==null?void 0:u.url)||"",onChange:h=>ae(g=>({...g,[n]:{...g[n],url:h.target.value}})),className:`col-span-3 w-full rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:"https://..."})]})]}),s.jsxs("div",{className:`mt-2 pt-2 border-t ${e==="dark"?"border-zinc-800/50":"border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:""}),s.jsxs("button",{onClick:()=>{const h=`${n}-${Date.now()}`;K(g=>[...g,{id:h,provider:n,type:"Chat"}])},className:`text-[9px] px-1.5 py-0.5 rounded flex items-center gap-1 ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-200 text-zinc-600 hover:bg-zinc-300"}`,children:[s.jsx(Ji,{size:10})," "]})]}),s.jsx("div",{className:"space-y-1.5",children:l.models.map(h=>s.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 rounded ${e==="dark"?"bg-zinc-900/50 hover:bg-zinc-800/50":"bg-white hover:bg-zinc-100"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Ds(h.id)}`}),s.jsx("input",{type:"text",value:h.id||"",onChange:g=>qh(h.id,{id:g.target.value},h.id),className:`text-xs bg-transparent border-b border-transparent hover:border-zinc-600 focus:border-blue-500 outline-none flex-1 font-mono ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,placeholder:"model-id",title:` ID: ${h.id}`}),s.jsxs("select",{value:h.type||"Chat",onChange:g=>qh(h.id,{type:g.target.value}),className:`text-[9px] px-1 rounded cursor-pointer outline-none ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-200 text-zinc-500 hover:bg-zinc-300"}`,children:[s.jsx("option",{value:"Chat",children:"Chat"}),s.jsx("option",{value:"Image",children:"Image"}),s.jsx("option",{value:"Video",children:"Video"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>N1(h.id),disabled:$h===h.id,className:`px-1.5 py-0.5 rounded text-[9px] ${up[h.id]==="success"?"text-green-500":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-400 hover:text-zinc-600"}`,children:$h===h.id?s.jsx(xi,{size:10,className:"animate-spin"}):up[h.id]==="success"?s.jsx(Vl,{size:10}):s.jsx(Ol,{size:10})}),s.jsx("button",{onClick:()=>j1(h.id),className:`px-1 ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,children:s.jsx(Fr,{size:10})})]})]},h._uid||h.id))})]})]})]},n)})}),s.jsx("div",{className:`pt-2 flex justify-end gap-2 border-t mt-3 ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:s.jsx(Uu,{variant:"secondary",onClick:()=>ss(!1),children:""})})]}),i1&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>{Hc(!1),vo(new Set)}}),s.jsxs("div",{className:`relative w-[90vw] h-[85vh] max-w-7xl rounded-lg shadow-2xl flex flex-col ${e==="dark"?"bg-[#121214] border border-zinc-800":"bg-white border border-zinc-200"}`,children:[s.jsxs("div",{className:`p-4 border-b flex items-center justify-between ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("h2",{className:`text-lg font-bold ${e==="dark"?"text-zinc-100":"text-zinc-900"}`,children:""}),s.jsxs("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:[" ",ar.size," "]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{ar.size===Pt.length?vo(new Set):vo(new Set(Pt.map(n=>n.id)))},className:`px-3 py-1.5 text-xs rounded transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200"}`,children:ar.size===Pt.length?"":""}),s.jsxs("button",{onClick:()=>{ar.size!==0&&confirm(` ${ar.size} `)&&(St(n=>{const l=n.filter(d=>!ar.has(d.id));try{localStorage.setItem("tapnow_history",JSON.stringify(l))}catch(d){console.error(":",d)}return l}),vo(new Set))},disabled:ar.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${ar.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[s.jsx(Fr,{size:14}),""]}),s.jsxs("button",{onClick:async()=>{if(ar.size===0)return;const n=(In||"").replace(/\/+$/,"");if(!n){o("","error");return}const d=Pt.filter(f=>ar.has(f.id)).map(f=>f.localFilePath||f.localCacheUrl).filter(Boolean);if(d.length===0){o("","warning");return}try{const f=await fetch(`${n}/delete-batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:d})});if(!f.ok){const h=await f.text();throw new Error(h||"")}const u=await f.json();St(h=>h.map(g=>ar.has(g.id)?{...g,localCacheUrl:null,localFilePath:null}:g)),o((u==null?void 0:u.message)||` ${d.length} `,"success")}catch(f){o(`: ${f.message||""}`,"error")}},disabled:ar.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${ar.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-amber-600/30 text-amber-200 hover:bg-amber-600/40":"bg-amber-100 text-amber-600 hover:bg-amber-200"}`,children:[s.jsx(Fr,{size:14}),""]}),s.jsxs("button",{onClick:async()=>{if(ar.size===0)return;const n=Pt.filter(u=>ar.has(u.id)&&(u.url||u.localCacheUrl||u.originalUrl||u.mjOriginalUrl));if(n.length===0){alert("");return}const l=xn(window.innerWidth/2,window.innerHeight/2),d=l.x,f=l.y;n.forEach((u,h)=>{const g=h%5*20,v=Math.floor(h/5)*20;let x=u.localCacheUrl||u.url||u.originalUrl||u.mjOriginalUrl;u.type==="video"&&!Hn(x)&&(x+=(x.includes("?")?"&":"?")+"force_video_display=true"),u.type==="image"?(async()=>{try{const _=await Br(x);Lr("input-image",d+g,f+v,null,x,_)}catch{Lr("input-image",d+g,f+v,null,x)}})():u.type==="video"&&Lr("video-input",d+g,f+v,null,x)}),Hc(!1),vo(new Set)},disabled:ar.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${ar.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[s.jsx(Pu,{size:14}),""]}),s.jsx("button",{onClick:()=>{Hc(!1),vo(new Set)},className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,children:s.jsx(cs,{size:18})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:s.jsx("div",{className:"grid grid-cols-4 gap-4",children:Pt.map(n=>{var le,ne,te,$e,rt;const l=ar.has(n.id),d=n.modelName||((le=n.apiConfig)==null?void 0:le.modelId)||((ne=n.apiConfig)==null?void 0:ne.model)||((te=n.apiConfig)==null?void 0:te.modelName)||n.model||"",f=d.length>12?`${d.slice(0,9)}...`:d,u=(fn?n.localCacheUrl||(n.localCacheMap?Object.values(n.localCacheMap)[0]:null):null)||n.url||n.originalUrl||n.mjOriginalUrl,h=n.mjImages&&n.mjImages.length>0?n.mjImages:n.output_images&&n.output_images.length>0?n.output_images:null,g=h?h.map(Oe=>fn&&n.localCacheMap&&n.localCacheMap[Oe]?n.localCacheMap[Oe]:Oe):null,v=typeof n.selectedMjImageIndex=="number"?n.selectedMjImageIndex:0,x=g?Math.min(v,g.length-1):0,_=g&&g.length>=4?g.slice(0,4):null,S=_?Math.min(x,_.length-1):0,j=g?g[x]||g[0]:u,C=!!(fn&&(n.localCacheUrl||n.localFilePath||n.localCacheMap&&Object.keys(n.localCacheMap).length>0)),L=n.type==="video"||(j?Hn(j):!1),M=n.ratio||n.mjRatio||"",U=n.resolution||(n.width&&n.height?`${n.width}x${n.height}`:""),V=U?U.replace(/p$/i,""):"",F=L&&n.duration?`${String(n.duration).replace(/s$/i,"")}s`:"",J=[M,V].filter(Boolean);L&&F&&J.push(F);const Y=J.join("/"),de=n.startTime?new Date(n.startTime).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit"}):n.time||"",Z=typeof n.durationMs=="number"&&n.durationMs>0?`${(n.durationMs/6e4).toFixed(1)}m`:"",xe=L?n.hasInputImages?"":"":n.hasInputImages?"":"";return s.jsxs("div",{className:`relative rounded-lg overflow-hidden border-2 transition-all ${l?"border-blue-500 shadow-lg shadow-blue-500/20":e==="dark"?"border-zinc-800 hover:border-zinc-700":"border-zinc-200 hover:border-zinc-300"}`,children:[s.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-1.5",children:[l&&s.jsx("div",{className:"bg-blue-500 rounded-full p-1",children:s.jsx(Kl,{size:16,className:"text-white"})}),n.status==="completed"&&j&&s.jsx("button",{onClick:Oe=>{Oe.stopPropagation();const He={...n,url:j,selectedMjImageIndex:h&&h.length>1?x:void 0};$n(He)},className:`p-1.5 rounded-full transition-colors backdrop-blur-sm ${e==="dark"?"bg-black/60 text-white hover:bg-black/80":"bg-white/80 text-zinc-700 hover:bg-white"}`,title:" ()",children:s.jsx(Us,{size:14})})]}),s.jsxs("div",{className:`relative ${n.mjImages&&(n.mjImages.length===4||n.mjImages.length>1)||n.mjNeedsSplit&&((rt=($e=n.apiConfig)==null?void 0:$e.modelId)!=null&&rt.includes("mj"))?(()=>{const Oe=n.mjRatio||"1:1";return Oe==="16:9"?"aspect-video":Oe==="9:16"?"aspect-[9/16]":Oe==="4:3"?"aspect-[4/3]":Oe==="3:4"?"aspect-[3/4]":Oe==="21:9"?"aspect-[21/9]":"aspect-square"})():"aspect-video"} ${e==="dark"?"bg-zinc-900":"bg-zinc-100"}`,children:[C&&s.jsx("div",{className:"absolute top-2 left-2 z-10 text-[9px] px-2 py-0.5 rounded bg-orange-500 text-white shadow",children:""}),n.status==="completed"&&(j||_&&_.length>0)?L?s.jsx("video",{src:j,className:"w-full h-full object-contain",controls:!0,playsInline:!0,preload:"metadata"}):_&&_.length>0?s.jsx("div",{className:"grid grid-cols-2 grid-rows-2 w-full h-full",children:_.map((Oe,He)=>{const gt=S===He;return s.jsxs("div",{className:`relative w-full h-full cursor-pointer ${gt?"ring-2 ring-blue-400":""}`,onClick:xt=>{xt.stopPropagation(),St(Ct=>Ct.map(bt=>bt.id===n.id?{...bt,selectedMjImageIndex:He}:bt))},onDoubleClick:xt=>{xt.preventDefault(),xt.stopPropagation(),$n({...n,url:Oe,selectedMjImageIndex:He})},children:[s.jsx(Yn,{src:Oe,className:`w-full h-full object-cover ${gt?"opacity-80":""}`,alt:`-${He+1}`}),gt&&s.jsx("div",{className:"absolute inset-0 bg-black/20 pointer-events-none"}),s.jsx("div",{className:"absolute bottom-1 left-1 bg-black/60 text-white text-[9px] px-1.5 py-0.5 rounded",children:He+1})]},`${n.id}-${He}`)})}):s.jsx(Yn,{src:j,className:"w-full h-full object-contain",alt:"",onError:Oe=>{Oe.target.style.display="none"}}):s.jsx("div",{className:`w-full h-full flex items-center justify-center ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:n.status==="generating"?s.jsx(xi,{size:24,className:"animate-spin"}):s.jsx(hz,{size:24})})]}),s.jsxs("div",{onClick:()=>{const Oe=new Set(ar);l?Oe.delete(n.id):Oe.add(n.id),vo(Oe)},className:`p-2 text-xs cursor-pointer ${e==="dark"?"bg-zinc-900 text-zinc-300":"bg-zinc-50 text-zinc-700"}`,children:[s.jsx("div",{className:"truncate font-medium",children:n.prompt||""}),s.jsxs("div",{className:"text-[10px] opacity-70 mt-0.5",children:[s.jsxs("span",{children:[xe," "]}),s.jsx("span",{title:d,children:f}),Y&&s.jsxs("span",{children:["  ",Y]}),de&&s.jsxs("span",{children:["  ",de]}),Z&&s.jsxs("span",{children:["  ",Z]})]})]})]},n.id)})})})]})]})]})]})]}),s.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[9999] flex flex-col gap-2 pointer-events-none",children:r.map(n=>s.jsx("div",{className:`px-4 py-2 rounded-lg shadow-lg text-sm font-medium pointer-events-auto animate-pulse ${n.type==="success"?"bg-green-600 text-white":n.type==="error"?"bg-red-600 text-white":n.type==="warning"?"bg-yellow-500 text-black":"bg-zinc-800 text-white"}`,children:n.message},n.id))})]})}ff.createRoot(document.getElementById("root")).render(s.jsx(Ed.StrictMode,{children:s.jsx(Xz,{})}));</script>
  <style rel="stylesheet" crossorigin>*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.\!visible{visibility:visible!important}.visible{visibility:visible}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.-bottom-0\.5{bottom:-.125rem}.-bottom-1\.5{bottom:-.375rem}.-left-1{left:-.25rem}.-right-0\.5{right:-.125rem}.-right-1{right:-.25rem}.-right-2\.5{right:-.625rem}.-top-1{top:-.25rem}.-top-1\.5{top:-.375rem}.-top-10{top:-2.5rem}.-top-2\.5{top:-.625rem}.bottom-0{bottom:0}.bottom-1{bottom:.25rem}.bottom-2{bottom:.5rem}.bottom-4{bottom:1rem}.bottom-8{bottom:2rem}.bottom-full{bottom:100%}.left-0{left:0}.left-1{left:.25rem}.left-1\/2{left:50%}.left-2{left:.5rem}.left-4{left:1rem}.left-6{left:1.5rem}.left-full{left:100%}.right-0{right:0}.right-1{right:.25rem}.right-2{right:.5rem}.right-4{right:1rem}.top-0{top:0}.top-1{top:.25rem}.top-1\/2{top:50%}.top-12{top:3rem}.top-2{top:.5rem}.top-20{top:5rem}.top-4{top:1rem}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[120\]{z-index:120}.z-\[200\]{z-index:200}.z-\[60\]{z-index:60}.z-\[9999\]{z-index:9999}.col-span-3{grid-column:span 3 / span 3}.col-span-full{grid-column:1 / -1}.m-3{margin:.75rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.-mb-1{margin-bottom:-.25rem}.-mt-1{margin-top:-.25rem}.mb-0{margin-bottom:0}.mb-0\.5{margin-bottom:.125rem}.mb-1{margin-bottom:.25rem}.mb-1\.5{margin-bottom:.375rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-auto{margin-bottom:auto}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-auto{margin-left:auto}.mr-0{margin-right:0}.mr-1{margin-right:.25rem}.mr-1\.5{margin-right:.375rem}.mr-2{margin-right:.5rem}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-auto{margin-top:auto}.line-clamp-1{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.aspect-\[21\/9\]{aspect-ratio:21/9}.aspect-\[3\/4\]{aspect-ratio:3/4}.aspect-\[4\/3\]{aspect-ratio:4/3}.aspect-\[9\/16\]{aspect-ratio:9/16}.aspect-square{aspect-ratio:1 / 1}.aspect-video{aspect-ratio:16 / 9}.h-0{height:0px}.h-1{height:.25rem}.h-1\.5{height:.375rem}.h-10{height:2.5rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:.5rem}.h-20{height:5rem}.h-24{height:6rem}.h-28{height:7rem}.h-3{height:.75rem}.h-4{height:1rem}.h-40{height:10rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-\[2px\]{height:2px}.h-\[85vh\]{height:85vh}.h-\[90px\]{height:90px}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.max-h-32{max-height:8rem}.max-h-36{max-height:9rem}.max-h-40{max-height:10rem}.max-h-64{max-height:16rem}.max-h-80{max-height:20rem}.max-h-\[140px\]{max-height:140px}.max-h-\[300px\]{max-height:300px}.max-h-\[50vh\]{max-height:50vh}.max-h-\[85vh\]{max-height:85vh}.max-h-\[90vh\]{max-height:90vh}.max-h-full{max-height:100%}.min-h-0{min-height:0px}.min-h-\[100px\]{min-height:100px}.min-h-\[14rem\]{min-height:14rem}.min-h-\[70px\]{min-height:70px}.min-h-\[80px\]{min-height:80px}.w-0{width:0px}.w-0\.5{width:.125rem}.w-1{width:.25rem}.w-1\.5{width:.375rem}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-14{width:3.5rem}.w-16{width:4rem}.w-2{width:.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-32{width:8rem}.w-36{width:9rem}.w-4{width:1rem}.w-40{width:10rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-96{width:24rem}.w-\[500px\]{width:500px}.w-\[680px\]{width:680px}.w-\[90vw\]{width:90vw}.w-auto{width:auto}.w-full{width:100%}.min-w-0{min-width:0px}.min-w-\[100px\]{min-width:100px}.min-w-\[300px\]{min-width:300px}.max-w-7xl{max-width:80rem}.max-w-\[150px\]{max-width:150px}.max-w-\[200px\]{max-width:200px}.max-w-\[360px\]{max-width:360px}.max-w-\[85\%\]{max-width:85%}.max-w-\[90vw\]{max-width:90vw}.max-w-full{max-width:100%}.max-w-xl{max-width:36rem}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.border-collapse{border-collapse:collapse}.origin-top-left{transform-origin:top left}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-75{--tw-scale-x: .75;--tw-scale-y: .75;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-90{--tw-scale-x: .9;--tw-scale-y: .9;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-95{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.animate-bounce{animation:bounce 1s infinite}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes spin{to{transform:rotate(360deg)}}.cursor-col-resize{cursor:col-resize}.cursor-default{cursor:default}.cursor-ew-resize{cursor:ew-resize}.cursor-move{cursor:move}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.cursor-text{cursor:text}.resize-none{resize:none}.resize{resize:both}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-row-reverse{flex-direction:row-reverse}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.flex-nowrap{flex-wrap:nowrap}.content-start{align-content:flex-start}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-0{gap:0px}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.-space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(-.5rem * var(--tw-space-x-reverse));margin-left:calc(-.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-1\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-visible{overflow:visible}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-xl{border-radius:.75rem}.rounded-bl{border-bottom-left-radius:.25rem}.rounded-br{border-bottom-right-radius:.25rem}.rounded-tl-none{border-top-left-radius:0}.rounded-tr{border-top-right-radius:.25rem}.rounded-tr-none{border-top-right-radius:0}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-\[\#18181b\]{--tw-border-opacity: 1;border-color:rgb(24 24 27 / var(--tw-border-opacity, 1))}.border-amber-200{--tw-border-opacity: 1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-amber-500\/30{border-color:#f59e0b4d}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-300{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-blue-400{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.border-blue-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-blue-500\/30{border-color:#3b82f64d}.border-blue-800{--tw-border-opacity: 1;border-color:rgb(30 64 175 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-400{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-green-500{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-purple-500\/20{border-color:#a855f733}.border-purple-800{--tw-border-opacity: 1;border-color:rgb(107 33 168 / var(--tw-border-opacity, 1))}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-red-500\/30{border-color:#ef44444d}.border-red-500\/50{border-color:#ef444480}.border-red-800{--tw-border-opacity: 1;border-color:rgb(153 27 27 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-violet-200{--tw-border-opacity: 1;border-color:rgb(221 214 254 / var(--tw-border-opacity, 1))}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\/10{border-color:#ffffff1a}.border-white\/60{border-color:#fff9}.border-white\/70{border-color:#ffffffb3}.border-white\/80{border-color:#fffc}.border-zinc-200{--tw-border-opacity: 1;border-color:rgb(228 228 231 / var(--tw-border-opacity, 1))}.border-zinc-300{--tw-border-opacity: 1;border-color:rgb(212 212 216 / var(--tw-border-opacity, 1))}.border-zinc-400{--tw-border-opacity: 1;border-color:rgb(161 161 170 / var(--tw-border-opacity, 1))}.border-zinc-500\/60{border-color:#71717a99}.border-zinc-600{--tw-border-opacity: 1;border-color:rgb(82 82 91 / var(--tw-border-opacity, 1))}.border-zinc-700{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.border-zinc-700\/40{border-color:#3f3f4666}.border-zinc-700\/50{border-color:#3f3f4680}.border-zinc-800{--tw-border-opacity: 1;border-color:rgb(39 39 42 / var(--tw-border-opacity, 1))}.border-zinc-800\/50{border-color:#27272a80}.bg-\[\#09090b\]{--tw-bg-opacity: 1;background-color:rgb(9 9 11 / var(--tw-bg-opacity, 1))}.bg-\[\#09090b\]\/90{background-color:#09090be6}.bg-\[\#121214\]{--tw-bg-opacity: 1;background-color:rgb(18 18 20 / var(--tw-bg-opacity, 1))}.bg-\[\#18181b\]{--tw-bg-opacity: 1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-amber-100{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity: 1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-amber-500\/30{background-color:#f59e0b4d}.bg-amber-600\/20{background-color:#d9770633}.bg-amber-600\/30{background-color:#d977064d}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\/20{background-color:#0003}.bg-black\/40{background-color:#0006}.bg-black\/50{background-color:#00000080}.bg-black\/60{background-color:#0009}.bg-black\/70{background-color:#000000b3}.bg-black\/80{background-color:#000c}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-500\/10{background-color:#3b82f61a}.bg-blue-500\/20{background-color:#3b82f633}.bg-blue-500\/30{background-color:#3b82f64d}.bg-blue-500\/5{background-color:#3b82f60d}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-600\/20{background-color:#2563eb33}.bg-blue-600\/30{background-color:#2563eb4d}.bg-blue-600\/80{background-color:#2563ebcc}.bg-blue-900\/20{background-color:#1e3a8a33}.bg-blue-900\/30{background-color:#1e3a8a4d}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-500\/20{background-color:#22c55e33}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-600\/40{background-color:#16a34a66}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-orange-500\/20{background-color:#f9731633}.bg-orange-600\/30{background-color:#ea580c4d}.bg-purple-50{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-purple-500{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-purple-600\/80{background-color:#9333eacc}.bg-purple-900\/30{background-color:#581c874d}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-500\/10{background-color:#ef44441a}.bg-red-500\/30{background-color:#ef44444d}.bg-red-500\/80{background-color:#ef4444cc}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-red-600\/20{background-color:#dc262633}.bg-red-600\/30{background-color:#dc26264d}.bg-red-600\/80{background-color:#dc2626cc}.bg-red-900\/30{background-color:#7f1d1d4d}.bg-red-900\/40{background-color:#7f1d1d66}.bg-transparent{background-color:transparent}.bg-violet-50{--tw-bg-opacity: 1;background-color:rgb(245 243 255 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:#ffffff1a}.bg-white\/40{background-color:#fff6}.bg-white\/80{background-color:#fffc}.bg-white\/90{background-color:#ffffffe6}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity: 1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-zinc-100{--tw-bg-opacity: 1;background-color:rgb(244 244 245 / var(--tw-bg-opacity, 1))}.bg-zinc-200{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.bg-zinc-300{--tw-bg-opacity: 1;background-color:rgb(212 212 216 / var(--tw-bg-opacity, 1))}.bg-zinc-400{--tw-bg-opacity: 1;background-color:rgb(161 161 170 / var(--tw-bg-opacity, 1))}.bg-zinc-50{--tw-bg-opacity: 1;background-color:rgb(250 250 250 / var(--tw-bg-opacity, 1))}.bg-zinc-50\/50{background-color:#fafafa80}.bg-zinc-500{--tw-bg-opacity: 1;background-color:rgb(113 113 122 / var(--tw-bg-opacity, 1))}.bg-zinc-600{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity, 1))}.bg-zinc-700{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.bg-zinc-700\/50{background-color:#3f3f4680}.bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.bg-zinc-800\/40{background-color:#27272a66}.bg-zinc-800\/50{background-color:#27272a80}.bg-zinc-800\/60{background-color:#27272a99}.bg-zinc-900{--tw-bg-opacity: 1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-zinc-900\/30{background-color:#18181b4d}.bg-zinc-900\/50{background-color:#18181b80}.bg-zinc-900\/60{background-color:#18181b99}.bg-zinc-900\/80{background-color:#18181bcc}.bg-zinc-900\/90{background-color:#18181be6}.bg-zinc-950{--tw-bg-opacity: 1;background-color:rgb(9 9 11 / var(--tw-bg-opacity, 1))}.bg-zinc-950\/50{background-color:#09090b80}.bg-opacity-50{--tw-bg-opacity: .5}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-blue-600{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-600{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-emerald-600{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.to-indigo-600{--tw-gradient-to: #4f46e5 var(--tw-gradient-to-position)}.fill-current{fill:currentColor}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-0\.5{padding:.125rem}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-2{padding:.5rem}.p-2\.5{padding:.625rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-8{padding:2rem}.px-0\.5{padding-left:.125rem;padding-right:.125rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-1{padding-bottom:.25rem}.pb-2{padding-bottom:.5rem}.pb-3{padding-bottom:.75rem}.pl-1{padding-left:.25rem}.pl-2{padding-left:.5rem}.pl-8{padding-left:2rem}.pr-1{padding-right:.25rem}.pr-2{padding-right:.5rem}.pr-8{padding-right:2rem}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-\[7px\]{font-size:7px}.text-\[8px\]{font-size:8px}.text-\[9px\]{font-size:9px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-none{line-height:1}.leading-snug{line-height:1.375}.tracking-\[0\.3em\]{letter-spacing:.3em}.tracking-tighter{letter-spacing:-.05em}.tracking-wide{letter-spacing:.025em}.tracking-wider{letter-spacing:.05em}.tracking-widest{letter-spacing:.1em}.text-amber-200{--tw-text-opacity: 1;color:rgb(253 230 138 / var(--tw-text-opacity, 1))}.text-amber-400{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.text-amber-600{--tw-text-opacity: 1;color:rgb(217 119 6 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-cyan-500{--tw-text-opacity: 1;color:rgb(6 182 212 / var(--tw-text-opacity, 1))}.text-emerald-500{--tw-text-opacity: 1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-400{--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-orange-200{--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity: 1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-red-200{--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\/70{color:#ffffffb3}.text-yellow-300{--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity: 1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-zinc-100{--tw-text-opacity: 1;color:rgb(244 244 245 / var(--tw-text-opacity, 1))}.text-zinc-200{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.text-zinc-300{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.text-zinc-500{--tw-text-opacity: 1;color:rgb(113 113 122 / var(--tw-text-opacity, 1))}.text-zinc-600{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.text-zinc-700{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.text-zinc-800{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity, 1))}.text-zinc-900{--tw-text-opacity: 1;color:rgb(24 24 27 / var(--tw-text-opacity, 1))}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.placeholder-zinc-400::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(161 161 170 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-400::placeholder{--tw-placeholder-opacity: 1;color:rgb(161 161 170 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-500::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(113 113 122 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-500::placeholder{--tw-placeholder-opacity: 1;color:rgb(113 113 122 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-600::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(82 82 91 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-600::placeholder{--tw-placeholder-opacity: 1;color:rgb(82 82 91 / var(--tw-placeholder-opacity, 1))}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-20{opacity:.2}.opacity-30{opacity:.3}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-80{opacity:.8}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(0\,0\,0\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(0,0,0,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(255\,255\,255\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(255,255,255,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(239\,68\,68\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(239,68,68,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(34\,197\,94\,0\.6\)\]{--tw-shadow: 0 0 8px rgba(34,197,94,.6);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(34\,197\,94\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(34,197,94,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-black\/10{--tw-shadow-color: rgb(0 0 0 / .1);--tw-shadow: var(--tw-shadow-colored)}.shadow-black\/40{--tw-shadow-color: rgb(0 0 0 / .4);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-300\/30{--tw-shadow-color: rgb(147 197 253 / .3);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-500\/20{--tw-shadow-color: rgb(59 130 246 / .2);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-900\/20{--tw-shadow-color: rgb(30 58 138 / .2);--tw-shadow: var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.ring-1{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-blue-300\/60{--tw-ring-color: rgb(147 197 253 / .6)}.ring-blue-400{--tw-ring-opacity: 1;--tw-ring-color: rgb(96 165 250 / var(--tw-ring-opacity, 1))}.ring-blue-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.ring-blue-500\/30{--tw-ring-color: rgb(59 130 246 / .3)}.ring-blue-500\/50{--tw-ring-color: rgb(59 130 246 / .5)}.ring-green-500\/50{--tw-ring-color: rgb(34 197 94 / .5)}.ring-offset-2{--tw-ring-offset-width: 2px}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\[50px\]{--tw-blur: blur(50px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.grayscale{--tw-grayscale: grayscale(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-\[2px\]{--tw-backdrop-blur: blur(2px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-100{transition-duration:.1s}.duration-150{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}.will-change-transform{will-change:transform}body{margin:0;padding:0;background-color:#09090b}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.select-text{-webkit-user-select:text;-moz-user-select:text;user-select:text}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.art-loader-container{position:fixed;top:0;left:0;right:0;bottom:0;background-color:#09090b;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;color:#e4e4e7}.art-center-group{display:flex;flex-direction:column;align-items:center;transform:translateY(-20px)}.art-visual{position:relative;width:60px;height:60px;margin-bottom:30px}.art-ring-outer{position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(255,255,255,.1);border-radius:50%;animation:art-breathe 4s ease-in-out infinite}.art-ring-inner{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:50%;border:1px solid transparent;border-top-color:#fff;border-left-color:#ffffff4d;opacity:.8;animation:art-spin 2s cubic-bezier(.4,0,.2,1) infinite}.art-dot{position:absolute;top:50%;left:50%;width:4px;height:4px;background-color:#fff;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #ffffff80}.art-title{font-size:12px;font-weight:300;text-transform:uppercase;letter-spacing:.3em;opacity:.9;margin-bottom:8px}.art-status{font-family:Courier New,monospace;font-size:10px;color:#71717a;letter-spacing:.1em;animation:art-pulse 2s ease-in-out infinite}.art-footer{position:absolute;bottom:40px;display:flex;flex-direction:column;align-items:center;text-align:center;gap:12px;opacity:0;animation:art-fade-up 1s ease-out .5s forwards}.footer-author{display:flex;flex-direction:column;gap:4px}.footer-author .label{font-size:9px;color:#52525b;text-transform:uppercase;letter-spacing:.2em}.footer-author .name{font-size:14px;font-weight:500;letter-spacing:.5em;color:#fff;text-indent:.5em}.footer-divider{width:20px;height:1px;background-color:#27272a}.footer-thanks{display:flex;flex-direction:column;gap:2px}.footer-thanks .label{font-size:8px;color:#3f3f46;text-transform:uppercase;letter-spacing:.1em}.footer-thanks .content{font-size:10px;color:#71717a;font-family:Courier New,monospace}.footer-thanks .highlight{color:#a1a1aa;font-weight:600}@keyframes art-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes art-breathe{0%,to{transform:scale(1);opacity:.5}50%{transform:scale(1.1);opacity:.2}}@keyframes art-pulse{0%,to{opacity:.4}50%{opacity:.8}}@keyframes art-fade-up{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.markdown-body{line-height:1.5}.markdown-body p{margin:0}.markdown-body p+p{margin-top:.5em}.markdown-body ul,.markdown-body ol{margin:.5em 0;padding-left:1.5em}.markdown-body pre{margin:.5em 0;padding:.5em;border-radius:.5em;overflow-x:auto}.markdown-body code{font-size:.875em}.placeholder\:text-zinc-400::-moz-placeholder{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-400::placeholder{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-600::-moz-placeholder{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-600::placeholder{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-700::-moz-placeholder{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-700::placeholder{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.placeholder\:text-opacity-50::-moz-placeholder{--tw-text-opacity: .5}.placeholder\:text-opacity-50::placeholder{--tw-text-opacity: .5}.after\:absolute:after{content:var(--tw-content);position:absolute}.after\:left-\[2px\]:after{content:var(--tw-content);left:2px}.after\:top-\[2px\]:after{content:var(--tw-content);top:2px}.after\:h-5:after{content:var(--tw-content);height:1.25rem}.after\:w-5:after{content:var(--tw-content);width:1.25rem}.after\:rounded-full:after{content:var(--tw-content);border-radius:9999px}.after\:bg-white:after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.after\:transition-all:after{content:var(--tw-content);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.after\:content-\[\'\'\]:after{--tw-content: "";content:var(--tw-content)}.focus-within\:border-blue-500\/30:focus-within{border-color:#3b82f64d}.focus-within\:border-blue-500\/50:focus-within{border-color:#3b82f680}.hover\:h-6:hover{height:1.5rem}.hover\:scale-100:hover{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-blue-300:hover{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.hover\:border-blue-400:hover{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.hover\:border-blue-500:hover{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.hover\:border-blue-500\/30:hover{border-color:#3b82f64d}.hover\:border-blue-500\/50:hover{border-color:#3b82f680}.hover\:border-green-400:hover{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.hover\:border-green-500:hover{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.hover\:border-zinc-300:hover{--tw-border-opacity: 1;border-color:rgb(212 212 216 / var(--tw-border-opacity, 1))}.hover\:border-zinc-400:hover{--tw-border-opacity: 1;border-color:rgb(161 161 170 / var(--tw-border-opacity, 1))}.hover\:border-zinc-500:hover{--tw-border-opacity: 1;border-color:rgb(113 113 122 / var(--tw-border-opacity, 1))}.hover\:border-zinc-600:hover{--tw-border-opacity: 1;border-color:rgb(82 82 91 / var(--tw-border-opacity, 1))}.hover\:border-zinc-700:hover{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.hover\:bg-amber-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-200:hover{--tw-bg-opacity: 1;background-color:rgb(253 230 138 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-600\/30:hover{background-color:#d977064d}.hover\:bg-amber-600\/40:hover{background-color:#d9770666}.hover\:bg-black\/70:hover{background-color:#000000b3}.hover\:bg-black\/80:hover{background-color:#000c}.hover\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-200:hover{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-400:hover{--tw-bg-opacity: 1;background-color:rgb(96 165 250 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-400\/30:hover{background-color:#60a5fa4d}.hover\:bg-blue-500:hover{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-500\/30:hover{background-color:#3b82f64d}.hover\:bg-blue-600:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-600\/30:hover{background-color:#2563eb4d}.hover\:bg-blue-600\/50:hover{background-color:#2563eb80}.hover\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-green-200:hover{--tw-bg-opacity: 1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.hover\:bg-green-400:hover{--tw-bg-opacity: 1;background-color:rgb(74 222 128 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500:hover{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500\/30:hover{background-color:#22c55e4d}.hover\:bg-green-600:hover{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.hover\:bg-green-600\/60:hover{background-color:#16a34a99}.hover\:bg-orange-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 215 170 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-500\/30:hover{background-color:#f973164d}.hover\:bg-orange-600\/40:hover{background-color:#ea580c66}.hover\:bg-purple-400:hover{--tw-bg-opacity: 1;background-color:rgb(192 132 252 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-500:hover{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.hover\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\:bg-red-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 202 202 / var(--tw-bg-opacity, 1))}.hover\:bg-red-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500:hover{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500\/10:hover{background-color:#ef44441a}.hover\:bg-red-600:hover{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600\/30:hover{background-color:#dc26264d}.hover\:bg-red-600\/50:hover{background-color:#dc262680}.hover\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\:bg-red-800:hover{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.hover\:bg-red-900\/60:hover{background-color:#7f1d1d99}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:bg-white\/20:hover{background-color:#fff3}.hover\:bg-yellow-400:hover{--tw-bg-opacity: 1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.hover\:bg-yellow-500:hover{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-100:hover{--tw-bg-opacity: 1;background-color:rgb(244 244 245 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-200:hover{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-300:hover{--tw-bg-opacity: 1;background-color:rgb(212 212 216 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-600:hover{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-700:hover{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-800:hover{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-800\/50:hover{background-color:#27272a80}.hover\:from-blue-500:hover{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-green-500:hover{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-purple-500:hover{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:to-emerald-500:hover{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.hover\:to-indigo-500:hover{--tw-gradient-to: #6366f1 var(--tw-gradient-to-position)}.hover\:text-blue-300:hover{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.hover\:text-blue-400:hover{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.hover\:text-blue-500:hover{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.hover\:text-blue-600:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.hover\:text-green-600:hover{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.hover\:text-red-300:hover{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-red-500:hover{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.hover\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:text-zinc-200:hover{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.hover\:text-zinc-300:hover{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.hover\:text-zinc-600:hover{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.hover\:text-zinc-700:hover{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.hover\:text-zinc-800:hover{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity, 1))}.hover\:text-zinc-900:hover{--tw-text-opacity: 1;color:rgb(24 24 27 / var(--tw-text-opacity, 1))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.hover\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:ring-1:hover{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.hover\:ring-zinc-400:hover{--tw-ring-opacity: 1;--tw-ring-color: rgb(161 161 170 / var(--tw-ring-opacity, 1))}.focus\:border-blue-500:focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:border-blue-500\/50:focus{border-color:#3b82f680}.focus\:border-blue-600\/50:focus{border-color:#2563eb80}.focus\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-blue-500\/50:focus{--tw-ring-color: rgb(59 130 246 / .5)}.active\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:.5}.group\/insert:hover .group-hover\/insert\:scale-100{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:bg-zinc-200{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.group\/cell:hover .group-hover\/cell\:opacity-100,.group\/insert:hover .group-hover\/insert\:opacity-100,.group\/main:hover .group-hover\/main\:opacity-100,.group\/preview:hover .group-hover\/preview\:opacity-100,.group:hover .group-hover\:opacity-100{opacity:1}.peer:checked~.peer-checked\:after\:translate-x-full:after{content:var(--tw-content);--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.peer:checked~.peer-checked\:after\:border-white:after{content:var(--tw-content);--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.peer:focus~.peer-focus\:outline-none{outline:2px solid transparent;outline-offset:2px}.peer:focus~.peer-focus\:ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.peer:focus~.peer-focus\:ring-blue-500\/50{--tw-ring-color: rgb(59 130 246 / .5)}@media (prefers-color-scheme: dark){.dark\:border-zinc-700{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.dark\:bg-blue-900\/30{background-color:#1e3a8a4d}.dark\:bg-zinc-700{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.dark\:bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.dark\:text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\:text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\:text-zinc-200{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.dark\:text-zinc-300{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.dark\:text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.dark\:hover\:bg-blue-900\/30:hover{background-color:#1e3a8a4d}.dark\:hover\:bg-zinc-700:hover{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-zinc-800:hover{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.dark\:hover\:text-zinc-300:hover{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}}</style>
</head>

<body style="margin: 0; padding: 0; background-color: #09090b;">
    <div id="root"></div>
</body>

</html>